/*!
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
!function(t){const e=t.ru=t.ru||{};e.dictionary=Object.assign(e.dictionary||{},{"%0 of %1":"%0 из %1",Big:"Крупный","Block quote":"Цитата","Blue marker":"Выделение синим маркером",Bold:"Жирный","Bulleted List":"Маркированный список",Cancel:"Отмена","Cannot upload file:":"Невозможно загрузить файл","Change image text alternative":"Редактировать альтернативный текст","Could not insert image at the current position.":"Нельзя вставить изображение на текущую позицию.","Could not obtain resized image URL.":"Не удалось получить URL с измененным размером изображения.","Decrease indent":"Уменьшить отступ",Default:"По умолчанию",Downloadable:"Загружаемые","Dropdown toolbar":"Выпадающая панель инструментов","Editor toolbar":"Панель инструментов редактора","Font Family":"Семейство шрифтов","Font Size":"Размер шрифта","Green marker":"Выделение зелёным маркером","Green pen":"Зеленый цвет текста","Heading 1":"Заголовок 1","Heading 2":"Заголовок 2","Heading 3":"Заголовок 3","Heading 4":"Заголовок 4","Heading 5":"Заголовок 5","Heading 6":"Заголовок 6",Highlight:"Выделить",Huge:"Очень крупный","Image toolbar":"Панель инструментов изображения","Increase indent":"Увеличить отступ","Insert image":"Вставить изображение","Insert image or file":"Вставьте изображение или файл","Insert paragraph after block":"","Insert paragraph before block":"","Inserting image failed":"Вставка изображения не удалась",Italic:"Курсив","media widget":"медиа-виджет",Next:"Следующий","Numbered List":"Нумерованный список","Open in a new tab":"Открыть в новой вкладке",Paragraph:"Параграф","Pink marker":"Выделение розовым маркером",Previous:"Предыдущий","Red pen":"Красный цвет текста",Redo:"Повторить","Remove highlight":"Убрать выделение","Rich Text Editor, %0":"Редактор, %0",Save:"Сохранить","Select all":"Выбрать все","Selecting resized image failed":"Выбор изображения с измененным размером не удался","Show more items":"Другие инструменты",Small:"Мелкий",Strikethrough:"Зачеркнутый","Table toolbar":"Панель инструментов таблицы","Text alternative":"Альтернативный текст","Text highlight toolbar":"Панель инструментов выделения текста",Tiny:"Очень мелкий",Underline:"Подчеркнутый",Undo:"Отменить","Upload failed":"Загрузка не выполнена","Upload in progress":"Идёт загрузка","Widget toolbar":"Панель инструментов виджета","Yellow marker":"Выделение жёлтым маркером"}),e.getPluralForm=function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:t%10==0||t%10>=5&&t%10<=9||t%100>=11&&t%100<=14?2:3}}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BalloonEditor=e():t.BalloonEditor=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=137)}([function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e,n){t=s(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e,n){t=s(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},function(t,e,n){"use strict";var i,s=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),r=[];function a(t){for(var e=-1,n=0;n<r.length;n++)if(r[n].identifier===t){e=n;break}return e}function l(t,e){for(var n={},i=[],s=0;s<t.length;s++){var o=t[s],l=e.base?o[0]+e.base:o[0],c=n[l]||0,h="".concat(l," ").concat(c);n[l]=c+1;var d=a(h),u={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(r[d].references++,r[d].updater(u)):r.push({identifier:h,updater:m(u,e),references:1}),i.push(h)}return i}function c(t){var e=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var s=n.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),"function"==typeof t.insert)t.insert(e);else{var r=o(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var h,d=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function u(t,e,n,i){var s=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(t.styleSheet)t.styleSheet.cssText=d(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}function f(t,e,n){var i=n.css,s=n.media,o=n.sourceMap;if(s?t.setAttribute("media",s):t.removeAttribute("media"),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var g=null,p=0;function m(t,e){var n,i,s;if(e.singleton){var o=p++;n=g||(g=c(e)),i=u.bind(null,n,o,!1),s=u.bind(null,n,o,!0)}else n=c(e),i=f.bind(null,n,e),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else s()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=s());var n=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var i=0;i<n.length;i++){var s=a(n[i]);r[s].references--}for(var o=l(t,e),c=0;c<n.length;c++){var h=a(n[c]);0===r[h].references&&(r[h].updater(),r.splice(h,1))}n=o}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e,n){t=s(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e){t=s(t),e&&(t+=" "+JSON.stringify(e)),super(t),this.name="CKEditorError",this.data=e}static isCKEditorError(t){return t instanceof i}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e,n){t=s(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));class i extends Error{constructor(t,e,n){t=s(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}function s(t){const e=t.match(/^([^:]+):/);return e?t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`:t}},function(t,e,n){"use strict";var i=n(27),s="object"==typeof self&&self&&self.Object===Object&&self,o=i.a||s||Function("return this")();e.a=o},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";(function(t){var i=n(17),s=n(40),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,r=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===o?i.a.Buffer:void 0,l=(a?a.isBuffer:void 0)||s.a;e.a=l}).call(this,n(30)(t))},function(t,e,n){"use strict";(function(t){var i=n(27),s="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=s&&"object"==typeof t&&t&&!t.nodeType&&t,r=o&&o.exports===s&&i.a.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||r&&r.binding&&r.binding("util")}catch(t){}}();e.a=a}).call(this,n(30)(t))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";var i=n(13);const s={error(t,e){console.error(Object(i.a)(t),e)},warn(t,e){console.warn(Object(i.a)(t),e)}};e.a=s},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new i(t.message,e);throw n.stack=t.stack,n}}},function(t,e,n){"use strict";(function(t){var e=n(0);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(11);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var i=n(17),s="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=s&&"object"==typeof t&&t&&!t.nodeType&&t,r=o&&o.exports===s?i.a.Buffer:void 0,a=r?r.allocUnsafe:void 0;e.a=function(t,e){if(e)return t.slice();var n=t.length,i=a?a(n):new t.constructor(n);return t.copy(i),i}}).call(this,n(30)(t))},function(t){t.exports=JSON.parse('{"a":"12.4.0"}')},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";(function(t){var e=n(6);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(41),i=n(29);const s="object"==typeof window?window:t;s.CKEDITOR_VERSION?e.a.error("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated."):s.CKEDITOR_VERSION=i.a}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(7);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(8);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(9);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(10);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(5);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(69);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e,n){"use strict";(function(t){var e=n(2);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";e.a=function(){return!1}},function(t,e,n){"use strict";var i=n(15);const s={error(t,e){console.error(Object(i.a)(t),e)},warn(t,e){console.warn(Object(i.a)(t),e)}};e.a=s},function(t,e,n){"use strict";(function(t){var e=n(3);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(44);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999);--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border-coordinates:208,79%,51%;--ck-color-focus-border:hsl(var(--ck-color-focus-border-coordinates));--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#5c5c5c;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"},function(t,e,n){var i=n(4),s=n(46);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}'},function(t,e,n){var i=n(4),s=n(48);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"},function(t,e,n){var i=n(4),s=n(50);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_n{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}'},function(t,e,n){var i=n(4),s=n(52);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(-1*var(--ck-spacing-small));margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(-1*var(--ck-spacing-small));margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"},function(t,e,n){var i=n(4),s=n(54);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"},function(t,e,n){var i=n(4),s=n(56);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"},function(t,e,n){var i=n(4),s=n(58);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}:root{--ck-dropdown-arrow-size:calc(0.5*var(--ck-icon-size))}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-dropdown__button_label-width_auto .ck-button__label{width:auto}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}"},function(t,e,n){var i=n(4),s=n(60);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(0.2*var(--ck-line-height-base)*var(--ck-font-size-base)) calc(0.4*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(1.2*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"},function(t,e,n){var i=n(4),s=n(62);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:calc(var(--ck-switch-button-toggle-width) - var(--ck-switch-button-toggle-inner-size) - 2*var(--ck-switch-button-toggle-spacing))}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(2*var(--ck-spacing-large))}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(2*var(--ck-spacing-large))}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(0.5*var(--ck-border-radius))}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(-1*var(--ck-switch-button-translation)))}"},function(t,e,n){var i=n(4),s=n(64);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-toolbar-dropdown .ck.ck-toolbar .ck.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar-dropdown .ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"},function(t,e,n){var i=n(4),s=n(66);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"},function(t,e,n){var i=n(4),s=n(68);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;margin-top:0;margin-bottom:0;background:var(--ck-color-toolbar-border)}.ck.ck-toolbar>.ck-toolbar__items>*{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small);margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>*,.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}"},function(t,e){t.exports=".ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none;cursor:text;color:var(--ck-color-engine-placeholder-text)}"},function(t,e,n){var i=n(4),s=n(71);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-color-editable-blur-selection:#d9d9d9}.ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-editor__editable_inline.ck-blurred ::selection{background:var(--ck-color-editable-blur-selection)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"},function(t,e,n){var i=n(4),s=n(73);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"},function(t,e,n){var i=n(4),s=n(75);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-color-grid{display:grid}:root{--ck-color-grid-tile-size:24px;--ck-color-color-grid-check-icon:#000}.ck.ck-color-grid{grid-gap:5px;padding:8px}.ck.ck-color-grid__tile{width:var(--ck-color-grid-tile-size);height:var(--ck-color-grid-tile-size);min-width:var(--ck-color-grid-tile-size);min-height:var(--ck-color-grid-tile-size);padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-color-grid__tile.ck-disabled{cursor:unset;transition:unset}.ck.ck-color-grid__tile.ck-color-table__color-tile_bordered{box-shadow:0 0 0 1px var(--ck-color-base-border)}.ck.ck-color-grid__tile .ck.ck-icon{display:none;color:var(--ck-color-color-grid-check-icon)}.ck.ck-color-grid__tile.ck-on{box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-base-text)}.ck.ck-color-grid__tile.ck-on .ck.ck-icon{display:block}.ck.ck-color-grid__tile.ck-on,.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){border:0}.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-color-grid__label{padding:0 var(--ck-spacing-standard)}"},function(t,e,n){var i=n(4),s=n(77);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"},function(t,e,n){"use strict";(function(t){var e=n(12);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(80);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck .ck-button.ck-color-table__remove-color{display:flex;align-items:center;width:100%}label.ck.ck-color-grid__label{font-weight:unset}.ck .ck-button.ck-color-table__remove-color{padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck .ck-button.ck-color-table__remove-color:not(:focus){border-bottom:1px solid var(--ck-color-base-border)}[dir=ltr] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-left:var(--ck-spacing-standard)}"},function(t,e,n){var i=n(4),s=n(82);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content .text-tiny{font-size:.7em}.ck-content .text-small{font-size:.85em}.ck-content .text-big{font-size:1.4em}.ck-content .text-huge{font-size:1.8em}"},function(t,e,n){var i=n(4),s=n(84);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-splitbutton{font-size:inherit}.ck.ck-splitbutton .ck-splitbutton__action:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button .ck-tooltip{display:none}:root{--ck-color-split-button-hover-background:#ebebeb;--ck-color-split-button-hover-border:#b3b3b3}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__action{border-top-right-radius:unset;border-bottom-right-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__action{border-top-left-radius:unset;border-bottom-left-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow{min-width:unset}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-radius:0}.ck-rounded-corners [dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow,[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:unset;border-bottom-left-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-right-radius:unset;border-bottom-right-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow svg{width:var(--ck-dropdown-arrow-size)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover),.ck.ck-splitbutton:hover>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover){background:var(--ck-color-split-button-hover-background)}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled){border-left-color:var(--ck-color-split-button-hover-border)}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled){border-right-color:var(--ck-color-split-button-hover-border)}.ck.ck-splitbutton.ck-splitbutton_open{border-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__action{border-bottom-left-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__arrow{border-bottom-right-radius:0}"},function(t,e,n){var i=n(4),s=n(86);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-highlight-marker-yellow:#fdfd77;--ck-highlight-marker-green:#62f962;--ck-highlight-marker-pink:#fc7899;--ck-highlight-marker-blue:#72ccfd;--ck-highlight-pen-red:#e71313;--ck-highlight-pen-green:#128a00}.ck-content .marker-yellow{background-color:var(--ck-highlight-marker-yellow)}.ck-content .marker-green{background-color:var(--ck-highlight-marker-green)}.ck-content .marker-pink{background-color:var(--ck-highlight-marker-pink)}.ck-content .marker-blue{background-color:var(--ck-highlight-marker-blue)}.ck-content .pen-red{color:var(--ck-highlight-pen-red);background-color:transparent}.ck-content .pen-green{color:var(--ck-highlight-pen-green);background-color:transparent}"},function(t,e,n){var i=n(4),s=n(88);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-block-toolbar-button{position:absolute;z-index:var(--ck-z-default)}:root{--ck-color-block-toolbar-button:var(--ck-color-text);--ck-block-toolbar-button-size:var(--ck-font-size-normal)}.ck.ck-block-toolbar-button{color:var(--ck-color-block-toolbar-button);font-size:var(--ck-block-toolbar-size)}"},function(t,e,n){"use strict";(function(t){var e=n(22);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(19);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(92);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-link-preview-padding:24px;--ck-link-preview-image-width:160px}section.ck-link.ck-widget_with-selection-handler.ck-widget_selected .ck-icon__selected-indicator,section.ck-link.ck-widget_with-selection-handler.ck-widget_selected:hover .ck-icon__selected-indicator,section.ck-link .ck.ck-widget__selection-handler,section.ck-link .ck.ck-widget__selection-handler:hover{opacity:0!important}section.ck-link.ck-widget,section.ck-link.ck-widget:hover,section.ck-link.ck-widget_selected,section.ck-link.ck-widget_selected:hover{outline:none!important;transition:none!important}.ck-link.ck-widget.ck-widget_selected{box-shadow:inset 0 0 0 1px #3bc7ab}section.ck-link .ck-link__image{display:table-cell;vertical-align:middle;width:var(--ck-link-preview-image-width);margin-right:2px;-webkit-box-sizing:border-box;box-sizing:border-box}section.ck-link .ck-link__image img{width:160px}section.ck-link{box-shadow:inset 0 0 0 1px rgba(0,0,0,.09);display:flex;align-items:center;margin:0 0 24px}section.ck-link .ck-link__container{padding:var(--ck-link-preview-padding);width:calc(100% - var(--ck-link-preview-image-width) - 2*var(--ck-link-preview-padding) - 2px)}section.ck-link .ck-link__header{letter-spacing:0;font-weight:400;font-style:normal;font-size:18px;line-height:1.3;color:#333;margin:0 0 8px}section.ck-link .ck-link__url,section.ck-link .ck-link__url a{overflow:hidden;text-overflow:ellipsis;font-size:12px;text-decoration:none;border-bottom:none}section.ck-link .ck-link__description{font-size:16px;font-style:normal;color:#556066;margin-bottom:10px;line-height:1em;white-space:normal!important}"},function(t,e,n){"use strict";(function(t){var e=n(16);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(95);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='.ck .ck-widget .ck-widget__type-around__button{display:block;position:absolute;overflow:hidden;z-index:var(--ck-z-default)}.ck .ck-widget .ck-widget__type-around__button svg{position:absolute;top:50%;left:50%;z-index:calc(var(--ck-z-default) + 2)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_before{top:calc(-0.5*var(--ck-widget-outline-thickness));left:min(10%,30px);transform:translateY(-50%)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_after{bottom:calc(-0.5*var(--ck-widget-outline-thickness));right:min(10%,30px);transform:translateY(50%)}.ck .ck-widget:not(.ck-widget_can-type-around_after)>.ck-widget__type-around>.ck-widget__type-around__button_after,.ck .ck-widget:not(.ck-widget_can-type-around_before)>.ck-widget__type-around>.ck-widget__type-around__button_before{display:none}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{content:"";display:block;position:absolute;top:1px;left:1px;z-index:calc(var(--ck-z-default) + 1)}.ck.ck-editor__editable.ck-read-only .ck-widget__type-around,.ck.ck-editor__editable.ck-restricted-editing_mode_restricted .ck-widget__type-around{display:none}:root{--ck-widget-type-around-button-size:20px;--ck-color-widget-type-around-button-active:var(--ck-color-focus-border);--ck-color-widget-type-around-button-hover:var(--ck-color-widget-hover-border);--ck-color-widget-type-around-button-blurred-editable:var(--ck-color-widget-blurred-border);--ck-color-widget-type-around-button-radar-start-alpha:0;--ck-color-widget-type-around-button-radar-end-alpha:.3;--ck-color-widget-type-around-button-icon:var(--ck-color-base-background)}.ck .ck-widget .ck-widget__type-around__button{width:var(--ck-widget-type-around-button-size);height:var(--ck-widget-type-around-button-size);background:var(--ck-color-widget-type-around-button);border-radius:100px;pointer-events:none;opacity:0;transition:opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget .ck-widget__type-around__button svg{width:10px;height:8px;transform:translate(-50%,-50%);transition:transform .5s ease;margin-top:1px}.ck .ck-widget .ck-widget__type-around__button svg *{stroke-dasharray:10;stroke-dashoffset:0;fill:none;stroke:var(--ck-color-widget-type-around-button-icon);stroke-width:1.5px;stroke-linecap:round;stroke-linejoin:round}.ck .ck-widget .ck-widget__type-around__button svg line{stroke-dasharray:7}.ck .ck-widget .ck-widget__type-around__button:hover{animation:ck-widget-type-around-button-sonar 1s ease infinite}.ck .ck-widget .ck-widget__type-around__button:hover svg polyline{animation:ck-widget-type-around-arrow-dash 2s linear}.ck .ck-widget .ck-widget__type-around__button:hover svg line{animation:ck-widget-type-around-arrow-tip-dash 2s linear}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{pointer-events:auto;opacity:1}.ck .ck-widget:not(.ck-widget_selected)>.ck-widget__type-around>.ck-widget__type-around__button{background:var(--ck-color-widget-type-around-button-hover)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover{background:var(--ck-color-widget-type-around-button-active)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{width:calc(var(--ck-widget-type-around-button-size) - 2px);height:calc(var(--ck-widget-type-around-button-size) - 2px);border-radius:100px;background:linear-gradient(135deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.3))}.ck .ck-widget.ck-widget_with-selection-handle>.ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:20px}.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{pointer-events:none;opacity:0}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover){background:var(--ck-color-widget-type-around-button-blurred-editable)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover) svg *{stroke:#999}@keyframes ck-widget-type-around-arrow-dash{0%{stroke-dashoffset:10}20%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-arrow-tip-dash{0%,20%{stroke-dashoffset:7}40%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-button-sonar{0%{box-shadow:0 0 0 0 hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}50%{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-end-alpha))}to{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}}'},function(t,e,n){var i=n(4),s=n(97);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-resizer-size:10px;--ck-resizer-border-width:1px;--ck-resizer-border-radius:2px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-tooltip-offset:10px;--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2}.ck .ck-widget,.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:var(--ck-spacing-small)}.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck.ck-editor__editable.ck-read-only .ck-widget{transition:none}.ck.ck-editor__editable.ck-read-only .ck-widget:not(.ck-widget_selected){--ck-widget-outline-thickness:0px}.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle:hover,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}"},function(t,e,n){"use strict";(function(t){var e=n(24);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){"use strict";(function(t){var e=n(14);const i="object"==typeof window?window:t;if(i.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);i.CKEDITOR_VERSION="19.1.1"}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(101);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-labeled-field-view .ck-labeled-field-view__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-field-view .ck-labeled-field-view__status_error{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view>.ck.ck-label{width:100%;text-overflow:ellipsis;overflow:hidden}"},function(t,e,n){var i=n(4),s=n(103);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{box-shadow:var(--ck-inner-shadow),0 0;background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .2s ease-in-out,border .2s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),var(--ck-inner-shadow)}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"},function(t,e,n){var i=n(4),s=n(105);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-field-view{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}.ck.ck-text-alternative-form{padding:var(--ck-spacing-standard)}.ck.ck-text-alternative-form:focus{outline:none}[dir=ltr] .ck.ck-text-alternative-form>:not(:first-child),[dir=rtl] .ck.ck-text-alternative-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-text-alternative-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-text-alternative-form .ck-labeled-field-view{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-text-alternative-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-text-alternative-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-text-alternative-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-text-alternative-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(t,e,n){var i=n(4),s=n(107);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content .image{display:table;clear:both;text-align:center;margin:1em auto}.ck-content .image>img{display:block;margin:0 auto;max-width:100%;min-width:50px}"},function(t,e,n){var i=n(4),s=n(109);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-editor__editable .image{position:relative}.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"},function(t,e,n){var i=n(4),s=n(111);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'},function(t,e,n){var i=n(4),s=n(113);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'},function(t,e,n){"use strict";(function(t){var e=n(23),i=n(29);const s="object"==typeof window?window:t;s.CKEDITOR_VERSION?e.a.error("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated."):s.CKEDITOR_VERSION=i.a}).call(this,n(18))},function(t,e,n){var i=n(4),s=n(116);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"},function(t,e,n){var i=n(4),s=n(118);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:#333;background-color:#f7f7f7;padding:.6em;font-size:.75em;outline-offset:-1px}"},function(t,e,n){var i=n(4),s=n(120);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-image-style-spacing:1.5em;--ck-image-upload-progress-line-width:30px}.ck-content__image{clear:both;text-align:center;margin:1em 0}.ck-content__image img{display:block;margin:0 auto;max-width:100%}.ck-content__image{position:relative;overflow:hidden}.ck-content__image .ck-progress-bar{position:absolute;top:0;left:0}.ck-content__image figcaption{background-color:transparent!important;color:#9aa5ab;font-size:14px;padding:16px;display:block!important;text-align:center}.ck-content__image_align-center,.ck-content__image_align-left,.ck-content__image_align-right,.ck-content__image_side{max-width:50%}.ck-content__image_side{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content__image_align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content__image_align-center{margin-left:auto;margin-right:auto}.ck-content__image_align-right{float:right;margin-left:var(--ck-image-style-spacing)}"},function(t,e,n){var i=n(4),s=n(122);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck.ck-labeled-input .ck-labeled-input__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-input .ck-labeled-input__status_error{color:var(--ck-color-base-error)}"},function(t,e,n){var i=n(4),s=n(124);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(3*var(--ck-spacing-standard));background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c7,#b800b1,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}'},function(t,e,n){var i=n(4),s=n(126);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content .media{clear:both;margin:1em 0;display:block;min-width:15em}"},function(t,e,n){var i=n(4),s=n(128);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"},function(t,e,n){var i=n(4),s=n(130);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"},function(t,e,n){var i=n(4),s=n(132);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=':root{--ck-table-selected-cell-background:rgba(158,207,250,0.3)}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{position:relative;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected:after,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:after{content:"";pointer-events:none;background-color:var(--ck-table-selected-cell-background);position:absolute;top:0;left:0;right:0;bottom:0}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table td.ck-editor__editable_selected:focus,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:focus{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget_selected{outline:unset}'},function(t,e,n){var i=n(4),s=n(134);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports=".ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border:1px solid #bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}.ck-content[dir=rtl] .table th{text-align:right}.ck-content[dir=ltr] .table th{text-align:left}"},function(t,e,n){var i=n(4),s=n(136);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};i(s,o);t.exports=s.locals||{}},function(t,e){t.exports='@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-Bold.otf) format("opentype");font-weight:700;font-style:normal}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-BoldIt.otf) format("opentype");font-weight:700;font-style:italic}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-Light.otf) format("opentype");font-weight:100;font-style:normal}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-LightIt.otf) format("opentype");font-weight:100;font-style:italic}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-Semibold.otf) format("opentype");font-weight:600;font-style:normal}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-Reg.otf) format("opentype");font-weight:400;font-style:normal}@font-face{font-family:ProximaNova;src:url(../src/assets/fonts/ProximaNova-RegIt.otf) format("opentype");font-weight:400;font-style:italic}*{font-family:ProximaNova!important}:root{--ck-border-radius:8px!important;--ck-icon-size:24px!important;--ck-custom-background:#556066!important;--ck-custom-foreground:#556066!important;--ck-custom-border:#556066!important;--ck-color-base-border:#556066!important;--ck-color-base-foreground:var(--ck-custom-background)!important;--ck-color-button-default-background:var(--ck-custom-background)!important;--ck-color-base-background:var(--ck-custom-background)!important;--ck-color-button-default-hover-background:#fff!important;--ck-color-button-default-active-background:#fff!important;--ck-color-button-default-active-shadow:transparent!important;--ck-color-button-on-background:var(--ck-custom-foreground)!important;--ck-color-button-on-hover-background:#fff!important;--ck-color-focus-border:transparent!important;--ck-color-dropdown-panel-background:#fff!important;--ck-color-dropdown-panel-border:transparent!important;--ck-focus-outer-shadow:transparent!important;--ck-inner-shadow:transparent!important;--ck-focus-disabled-outer-shadow:transparent!important;--ck-focus-error-outer-shadow:transparent!important;--ck-color-tooltip-background:#1f8ceb!important;--ck-tooltip-arrow-size:8px!important;--ck-custom-shadow:-4px 5px 18px 0 rgba(29,42,68,0.13)!important;--ck-dropdown-arrow-size:calc(var(--ck-icon-size))!important;--ck-color-switch-button-off-background:#e4e5e9!important;--ck-color-switch-button-on-background:#1f8ceb!important;--ck-color-switch-button-inner-background:#fff!important;--ck-switch-button-toggle-spacing:2px!important;--ck-switch-button-toggle-inner-size:16px!important;--ck-switch-button-toggle-width:32px!important;--ck-switch-button-toggle-transform:calc(var(--ck-switch-button-toggle-width) - 2*var(--ck-switch-button-toggle-spacing) - var(--ck-switch-button-toggle-inner-size))!important;--ck-color-widget-editable-focus-background:hsla(0,0%,100%,0)!important;--ck-insert-table-dropdown-padding:16px!important}.ck.ck-toolbar{max-width:700px}.ck-button{cursor:pointer!important}.ck-toolbar .ck-button{outline:none!important;padding:0!important;width:32px!important;height:32px!important;margin:0 4px 0 0!important}.ck-dropdown .ck-button{border-radius:var(--ck-border-radius)}.ck-dropdown__button .ck-button__icon{margin-right:0!important}.ck.ck-dropdown__header{font-size:16px;font-weight:600;line-height:1.25;color:#9aa5ab;margin-bottom:16px}.ck.ck-button.ck-off{color:#fff!important}.ck.ck-button.ck-on{color:#1ebfe9!important}.ck.ck-button.ck-off:hover,.ck.ck-button.ck-on:hover,.ck.ck-button:active{color:var(--ck-custom-background)!important}.ck.ck-button.ck-disabled:hover{color:#fff!important}.ck-button .ck-dropdown__arrow{margin-left:-8px!important;height:8px!important}.ck-dropdown__panel{padding:8px!important;background-color:var(--ck-color-dropdown-panel-background);border:0 solid!important;top:46px!important;border-radius:var(--ck-border-radius)!important;-webkit-box-shadow:var(--ck-custom-shadow)!important;-moz-box-shadow:var(--ck-custom-shadow)!important}.ck-dropdown__container,.ck-dropdown__panel{box-shadow:var(--ck-custom-shadow)!important}.ck-dropdown__container{margin-top:14px!important;background-color:var(--ck-color-dropdown-panel-background)!important;border-radius:var(--ck-border-radius)!important}.ck-alignment-dropdown .ck-dropdown__container .ck-button{margin:4px!important}.ck-dropdown__panel .ck-list{background-color:var(--ck-color-dropdown-panel-background);border:0 solid!important;box-shadow:var(--ck-custom-shadow)!important;border-radius:var(--ck-border-radius)!important}.ck-dropdown__panel .ck-list .ck-list__separator{display:none!important}.ck-rounded-corners .ck.ck-dropdown__panel{border-top-left-radius:var(--ck-border-radius)!important}.ck-alignment-dropdown .ck-dropdown__panel{padding:4px!important}.ck-alignment-dropdown .ck-toolbar{background-color:#fff!important}.ck-alignment-dropdown .ck-dropdown__panel .ck-button{background-color:#fff!important;color:#333!important;width:32px!important;height:32px!important}.ck.ck-button.ck-dropdown__button{display:inline-block;width:36px!important;border-bottom-left-radius:var(--ck-border-radius)!important;border-bottom-right-radius:var(--ck-border-radius)!important}.ck.ck-button.ck-dropdown__button.ck-on,.ck.ck-button.ck-dropdown__button.ck-on:hover{color:var(--ck-custom-background)!important;background-color:#fff!important}.ck-dropdown__panel .ck-button_with-text.ck-off,.ck-dropdown__panel .ck-button_with-text.ck-on{width:100%!important;height:100%!important;color:#333!important;background-color:#fff!important;padding:6px 8px!important;justify-content:space-between;border:none!important;border-radius:var(--ck-border-radius)!important}.ck-heading-dropdown .ck-dropdown__panel{padding:0!important}.ck-heading-dropdown .ck-dropdown__panel .ck-button{padding:10px 16px 10px 24px!important}.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{border-bottom:1px solid #e4e5e9!important}.ck-heading-dropdown .ck-dropdown__panel .ck-button,.ck-heading-dropdown .ck-dropdown__panel .ck-button.ck-on,.ck-heading-dropdown .ck-dropdown__panel .ck-button:hover{color:#333!important}.ck-heading-dropdown .ck-dropdown__panel .ck-button.ck-on:after{content:url(../src/assets/icons/done-green.svg);align-items:center!important}.ck-heading-dropdown .ck-dropdown__panel .ck-list__item:last-child{border-bottom:0 solid transparent!important}.ck.ck-link-form,.ck.ck-media-form{padding:20px 16px!important;border:0 solid!important;border-radius:4px!important;outline:none;--ck-color-panel-border:transparent!important}.ck.ck-link-form .ck-dropdown__header,.ck.ck-media-form .ck-dropdown__header{color:#fff!important}.ck.ck-link-form .ck-label,.ck.ck-media-form .ck-label{font-size:12px;letter-spacing:.5px;margin-bottom:6px;line-height:1.42;color:#fff;font-weight:400;text-transform:uppercase}.ck.ck-link-form .ck-input-text,.ck.ck-media-form .ck-input-text{font-size:14px;font-weight:400;line-height:1.21;letter-spacing:normal;color:#556066!important}.ck.ck-link-form .ck-input-text::placeholder,.ck.ck-media-form .ck-input-text::placeholder{color:#9aa5ab!important}.ck.ck-link-form .ck-input,.ck.ck-media-form .ck-input{height:40px;border:1px solid #9aa5ab;margin-bottom:16px;background-color:#fff!important;color:#556066!important;border-radius:4px!important}.ck-link-actions{padding:4px 12px!important}.ck.ck-block-toolbar-button{border-radius:50%!important;color:#1f8ceb!important;width:40px;height:40px;box-shadow:-4px 5px 18px 0 rgba(29,42,68,.13)!important;background-color:hsla(0,0%,100%,0)!important;transform-origin:0 0;transform:translateX(calc(-1*var(--ck-spacing-large)))}.ck.ck-block-toolbar-button .ck-icon{transition:transform .2s ease}.ck.ck-block-toolbar-button.ck-on .ck-icon{transform:rotate(45deg)}.ck-dropdown__panel .ck-button:hover{background-color:#f6f9fb!important}.ck-dropdown__panel .ck-button.ck-disabled:hover{color:#9aa5ab!important}.ck-toolbar__separator{margin:8px 4px 8px 0!important;height:24px!important;background-color:#fff!important}.ck-tooltip{position:relative;top:-20px!important}.ck-tooltip__text{background-color:#1f8ceb!important;color:#fff!important;padding:10px 16px!important;font-size:14px!important;line-height:1.21!important;border-radius:var(--ck-border-radius)}.ck-tooltip__text:after{color:#1f8ceb!important}.ck-alignment-dropdown .ck-dropdown__panel,.ck-custom-highlight .ck-dropdown__panel,.ck-custom-table-dropdown .ck-dropdown__panel,.ck-media-embed-dropdown .ck-dropdown__panel{top:unset!important;padding:0!important;box-shadow:none!important;background-color:transparent!important}.ck-custom-highlight .ck-dropdown__container{margin-top:14px;padding:18px 12px 8px 16px!important;background-color:#fff!important;box-shadow:var(--ck-custom-shadow)!important;border-radius:var(--ck-border-radius)!important}.ck-custom-highlight .ck-dropdown__panel .ck-toolbar{width:290px;background-color:inherit!important;display:flex;flex-wrap:wrap;padding:0 0 16px}.ck-custom-highlight .ck-dropdown__panel .ck-toolbar .ck-button{border:none!important;padding:0!important;margin:0 8px 8px 0!important;width:40px!important;height:40px!important;border-radius:4px!important}.ck-custom-highlight .ck-dropdown__panel .ck-toolbar .ck-icon{display:none}.ck-custom-highlight .ck-dropdown__panel .ck-toolbar .ck-button_eraser{border:1px double #e4e5e9!important;border-radius:4px;background-color:transparent!important}.ck-dropdown__panel .ck-toolbar .ck-button_eraser .ck-icon{color:var(--ck-custom-background)!important;display:inherit;height:22px!important}:root{--ck-custom-highlight-marker-yellow:#fdf5dd;--ck-custom-highlight-marker-green:#e3f7f3;--ck-custom-highlight-marker-orange:#fbe8df;--ck-custom-highlight-marker-blue:#ddf5fb;--ck-custom-highlight-marker-gray:#f0f2f3;--ck-custom-highlight-pen-red:#f35e5e;--ck-custom-highlight-pen-green:#3bc7ab;--ck-custom-highlight-pen-blue:#1f8ceb;--ck-custom-highlight-pen-light-blue:#1ebfe9;--ck-custom-highlight-pen-yellow:#f4c221;--ck-custom-highlight-pen-orange:#e86d31;--ck-custom-highlight-pen-black:#333;--ck-custom-highlight-pen-gray:#c4c7cc;--ck-custom-highlight-pen-light-gray:#e4e5e9;--ck-custom-highlight-pen-medium-gray:#9aa5ab;--ck-custom-highlight-pen-dark-gray:#556066}\n\n/*!* Override default yellow background of `<mark>` from user agent stylesheet *!*/.marker-yellow{background-color:#fdf5dd}.marker-green{background-color:#e3f7f3}.marker-orange{background-color:#fbe8df}.marker-blue{background-color:#ddf5fb}.marker-gray{background-color:#f0f2f3}.pen-red{color:#f35e5e}.pen-green,.pen-red{background-color:transparent!important}.pen-green{color:#3bc7ab}.pen-blue{color:#1f8ceb}.pen-blue,.pen-light-blue{background-color:transparent!important}.pen-light-blue{color:#1ebfe9}.pen-yellow{color:#f4c221}.pen-orange,.pen-yellow{background-color:transparent!important}.pen-orange{color:#e86d31}.pen-black{color:#333}.pen-black,.pen-gray{background-color:transparent!important}.pen-gray{color:#c4c7cc}.pen-light-gray{color:#e4e5e9}.pen-light-gray,.pen-medium-gray{background-color:transparent!important}.pen-medium-gray{color:#9aa5ab}.pen-dark-gray{color:#556066;background-color:transparent!important}.ck.ck-button.marker-yellow,.ck.ck-button.marker-yellow:hover{background-color:var(--ck-custom-highlight-marker-yellow)!important}.ck.ck-button.pen-yellow,.ck.ck-button.pen-yellow:hover{background-color:var(--ck-custom-highlight-pen-yellow)!important}.ck.ck-button.marker-yellow.ck-on:before,.ck.ck-button.pen-yellow.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-yellow:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-yellow:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-green,.ck.ck-button.marker-green:hover{background-color:var(--ck-custom-highlight-marker-green)!important}.ck.ck-button.pen-green,.ck.ck-button.pen-green:hover{background-color:var(--ck-custom-highlight-pen-green)!important}.ck.ck-button.marker-green.ck-on:before,.ck.ck-button.pen-green.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-green:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-green:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-orange,.ck.ck-button.marker-orange:hover{background-color:var(--ck-custom-highlight-marker-orange)!important}.ck.ck-button.pen-orange,.ck.ck-button.pen-orange:hover{background-color:var(--ck-custom-highlight-pen-orange)!important}.ck.ck-button.marker-orange.ck-on:before,.ck.ck-button.pen-orange.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-orange:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-orange:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-blue,.ck.ck-button.marker-blue:hover{background-color:var(--ck-custom-highlight-marker-blue)!important}.ck.ck-button.pen-blue,.ck.ck-button.pen-blue:hover{background-color:var(--ck-custom-highlight-pen-blue)!important}.ck.ck-button.marker-blue.ck-on:before,.ck.ck-button.pen-blue.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-blue:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-blue:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-gray,.ck.ck-button.marker-gray:hover{background-color:var(--ck-custom-highlight-marker-gray)!important}.ck.ck-button.pen-gray,.ck.ck-button.pen-gray:hover{background-color:var(--ck-custom-highlight-pen-gray)!important}.ck.ck-button.marker-gray.ck-on:before,.ck.ck-button.pen-gray.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-gray:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-gray:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-red,.ck.ck-button.marker-red:hover{background-color:var(--ck-custom-highlight-marker-red)!important}.ck.ck-button.pen-red,.ck.ck-button.pen-red:hover{background-color:var(--ck-custom-highlight-pen-red)!important}.ck.ck-button.marker-red.ck-on:before,.ck.ck-button.pen-red.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-red:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-red:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-light-blue,.ck.ck-button.marker-light-blue:hover{background-color:var(--ck-custom-highlight-marker-light-blue)!important}.ck.ck-button.pen-light-blue,.ck.ck-button.pen-light-blue:hover{background-color:var(--ck-custom-highlight-pen-light-blue)!important}.ck.ck-button.marker-light-blue.ck-on:before,.ck.ck-button.pen-light-blue.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-light-blue:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-light-blue:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-black,.ck.ck-button.marker-black:hover{background-color:var(--ck-custom-highlight-marker-black)!important}.ck.ck-button.pen-black,.ck.ck-button.pen-black:hover{background-color:var(--ck-custom-highlight-pen-black)!important}.ck.ck-button.marker-black.ck-on:before,.ck.ck-button.pen-black.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-black:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-black:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-dark-gray,.ck.ck-button.marker-dark-gray:hover{background-color:var(--ck-custom-highlight-marker-dark-gray)!important}.ck.ck-button.pen-dark-gray,.ck.ck-button.pen-dark-gray:hover{background-color:var(--ck-custom-highlight-pen-dark-gray)!important}.ck.ck-button.marker-dark-gray.ck-on:before,.ck.ck-button.pen-dark-gray.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-dark-gray:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-dark-gray:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-medium-gray,.ck.ck-button.marker-medium-gray:hover{background-color:var(--ck-custom-highlight-marker-medium-gray)!important}.ck.ck-button.pen-medium-gray,.ck.ck-button.pen-medium-gray:hover{background-color:var(--ck-custom-highlight-pen-medium-gray)!important}.ck.ck-button.marker-medium-gray.ck-on:before,.ck.ck-button.pen-medium-gray.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-medium-gray:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-medium-gray:before{content:url(../src/assets/icons/done-black.svg)}.ck.ck-button.marker-light-gray,.ck.ck-button.marker-light-gray:hover{background-color:var(--ck-custom-highlight-marker-light-gray)!important}.ck.ck-button.pen-light-gray,.ck.ck-button.pen-light-gray:hover{background-color:var(--ck-custom-highlight-pen-light-gray)!important}.ck.ck-button.marker-light-gray.ck-on:before,.ck.ck-button.pen-light-gray.ck-on:before{position:absolute;top:8px;left:8px;z-index:3}.ck.ck-button.ck-on.pen-light-gray:before{content:url(../src/assets/icons/done.svg)}.ck.ck-button.ck-on.marker-light-gray:before{content:url(../src/assets/icons/done-black.svg)}.ck-button__toggle{border-radius:10px!important}.ck-button__toggle__inner{border-radius:50%!important;cursor:pointer!important}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-toggle-transform))!important}.ck-media-embed-dropdown .ck-dropdown__container{padding-bottom:40px!important;background-color:var(--ck-color-base-background)!important}.ck-link-form .ck-button-save,.ck-media-form .ck.ck-button.ck-button-save{float:right!important;margin-bottom:16px!important;font-size:16px!important;font-weight:600!important;line-height:1.25!important;height:40px!important;width:auto!important;padding-right:20px!important;padding-left:20px!important;border-radius:4px!important}.ck-link-form .ck.ck-button.ck-button-save,.ck-media-form .ck.ck-button.ck-button_with-text.ck-off{color:#fff!important;border-color:#1f8ceb!important;background-color:#1f8ceb!important}.ck-link-form .ck.ck-button.ck-button-save:hover,.ck-media-form .ck.ck-button.ck-button_with-text.ck-off:hover{background-color:#3095ec!important;border-color:#3095ec!important}.ck-link-form .ck.ck-button.ck-button-save:active,.ck-media-form .ck.ck-button.ck-button_with-text.ck-off:active{background-color:#409ded!important;border-color:#409ded!important}.ck-link-form .ck.ck-button.ck-button-save:disabled,.ck-media-form .ck.ck-button.ck-button_with-text.ck-off:disabled{background-color:#c4c7cc!important;border-color:#c4c7cc!important}.ck-custom-table-dropdown .ck-dropdown__container .ck-list{padding:8px!important}.ck-insert-table-dropdown__grid{padding:16px 16px 8px!important}.ck-insert-table-dropdown__label{padding-bottom:16px!important;line-height:normal!important}.ck-delimiter.ck-placeholder:before,.ck-delimiter:before{display:inline-block;content:" "!important;font-size:30px;line-height:65px;height:0;width:100%;margin:7px auto 8px;letter-spacing:.2em;border-bottom:1px solid #e4e5e9}.ck-delimiter.ck-widget,.ck-delimiter.ck-widget:hover,.ck-delimiter.ck-widget_selected,.ck-delimiter.ck-widget_selected:hover{outline:none!important;transition:none!important}.ck-delimiter-remove-container:after,.ck-delimiter-remove-container:before,.ck-delimiter .ck-widget__selection-handler{display:none!important}.ck-delimiter-remove-container,.ck-delimiter-remove-container .ck-button,.ck-delimiter-remove-container .ck-toolbar{border:none!important;box-shadow:none!important;background-color:transparent!important}.ck-content blockquote{border-left:2px solid #556066;padding-left:16px;line-height:1.5}'},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return jM}));var i=n(17),s=i.a.Symbol,o=Object.prototype,r=o.hasOwnProperty,a=o.toString,l=s?s.toStringTag:void 0;var c=function(t){var e=r.call(t,l),n=t[l];try{t[l]=void 0;var i=!0}catch(t){}var s=a.call(t);return i&&(e?t[l]=n:delete t[l]),s},h=Object.prototype.toString;var d=function(t){return h.call(t)},u=s?s.toStringTag:void 0;var f=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":u&&u in Object(t)?c(t):d(t)};var g=function(t,e){return function(n){return t(e(n))}},p=g(Object.getPrototypeOf,Object);var m=function(t){return null!=t&&"object"==typeof t},b=Function.prototype,w=Object.prototype,_=b.toString,k=w.hasOwnProperty,v=_.call(Object);var y=function(t){if(!m(t)||"[object Object]"!=f(t))return!1;var e=p(t);if(null===e)return!0;var n=k.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&_.call(n)==v};var x=function(){this.__data__=[],this.size=0};var C=function(t,e){return t===e||t!=t&&e!=e};var E=function(t,e){for(var n=t.length;n--;)if(C(t[n][0],e))return n;return-1},T=Array.prototype.splice;var A=function(t){var e=this.__data__,n=E(e,t);return!(n<0)&&(n==e.length-1?e.pop():T.call(e,n,1),--this.size,!0)};var P=function(t){var e=this.__data__,n=E(e,t);return n<0?void 0:e[n][1]};var S=function(t){return E(this.__data__,t)>-1};var O=function(t,e){var n=this.__data__,i=E(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function M(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}M.prototype.clear=x,M.prototype.delete=A,M.prototype.get=P,M.prototype.has=S,M.prototype.set=O;var N=M;var I=function(){this.__data__=new N,this.size=0};var R=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var L=function(t){return this.__data__.get(t)};var D=function(t){return this.__data__.has(t)};var V=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var B,F=function(t){if(!V(t))return!1;var e=f(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},j=i.a["__core-js_shared__"],z=(B=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";var q=function(t){return!!z&&z in t},U=Function.prototype.toString;var W=function(t){if(null!=t){try{return U.call(t)}catch(t){}try{return t+""}catch(t){}}return""},H=/^\[object .+?Constructor\]$/,K=Function.prototype,J=Object.prototype,$=K.toString,G=J.hasOwnProperty,Y=RegExp("^"+$.call(G).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Q=function(t){return!(!V(t)||q(t))&&(F(t)?Y:H).test(W(t))};var Z=function(t,e){return null==t?void 0:t[e]};var X=function(t,e){var n=Z(t,e);return Q(n)?n:void 0},tt=X(i.a,"Map"),et=X(Object,"create");var nt=function(){this.__data__=et?et(null):{},this.size=0};var it=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},st=Object.prototype.hasOwnProperty;var ot=function(t){var e=this.__data__;if(et){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return st.call(e,t)?e[t]:void 0},rt=Object.prototype.hasOwnProperty;var at=function(t){var e=this.__data__;return et?void 0!==e[t]:rt.call(e,t)};var lt=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=et&&void 0===e?"__lodash_hash_undefined__":e,this};function ct(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ct.prototype.clear=nt,ct.prototype.delete=it,ct.prototype.get=ot,ct.prototype.has=at,ct.prototype.set=lt;var ht=ct;var dt=function(){this.size=0,this.__data__={hash:new ht,map:new(tt||N),string:new ht}};var ut=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var ft=function(t,e){var n=t.__data__;return ut(e)?n["string"==typeof e?"string":"hash"]:n.map};var gt=function(t){var e=ft(this,t).delete(t);return this.size-=e?1:0,e};var pt=function(t){return ft(this,t).get(t)};var mt=function(t){return ft(this,t).has(t)};var bt=function(t,e){var n=ft(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};function wt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}wt.prototype.clear=dt,wt.prototype.delete=gt,wt.prototype.get=pt,wt.prototype.has=mt,wt.prototype.set=bt;var _t=wt;var kt=function(t,e){var n=this.__data__;if(n instanceof N){var i=n.__data__;if(!tt||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new _t(i)}return n.set(t,e),this.size=n.size,this};function vt(t){var e=this.__data__=new N(t);this.size=e.size}vt.prototype.clear=I,vt.prototype.delete=R,vt.prototype.get=L,vt.prototype.has=D,vt.prototype.set=kt;var yt=vt;var xt=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},Ct=function(){try{var t=X(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Et=function(t,e,n){"__proto__"==e&&Ct?Ct(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Tt=Object.prototype.hasOwnProperty;var At=function(t,e,n){var i=t[e];Tt.call(t,e)&&C(i,n)&&(void 0!==n||e in t)||Et(t,e,n)};var Pt=function(t,e,n,i){var s=!n;n||(n={});for(var o=-1,r=e.length;++o<r;){var a=e[o],l=i?i(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),s?Et(n,a,l):At(n,a,l)}return n};var St=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i};var Ot=function(t){return m(t)&&"[object Arguments]"==f(t)},Mt=Object.prototype,Nt=Mt.hasOwnProperty,It=Mt.propertyIsEnumerable,Rt=Ot(function(){return arguments}())?Ot:function(t){return m(t)&&Nt.call(t,"callee")&&!It.call(t,"callee")},Lt=Array.isArray,Dt=n(20),Vt=/^(?:0|[1-9]\d*)$/;var Bt=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&Vt.test(t))&&t>-1&&t%1==0&&t<e};var Ft=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},jt={};jt["[object Float32Array]"]=jt["[object Float64Array]"]=jt["[object Int8Array]"]=jt["[object Int16Array]"]=jt["[object Int32Array]"]=jt["[object Uint8Array]"]=jt["[object Uint8ClampedArray]"]=jt["[object Uint16Array]"]=jt["[object Uint32Array]"]=!0,jt["[object Arguments]"]=jt["[object Array]"]=jt["[object ArrayBuffer]"]=jt["[object Boolean]"]=jt["[object DataView]"]=jt["[object Date]"]=jt["[object Error]"]=jt["[object Function]"]=jt["[object Map]"]=jt["[object Number]"]=jt["[object Object]"]=jt["[object RegExp]"]=jt["[object Set]"]=jt["[object String]"]=jt["[object WeakMap]"]=!1;var zt=function(t){return m(t)&&Ft(t.length)&&!!jt[f(t)]};var qt=function(t){return function(e){return t(e)}},Ut=n(21),Wt=Ut.a&&Ut.a.isTypedArray,Ht=Wt?qt(Wt):zt,Kt=Object.prototype.hasOwnProperty;var Jt=function(t,e){var n=Lt(t),i=!n&&Rt(t),s=!n&&!i&&Object(Dt.a)(t),o=!n&&!i&&!s&&Ht(t),r=n||i||s||o,a=r?St(t.length,String):[],l=a.length;for(var c in t)!e&&!Kt.call(t,c)||r&&("length"==c||s&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Bt(c,l))||a.push(c);return a},$t=Object.prototype;var Gt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||$t)},Yt=g(Object.keys,Object),Qt=Object.prototype.hasOwnProperty;var Zt=function(t){if(!Gt(t))return Yt(t);var e=[];for(var n in Object(t))Qt.call(t,n)&&"constructor"!=n&&e.push(n);return e};var Xt=function(t){return null!=t&&Ft(t.length)&&!F(t)};var te=function(t){return Xt(t)?Jt(t):Zt(t)};var ee=function(t,e){return t&&Pt(e,te(e),t)};var ne=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},ie=Object.prototype.hasOwnProperty;var se=function(t){if(!V(t))return ne(t);var e=Gt(t),n=[];for(var i in t)("constructor"!=i||!e&&ie.call(t,i))&&n.push(i);return n};var oe=function(t){return Xt(t)?Jt(t,!0):se(t)};var re=function(t,e){return t&&Pt(e,oe(e),t)},ae=n(28);var le=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var ce=function(t,e){for(var n=-1,i=null==t?0:t.length,s=0,o=[];++n<i;){var r=t[n];e(r,n,t)&&(o[s++]=r)}return o};var he=function(){return[]},de=Object.prototype.propertyIsEnumerable,ue=Object.getOwnPropertySymbols,fe=ue?function(t){return null==t?[]:(t=Object(t),ce(ue(t),(function(e){return de.call(t,e)})))}:he;var ge=function(t,e){return Pt(t,fe(t),e)};var pe=function(t,e){for(var n=-1,i=e.length,s=t.length;++n<i;)t[s+n]=e[n];return t},me=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)pe(e,fe(t)),t=p(t);return e}:he;var be=function(t,e){return Pt(t,me(t),e)};var we=function(t,e,n){var i=e(t);return Lt(t)?i:pe(i,n(t))};var _e=function(t){return we(t,te,fe)};var ke=function(t){return we(t,oe,me)},ve=X(i.a,"DataView"),ye=X(i.a,"Promise"),xe=X(i.a,"Set"),Ce=X(i.a,"WeakMap"),Ee=W(ve),Te=W(tt),Ae=W(ye),Pe=W(xe),Se=W(Ce),Oe=f;(ve&&"[object DataView]"!=Oe(new ve(new ArrayBuffer(1)))||tt&&"[object Map]"!=Oe(new tt)||ye&&"[object Promise]"!=Oe(ye.resolve())||xe&&"[object Set]"!=Oe(new xe)||Ce&&"[object WeakMap]"!=Oe(new Ce))&&(Oe=function(t){var e=f(t),n="[object Object]"==e?t.constructor:void 0,i=n?W(n):"";if(i)switch(i){case Ee:return"[object DataView]";case Te:return"[object Map]";case Ae:return"[object Promise]";case Pe:return"[object Set]";case Se:return"[object WeakMap]"}return e});var Me=Oe,Ne=Object.prototype.hasOwnProperty;var Ie=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ne.call(t,"index")&&(n.index=t.index,n.input=t.input),n},Re=i.a.Uint8Array;var Le=function(t){var e=new t.constructor(t.byteLength);return new Re(e).set(new Re(t)),e};var De=function(t,e){var n=e?Le(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},Ve=/\w*$/;var Be=function(t){var e=new t.constructor(t.source,Ve.exec(t));return e.lastIndex=t.lastIndex,e},Fe=s?s.prototype:void 0,je=Fe?Fe.valueOf:void 0;var ze=function(t){return je?Object(je.call(t)):{}};var qe=function(t,e){var n=e?Le(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var Ue=function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return Le(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return De(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return qe(t,n);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return Be(t);case"[object Set]":return new i;case"[object Symbol]":return ze(t)}},We=Object.create,He=function(){function t(){}return function(e){if(!V(e))return{};if(We)return We(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var Ke=function(t){return"function"!=typeof t.constructor||Gt(t)?{}:He(p(t))};var Je=function(t){return m(t)&&"[object Map]"==Me(t)},$e=Ut.a&&Ut.a.isMap,Ge=$e?qt($e):Je;var Ye=function(t){return m(t)&&"[object Set]"==Me(t)},Qe=Ut.a&&Ut.a.isSet,Ze=Qe?qt(Qe):Ye,Xe={};Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object DataView]"]=Xe["[object Boolean]"]=Xe["[object Date]"]=Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object Symbol]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object WeakMap]"]=!1;var tn=function t(e,n,i,s,o,r){var a,l=1&n,c=2&n,h=4&n;if(i&&(a=o?i(e,s,o,r):i(e)),void 0!==a)return a;if(!V(e))return e;var d=Lt(e);if(d){if(a=Ie(e),!l)return le(e,a)}else{var u=Me(e),f="[object Function]"==u||"[object GeneratorFunction]"==u;if(Object(Dt.a)(e))return Object(ae.a)(e,l);if("[object Object]"==u||"[object Arguments]"==u||f&&!o){if(a=c||f?{}:Ke(e),!l)return c?be(e,re(a,e)):ge(e,ee(a,e))}else{if(!Xe[u])return o?e:{};a=Ue(e,u,l)}}r||(r=new yt);var g=r.get(e);if(g)return g;r.set(e,a),Ze(e)?e.forEach((function(s){a.add(t(s,n,i,s,e,r))})):Ge(e)&&e.forEach((function(s,o){a.set(o,t(s,n,i,o,e,r))}));var p=h?c?ke:_e:c?keysIn:te,m=d?void 0:p(e);return xt(m||e,(function(s,o){m&&(s=e[o=s]),At(a,o,t(s,n,i,o,e,r))})),a};var en=function(t,e){return tn(t,5,e="function"==typeof e?e:void 0)};var nn=function(t){return m(t)&&1===t.nodeType&&!y(t)};class sn{constructor(t,e){this._config={},e&&this.define(on(e)),t&&this._setObjectToTarget(this._config,t)}set(t,e){this._setToTarget(this._config,t,e)}define(t,e){this._setToTarget(this._config,t,e,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,e,n,i=!1){if(y(e))return void this._setObjectToTarget(t,e,i);const s=e.split(".");e=s.pop();for(const e of s)y(t[e])||(t[e]={}),t=t[e];if(y(n))return y(t[e])||(t[e]={}),t=t[e],void this._setObjectToTarget(t,n,i);i&&void 0!==t[e]||(t[e]=n)}_getFromSource(t,e){const n=e.split(".");e=n.pop();for(const e of n){if(!y(t[e])){t=null;break}t=t[e]}return t?on(t[e]):void 0}_setObjectToTarget(t,e,n){Object.keys(e).forEach(i=>{this._setToTarget(t,i,e[i],n)})}}function on(t){return en(t,rn)}function rn(t){return nn(t)?t:void 0}var an=function(){return function t(){t.called=!0}};class ln{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=an(),this.off=an()}}const cn=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function hn(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+cn[t>>0&255]+cn[t>>8&255]+cn[t>>16&255]+cn[t>>24&255]+cn[e>>0&255]+cn[e>>8&255]+cn[e>>16&255]+cn[e>>24&255]+cn[n>>0&255]+cn[n>>8&255]+cn[n>>16&255]+cn[n>>24&255]+cn[i>>0&255]+cn[i>>8&255]+cn[i>>16&255]+cn[i>>24&255]}var dn={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},un=(n(25),n(0));const fn=Symbol("listeningTo"),gn=Symbol("emitterId");var pn={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[fn]||(this[fn]={});const r=this[fn];bn(t)||mn(t);const a=bn(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=wn(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=_n(t,e),c=dn.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[fn];let s=t&&bn(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)vn(t,e,n);else if(r){for(;n=r.pop();)vn(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[fn]}},fire(t,...e){try{const n=t instanceof ln?t:new ln(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,vn(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&kn(t,n,e),s&&kn(s,n,e)}return n.return}catch(t){un.b.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function mn(t,e){t[gn]||(t[gn]=e||hn())}function bn(t){return t[gn]}function wn(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function _n(t,e){const n=wn(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=_n(t,n.childEvents[e]);i=i.concat(s)}return i}function kn(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new ln(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function vn(t,e,n){const i=_n(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function yn(t){return!(!t||!t[Symbol.iterator])}function xn(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class Cn{constructor(t={},e={}){const n=yn(t);if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new un.b("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new un.b("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new un.b("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new un.b("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new un.b("collection-add-invalid-id",this);if(this.get(n))throw new un.b("collection-add-item-already-exists",this)}else t[e]=n=hn();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}xn(Cn,pn);class En{constructor(t,e=[],n=[]){this._context=t,this._plugins=new Map,this._availablePlugins=new Map;for(const t of e)t.pluginName&&this._availablePlugins.set(t.pluginName,t);this._contextPlugins=new Map;for(const[t,e]of n)this._contextPlugins.set(t,e),this._contextPlugins.set(e,t),t.pluginName&&this._availablePlugins.set(t.pluginName,t)}*[Symbol.iterator](){for(const t of this._plugins)"function"==typeof t[0]&&(yield t)}get(t){const e=this._plugins.get(t);if(!e){const e="plugincollection-plugin-not-loaded: The requested plugin is not loaded.";let n=t;throw"function"==typeof t&&(n=t.pluginName||t.name),new un.b(e,this._context,{plugin:n})}return e}has(t){return this._plugins.has(t)}init(t,e=[]){const n=this,i=this._context,s=new Set,o=[],r=u(t),a=u(e),l=function(t){const e=[];for(const n of t)d(n)||e.push(n);return e.length?e:null}(t);if(l){const t="plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.";return console.error(Object(un.a)(t),{plugins:l}),Promise.reject(new un.b(t,i,{plugins:l}))}return Promise.all(r.map(c)).then(()=>h(o,"init")).then(()=>h(o,"afterInit")).then(()=>o);function c(t){if(!a.includes(t)&&!n._plugins.has(t)&&!s.has(t))return function(t){return new Promise(r=>{s.add(t),t.requires&&t.requires.forEach(n=>{const s=d(n);if(t.isContextPlugin&&!s.isContextPlugin)throw new un.b("plugincollection-context-required: Context plugin can not require plugin which is not a context plugin",null,{plugin:s.name,requiredBy:t.name});if(e.includes(s))throw new un.b("plugincollection-required: Cannot load a plugin because one of its dependencies is listed inthe `removePlugins` option.",i,{plugin:s.name,requiredBy:t.name});c(s)});const a=n._contextPlugins.get(t)||new t(i);n._add(t,a),o.push(a),r()})}(t).catch(e=>{throw console.error(Object(un.a)("plugincollection-load: It was not possible to load the plugin."),{plugin:t}),e})}function h(t,e){return t.reduce((t,i)=>i[e]?n._contextPlugins.has(i)?t:t.then(i[e].bind(i)):t,Promise.resolve())}function d(t){return"function"==typeof t?t:n._availablePlugins.get(t)}function u(t){return t.map(t=>d(t)).filter(t=>!!t)}}destroy(){const t=[];for(const[,e]of this)"function"!=typeof e.destroy||this._contextPlugins.has(e)||t.push(e.destroy());return Promise.all(t)}_add(t,e){this._plugins.set(t,e);const n=t.pluginName;if(n){if(this._plugins.has(n))throw new un.b("plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:t});this._plugins.set(n,e)}}}function Tn(t,e,n=1){if("number"!=typeof n)throw new un.b("translation-service-quantity-not-a-number: Expecting `quantity` to be a number.",null,{quantity:n});const i=Object.keys(window.CKEDITOR_TRANSLATIONS).length;1===i&&(t=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const s=e.id||e.string;if(0===i||!function(t,e){return!!window.CKEDITOR_TRANSLATIONS[t]&&!!window.CKEDITOR_TRANSLATIONS[t].dictionary[e]}(t,s))return 1!==n?e.plural:e.string;const o=window.CKEDITOR_TRANSLATIONS[t].dictionary,r=window.CKEDITOR_TRANSLATIONS[t].getPluralForm||(t=>1===t?0:1);if("string"==typeof o[s])return o[s];const a=Number(r(n));return o[s][a]}xn(En,pn),window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});const An=["ar","fa","he","ku","ug"];class Pn{constructor(t={}){this.uiLanguage=t.uiLanguage||"en",this.contentLanguage=t.contentLanguage||this.uiLanguage,this.uiLanguageDirection=Sn(this.uiLanguage),this.contentLanguageDirection=Sn(this.contentLanguage),this.t=(t,e)=>this._t(t,e)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,e=[]){Array.isArray(e)||(e=[e]),"string"==typeof t&&(t={string:t});const n=!!t.plural?e[0]:1;return function(t,e){return t.replace(/%(\d+)/g,(t,n)=>n<e.length?e[n]:t)}(Tn(this.uiLanguage,t,n),e)}}function Sn(t){return An.includes(t)?"rtl":"ltr"}class On{constructor(t){this.config=new sn(t,this.constructor.defaultConfig);const e=this.constructor.builtinPlugins;this.config.define("plugins",e),this.plugins=new En(this,e);const n=this.config.get("language")||{};this.locale=new Pn({uiLanguage:"string"==typeof n?n:n.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new Cn,this._contextOwner=null}initPlugins(){const t=this.config.get("plugins")||[];for(const e of t){if("function"!=typeof e)throw new un.b("context-initplugins-constructor-only: Only a constructor function is allowed as a context plugin.",null,{Plugin:e});if(!0!==e.isContextPlugin)throw new un.b("context-initplugins-invalid-plugin: Only a plugin marked as a context plugin is allowed to be used with a context.",null,{Plugin:e})}return this.plugins.init(t)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,e){if(this._contextOwner)throw new un.b("context-addEditor-private-context: Cannot add multiple editors to the context which is created by the editor.");this.editors.add(t),e&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const e of this.config.names())["plugins","removePlugins","extraPlugins"].includes(e)||(t[e]=this.config.get(e));return t}static create(t){return new Promise(e=>{const n=new this(t);e(n.initPlugins().then(()=>n))})}}function Mn(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}var Nn=function(t){return tn(t,4)};class In{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new un.b("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=Mn(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}xn(In,pn);class Rn extends In{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof Rn&&(this===t||this.data===t.data)}_clone(){return new Rn(this.document,this.data)}}class Ln{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new un.b("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new un.b("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function Dn(t){return yn(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}class Vn{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=Bn(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=Bn(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function Bn(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}var Fn=function(t){return"symbol"==typeof t||m(t)&&"[object Symbol]"==f(t)},jn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zn=/^\w*$/;var qn=function(t,e){if(Lt(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Fn(t))||(zn.test(t)||!jn.test(t)||null!=e&&t in Object(e))};function Un(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,s=e?e.apply(this,i):i[0],o=n.cache;if(o.has(s))return o.get(s);var r=t.apply(this,i);return n.cache=o.set(s,r)||o,r};return n.cache=new(Un.Cache||_t),n}Un.Cache=_t;var Wn=Un;var Hn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kn=/\\(\\)?/g,Jn=function(t){var e=Wn(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Hn,(function(t,n,i,s){e.push(i?s.replace(Kn,"$1"):n||t)})),e}));var $n=function(t,e){for(var n=-1,i=null==t?0:t.length,s=Array(i);++n<i;)s[n]=e(t[n],n,t);return s},Gn=s?s.prototype:void 0,Yn=Gn?Gn.toString:void 0;var Qn=function t(e){if("string"==typeof e)return e;if(Lt(e))return $n(e,t)+"";if(Fn(e))return Yn?Yn.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n};var Zn=function(t){return null==t?"":Qn(t)};var Xn=function(t,e){return Lt(t)?t:qn(t,e)?[t]:Jn(Zn(t))};var ti=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var ei=function(t){if("string"==typeof t||Fn(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e};var ni=function(t,e){for(var n=0,i=(e=Xn(e,t)).length;null!=t&&n<i;)t=t[ei(e[n++])];return n&&n==i?t:void 0};var ii=function(t,e,n){var i=-1,s=t.length;e<0&&(e=-e>s?0:s+e),(n=n>s?s:n)<0&&(n+=s),s=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(s);++i<s;)o[i]=t[i+e];return o};var si=function(t,e){return e.length<2?t:ni(t,ii(e,0,-1))};var oi=function(t,e){return e=Xn(e,t),null==(t=si(t,e))||delete t[ei(ti(e))]};var ri=function(t,e){return null==t||oi(t,e)};var ai=function(t,e,n){var i=null==t?void 0:ni(t,e);return void 0===i?n:i};var li=function(t,e,n){(void 0!==n&&!C(t[e],n)||void 0===n&&!(e in t))&&Et(t,e,n)};var ci=function(t){return function(e,n,i){for(var s=-1,o=Object(e),r=i(e),a=r.length;a--;){var l=r[t?a:++s];if(!1===n(o[l],l,o))break}return e}}();var hi=function(t){return m(t)&&Xt(t)};var di=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var ui=function(t){return Pt(t,oe(t))};var fi=function(t,e,n,i,s,o,r){var a=di(t,n),l=di(e,n),c=r.get(l);if(c)li(t,n,c);else{var h=o?o(a,l,n+"",t,e,r):void 0,d=void 0===h;if(d){var u=Lt(l),f=!u&&Object(Dt.a)(l),g=!u&&!f&&Ht(l);h=l,u||f||g?Lt(a)?h=a:hi(a)?h=le(a):f?(d=!1,h=Object(ae.a)(l,!0)):g?(d=!1,h=qe(l,!0)):h=[]:y(l)||Rt(l)?(h=a,Rt(a)?h=ui(a):V(a)&&!F(a)||(h=Ke(l))):d=!1}d&&(r.set(l,h),s(h,l,i,o,r),r.delete(l)),li(t,n,h)}};var gi=function t(e,n,i,s,o){e!==n&&ci(n,(function(r,a){if(o||(o=new yt),V(r))fi(e,n,a,i,t,s,o);else{var l=s?s(di(e,a),r,a+"",e,n,o):void 0;void 0===l&&(l=r),li(e,a,l)}}),oe)};var pi=function(t){return t};var mi=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},bi=Math.max;var wi=function(t,e,n){return e=bi(void 0===e?t.length-1:e,0),function(){for(var i=arguments,s=-1,o=bi(i.length-e,0),r=Array(o);++s<o;)r[s]=i[e+s];s=-1;for(var a=Array(e+1);++s<e;)a[s]=i[s];return a[e]=n(r),mi(t,this,a)}};var _i=function(t){return function(){return t}},ki=Ct?function(t,e){return Ct(t,"toString",{configurable:!0,enumerable:!1,value:_i(e),writable:!0})}:pi,vi=Date.now;var yi=function(t){var e=0,n=0;return function(){var i=vi(),s=16-(i-n);if(n=i,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(ki);var xi=function(t,e){return yi(wi(t,e,pi),t+"")};var Ci=function(t,e,n){if(!V(n))return!1;var i=typeof e;return!!("number"==i?Xt(n)&&Bt(e,n.length):"string"==i&&e in n)&&C(n[e],t)};var Ei=function(t){return xi((function(e,n){var i=-1,s=n.length,o=s>1?n[s-1]:void 0,r=s>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(s--,o):void 0,r&&Ci(n[0],n[1],r)&&(o=s<3?void 0:o,s=1),e=Object(e);++i<s;){var a=n[i];a&&t(e,a,i,o)}return e}))},Ti=Ei((function(t,e,n){gi(t,e,n)}));var Ai=function(t,e,n,i){if(!V(t))return t;for(var s=-1,o=(e=Xn(e,t)).length,r=o-1,a=t;null!=a&&++s<o;){var l=ei(e[s]),c=n;if(s!=r){var h=a[l];void 0===(c=i?i(h,l,a):void 0)&&(c=V(h)?h:Bt(e[s+1])?[]:{})}At(a,l,c),a=a[l]}return t};var Pi=function(t,e,n){return null==t?t:Ai(t,e,n)};class Si{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Mi(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}class Oi{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,e,n){if(V(e))Ni(n,Mi(t),e);else if(this._normalizers.has(t)){const i=this._normalizers.get(t),{path:s,value:o}=i(e);Ni(n,s,o)}else Ni(n,t,e)}getNormalized(t,e){if(!t)return Ti({},e);if(void 0!==e[t])return e[t];if(this._extractors.has(t)){const n=this._extractors.get(t);if("string"==typeof n)return ai(e,n);const i=n(t,e);if(i)return i}return ai(e,Mi(t))}getReducedForm(t,e){const n=this.getNormalized(t,e);if(void 0===n)return[];if(this._reducers.has(t)){return this._reducers.get(t)(n)}return[[t,n]]}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,e){this._normalizers.set(t,e)}setExtractor(t,e){this._extractors.set(t,e)}setReducer(t,e){this._reducers.set(t,e)}setStyleRelation(t,e){this._mapStyleNames(t,e);for(const n of e)this._mapStyleNames(n,[t])}_mapStyleNames(t,e){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...e)}}function Mi(t){return t.replace("-",".")}function Ni(t,e,n){let i=n;V(n)&&(i=Ti({},ai(t,e),n)),Pi(t,e,i)}class Ii extends In{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=Dn(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");Ri(this._classes,t),this._attrs.delete("class")}this._styles=new Si(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Ii))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new Vn(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Rn(t,e)];yn(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Rn(t,e):e instanceof Ln?new Rn(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?Ri(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function Ri(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class Li extends Ii{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=Di}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function Di(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}var Vi=Ei((function(t,e){Pt(e,oe(e),t)}));const Bi=Symbol("observableProperties"),Fi=Symbol("boundObservables"),ji=Symbol("boundProperties"),zi={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);Ui(this);const n=this[Bi];if(t in this&&!n.has(t))throw new un.b("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!Ki(t))throw new un.b("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new un.b("observable-bind-duplicate-properties: Properties must be unique.",this);Ui(this);const e=this[ji];t.forEach(t=>{if(e.has(t))throw new un.b("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:Wi,toMany:Hi,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Bi])return;const e=this[ji],n=this[Fi];if(t.length){if(!Ki(t))throw new un.b("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new un.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(zi,pn);var qi=zi;function Ui(t){t[Bi]||(Object.defineProperty(t,Bi,{value:new Map}),Object.defineProperty(t,Fi,{value:new Map}),Object.defineProperty(t,ji,{value:new Map}))}function Wi(...t){const e=function(...t){if(!t.length)throw new un.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new un.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new un.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new un.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new un.b("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Fi];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{Ji(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Fi],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{Ji(this._observable,t)})}function Hi(t,e,n){if(this._bindings.size>1)throw new un.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function Ki(t){return t.every(t=>"string"==typeof t)}function Ji(t,e){const n=t[ji].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class $i extends Li{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}xn($i,qi);const Gi=Symbol("rootName");class Yi extends $i{constructor(t,e){super(t,e),this.rootName="main"}is(t,e=null){return e?e===this.name&&("rootElement"===t||"view:rootElement"===t||"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"rootElement"===t||"view:rootElement"===t||"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}get rootName(){return this.getCustomProperty(Gi)}set rootName(t){this._setCustomProperty(Gi,t)}set _name(t){this.name=t}}class Qi{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new un.b("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new un.b("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=Zi._createAt(t.startPosition):this.position=Zi._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof Rn){if(t.isAtEnd)return this.position=Zi._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof Ii)return this.shallow?t.offset++:t=new Zi(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof Rn){if(this.singleCharacters)return t=new Zi(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new Ln(i,0,s),t=Zi._createAfter(n)):(n=new Ln(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new Ln(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=Zi._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof Rn){if(t.isAtStart)return this.position=Zi._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof Ii)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new Zi(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof Rn){if(this.singleCharacters)return t=new Zi(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new Ln(i,e,i.data.length-e),s=n.data.length,t=Zi._createBefore(n)}else n=new Ln(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new Ln(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=Zi._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof Ln&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=Zi._createAfter(e.textNode):(i=Zi._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=Zi._createBefore(e.textNode):(i=Zi._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class Zi{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof $i);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=Zi._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new Qi(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=Mn(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new Qi(t)}clone(){return new Zi(this.parent,this.offset)}static _createAt(t,e){if(t instanceof Zi)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new un.b("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new Zi(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new Zi(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new un.b("view-position-after-root: You can not make position after root.",t,{root:t});return new Zi(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new Zi(t.textNode,t.offsetInText);if(!t.parent)throw new un.b("view-position-before-root: You can not make position before root.",t,{root:t});return new Zi(t.parent,t.index)}}class Xi{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new Qi({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(ts,{direction:"backward"}),e=this.end.getLastMatchingPosition(ts);return t.parent.is("text")&&t.isAtStart&&(t=Zi._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=Zi._createAfter(e.parent)),new Xi(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition(ts);if(t.isAfter(this.end)||t.isEqual(this.end))return new Xi(t,t);let e=this.end.getLastMatchingPosition(ts,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new Zi(n,0)),i&&i.is("text")&&(e=new Zi(i,i.data.length)),new Xi(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new Xi(this.start,t.start)),this.containsPosition(t.end)&&e.push(new Xi(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new Xi(e,n)}return null}getWalker(t={}){return t.boundaries=this,new Qi(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new Xi(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new Qi(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new Qi(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new Zi(t,e),new Zi(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Zi._createBefore(t),e)}}function ts(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function es(t){let e=0;for(const n of t)e++;return e}class ns{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=es(this.getRanges());if(e!=es(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof ns||t instanceof is)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof Xi)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof Zi)this._setRanges([new Xi(t)]),this._setFakeOptions(e);else if(t instanceof In){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new un.b("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?Xi._createIn(t):"on"==e?Xi._createOn(t):new Xi(Zi._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!yn(t))throw new un.b("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new un.b("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=Zi._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new Xi(n,i),!0):this._addRange(new Xi(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof Xi))throw new un.b("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new un.b("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new Xi(t.start,t.end))}}xn(ns,pn);class is{constructor(t=null,e,n){this._selection=new ns,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}xn(is,pn);class ss{constructor(t){this.selection=new is,this.roots=new Cn({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.map(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let e=!1;do{for(const n of this._postFixers)if(e=n(t),e)break}while(e)}}xn(ss,qi);class os extends Ii{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=rs,this._priority=10,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new un.b("attribute-element-get-elements-with-same-id-no-id: Cannot get elements with the same id for an attribute element without id.",this);return new Set(this._clonesGroup)}is(t,e=null){return e?e===this.name&&("attributeElement"===t||"view:attributeElement"===t||"element"===t||"view:element"===t):"attributeElement"===t||"view:attributeElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}isSimilar(t){return null!==this.id||null!==t.id?this.id===t.id:super.isSimilar(t)&&this.priority==t.priority}_clone(t){const e=super._clone(t);return e._priority=this._priority,e._id=this._id,e}}function rs(){if(as(this))return null;let t=this.parent;for(;t&&t.is("attributeElement");){if(as(t)>1)return null;t=t.parent}return!t||as(t)>1?null:this.childCount}function as(t){return Array.from(t.getChildren()).filter(t=>!t.is("uiElement")).length}os.DEFAULT_PRIORITY=10;class ls extends Ii{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=cs}is(t,e=null){return e?e===this.name&&("emptyElement"===t||"view:emptyElement"===t||"element"===t||"view:element"===t):"emptyElement"===t||"view:emptyElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}_insertChild(t,e){if(e&&(e instanceof In||Array.from(e).length>0))throw new un.b("view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.",[this,e])}}function cs(){return null}const hs=navigator.userAgent.toLowerCase();var ds={isMac:function(t){return t.indexOf("macintosh")>-1}(hs),isGecko:function(t){return!!t.match(/gecko\/\d+/)}(hs),isSafari:function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(hs),isAndroid:function(t){return t.indexOf("android")>-1}(hs),features:{isRegExpUnicodePropertySupported:function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}()}};const us=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function fs(t){let e;if("string"==typeof t){if(e=us[t.toLowerCase()],!e)throw new un.b("keyboard-unknown-key: Unknown key name.",null,{key:t})}else e=t.keyCode+(t.altKey?us.alt:0)+(t.ctrlKey?us.ctrl:0)+(t.shiftKey?us.shift:0);return e}function gs(t){return t.split(/\s*\+\s*/)}class ps extends Ii{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=bs}is(t,e=null){return e?e===this.name&&("uiElement"===t||"view:uiElement"===t||"element"===t||"view:element"===t):"uiElement"===t||"view:uiElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}_insertChild(t,e){if(e&&(e instanceof In||Array.from(e).length>0))throw new un.b("view-uielement-cannot-add: Cannot add child nodes to UIElement instance.",this)}render(t){return this.toDomElement(t)}toDomElement(t){const e=t.createElement(this.name);for(const t of this.getAttributeKeys())e.setAttribute(t,this.getAttribute(t));return e}}function ms(t){t.document.on("keydown",(e,n)=>function(t,e,n){if(e.keyCode==us.arrowright){const t=e.domTarget.ownerDocument.defaultView.getSelection(),i=1==t.rangeCount&&t.getRangeAt(0).collapsed;if(i||e.shiftKey){const e=t.focusNode,s=t.focusOffset,o=n.domPositionToView(e,s);if(null===o)return;let r=!1;const a=o.getLastMatchingPosition(t=>(t.item.is("uiElement")&&(r=!0),!(!t.item.is("uiElement")&&!t.item.is("attributeElement"))));if(r){const e=n.viewPositionToDom(a);i?t.collapse(e.parent,e.offset):t.extend(e.parent,e.offset)}}}}(0,n,t.domConverter))}function bs(){return null}class ws{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Rn(t,e)];yn(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Rn(t,e):e instanceof Ln?new Rn(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}xn(ws,pn);class _s{constructor(t){this.document=t,this._cloneGroups=new Map}setSelection(t,e,n){this.document.selection._setTo(t,e,n)}setSelectionFocus(t,e){this.document.selection._setFocus(t,e)}createText(t){return new Rn(this.document,t)}createAttributeElement(t,e,n={}){const i=new os(this.document,t,e);return n.priority&&(i._priority=n.priority),n.id&&(i._id=n.id),i}createContainerElement(t,e){return new Li(this.document,t,e)}createEditableElement(t,e){const n=new $i(this.document,t,e);return n._document=this.document,n}createEmptyElement(t,e){return new ls(this.document,t,e)}createUIElement(t,e,n){const i=new ps(this.document,t,e);return n&&(i.render=n),i}setAttribute(t,e,n){n._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,n){y(t)&&void 0===n&&(n=e),n._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,n){n._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}breakAttributes(t){return t instanceof Zi?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const e=t.parent;if(!e.is("containerElement"))throw new un.b("view-writer-break-non-container-element: Trying to break an element which is not a container element.",this.document);if(!e.parent)throw new un.b("view-writer-break-root: Trying to break root element.",this.document);if(t.isAtStart)return Zi._createBefore(e);if(!t.isAtEnd){const n=e._clone(!1);this.insert(Zi._createAfter(e),n);const i=new Xi(t,Zi._createAt(e,"end")),s=new Zi(n,0);this.move(i,s)}return Zi._createAfter(e)}mergeAttributes(t){const e=t.offset,n=t.parent;if(n.is("text"))return t;if(n.is("attributeElement")&&0===n.childCount){const t=n.parent,e=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Zi(t,e))}const i=n.getChild(e-1),s=n.getChild(e);if(!i||!s)return t;if(i.is("text")&&s.is("text"))return Cs(i,s);if(i.is("attributeElement")&&s.is("attributeElement")&&i.isSimilar(s)){const t=i.childCount;return i._appendChild(s.getChildren()),s._remove(),this._removeFromClonedElementsGroup(s),this.mergeAttributes(new Zi(i,t))}return t}mergeContainers(t){const e=t.nodeBefore,n=t.nodeAfter;if(!(e&&n&&e.is("containerElement")&&n.is("containerElement")))throw new un.b("view-writer-merge-containers-invalid-position: Element before and after given position cannot be merged.",this.document);const i=e.getChild(e.childCount-1),s=i instanceof Rn?Zi._createAt(i,"end"):Zi._createAt(e,"end");return this.move(Xi._createIn(n),Zi._createAt(e,"end")),this.remove(Xi._createOn(n)),s}insert(t,e){(function t(e,n){for(const i of e){if(!Es.some(t=>i instanceof t))throw new un.b("view-writer-insert-invalid-node",n);i.is("text")||t(i.getChildren(),n)}})(e=yn(e)?[...e]:[e],this.document);const n=ks(t);if(!n)throw new un.b("view-writer-invalid-position-container",this.document);const i=this._breakAttributes(t,!0),s=n._insertChild(i.offset,e);for(const t of e)this._addToClonedElementsGroup(t);const o=i.getShiftedBy(s),r=this.mergeAttributes(i);if(0===s)return new Xi(r,r);{r.isEqual(i)||o.offset--;const t=this.mergeAttributes(o);return new Xi(r,t)}}remove(t){const e=t instanceof Xi?t:Xi._createOn(t);if(As(e,this.document),e.isCollapsed)return new ws(this.document);const{start:n,end:i}=this._breakAttributesRange(e,!0),s=n.parent,o=i.offset-n.offset,r=s._removeChildren(n.offset,o);for(const t of r)this._removeFromClonedElementsGroup(t);const a=this.mergeAttributes(n);return e.start=a,e.end=a.clone(),new ws(this.document,r)}clear(t,e){As(t,this.document);const n=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const i of n){const n=i.item;let s;if(n.is("element")&&e.isSimilar(n))s=Xi._createOn(n);else if(!i.nextPosition.isAfter(t.start)&&n.is("textProxy")){const t=n.getAncestors().find(t=>t.is("element")&&e.isSimilar(t));t&&(s=Xi._createIn(t))}s&&(s.end.isAfter(t.end)&&(s.end=t.end),s.start.isBefore(t.start)&&(s.start=t.start),this.remove(s))}}move(t,e){let n;if(e.isAfter(t.end)){const i=(e=this._breakAttributes(e,!0)).parent,s=i.childCount;t=this._breakAttributesRange(t,!0),n=this.remove(t),e.offset+=i.childCount-s}else n=this.remove(t);return this.insert(e,n)}wrap(t,e){if(!(e instanceof os))throw new un.b("view-writer-wrap-invalid-attribute",this.document);if(As(t,this.document),t.isCollapsed){let i=t.start;i.parent.is("element")&&(n=i.parent,!Array.from(n.getChildren()).some(t=>!t.is("uiElement")))&&(i=i.getLastMatchingPosition(t=>t.item.is("uiElement"))),i=this._wrapPosition(i,e);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(t.start)&&this.setSelection(i),new Xi(i)}return this._wrapRange(t,e);var n}unwrap(t,e){if(!(e instanceof os))throw new un.b("view-writer-unwrap-invalid-attribute",this.document);if(As(t,this.document),t.isCollapsed)return t;const{start:n,end:i}=this._breakAttributesRange(t,!0),s=n.parent,o=this._unwrapChildren(s,n.offset,i.offset,e),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new Xi(r,a)}rename(t,e){const n=new Li(this.document,t,e.getAttributes());return this.insert(Zi._createAfter(e),n),this.move(Xi._createIn(e),Zi._createAt(n,0)),this.remove(Xi._createOn(e)),n}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,e){return Zi._createAt(t,e)}createPositionAfter(t){return Zi._createAfter(t)}createPositionBefore(t){return Zi._createBefore(t)}createRange(t,e){return new Xi(t,e)}createRangeOn(t){return Xi._createOn(t)}createRangeIn(t){return Xi._createIn(t)}createSelection(t,e,n){return new ns(t,e,n)}_wrapChildren(t,e,n,i){let s=e;const o=[];for(;s<n;){const e=t.getChild(s),n=e.is("text"),r=e.is("attributeElement"),a=e.is("emptyElement"),l=e.is("uiElement");if(r&&this._wrapAttributeElement(i,e))o.push(new Zi(t,s));else if(n||a||l||r&&vs(i,e)){const n=i._clone();e._remove(),n._appendChild(e),t._insertChild(s,n),this._addToClonedElementsGroup(n),o.push(new Zi(t,s))}else r&&this._wrapChildren(e,0,e.childCount,i);s++}let r=0;for(const t of o){if(t.offset-=r,t.offset==e)continue;this.mergeAttributes(t).isEqual(t)||(r++,n--)}return Xi._createFromParentsAndOffsets(t,e,t,n)}_unwrapChildren(t,e,n,i){let s=e;const o=[];for(;s<n;){const e=t.getChild(s);if(e.is("attributeElement"))if(e.isSimilar(i)){const i=e.getChildren(),r=e.childCount;e._remove(),t._insertChild(s,i),this._removeFromClonedElementsGroup(e),o.push(new Zi(t,s),new Zi(t,s+r)),s+=r,n+=r-1}else this._unwrapAttributeElement(i,e)?(o.push(new Zi(t,s),new Zi(t,s+1)),s++):(this._unwrapChildren(e,0,e.childCount,i),s++);else s++}let r=0;for(const t of o){if(t.offset-=r,t.offset==e||t.offset==n)continue;this.mergeAttributes(t).isEqual(t)||(r++,n--)}return Xi._createFromParentsAndOffsets(t,e,t,n)}_wrapRange(t,e){const{start:n,end:i}=this._breakAttributesRange(t,!0),s=n.parent,o=this._wrapChildren(s,n.offset,i.offset,e),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new Xi(r,a)}_wrapPosition(t,e){if(e.isSimilar(t.parent))return ys(t.clone());t.parent.is("text")&&(t=xs(t));const n=this.createAttributeElement();n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,t.parent._insertChild(t.offset,n);const i=new Xi(t,t.getShiftedBy(1));this.wrap(i,e);const s=new Zi(n.parent,n.index);n._remove();const o=s.nodeBefore,r=s.nodeAfter;return o instanceof Rn&&r instanceof Rn?Cs(o,r):ys(s)}_wrapAttributeElement(t,e){if(!Ps(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;for(const n of t.getAttributeKeys())if("class"!==n&&"style"!==n&&e.hasAttribute(n)&&e.getAttribute(n)!==t.getAttribute(n))return!1;for(const n of t.getStyleNames())if(e.hasStyle(n)&&e.getStyle(n)!==t.getStyle(n))return!1;for(const n of t.getAttributeKeys())"class"!==n&&"style"!==n&&(e.hasAttribute(n)||this.setAttribute(n,t.getAttribute(n),e));for(const n of t.getStyleNames())e.hasStyle(n)||this.setStyle(n,t.getStyle(n),e);for(const n of t.getClassNames())e.hasClass(n)||this.addClass(n,e);return!0}_unwrapAttributeElement(t,e){if(!Ps(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;for(const n of t.getAttributeKeys())if("class"!==n&&"style"!==n&&(!e.hasAttribute(n)||e.getAttribute(n)!==t.getAttribute(n)))return!1;if(!e.hasClass(...t.getClassNames()))return!1;for(const n of t.getStyleNames())if(!e.hasStyle(n)||e.getStyle(n)!==t.getStyle(n))return!1;for(const n of t.getAttributeKeys())"class"!==n&&"style"!==n&&this.removeAttribute(n,e);return this.removeClass(Array.from(t.getClassNames()),e),this.removeStyle(Array.from(t.getStyleNames()),e),!0}_breakAttributesRange(t,e=!1){const n=t.start,i=t.end;if(As(t,this.document),t.isCollapsed){const n=this._breakAttributes(t.start,e);return new Xi(n,n)}const s=this._breakAttributes(i,e),o=s.parent.childCount,r=this._breakAttributes(n,e);return s.offset+=s.parent.childCount-o,new Xi(r,s)}_breakAttributes(t,e=!1){const n=t.offset,i=t.parent;if(t.parent.is("emptyElement"))throw new un.b("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new un.b("view-writer-cannot-break-ui-element",this.document);if(!e&&i.is("text")&&Ts(i.parent))return t.clone();if(Ts(i))return t.clone();if(i.is("text"))return this._breakAttributes(xs(t),e);if(n==i.childCount){const t=new Zi(i.parent,i.index+1);return this._breakAttributes(t,e)}if(0===n){const t=new Zi(i.parent,i.index);return this._breakAttributes(t,e)}{const t=i.index+1,s=i._clone();i.parent._insertChild(t,s),this._addToClonedElementsGroup(s);const o=i.childCount-n,r=i._removeChildren(n,o);s._appendChild(r);const a=new Zi(i.parent,t);return this._breakAttributes(a,e)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const e of t.getChildren())this._addToClonedElementsGroup(e);const e=t.id;if(!e)return;let n=this._cloneGroups.get(e);n||(n=new Set,this._cloneGroups.set(e,n)),n.add(t),t._clonesGroup=n}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const e of t.getChildren())this._removeFromClonedElementsGroup(e);const e=t.id;if(!e)return;const n=this._cloneGroups.get(e);n&&n.delete(t)}}function ks(t){let e=t.parent;for(;!Ts(e);){if(!e)return;e=e.parent}return e}function vs(t,e){return t.priority<e.priority||!(t.priority>e.priority)&&t.getIdentity()<e.getIdentity()}function ys(t){const e=t.nodeBefore;if(e&&e.is("text"))return new Zi(e,e.data.length);const n=t.nodeAfter;return n&&n.is("text")?new Zi(n,0):t}function xs(t){if(t.offset==t.parent.data.length)return new Zi(t.parent.parent,t.parent.index+1);if(0===t.offset)return new Zi(t.parent.parent,t.parent.index);const e=t.parent.data.slice(t.offset);return t.parent._data=t.parent.data.slice(0,t.offset),t.parent.parent._insertChild(t.parent.index+1,new Rn(t.root.document,e)),new Zi(t.parent.parent,t.parent.index+1)}function Cs(t,e){const n=t.data.length;return t._data+=e.data,e._remove(),new Zi(t,n)}const Es=[Rn,os,Li,ls,ps];function Ts(t){return t&&(t.is("containerElement")||t.is("documentFragment"))}function As(t,e){const n=ks(t.start),i=ks(t.end);if(!n||!i||n!==i)throw new un.b("view-writer-invalid-range-container",e)}function Ps(t,e){return null===t.id&&null===e.id}function Ss(t){return"[object Text]"==Object.prototype.toString.call(t)}const Os=t=>t.createTextNode(" "),Ms=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},Ns=(()=>{let t="";for(let e=0;e<7;e++)t+="​";return t})();function Is(t){return Ss(t)&&t.data.substr(0,7)===Ns}function Rs(t){return 7==t.data.length&&Is(t)}function Ls(t){return Is(t)?t.data.slice(7):t.data}function Ds(t,e){if(e.keyCode==us.arrowleft){const t=e.domTarget.ownerDocument.defaultView.getSelection();if(1==t.rangeCount&&t.getRangeAt(0).collapsed){const e=t.getRangeAt(0).startContainer,n=t.getRangeAt(0).startOffset;Is(e)&&n<=7&&t.collapse(e,0)}}}function Vs(t,e,n,i=!1){n=n||function(t,e){return t===e},Array.isArray(t)||(t=Array.prototype.slice.call(t)),Array.isArray(e)||(e=Array.prototype.slice.call(e));const s=function(t,e,n){const i=Bs(t,e,n);if(-1===i)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=Fs(t,i),o=Fs(e,i),r=Bs(s,o,n),a=t.length-r,l=e.length-r;return{firstIndex:i,lastIndexOld:a,lastIndexNew:l}}(t,e,n);return i?function(t,e){const{firstIndex:n,lastIndexOld:i,lastIndexNew:s}=t;if(-1===n)return Array(e).fill("equal");let o=[];n>0&&(o=o.concat(Array(n).fill("equal")));s-n>0&&(o=o.concat(Array(s-n).fill("insert")));i-n>0&&(o=o.concat(Array(i-n).fill("delete")));s<e&&(o=o.concat(Array(e-s).fill("equal")));return o}(s,e.length):function(t,e){const n=[],{firstIndex:i,lastIndexOld:s,lastIndexNew:o}=e;o-i>0&&n.push({index:i,type:"insert",values:t.slice(i,o)});s-i>0&&n.push({index:i+(o-i),type:"delete",howMany:s-i});return n}(e,s)}function Bs(t,e,n){for(let i=0;i<Math.max(t.length,e.length);i++)if(void 0===t[i]||void 0===e[i]||!n(t[i],e[i]))return i;return-1}function Fs(t,e){return t.slice(e).reverse()}function js(t,e,n){n=n||function(t,e){return t===e};const i=t.length,s=e.length;if(i>200||s>200||i+s>300)return js.fastDiff(t,e,n,!0);let o,r;if(s<i){const n=t;t=e,e=n,o="delete",r="insert"}else o="insert",r="delete";const a=t.length,l=e.length,c=l-a,h={},d={};function u(i){const s=(void 0!==d[i-1]?d[i-1]:-1)+1,c=void 0!==d[i+1]?d[i+1]:-1,u=s>c?-1:1;h[i+u]&&(h[i]=h[i+u].slice(0)),h[i]||(h[i]=[]),h[i].push(s>c?o:r);let f=Math.max(s,c),g=f-i;for(;g<a&&f<l&&n(t[g],e[f]);)g++,f++,h[i].push("equal");return f}let f,g=0;do{for(f=-g;f<c;f++)d[f]=u(f);for(f=c+g;f>c;f--)d[f]=u(f);d[c]=u(c),g++}while(d[c]!==l);return h[c].slice(1)}function zs(t,e,n){t.insertBefore(n,t.childNodes[e]||null)}function qs(t){const e=t.parentNode;e&&e.removeChild(t)}function Us(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}js.fastDiff=Vs;class Ws{constructor(t,e){this.domDocuments=new Set,this.domConverter=t,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=e,this.isFocused=!1,this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(t,e){if("text"===t)this.domConverter.mapViewToDom(e.parent)&&this.markedTexts.add(e);else{if(!this.domConverter.mapViewToDom(e))return;if("attributes"===t)this.markedAttributes.add(e);else{if("children"!==t)throw new un.b("view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.",this);this.markedChildren.add(e)}}}render(){let t;for(const t of this.markedChildren)this._updateChildrenMappings(t);this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?t=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(t=this.selection.getFirstPosition(),this.markedChildren.add(t.parent));for(const t of this.markedAttributes)this._updateAttrs(t);for(const e of this.markedChildren)this._updateChildren(e,{inlineFillerPosition:t});for(const e of this.markedTexts)!this.markedChildren.has(e.parent)&&this.domConverter.mapViewToDom(e.parent)&&this._updateText(e,{inlineFillerPosition:t});if(t){const e=this.domConverter.viewPositionToDom(t),n=e.parent.ownerDocument;Is(e.parent)?this._inlineFiller=e.parent:this._inlineFiller=Hs(n,e.parent,e.offset)}else this._inlineFiller=null;this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(t){const e=this.domConverter.mapViewToDom(t);if(!e)return;const n=this.domConverter.mapViewToDom(t).childNodes,i=Array.from(this.domConverter.viewChildrenToDom(t,e.ownerDocument,{withChildren:!1})),s=this._diffNodeLists(n,i),o=this._findReplaceActions(s,n,i);if(-1!==o.indexOf("replace")){const e={equal:0,insert:0,delete:0};for(const s of o)if("replace"===s){const s=e.equal+e.insert,o=e.equal+e.delete,r=t.getChild(s);r&&!r.is("uiElement")&&this._updateElementMappings(r,n[o]),qs(i[s]),e.equal++}else e[s]++}}_updateElementMappings(t,e){this.domConverter.unbindDomElement(e),this.domConverter.bindElements(e,t),this.markedChildren.add(t),this.markedAttributes.add(t)}_getInlineFillerPosition(){const t=this.selection.getFirstPosition();return t.parent.is("text")?Zi._createBefore(this.selection.getFirstPosition().parent):t}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),e=this.domConverter.viewPositionToDom(t);return!!(e&&Ss(e.parent)&&Is(e.parent))}_removeInlineFiller(){const t=this._inlineFiller;if(!Is(t))throw new un.b("view-renderer-filler-was-lost: The inline filler node was lost.",this);Rs(t)?t.parentNode.removeChild(t):t.data=t.data.substr(7),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),e=t.parent,n=t.offset;if(!this.domConverter.mapViewToDom(e.root))return!1;if(!e.is("element"))return!1;if(!function(t){if("false"==t.getAttribute("contenteditable"))return!1;const e=t.findAncestor(t=>t.hasAttribute("contenteditable"));return!e||"true"==e.getAttribute("contenteditable")}(e))return!1;if(n===e.getFillerOffset())return!1;const i=t.nodeBefore,s=t.nodeAfter;return!(i instanceof Rn||s instanceof Rn)}_updateText(t,e){const n=this.domConverter.findCorrespondingDomText(t),i=this.domConverter.viewToDom(t,n.ownerDocument),s=n.data;let o=i.data;const r=e.inlineFillerPosition;if(r&&r.parent==t.parent&&r.offset==t.index&&(o=Ns+o),s!=o){const t=Vs(s,o);for(const e of t)"insert"===e.type?n.insertData(e.index,e.values.join("")):n.deleteData(e.index,e.howMany)}}_updateAttrs(t){const e=this.domConverter.mapViewToDom(t);if(!e)return;const n=Array.from(e.attributes).map(t=>t.name),i=t.getAttributeKeys();for(const n of i)e.setAttribute(n,t.getAttribute(n));for(const i of n)t.hasAttribute(i)||e.removeAttribute(i)}_updateChildren(t,e){const n=this.domConverter.mapViewToDom(t);if(!n)return;const i=e.inlineFillerPosition,s=this.domConverter.mapViewToDom(t).childNodes,o=Array.from(this.domConverter.viewChildrenToDom(t,n.ownerDocument,{bind:!0,inlineFillerPosition:i}));i&&i.parent===t&&Hs(n.ownerDocument,o,i.offset);const r=this._diffNodeLists(s,o);let a=0;const l=new Set;for(const t of r)"delete"===t?(l.add(s[a]),qs(s[a])):"equal"===t&&a++;a=0;for(const t of r)"insert"===t?(zs(n,a,o[a]),a++):"equal"===t&&(this._markDescendantTextToSync(this.domConverter.domToView(o[a])),a++);for(const t of l)t.parentNode||this.domConverter.unbindDomElement(t)}_diffNodeLists(t,e){return js(t=function(t,e){const n=Array.from(t);if(0==n.length||!e)return n;n[n.length-1]==e&&n.pop();return n}(t,this._fakeSelectionContainer),e,Js.bind(null,this.domConverter))}_findReplaceActions(t,e,n){if(-1===t.indexOf("insert")||-1===t.indexOf("delete"))return t;let i=[],s=[],o=[];const r={equal:0,insert:0,delete:0};for(const a of t)"insert"===a?o.push(n[r.equal+r.insert]):"delete"===a?s.push(e[r.equal+r.delete]):(i=i.concat(js(s,o,Ks).map(t=>"equal"===t?"replace":t)),i.push("equal"),s=[],o=[]),r[a]++;return i.concat(js(s,o,Ks).map(t=>"equal"===t?"replace":t))}_markDescendantTextToSync(t){if(t)if(t.is("text"))this.markedTexts.add(t);else if(t.is("element"))for(const e of t.getChildren())this._markDescendantTextToSync(e)}_updateSelection(){if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const t=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&t&&(this.selection.isFake?this._updateFakeSelection(t):(this._removeFakeSelection(),this._updateDomSelection(t)))}_updateFakeSelection(t){const e=t.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(t){const e=t.createElement("div");return Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent=" ",e}(e));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(t))return;n.parentElement&&n.parentElement==t||t.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const i=e.getSelection(),s=e.createRange();i.removeAllRanges(),s.selectNodeContents(n),i.addRange(s)}_updateDomSelection(t){const e=t.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(e))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),i=this.domConverter.viewPositionToDom(this.selection.focus);t.focus(),e.collapse(n.parent,n.offset),e.extend(i.parent,i.offset),ds.isGecko&&function(t,e){const n=t.parent;if(n.nodeType!=Node.ELEMENT_NODE||t.offset!=n.childNodes.length-1)return;const i=n.childNodes[t.offset];i&&"BR"==i.tagName&&e.addRange(e.getRangeAt(0))}(i,e)}_domSelectionNeedsUpdate(t){if(!this.domConverter.isDomSelectionCorrect(t))return!0;const e=t&&this.domConverter.domSelectionToView(t);return(!e||!this.selection.isEqual(e))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(e))}_fakeSelectionNeedsUpdate(t){const e=this._fakeSelectionContainer,n=t.ownerDocument.getSelection();return!e||e.parentElement!==t||(n.anchorNode!==e&&!e.contains(n.anchorNode)||e.textContent!==this.selection.fakeSelectionLabel)}_removeDomSelection(){for(const t of this.domDocuments){if(t.getSelection().rangeCount){const e=t.activeElement,n=this.domConverter.mapDomToView(e);e&&n&&t.getSelection().removeAllRanges()}}}_removeFakeSelection(){const t=this._fakeSelectionContainer;t&&t.remove()}_updateFocus(){if(this.isFocused){const t=this.selection.editableElement;t&&this.domConverter.focus(t)}}}function Hs(t,e,n){const i=e instanceof Array?e:e.childNodes,s=i[n];if(Ss(s))return s.data=Ns+s.data,s;{const s=t.createTextNode(Ns);return Array.isArray(e)?i.splice(n,0,s):zs(e,n,s),s}}function Ks(t,e){return Us(t)&&Us(e)&&!Ss(t)&&!Ss(e)&&t.tagName.toLowerCase()===e.tagName.toLowerCase()}function Js(t,e,n){return e===n||(Ss(e)&&Ss(n)?e.data===n.data:!(!t.isBlockFiller(e)||!t.isBlockFiller(n)))}xn(Ws,qi);var $s={window:window,document:document};function Gs(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function Ys(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const Qs=Ms(document);class Zs{constructor(t,e={}){this.document=t,this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?Ms:Os,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new ns(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}viewToDom(t,e,n={}){if(t.is("text")){const n=this._processDataFromViewText(t);return e.createTextNode(n)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let i;if(t.is("documentFragment"))i=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(i,t);else{if(t.is("uiElement"))return i=t.render(e),n.bind&&this.bindElements(i,t),i;i=t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),n.bind&&this.bindElements(i,t);for(const e of t.getAttributeKeys())i.setAttribute(e,t.getAttribute(e))}if(n.withChildren||void 0===n.withChildren)for(const s of this.viewChildrenToDom(t,e,n))i.appendChild(s);return i}}*viewChildrenToDom(t,e,n={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren())i===s&&(yield this._blockFiller(e)),yield this.viewToDom(o,e,n),s++;i===s&&(yield this._blockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),i=document.createRange();return i.setStart(e.parent,e.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(t){const e=t.parent;if(e.is("text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let i=t.offset;return Is(n)&&(i+=7),{parent:n,offset:i}}{let n,i,s;if(0===t.offset){if(n=this.mapViewToDom(e),!n)return null;s=n.childNodes[0]}else{const e=t.nodeBefore;if(i=e.is("text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!i)return null;n=i.parentNode,s=i.nextSibling}if(Ss(s)&&Is(s))return{parent:s,offset:7};return{parent:n,offset:i?Gs(i)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t,this.blockFillerMode))return null;const n=this.getParentUIElement(t,this._domToViewMapping);if(n)return n;if(Ss(t)){if(Rs(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new Rn(this.document,e)}}if(this.isComment(t))return null;{if(this.mapDomToView(t))return this.mapDomToView(t);let n;if(this.isDocumentFragment(t))n=new ws(this.document),e.bind&&this.bindDocumentFragments(t,n);else{const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new Ii(this.document,i),e.bind&&this.bindElements(t,n);const s=t.attributes;for(let t=s.length-1;t>=0;t--)n._setAttribute(s[t].name,s[t].value)}if(e.withChildren||void 0===e.withChildren)for(const i of this.domChildrenToView(t,e))n._appendChild(i);return n}}*domChildrenToView(t,e={}){for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n],s=this.domToView(i,e);null!==s&&(yield s)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;Ss(e)&&(e=e.parentNode);const n=this.fakeSelectionToView(e);if(n)return n}const e=this.isDomSelectionBackward(t),n=[];for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e),s=this.domRangeToView(i);s&&n.push(s)}return new ns(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new Xi(e,n):null}domPositionToView(t,e){if(this.isBlockFiller(t,this.blockFillerMode))return this.domPositionToView(t.parentNode,Gs(t));const n=this.mapDomToView(t);if(n&&n.is("uiElement"))return Zi._createBefore(n);if(Ss(t)){if(Rs(t))return this.domPositionToView(t.parentNode,Gs(t));const n=this.findCorrespondingViewText(t);let i=e;return n?(Is(t)&&(i-=7,i=i<0?0:i),new Zi(n,i)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new Zi(e,0)}else{const n=t.childNodes[e-1],i=Ss(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new Zi(i.parent,i.index+1)}return null}mapDomToView(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(Rs(t))return null;const e=this.getParentUIElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const t=this.mapDomToView(n);if(t){return t.nextSibling instanceof Rn?t.nextSibling:null}}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof Rn?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:n}=$s.window,i=[];to(e,t=>{const{scrollLeft:e,scrollTop:n}=t;i.push([e,n])}),e.focus(),to(e,t=>{const[e,n]=i.shift();t.scrollLeft=e,t.scrollTop=n}),$s.window.scrollTo(t,n)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(Qs):!("BR"!==t.tagName||!eo(t,this.blockElements)||1!==t.parentNode.childNodes.length)||function(t,e){return Ss(t)&&" "==t.data&&eo(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const n=e.collapsed;return e.detach(),n}getParentUIElement(t){const e=Ys(t);for(e.pop();e.length;){const t=e.pop(),n=this._domToViewMapping.get(t);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}_isDomSelectionPositionCorrect(t,e){if(Ss(t)&&Is(t)&&e<7)return!1;if(this.isElement(t)&&Is(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!n||!n.is("uiElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const n=this._getTouchingViewTextNode(t,!1);!(n&&this._nodeEndsWithSpace(n))&&n||(e=" "+e.substr(1))}if(" "==e.charAt(e.length-1)){const n=this._getTouchingViewTextNode(t,!0);" "!=e.charAt(e.length-2)&&n&&" "!=n.data.charAt(0)||(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(Xs(t,this.preElements))return Ls(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(t,!1),i=this._getTouchingInlineDomNode(t,!0),s=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,i);return s&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=Ls(new Text(e)),e=e.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(e)||!i||i.data&&" "==i.data.charAt(0))&&(e=e.replace(/\u00A0$/," ")),s&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t){return!t||(!!nn(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!Is(t)}_getTouchingViewTextNode(t,e){const n=new Qi({startPosition:e?Zi._createAfter(t):Zi._createBefore(t),direction:e?"forward":"backward"});for(const t of n){if(t.item.is("containerElement"))return null;if(t.item.is("br"))return null;if(t.item.is("textProxy"))return t.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const n=e?"nextNode":"previousNode",i=t.ownerDocument,s=Ys(t)[0],o=i.createTreeWalker(s,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:t=>Ss(t)||"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=t;const r=o[n]();if(null!==r){const e=function(t,e){const n=Ys(t),i=Ys(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}(t,r);if(e&&!Xs(t,this.blockElements,e)&&!Xs(r,this.blockElements,e))return r}return null}}function Xs(t,e,n){let i=Ys(t);return n&&(i=i.slice(i.indexOf(n)+1)),i.some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}function to(t,e){for(;t&&t!=$s.document;)e(t),t=t.parentNode}function eo(t,e){const n=t.parentNode;return n&&n.tagName&&e.includes(n.tagName.toLowerCase())}function no(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var io=Vi({},pn,{listenTo(t,...e){if(Us(t)||no(t)){const n=this._getProxyEmitter(t)||new so(t);n.attach(...e),t=n}pn.listenTo.call(this,t,...e)},stopListening(t,e,n){if(Us(t)||no(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}pn.stopListening.call(this,t,e,n),t instanceof so&&t.detach(e)},_getProxyEmitter(t){return e=this,n=oo(t),e[fn]&&e[fn][n]?e[fn][n].emitter:null;var e,n}});class so{constructor(t){mn(this,oo(t)),this._domNode=t}}function oo(t){return t["data-ck-expando"]||(t["data-ck-expando"]=hn())}Vi(so.prototype,pn,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class ro{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}xn(ro,io);var ao=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var lo=function(t){return this.__data__.has(t)};function co(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new _t;++e<n;)this.add(t[e])}co.prototype.add=co.prototype.push=ao,co.prototype.has=lo;var ho=co;var uo=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1};var fo=function(t,e){return t.has(e)};var go=function(t,e,n,i,s,o){var r=1&n,a=t.length,l=e.length;if(a!=l&&!(r&&l>a))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var h=-1,d=!0,u=2&n?new ho:void 0;for(o.set(t,e),o.set(e,t);++h<a;){var f=t[h],g=e[h];if(i)var p=r?i(g,f,h,e,t,o):i(f,g,h,t,e,o);if(void 0!==p){if(p)continue;d=!1;break}if(u){if(!uo(e,(function(t,e){if(!fo(u,e)&&(f===t||s(f,t,n,i,o)))return u.push(e)}))){d=!1;break}}else if(f!==g&&!s(f,g,n,i,o)){d=!1;break}}return o.delete(t),o.delete(e),d};var po=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n};var mo=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},bo=s?s.prototype:void 0,wo=bo?bo.valueOf:void 0;var _o=function(t,e,n,i,s,o,r){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Re(t),new Re(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return C(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=po;case"[object Set]":var l=1&i;if(a||(a=mo),t.size!=e.size&&!l)return!1;var c=r.get(t);if(c)return c==e;i|=2,r.set(t,e);var h=go(a(t),a(e),i,s,o,r);return r.delete(t),h;case"[object Symbol]":if(wo)return wo.call(t)==wo.call(e)}return!1},ko=Object.prototype.hasOwnProperty;var vo=function(t,e,n,i,s,o){var r=1&n,a=_e(t),l=a.length;if(l!=_e(e).length&&!r)return!1;for(var c=l;c--;){var h=a[c];if(!(r?h in e:ko.call(e,h)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var u=!0;o.set(t,e),o.set(e,t);for(var f=r;++c<l;){var g=t[h=a[c]],p=e[h];if(i)var m=r?i(p,g,h,e,t,o):i(g,p,h,t,e,o);if(!(void 0===m?g===p||s(g,p,n,i,o):m)){u=!1;break}f||(f="constructor"==h)}if(u&&!f){var b=t.constructor,w=e.constructor;b==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(u=!1)}return o.delete(t),o.delete(e),u},yo=Object.prototype.hasOwnProperty;var xo=function(t,e,n,i,s,o){var r=Lt(t),a=Lt(e),l=r?"[object Array]":Me(t),c=a?"[object Array]":Me(e),h="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),u=l==c;if(u&&Object(Dt.a)(t)){if(!Object(Dt.a)(e))return!1;r=!0,h=!1}if(u&&!h)return o||(o=new yt),r||Ht(t)?go(t,e,n,i,s,o):_o(t,e,l,n,i,s,o);if(!(1&n)){var f=h&&yo.call(t,"__wrapped__"),g=d&&yo.call(e,"__wrapped__");if(f||g){var p=f?t.value():t,m=g?e.value():e;return o||(o=new yt),s(p,m,n,i,o)}}return!!u&&(o||(o=new yt),vo(t,e,n,i,s,o))};var Co=function t(e,n,i,s,o){return e===n||(null==e||null==n||!m(e)&&!m(n)?e!=e&&n!=n:xo(e,n,i,s,t,o))};var Eo=function(t,e,n){var i=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===i?Co(t,e,void 0,n):!!i};class To extends ro{constructor(t){super(t),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=t.domConverter,this.renderer=t._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(t){this._domElements.push(t),this.isEnabled&&this._mutationObserver.observe(t,this._config)}enable(){super.enable();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(t){if(0===t.length)return;const e=this.domConverter,n=new Map,i=new Set;for(const n of t)if("childList"===n.type){const t=e.mapDomToView(n.target);if(t&&t.is("uiElement"))continue;t&&!this._isBogusBrMutation(n)&&i.add(t)}for(const s of t){const t=e.mapDomToView(s.target);if((!t||!t.is("uiElement"))&&"characterData"===s.type){const t=e.findCorrespondingViewText(s.target);t&&!i.has(t.parent)?n.set(t,{type:"text",oldText:t.data,newText:Ls(s.target),node:t}):!t&&Is(s.target)&&i.add(e.mapDomToView(s.target.parentNode))}}const s=[];for(const t of n.values())this.renderer.markToSync("text",t.node),s.push(t);for(const t of i){const n=e.mapViewToDom(t),i=Array.from(t.getChildren()),o=Array.from(e.domChildrenToView(n,{withChildren:!1}));Eo(i,o,a)||(this.renderer.markToSync("children",t),s.push({type:"children",oldChildren:i,newChildren:o,node:t}))}const o=t[0].target.ownerDocument.getSelection();let r=null;if(o&&o.anchorNode){const t=e.domPositionToView(o.anchorNode,o.anchorOffset),n=e.domPositionToView(o.focusNode,o.focusOffset);t&&n&&(r=new ns(t),r.setFocus(n))}function a(t,e){if(!Array.isArray(t))return t===e||!(!t.is("text")||!e.is("text"))&&t.data===e.data}s.length&&(this.document.fire("mutations",s,r),this.view.forceRender())}_isBogusBrMutation(t){let e=null;return null===t.nextSibling&&0===t.removedNodes.length&&1==t.addedNodes.length&&(e=this.domConverter.domToView(t.addedNodes[0],{withChildren:!1})),e&&e.is("element","br")}}class Ao{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Po extends ro{constructor(t){super(t),this.useCapture=!1}observe(t){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(e=>{this.listenTo(t,e,(t,e)=>{this.isEnabled&&this.onDomEvent(e)},{useCapture:this.useCapture})})}fire(t,e,n){this.isEnabled&&this.document.fire(t,new Ao(this.view,e,n))}}class So extends Po{constructor(t){super(t),this.domEventType=["keydown","keyup"]}onDomEvent(t){this.fire(t.type,t,{keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey||t.metaKey,shiftKey:t.shiftKey,get keystroke(){return fs(this)}})}}var Oo=function(){return i.a.Date.now()},Mo=/^\s+|\s+$/g,No=/^[-+]0x[0-9a-f]+$/i,Io=/^0b[01]+$/i,Ro=/^0o[0-7]+$/i,Lo=parseInt;var Do=function(t){if("number"==typeof t)return t;if(Fn(t))return NaN;if(V(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=V(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Mo,"");var n=Io.test(t);return n||Ro.test(t)?Lo(t.slice(2),n?2:8):No.test(t)?NaN:+t},Vo=Math.max,Bo=Math.min;var Fo=function(t,e,n){var i,s,o,r,a,l,c=0,h=!1,d=!1,u=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var n=i,o=s;return i=s=void 0,c=e,r=t.apply(o,n)}function g(t){return c=t,a=setTimeout(m,e),h?f(t):r}function p(t){var n=t-l;return void 0===l||n>=e||n<0||d&&t-c>=o}function m(){var t=Oo();if(p(t))return b(t);a=setTimeout(m,function(t){var n=e-(t-l);return d?Bo(n,o-(t-c)):n}(t))}function b(t){return a=void 0,u&&i?f(t):(i=s=void 0,r)}function w(){var t=Oo(),n=p(t);if(i=arguments,s=this,l=t,n){if(void 0===a)return g(l);if(d)return clearTimeout(a),a=setTimeout(m,e),f(l)}return void 0===a&&(a=setTimeout(m,e)),r}return e=Do(e)||0,V(n)&&(h=!!n.leading,o=(d="maxWait"in n)?Vo(Do(n.maxWait)||0,e):o,u="trailing"in n?!!n.trailing:u),w.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=s=a=void 0},w.flush=function(){return void 0===a?r:b(Oo())},w};class jo extends ro{constructor(t){super(t),this._fireSelectionChangeDoneDebounced=Fo(t=>this.document.fire("selectionChangeDone",t),200)}observe(){const t=this.document;t.on("keydown",(e,n)=>{var i;t.selection.isFake&&((i=n.keyCode)==us.arrowright||i==us.arrowleft||i==us.arrowup||i==us.arrowdown)&&this.isEnabled&&(n.preventDefault(),this._handleSelectionMove(n.keyCode))},{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(t){const e=this.document.selection,n=new ns(e.getRanges(),{backward:e.isBackward,fake:!1});t!=us.arrowleft&&t!=us.arrowup||n.setTo(n.getFirstPosition()),t!=us.arrowright&&t!=us.arrowdown||n.setTo(n.getLastPosition());const i={oldSelection:e,newSelection:n,domSelection:null};this.document.fire("selectionChange",i),this._fireSelectionChangeDoneDebounced(i)}}class zo extends ro{constructor(t){super(t),this.mutationObserver=t.getObserver(To),this.selection=this.document.selection,this.domConverter=t.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Fo(t=>this.document.fire("selectionChangeDone",t),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._loopbackCounter=0}observe(t){const e=t.ownerDocument;this._documents.has(e)||(this.listenTo(e,"selectionchange",()=>{this._handleSelectionChange(e)}),this._documents.add(e))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionChange(t){if(!this.isEnabled)return;this.mutationObserver.flush();const e=t.defaultView.getSelection(),n=this.domConverter.domSelectionToView(e);if(0!=n.rangeCount){if(this.view.hasDomSelection=!0,!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(e)||++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const t={oldSelection:this.selection,newSelection:n,domSelection:e};this.document.fire("selectionChange",t),this._fireSelectionChangeDoneDebounced(t)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}class qo extends Po{constructor(t){super(t),this.domEventType=["focus","blur"],this.useCapture=!0;const e=this.document;e.on("focus",()=>{e.isFocused=!0,this._renderTimeoutId=setTimeout(()=>t.forceRender(),50)}),e.on("blur",(n,i)=>{const s=e.selection.editableElement;null!==s&&s!==i.target||(e.isFocused=!1,t.forceRender())})}onDomEvent(t){this.fire(t.type,t)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class Uo extends Po{constructor(t){super(t),this.domEventType=["compositionstart","compositionupdate","compositionend"];const e=this.document;e.on("compositionstart",()=>{e.isComposing=!0}),e.on("compositionend",()=>{e.isComposing=!1})}onDomEvent(t){this.fire(t.type,t)}}class Wo extends Po{constructor(t){super(t),this.domEventType=["beforeinput"]}onDomEvent(t){this.fire(t.type,t)}}function Ho(t){return"[object Range]"==Object.prototype.toString.apply(t)}const Ko=["top","right","bottom","left","width","height"];class Jo{constructor(t){const e=Ho(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),nn(t)||e)$o(this,e?Jo.getDomRangeRects(t)[0]:t.getBoundingClientRect());else if(no(t)){const{innerWidth:e,innerHeight:n}=t;$o(this,{top:0,right:e,bottom:n,left:0,width:e,height:n})}else $o(this,t)}clone(){return new Jo(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0?null:new Jo(e)}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(!Go(t)){let n=t.parentNode||t.commonAncestorContainer;for(;n&&!Go(n);){const t=new Jo(n),i=e.getIntersection(t);if(!i)return null;i.getArea()<e.getArea()&&(e=i),n=n.parentNode}}return e}isEqual(t){for(const e of Ko)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!(!e||!e.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let e,n,i;if(no(t))e=t.innerWidth-t.document.documentElement.clientWidth,n=t.innerHeight-t.document.documentElement.clientHeight,i=t.getComputedStyle(t.document.documentElement).direction;else{const s=function(t){const e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}(this._source);e=t.offsetWidth-t.clientWidth-s.left-s.right,n=t.offsetHeight-t.clientHeight-s.top-s.bottom,i=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=s.left,this.top+=s.top,this.right-=s.right,this.bottom-=s.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,"ltr"===i?this.right-=e:this.left+=e,this.height-=n,this.bottom-=n,this}static getDomRangeRects(t){const e=[],n=Array.from(t.getClientRects());if(n.length)for(const t of n)e.push(new Jo(t));else{let n=t.startContainer;Ss(n)&&(n=n.parentNode);const i=new Jo(n.getBoundingClientRect());i.right=i.left,i.width=0,e.push(i)}return e}}function $o(t,e){for(const n of Ko)t[n]=e[n]}function Go(t){return!!nn(t)&&t===t.ownerDocument.body}function Yo({target:t,viewportOffset:e=0}){const n=ir(t);let i=n,s=null;for(;i;){let o;o=sr(i==n?t:s),Zo(o,()=>or(t,i));const r=or(t,i);if(Qo(i,r,e),i.parent!=i){if(s=i.frameElement,i=i.parent,!s)return}else i=null}}function Qo(t,e,n){const i=e.clone().moveBy(0,n),s=e.clone().moveBy(0,-n),o=new Jo(t).excludeScrollbarsAndBorders();if(![s,i].every(t=>o.contains(t))){let{scrollX:r,scrollY:a}=t;tr(s,o)?a-=o.top-e.top+n:Xo(i,o)&&(a+=e.bottom-o.bottom+n),er(e,o)?r-=o.left-e.left+n:nr(e,o)&&(r+=e.right-o.right+n),t.scrollTo(r,a)}}function Zo(t,e){const n=ir(t);let i,s;for(;t!=n.document.body;)s=e(),i=new Jo(t).excludeScrollbarsAndBorders(),i.contains(s)||(tr(s,i)?t.scrollTop-=i.top-s.top:Xo(s,i)&&(t.scrollTop+=s.bottom-i.bottom),er(s,i)?t.scrollLeft-=i.left-s.left:nr(s,i)&&(t.scrollLeft+=s.right-i.right)),t=t.parentNode}function Xo(t,e){return t.bottom>e.bottom}function tr(t,e){return t.top<e.top}function er(t,e){return t.left<e.left}function nr(t,e){return t.right>e.right}function ir(t){return Ho(t)?t.startContainer.ownerDocument.defaultView:t.ownerDocument.defaultView}function sr(t){if(Ho(t)){let e=t.commonAncestorContainer;return Ss(e)&&(e=e.parentNode),e}return t.parentNode}function or(t,e){const n=ir(t),i=new Jo(t);if(n===e)return i;{let t=n;for(;t!=e;){const e=t.frameElement,n=new Jo(e).excludeScrollbarsAndBorders();i.moveBy(n.left,n.top),t=t.parent}}return i}Object.assign({},{scrollViewportToShowTarget:Yo,scrollAncestorsToShowTarget:function(t){Zo(sr(t),()=>new Jo(t))}});class rr{constructor(t){this.document=new ss(t),this.domConverter=new Zs(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Ws(this.domConverter,this.document.selection),this._renderer.bind("isFocused").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new _s(this.document),this.addObserver(To),this.addObserver(zo),this.addObserver(qo),this.addObserver(So),this.addObserver(jo),this.addObserver(Uo),ds.isAndroid&&this.addObserver(Wo),this.document.on("keydown",Ds),ms(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0})}attachDomRoot(t,e="main"){const n=this.document.getRoot(e);n._name=t.tagName.toLowerCase();const i={};for(const{name:e,value:s}of Array.from(t.attributes))i[e]=s,"class"===e?this._writer.addClass(s.split(" "),n):this._writer.setAttribute(e,s,n);this._initialDomRootAttributes.set(t,i);const s=()=>{this._writer.setAttribute("contenteditable",!n.isReadOnly,n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};s(),this.domRoots.set(e,t),this.domConverter.bindElements(t,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(t.ownerDocument),n.on("change:children",(t,e)=>this._renderer.markToSync("children",e)),n.on("change:attributes",(t,e)=>this._renderer.markToSync("attributes",e)),n.on("change:text",(t,e)=>this._renderer.markToSync("text",e)),n.on("change:isReadOnly",()=>this.change(s)),n.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const n of this._observers.values())n.observe(t,e)}detachDomRoot(t){const e=this.domRoots.get(t);Array.from(e.attributes).forEach(({name:t})=>e.removeAttribute(t));const n=this._initialDomRootAttributes.get(e);for(const t in n)e.setAttribute(t,n[t]);this.domRoots.delete(t),this.domConverter.unbindDomElement(e)}getDomRoot(t="main"){return this.domRoots.get(t)}addObserver(t){let e=this._observers.get(t);if(e)return e;e=new t(this),this._observers.set(t,e);for(const[t,n]of this.domRoots)e.observe(n,t);return e.enable(),e}getObserver(t){return this._observers.get(t)}disableObservers(){for(const t of this._observers.values())t.disable()}enableObservers(){for(const t of this._observers.values())t.enable()}scrollToTheSelection(){const t=this.document.selection.getFirstRange();t&&Yo({target:this.domConverter.viewRangeToDom(t),viewportOffset:20})}focus(){if(!this.document.isFocused){const t=this.document.selection.editableElement;t&&(this.domConverter.focus(t),this.forceRender())}}change(t){if(this.isRenderingInProgress||this._postFixersInProgress)throw new un.b("cannot-change-view-tree: Attempting to make changes to the view when it is in an incorrect state: rendering or post-fixers are in progress. This may cause some unexpected behavior and inconsistency between the DOM and the view.",this);try{if(this._ongoingChange)return t(this._writer);this._ongoingChange=!0;const e=t(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),e}catch(t){un.b.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change(()=>{})}destroy(){for(const t of this._observers.values())t.destroy();this.document.destroy(),this.stopListening()}createPositionAt(t,e){return Zi._createAt(t,e)}createPositionAfter(t){return Zi._createAfter(t)}createPositionBefore(t){return Zi._createBefore(t)}createRange(t,e){return new Xi(t,e)}createRangeOn(t){return Xi._createOn(t)}createRangeIn(t){return Xi._createIn(t)}createSelection(t,e,n){return new ns(t,e,n)}_disableRendering(t){this._renderingDisabled=t,0==t&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}xn(rr,qi);class ar{constructor(t){this.parent=null,this._attrs=Dn(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new un.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new un.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=Mn(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}is(t){return"node"===t||"model:node"===t}_clone(){return new ar(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=Dn(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class lr extends ar{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"text"===t||"model:text"===t||"node"===t||"model:node"===t}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new lr(this.data,this.getAttributes())}static fromJSON(t){return new lr(t.data,t.attributes)}}class cr{constructor(t,e,n){if(this.textNode=t,e<0||e>t.offsetSize)throw new un.b("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.offsetSize)throw new un.b("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return"textProxy"===t||"model:textProxy"===t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class hr{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new un.b("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new un.b("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const t of e)if(!(t instanceof ar))throw new un.b("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class dr extends ar{constructor(t,e,n){super(e),this.name=t,this._children=new hr,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?e===this.name&&("element"===t||"model:element"===t):"element"===t||"model:element"===t||t===this.name||t==="model:"+this.name||"node"===t||"model:node"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new dr(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new lr(t)];yn(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new lr(t):t instanceof cr?new lr(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}static fromJSON(t){let e=null;if(t.children){e=[];for(const n of t.children)n.name?e.push(dr.fromJSON(n)):e.push(lr.fromJSON(n))}return new dr(t.name,t.attributes,e)}}class ur{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new un.b("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new un.b("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=gr._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,n,i,s;do{i=this.position,s=this._visitedParent,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const i=e.parent,s=pr(e,i),o=s||mr(e,i,s);if(o instanceof dr)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=o),this.position=e,fr("elementStart",o,t,e,1);if(o instanceof lr){let i;if(this.singleCharacters)i=1;else{let t=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),i=t-e.offset}const s=e.offset-o.startOffset,r=new cr(o,s,i);return e.offset+=i,this.position=e,fr("text",r,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():fr("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const i=e.parent,s=pr(e,i),o=s||br(e,i,s);if(o instanceof dr)return e.offset--,this.shallow?(this.position=e,fr("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this.position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():fr("elementEnd",o,t,e));if(o instanceof lr){let i;if(this.singleCharacters)i=1;else{let t=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),i=e.offset-t}const s=e.offset-o.startOffset,r=new cr(o,s-i,i);return e.offset-=i,this.position=e,fr("text",r,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,fr("elementStart",n,t,e,1)}}function fr(t,e,n,i,s){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}class gr{constructor(t,e,n="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new un.b("model-position-root-invalid: Position root invalid.",t);if(!(e instanceof Array)||0===e.length)throw new un.b("model-position-path-incorrect-format: Position path must be an array with at least one item.",t,{path:e});t.is("rootElement")?e=e.slice():(e=[...t.getPath(),...e],t=t.root),this.root=t,this.path=e,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)if(t=t.getChild(t.offsetToIndex(this.path[e])),!t)throw new un.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(t.is("text"))throw new un.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return pr(this,this.parent)}get nodeAfter(){const t=this.parent;return mr(this,t,pr(this,t))}get nodeBefore(){const t=this.parent;return br(this,t,pr(this,t))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=Mn(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new ur(e);return n.skip(t),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}getCommonPath(t){if(this.root!=t.root)return[];const e=Mn(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}getShiftedBy(t){const e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,n=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=gr._createAt(this),n=gr._createAt(t);break;case"after":e=gr._createAt(t),n=gr._createAt(this);break;default:return!1}let i=e.parent;for(;e.path.length+n.path.length;){if(e.isEqual(n))return!0;if(e.path.length>n.path.length){if(e.offset!==i.maxOffset)return!1;e.path=e.path.slice(0,-1),i=i.parent,e.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}is(t){return"position"===t||"model:position"===t}hasSameParentAs(t){if(this.root!==t.root)return!1;return"same"==Mn(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=gr._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let n;return e.containsPosition(this)||e.start.isEqual(this)?(n=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(n=n._getTransformedByDeletion(t.deletionPosition,1))):n=this.isEqual(t.deletionPosition)?gr._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),n}_getTransformedByDeletion(t,e){const n=gr._createAt(this);if(this.root!=t.root)return n;if("same"==Mn(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;n.offset-=e}}else if("prefix"==Mn(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;if(t.offset<=this.path[i]){if(t.offset+e>this.path[i])return null;n.path[i]-=e}}return n}_getTransformedByInsertion(t,e){const n=gr._createAt(this);if(this.root!=t.root)return n;if("same"==Mn(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=e);else if("prefix"==Mn(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;t.offset<=this.path[i]&&(n.path[i]+=e)}return n}_getTransformedByMove(t,e,n){if(e=e._getTransformedByDeletion(t,n),t.isEqual(e))return gr._createAt(this);const i=this._getTransformedByDeletion(t,n);return null===i||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):i._getTransformedByInsertion(e,n)}_getCombined(t,e){const n=t.path.length-1,i=gr._createAt(e);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-t.offset,i.path=[...i.path,...this.path.slice(n+1)],i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,n="toNone"){if(t instanceof gr)return new gr(t.root,t.path,t.stickiness);{const i=t;if("end"==e)e=i.maxOffset;else{if("before"==e)return this._createBefore(i,n);if("after"==e)return this._createAfter(i,n);if(0!==e&&!e)throw new un.b("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,t])}if(!i.is("element")&&!i.is("documentFragment"))throw new un.b("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,t]);const s=i.getPath();return s.push(e),new this(i.root,s,n)}}static _createAfter(t,e){if(!t.parent)throw new un.b("model-position-after-root: You cannot make a position after root.",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new un.b("model-position-before-root: You cannot make a position before root.",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const n=new gr(e.graveyard,t.path);return n.stickiness=t.stickiness,n}if(!e.getRoot(t.root))throw new un.b("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",e,{rootName:t.root});return new gr(e.getRoot(t.root),t.path,t.stickiness)}}function pr(t,e){const n=e.getChild(e.offsetToIndex(t.offset));return n&&n.is("text")&&n.startOffset<t.offset?n:null}function mr(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset))}function br(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset)-1)}class wr{constructor(t,e=null){this.start=gr._createAt(t),this.end=e?gr._createAt(e):gr._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new ur({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==Mn(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}containsItem(t){const e=gr._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}is(t){return"range"===t||"model:range"===t}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new wr(this.start,t.start)),this.containsPosition(t.end)&&e.push(new wr(t.end,this.end))):e.push(new wr(this.start,this.end)),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new wr(e,n)}return null}getMinimalFlatRanges(){const t=[],e=this.start.getCommonPath(this.end).length,n=gr._createAt(this.start);let i=n.parent;for(;n.path.length>e+1;){const e=i.maxOffset-n.offset;0!==e&&t.push(new wr(n,n.getShiftedBy(e))),n.path=n.path.slice(0,-1),n.offset++,i=i.parent}for(;n.path.length<=this.end.path.length;){const e=this.end.path[n.path.length-1],i=e-n.offset;0!==i&&t.push(new wr(n,n.getShiftedBy(i))),n.offset=e,n.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new ur(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new ur(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new ur(t);yield e.position;for(const t of e)yield t.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new wr(this.start,this.end)]}getTransformedByOperations(t){const e=[new wr(this.start,this.end)];for(const n of t)for(let t=0;t<e.length;t++){const i=e[t].getTransformedByOperation(n);e.splice(t,1,...i),t+=i.length-1}for(let t=0;t<e.length;t++){const n=e[t];for(let i=t+1;i<e.length;i++){const t=e[i];(n.containsRange(t)||t.containsRange(n)||n.isEqual(t))&&e.splice(i,1)}}return e}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,e=this.end.nodeBefore;return t&&t.is("element")&&t===e?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,e=!1){return this._getTransformedByInsertion(t.position,t.howMany,e)}_getTransformedByMoveOperation(t,e=!1){const n=t.sourcePosition,i=t.howMany,s=t.targetPosition;return this._getTransformedByMove(n,s,i,e)}_getTransformedBySplitOperation(t){const e=this.start._getTransformedBySplitOperation(t);let n=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(n=this.end.getShiftedBy(1)),e.root!=n.root&&(n=this.end.getShiftedBy(-1)),new wr(e,n)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new wr(this.start);let e=this.start._getTransformedByMergeOperation(t),n=this.end._getTransformedByMergeOperation(t);return e.root!=n.root&&(n=this.end.getShiftedBy(-1)),e.isAfter(n)?(t.sourcePosition.isBefore(t.targetPosition)?(e=gr._createAt(n),e.offset=0):(t.deletionPosition.isEqual(e)||(n=t.deletionPosition),e=t.targetPosition),new wr(e,n)):new wr(e,n)}_getTransformedByInsertion(t,e,n=!1){if(n&&this.containsPosition(t))return[new wr(this.start,t),new wr(t.getShiftedBy(e),this.end._getTransformedByInsertion(t,e))];{const n=new wr(this.start,this.end);return n.start=n.start._getTransformedByInsertion(t,e),n.end=n.end._getTransformedByInsertion(t,e),[n]}}_getTransformedByMove(t,e,n,i=!1){if(this.isCollapsed){const i=this.start._getTransformedByMove(t,e,n);return[new wr(i)]}const s=wr._createFromPositionAndShift(t,n),o=e._getTransformedByDeletion(t,n);if(this.containsPosition(e)&&!i&&(s.containsPosition(this.start)||s.containsPosition(this.end))){const i=this.start._getTransformedByMove(t,e,n),s=this.end._getTransformedByMove(t,e,n);return[new wr(i,s)]}let r;const a=this.getDifference(s);let l=null;const c=this.getIntersection(s);if(1==a.length?l=new wr(a[0].start._getTransformedByDeletion(t,n),a[0].end._getTransformedByDeletion(t,n)):2==a.length&&(l=new wr(this.start,this.end._getTransformedByDeletion(t,n))),r=l?l._getTransformedByInsertion(o,n,null!==c||i):[],c){const t=new wr(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,t):r.push(t)}return r}_getTransformedByDeletion(t,e){let n=this.start._getTransformedByDeletion(t,e),i=this.end._getTransformedByDeletion(t,e);return null==n&&null==i?null:(null==n&&(n=t),null==i&&(i=t),new wr(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return new this(gr._createAt(t,0),gr._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(gr._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(0===t.length)throw new un.b("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(1==t.length)return t[0].clone();const e=t[0];t.sort((t,e)=>t.start.isAfter(e.start)?1:-1);const n=t.indexOf(e),i=new this(e.start,e.end);if(n>0)for(let e=n-1;t[e].end.isEqual(i.start);e++)i.start=gr._createAt(t[e].start);for(let e=n+1;e<t.length&&t[e].start.isEqual(i.end);e++)i.end=gr._createAt(t[e].end);return i}static fromJSON(t,e){return new this(gr.fromJSON(t.start,e),gr.fromJSON(t.end,e))}}class _r{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(t,e)=>{if(e.viewPosition)return;const n=this._modelToViewMapping.get(e.modelPosition.parent);e.viewPosition=this._findPositionIn(n,e.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(t,e)=>{if(e.modelPosition)return;const n=this.findMappedViewAncestor(e.viewPosition),i=this._viewToModelMapping.get(n),s=this._toModelOffset(e.viewPosition.parent,e.viewPosition.offset,n);e.modelPosition=gr._createAt(i,s)},{priority:"low"})}bindElements(t,e){this._modelToViewMapping.set(t,e),this._viewToModelMapping.set(e,t)}unbindViewElement(t){const e=this.toModelElement(t);if(this._viewToModelMapping.delete(t),this._elementToMarkerNames.has(t))for(const e of this._elementToMarkerNames.get(t))this._unboundMarkerNames.add(e);this._modelToViewMapping.get(e)==t&&this._modelToViewMapping.delete(e)}unbindModelElement(t){const e=this.toViewElement(t);this._modelToViewMapping.delete(t),this._viewToModelMapping.get(e)==t&&this._viewToModelMapping.delete(e)}bindElementToMarker(t,e){const n=this._markerNameToElements.get(e)||new Set;n.add(t);const i=this._elementToMarkerNames.get(t)||new Set;i.add(e),this._markerNameToElements.set(e,n),this._elementToMarkerNames.set(t,i)}unbindElementFromMarkerName(t,e){const n=this._markerNameToElements.get(e);n&&(n.delete(t),0==n.size&&this._markerNameToElements.delete(e));const i=this._elementToMarkerNames.get(t);i&&(i.delete(e),0==i.size&&this._elementToMarkerNames.delete(t))}flushUnboundMarkerNames(){const t=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),t}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(t){return this._viewToModelMapping.get(t)}toViewElement(t){return this._modelToViewMapping.get(t)}toModelRange(t){return new wr(this.toModelPosition(t.start),this.toModelPosition(t.end))}toViewRange(t){return new Xi(this.toViewPosition(t.start),this.toViewPosition(t.end))}toModelPosition(t){const e={viewPosition:t,mapper:this};return this.fire("viewToModelPosition",e),e.modelPosition}toViewPosition(t,e={isPhantom:!1}){const n={modelPosition:t,mapper:this,isPhantom:e.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(t){const e=this._markerNameToElements.get(t);if(!e)return null;const n=new Set;for(const t of e)if(t.is("attributeElement"))for(const e of t.getElementsWithSameId())n.add(e);else n.add(t);return n}registerViewToModelLength(t,e){this._viewToModelLengthCallbacks.set(t,e)}findMappedViewAncestor(t){let e=t.parent;for(;!this._viewToModelMapping.has(e);)e=e.parent;return e}_toModelOffset(t,e,n){if(n!=t){return this._toModelOffset(t.parent,t.index,n)+this._toModelOffset(t,e,t)}if(t.is("text"))return e;let i=0;for(let n=0;n<e;n++)i+=this.getModelLength(t.getChild(n));return i}getModelLength(t){if(this._viewToModelLengthCallbacks.get(t.name)){return this._viewToModelLengthCallbacks.get(t.name)(t)}if(this._viewToModelMapping.has(t))return 1;if(t.is("text"))return t.data.length;if(t.is("uiElement"))return 0;{let e=0;for(const n of t.getChildren())e+=this.getModelLength(n);return e}}_findPositionIn(t,e){let n,i=0,s=0,o=0;if(t.is("text"))return new Zi(t,e);for(;s<e;)n=t.getChild(o),i=this.getModelLength(n),s+=i,o++;return s==e?this._moveViewPositionToTextNode(new Zi(t,o)):this._findPositionIn(n,e-(s-i))}_moveViewPositionToTextNode(t){const e=t.nodeBefore,n=t.nodeAfter;return e instanceof Rn?new Zi(e,e.data.length):n instanceof Rn?new Zi(n,0):t}}xn(_r,pn);class kr{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(t,e){e=vr(e),t instanceof cr&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}consume(t,e){return e=vr(e),t instanceof cr&&(t=this._getSymbolForTextProxy(t)),!!this.test(t,e)&&(this._consumable.get(t).set(e,!1),!0)}test(t,e){e=vr(e),t instanceof cr&&(t=this._getSymbolForTextProxy(t));const n=this._consumable.get(t);if(void 0===n)return null;const i=n.get(e);return void 0===i?null:i}revert(t,e){e=vr(e),t instanceof cr&&(t=this._getSymbolForTextProxy(t));const n=this.test(t,e);return!1===n?(this._consumable.get(t).set(e,!0),!0):!0!==n&&null}_getSymbolForTextProxy(t){let e=null;const n=this._textProxyRegistry.get(t.startOffset);if(n){const i=n.get(t.endOffset);i&&(e=i.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t.startOffset,t.endOffset,t.parent)),e}_addSymbolForTextProxy(t,e,n){const i=Symbol("textProxySymbol");let s,o;return s=this._textProxyRegistry.get(t),s||(s=new Map,this._textProxyRegistry.set(t,s)),o=s.get(e),o||(o=new Map,s.set(e,o)),o.set(n,i),i}}function vr(t){const e=t.split(":");return e.length>1?e[0]+":"+e[1]:e[0]}class yr{constructor(t){this.conversionApi=Vi({dispatcher:this},t)}convertChanges(t,e,n){for(const e of t.getMarkersToRemove())this.convertMarkerRemove(e.name,e.range,n);for(const e of t.getChanges())"insert"==e.type?this.convertInsert(wr._createFromPositionAndShift(e.position,e.length),n):"remove"==e.type?this.convertRemove(e.position,e.length,e.name,n):this.convertAttribute(e.range,e.attributeKey,e.attributeOldValue,e.attributeNewValue,n);for(const t of this.conversionApi.mapper.flushUnboundMarkerNames()){const i=e.get(t).getRange();this.convertMarkerRemove(t,i,n),this.convertMarkerAdd(t,i,n)}for(const e of t.getMarkersToAdd())this.convertMarkerAdd(e.name,e.range,n)}convertInsert(t,e){this.conversionApi.writer=e,this.conversionApi.consumable=this._createInsertConsumable(t);for(const e of t){const t=e.item,n={item:t,range:wr._createFromPositionAndShift(e.previousPosition,e.length)};this._testAndFire("insert",n);for(const e of t.getAttributeKeys())n.attributeKey=e,n.attributeOldValue=null,n.attributeNewValue=t.getAttribute(e),this._testAndFire("attribute:"+e,n)}this._clearConversionApi()}convertRemove(t,e,n,i){this.conversionApi.writer=i,this.fire("remove:"+n,{position:t,length:e},this.conversionApi),this._clearConversionApi()}convertAttribute(t,e,n,i,s){this.conversionApi.writer=s,this.conversionApi.consumable=this._createConsumableForRange(t,"attribute:"+e);for(const s of t){const t={item:s.item,range:wr._createFromPositionAndShift(s.previousPosition,s.length),attributeKey:e,attributeOldValue:n,attributeNewValue:i};this._testAndFire("attribute:"+e,t)}this._clearConversionApi()}convertSelection(t,e,n){const i=Array.from(e.getMarkersAtPosition(t.getFirstPosition()));if(this.conversionApi.writer=n,this.conversionApi.consumable=this._createSelectionConsumable(t,i),this.fire("selection",{selection:t},this.conversionApi),t.isCollapsed){for(const e of i){const n=e.getRange();if(!xr(t.getFirstPosition(),e,this.conversionApi.mapper))continue;const i={item:t,markerName:e.name,markerRange:n};this.conversionApi.consumable.test(t,"addMarker:"+e.name)&&this.fire("addMarker:"+e.name,i,this.conversionApi)}for(const e of t.getAttributeKeys()){const n={item:t,range:t.getFirstRange(),attributeKey:e,attributeOldValue:null,attributeNewValue:t.getAttribute(e)};this.conversionApi.consumable.test(t,"attribute:"+n.attributeKey)&&this.fire("attribute:"+n.attributeKey+":$text",n,this.conversionApi)}this._clearConversionApi()}}convertMarkerAdd(t,e,n){if(!e.root.document||"$graveyard"==e.root.rootName)return;this.conversionApi.writer=n;const i="addMarker:"+t,s=new kr;if(s.add(e,i),this.conversionApi.consumable=s,this.fire(i,{markerName:t,markerRange:e},this.conversionApi),s.test(e,i)){this.conversionApi.consumable=this._createConsumableForRange(e,i);for(const n of e.getItems()){if(!this.conversionApi.consumable.test(n,i))continue;const s={item:n,range:wr._createOn(n),markerName:t,markerRange:e};this.fire(i,s,this.conversionApi)}this._clearConversionApi()}}convertMarkerRemove(t,e,n){e.root.document&&"$graveyard"!=e.root.rootName&&(this.conversionApi.writer=n,this.fire("removeMarker:"+t,{markerName:t,markerRange:e},this.conversionApi),this._clearConversionApi())}_createInsertConsumable(t){const e=new kr;for(const n of t){const t=n.item;e.add(t,"insert");for(const n of t.getAttributeKeys())e.add(t,"attribute:"+n)}return e}_createConsumableForRange(t,e){const n=new kr;for(const i of t.getItems())n.add(i,e);return n}_createSelectionConsumable(t,e){const n=new kr;n.add(t,"selection");for(const i of e)n.add(t,"addMarker:"+i.name);for(const e of t.getAttributeKeys())n.add(t,"attribute:"+e);return n}_testAndFire(t,e){if(!this.conversionApi.consumable.test(e.item,t))return;const n=e.item.name||"$text";this.fire(t+":"+n,e,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}}function xr(t,e,n){const i=e.getRange(),s=Array.from(t.getAncestors());s.shift(),s.reverse();return!s.some(t=>{if(i.containsItem(t)){return!!n.toViewElement(t).getCustomProperty("addHighlight")}})}xn(yr,pn);class Cr{constructor(t,e,n){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,t&&this.setTo(t,e,n)}get anchor(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}get focus(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(t){if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const t of this._ranges)yield new wr(t.start,t.end)}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?new wr(t.start,t.end):null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?new wr(t.start,t.end):null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}setTo(t,e,n){if(null===t)this._setRanges([]);else if(t instanceof Cr)this._setRanges(t.getRanges(),t.isBackward);else if(t&&"function"==typeof t.getRanges)this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof wr)this._setRanges([t],!!e&&!!e.backward);else if(t instanceof gr)this._setRanges([new wr(t)]);else if(t instanceof ar){const i=!!n&&!!n.backward;let s;if("in"==e)s=wr._createIn(t);else if("on"==e)s=wr._createOn(t);else{if(void 0===e)throw new un.b("model-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",[this,t]);s=new wr(gr._createAt(t,e))}this._setRanges([s],i)}else{if(!yn(t))throw new un.b("model-selection-setTo-not-selectable: Cannot set the selection to the given place.",[this,t]);this._setRanges(t,e&&!!e.backward)}}_setRanges(t,e=!1){const n=(t=Array.from(t)).some(e=>{if(!(e instanceof wr))throw new un.b("model-selection-set-ranges-not-range: Selection range set to an object that is not an instance of model.Range.",[this,t]);return this._ranges.every(t=>!t.isEqual(e))});if(t.length!==this._ranges.length||n){this._removeAllRanges();for(const e of t)this._pushRange(e);this._lastRangeBackward=!!e,this.fire("change:range",{directChange:!0})}}setFocus(t,e){if(null===this.anchor)throw new un.b("model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",[this,t]);const n=gr._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.length&&this._popRange(),"before"==n.compareWith(i)?(this._pushRange(new wr(n,i)),this._lastRangeBackward=!0):(this._pushRange(new wr(i,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(t){return this._attrs.has(t)}removeAttribute(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}setAttribute(t,e){this.getAttribute(t)!==e&&(this._attrs.set(t,e),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(t){return"selection"===t||"model:selection"===t}*getSelectedBlocks(){const t=new WeakSet;for(const e of this.getRanges()){const n=Ar(e.start,t);n&&Pr(n,e)&&(yield n);for(const n of e.getWalker()){const i=n.item;"elementEnd"==n.type&&Tr(i,t,e)&&(yield i)}const i=Ar(e.end,t);i&&!e.end.isTouching(gr._createAt(i,0))&&Pr(i,e)&&(yield i)}}containsEntireContent(t=this.anchor.root){const e=gr._createAt(t,0),n=gr._createAt(t,"end");return e.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}_pushRange(t){this._checkRange(t),this._ranges.push(new wr(t.start,t.end))}_checkRange(t){for(let e=0;e<this._ranges.length;e++)if(t.isIntersecting(this._ranges[e]))throw new un.b("model-selection-range-intersects: Trying to add a range that intersects with another range in the selection.",[this,t],{addedRange:t,intersectingRange:this._ranges[e]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function Er(t,e){return!e.has(t)&&(e.add(t),t.root.document.model.schema.isBlock(t)&&t.parent)}function Tr(t,e,n){return Er(t,e)&&Pr(t,n)}function Ar(t,e){const n=t.parent.root.document.model.schema,i=t.parent.getAncestors({parentFirst:!0,includeSelf:!0});let s=!1;const o=i.find(t=>!s&&(s=n.isLimit(t),!s&&Er(t,e)));return i.forEach(t=>e.add(t)),o}function Pr(t,e){const n=function(t){const e=t.root.document.model.schema;let n=t.parent;for(;n;){if(e.isBlock(n))return n;n=n.parent}}(t);if(!n)return!0;return!e.containsRange(wr._createOn(n),!0)}xn(Cr,pn);class Sr extends wr{constructor(t,e){super(t,e),Or.call(this)}detach(){this.stopListening()}is(t){return"liveRange"===t||"model:liveRange"===t||"range"==t||"model:range"===t}toRange(){return new wr(this.start,this.end)}static fromRange(t){return new Sr(t.start,t.end)}}function Or(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&Mr.call(this,n)},{priority:"low"})}function Mr(t){const e=this.getTransformedByOperation(t),n=wr._createFromRanges(e),i=!n.isEqual(this),s=function(t,e){switch(e.type){case"insert":return t.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return t.containsPosition(e.sourcePosition)||t.start.isEqual(e.sourcePosition)||t.containsPosition(e.targetPosition);case"split":return t.containsPosition(e.splitPosition)||t.containsPosition(e.insertionPosition)}return!1}(this,t);let o=null;if(i){"$graveyard"==n.root.rootName&&(o="remove"==t.type?t.sourcePosition:t.deletionPosition);const e=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",e,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}xn(Sr,pn);class Nr{constructor(t){this._selection=new Ir(t),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(t){return this._selection.containsEntireContent(t)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(t){return this._selection.getAttribute(t)}hasAttribute(t){return this._selection.hasAttribute(t)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}is(t){return"selection"===t||"model:selection"==t||"documentSelection"==t||"model:documentSelection"==t}_setFocus(t,e){this._selection.setFocus(t,e)}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setAttribute(t,e){this._selection.setAttribute(t,e)}_removeAttribute(t){this._selection.removeAttribute(t)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(t){this._selection.restoreGravity(t)}static _getStoreAttributeKey(t){return"selection:"+t}static _isStoreAttributeKey(t){return t.startsWith("selection:")}}xn(Nr,pn);class Ir extends Cr{constructor(t){super(),this.markers=new Cn({idProperty:"name"}),this._model=t.model,this._document=t,this._attributePriority=new Map,this._fixGraveyardRangesData=[],this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this.listenTo(this._model,"applyOperation",(t,e)=>{const n=e[0];if(n.isDocumentOperation&&"marker"!=n.type&&"rename"!=n.type&&"noop"!=n.type){for(;this._fixGraveyardRangesData.length;){const{liveRange:t,sourcePosition:e}=this._fixGraveyardRangesData.shift();this._fixGraveyardSelection(t,e)}this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1}))}},{priority:"lowest"}),this.on("change:range",()=>{for(const t of this.getRanges())if(!this._document._validateSelectionRange(t))throw new un.b("document-selection-wrong-position: Range from document selection starts or ends at incorrect position.",this,{range:t})}),this.listenTo(this._model.markers,"update",()=>this._updateMarkers()),this.listenTo(this._document,"change",(t,e)=>{!function(t,e){const n=t.document.differ;for(const i of n.getChanges()){if("insert"!=i.type)continue;const n=i.position.parent;i.length===n.maxOffset&&t.enqueueChange(e,t=>{const e=Array.from(n.getAttributeKeys()).filter(t=>t.startsWith("selection:"));for(const i of e)t.removeAttribute(i,n)})}}(this._model,e)})}get isCollapsed(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let t=0;t<this._ranges.length;t++)this._ranges[t].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(t,e,n){super.setTo(t,e,n),this._updateAttributes(!0),this._updateMarkers()}setFocus(t,e){super.setFocus(t,e),this._updateAttributes(!0),this._updateMarkers()}setAttribute(t,e){if(this._setAttribute(t,e)){const e=[t];this.fire("change:attribute",{attributeKeys:e,directChange:!0})}}removeAttribute(t){if(this._removeAttribute(t)){const e=[t];this.fire("change:attribute",{attributeKeys:e,directChange:!0})}}overrideGravity(){const t=hn();return this._overriddenGravityRegister.add(t),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),t}restoreGravity(t){if(!this._overriddenGravityRegister.has(t))throw new un.b("document-selection-gravity-wrong-restore: Attempting to restore the selection gravity for an unknown UID.",this,{uid:t});this._overriddenGravityRegister.delete(t),this.isGravityOverridden||this._updateAttributes(!0)}_popRange(){this._ranges.pop().detach()}_pushRange(t){const e=this._prepareRange(t);e&&this._ranges.push(e)}_prepareRange(t){if(this._checkRange(t),t.root==this._document.graveyard)return;const e=Sr.fromRange(t);return e.on("change:range",(t,n,i)=>{this._hasChangedRange=!0,e.root==this._document.graveyard&&this._fixGraveyardRangesData.push({liveRange:e,sourcePosition:i.deletionPosition})}),e}_updateMarkers(){const t=[];let e=!1;for(const e of this._model.markers){const n=e.getRange();for(const i of this.getRanges())n.containsRange(i,!i.isCollapsed)&&t.push(e)}const n=Array.from(this.markers);for(const n of t)this.markers.has(n)||(this.markers.add(n),e=!0);for(const n of Array.from(this.markers))t.includes(n)||(this.markers.remove(n),e=!0);e&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateAttributes(t){const e=Dn(this._getSurroundingAttributes()),n=Dn(this.getAttributes());if(t)this._attributePriority=new Map,this._attrs=new Map;else for(const[t,e]of this._attributePriority)"low"==e&&(this._attrs.delete(t),this._attributePriority.delete(t));this._setAttributesTo(e);const i=[];for(const[t,e]of this.getAttributes())n.has(t)&&n.get(t)===e||i.push(t);for(const[t]of n)this.hasAttribute(t)||i.push(t);i.length>0&&this.fire("change:attribute",{attributeKeys:i,directChange:!1})}_setAttribute(t,e,n=!0){const i=n?"normal":"low";if("low"==i&&"normal"==this._attributePriority.get(t))return!1;return super.getAttribute(t)!==e&&(this._attrs.set(t,e),this._attributePriority.set(t,i),!0)}_removeAttribute(t,e=!0){const n=e?"normal":"low";return("low"!=n||"normal"!=this._attributePriority.get(t))&&(this._attributePriority.set(t,n),!!super.hasAttribute(t)&&(this._attrs.delete(t),!0))}_setAttributesTo(t){const e=new Set;for(const[e,n]of this.getAttributes())t.get(e)!==n&&this._removeAttribute(e,!1);for(const[n,i]of t){this._setAttribute(n,i,!1)&&e.add(n)}return e}*_getStoredAttributes(){const t=this.getFirstPosition().parent;if(this.isCollapsed&&t.isEmpty)for(const e of t.getAttributeKeys())if(e.startsWith("selection:")){const n=e.substr("selection:".length);yield[n,t.getAttribute(e)]}}_getSurroundingAttributes(){const t=this.getFirstPosition(),e=this._model.schema;let n=null;if(this.isCollapsed){const e=t.textNode?t.textNode:t.nodeBefore,i=t.textNode?t.textNode:t.nodeAfter;if(this.isGravityOverridden||(n=Rr(e)),n||(n=Rr(i)),!this.isGravityOverridden&&!n){let t=e;for(;t&&!n;)t=t.previousSibling,n=Rr(t)}if(!n){let t=i;for(;t&&!n;)t=t.nextSibling,n=Rr(t)}n||(n=this._getStoredAttributes())}else{const t=this.getFirstRange();for(const i of t){if(i.item.is("element")&&e.isObject(i.item))break;if("text"==i.type){n=i.item.getAttributes();break}}}return n}_fixGraveyardSelection(t,e){const n=e.clone(),i=this._model.schema.getNearestSelectionRange(n),s=this._ranges.indexOf(t);if(this._ranges.splice(s,1),t.detach(),i&&(o=i,this._ranges.every(t=>!o.isEqual(t)))){const t=this._prepareRange(i);this._ranges.splice(s,0,t)}var o}}function Rr(t){return t instanceof cr||t instanceof lr?t.getAttributes():null}class Lr{constructor(t){this._dispatchers=t}add(t){for(const e of this._dispatchers)t(e);return this}}var Dr=function(t){return tn(t,5)};class Vr extends Lr{elementToElement(t){return this.add(function(t){return(t=Dr(t)).view=Fr(t.view,"container"),e=>{var n;e.on("insert:"+t.model,(n=t.view,(t,e,i)=>{const s=n(e.item,i.writer);if(!s)return;if(!i.consumable.consume(e.item,"insert"))return;const o=i.mapper.toViewPosition(e.range.start);i.mapper.bindElements(e.item,s),i.writer.insert(o,s)}),{priority:t.converterPriority||"normal"})}}(t))}attributeToElement(t){return this.add(function(t){t=Dr(t);let e="attribute:"+(t.model.key?t.model.key:t.model);t.model.name&&(e+=":"+t.model.name);if(t.model.values)for(const e of t.model.values)t.view[e]=Fr(t.view[e],"attribute");else t.view=Fr(t.view,"attribute");const n=jr(t);return i=>{i.on(e,function(t){return(e,n,i)=>{const s=t(n.attributeOldValue,i.writer),o=t(n.attributeNewValue,i.writer);if(!s&&!o)return;if(!i.consumable.consume(n.item,e.name))return;const r=i.writer,a=r.document.selection;if(n.item instanceof Cr||n.item instanceof Nr)r.wrap(a.getFirstRange(),o);else{let t=i.mapper.toViewRange(n.range);null!==n.attributeOldValue&&s&&(t=r.unwrap(t,s)),null!==n.attributeNewValue&&o&&r.wrap(t,o)}}}(n),{priority:t.converterPriority||"normal"})}}(t))}attributeToAttribute(t){return this.add(function(t){t=Dr(t);let e="attribute:"+(t.model.key?t.model.key:t.model);t.model.name&&(e+=":"+t.model.name);if(t.model.values)for(const e of t.model.values)t.view[e]=zr(t.view[e]);else t.view=zr(t.view);const n=jr(t);return i=>{var s;i.on(e,(s=n,(t,e,n)=>{const i=s(e.attributeOldValue,e),o=s(e.attributeNewValue,e);if(!i&&!o)return;if(!n.consumable.consume(e.item,t.name))return;const r=n.mapper.toViewElement(e.item),a=n.writer;if(!r)throw new un.b("conversion-attribute-to-attribute-on-text: Trying to convert text node's attribute with attribute-to-attribute converter.",[e,n]);if(null!==e.attributeOldValue&&i)if("class"==i.key){const t=Array.isArray(i.value)?i.value:[i.value];for(const e of t)a.removeClass(e,r)}else if("style"==i.key){const t=Object.keys(i.value);for(const e of t)a.removeStyle(e,r)}else a.removeAttribute(i.key,r);if(null!==e.attributeNewValue&&o)if("class"==o.key){const t=Array.isArray(o.value)?o.value:[o.value];for(const e of t)a.addClass(e,r)}else if("style"==o.key){const t=Object.keys(o.value);for(const e of t)a.setStyle(e,o.value[e],r)}else a.setAttribute(o.key,o.value,r)}),{priority:t.converterPriority||"normal"})}}(t))}markerToElement(t){return this.add(function(t){return(t=Dr(t)).view=Fr(t.view,"ui"),e=>{var n;e.on("addMarker:"+t.model,(n=t.view,(t,e,i)=>{e.isOpening=!0;const s=n(e,i.writer);e.isOpening=!1;const o=n(e,i.writer);if(!s||!o)return;const r=e.markerRange;if(r.isCollapsed&&!i.consumable.consume(r,t.name))return;for(const e of r)if(!i.consumable.consume(e.item,t.name))return;const a=i.mapper,l=i.writer;l.insert(a.toViewPosition(r.start),s),i.mapper.bindElementToMarker(s,e.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),i.mapper.bindElementToMarker(o,e.markerName)),t.stop()}),{priority:t.converterPriority||"normal"}),e.on("removeMarker:"+t.model,(t.view,(t,e,n)=>{const i=n.mapper.markerNameToElements(e.markerName);if(i){for(const t of i)n.mapper.unbindElementFromMarkerName(t,e.markerName),n.writer.clear(n.writer.createRangeOn(t),t);n.writer.clearClonedElementsGroup(e.markerName),t.stop()}}),{priority:t.converterPriority||"normal"})}}(t))}markerToHighlight(t){return this.add(function(t){return e=>{var n;e.on("addMarker:"+t.model,(n=t.view,(t,e,i)=>{if(!e.item)return;if(!(e.item instanceof Cr||e.item instanceof Nr||e.item.is("textProxy")))return;const s=qr(n,e,i);if(!s)return;if(!i.consumable.consume(e.item,t.name))return;const o=i.writer,r=Br(o,s),a=o.document.selection;if(e.item instanceof Cr||e.item instanceof Nr)o.wrap(a.getFirstRange(),r,a);else{const t=i.mapper.toViewRange(e.range),n=o.wrap(t,r);for(const t of n.getItems())if(t.is("attributeElement")&&t.isSimilar(r)){i.mapper.bindElementToMarker(t,e.markerName);break}}}),{priority:t.converterPriority||"normal"}),e.on("addMarker:"+t.model,function(t){return(e,n,i)=>{if(!n.item)return;if(!(n.item instanceof dr))return;const s=qr(t,n,i);if(!s)return;if(!i.consumable.test(n.item,e.name))return;const o=i.mapper.toViewElement(n.item);if(o&&o.getCustomProperty("addHighlight")){i.consumable.consume(n.item,e.name);for(const t of wr._createIn(n.item))i.consumable.consume(t.item,e.name);o.getCustomProperty("addHighlight")(o,s,i.writer),i.mapper.bindElementToMarker(o,n.markerName)}}}(t.view),{priority:t.converterPriority||"normal"}),e.on("removeMarker:"+t.model,function(t){return(e,n,i)=>{if(n.markerRange.isCollapsed)return;const s=qr(t,n,i);if(!s)return;const o=Br(i.writer,s),r=i.mapper.markerNameToElements(n.markerName);if(r){for(const t of r)i.mapper.unbindElementFromMarkerName(t,n.markerName),t.is("attributeElement")?i.writer.unwrap(i.writer.createRangeOn(t),o):t.getCustomProperty("removeHighlight")(t,s.id,i.writer);i.writer.clearClonedElementsGroup(n.markerName),e.stop()}}}(t.view),{priority:t.converterPriority||"normal"})}}(t))}}function Br(t,e){const n=t.createAttributeElement("span",e.attributes);return e.classes&&n._addClass(e.classes),e.priority&&(n._priority=e.priority),n._id=e.id,n}function Fr(t,e){return"function"==typeof t?t:(n,i)=>function(t,e,n){"string"==typeof t&&(t={name:t});let i;const s=Object.assign({},t.attributes);if("container"==n)i=e.createContainerElement(t.name,s);else if("attribute"==n){const n={priority:t.priority||os.DEFAULT_PRIORITY};i=e.createAttributeElement(t.name,s,n)}else i=e.createUIElement(t.name,s);if(t.styles){const n=Object.keys(t.styles);for(const s of n)e.setStyle(s,t.styles[s],i)}if(t.classes){const n=t.classes;if("string"==typeof n)e.addClass(n,i);else for(const t of n)e.addClass(t,i)}return i}(t,i,e)}function jr(t){return t.model.values?(e,n)=>{const i=t.view[e];return i?i(e,n):null}:t.view}function zr(t){return"string"==typeof t?e=>({key:t,value:e}):"object"==typeof t?t.value?()=>t:e=>({key:t.key,value:e}):t}function qr(t,e,n){const i="function"==typeof t?t(e,n):t;return i?(i.priority||(i.priority=10),i.id||(i.id=e.markerName),i):null}class Ur extends Lr{elementToElement(t){return this.add(Wr(t))}elementToAttribute(t){return this.add(function(t){Kr(t=Dr(t));const e=Jr(t,!1),n=Hr(t.view),i=n?"element:"+n:"element";return n=>{n.on(i,e,{priority:t.converterPriority||"low"})}}(t))}attributeToAttribute(t){return this.add(function(t){t=Dr(t);let e=null;("string"==typeof t.view||t.view.key)&&(e=function(t){"string"==typeof t.view&&(t.view={key:t.view});const e=t.view.key;let n;if("class"==e||"style"==e){n={["class"==e?"classes":"styles"]:t.view.value}}else{const i=void 0===t.view.value?/[\s\S]*/:t.view.value;n={attributes:{[e]:i}}}t.view.name&&(n.name=t.view.name);return t.view=n,e}(t));Kr(t,e);const n=Jr(t,!0);return e=>{e.on("element",n,{priority:t.converterPriority||"low"})}}(t))}elementToMarker(t){return this.add(function(t){return function(t){const e=t.model;t.model=(t,n)=>{const i="string"==typeof e?e:e(t);return n.createElement("$marker",{"data-name":i})}}(t=Dr(t)),Wr(t)}(t))}}function Wr(t){const e=function(t){const e=t.view?new Vn(t.view):null;return(n,i,s)=>{let o={};if(e){const t=e.match(i.viewItem);if(!t)return;o=t.match}o.name=!0;const r=(a=t.model,l=i.viewItem,c=s.writer,a instanceof Function?a(l,c):c.createElement(a));var a,l,c;if(!r)return;if(!s.consumable.test(i.viewItem,o))return;const h=s.splitToAllowedParent(r,i.modelCursor);if(!h)return;s.writer.insert(r,h.position),s.convertChildren(i.viewItem,s.writer.createPositionAt(r,0)),s.consumable.consume(i.viewItem,o);const d=s.getSplitParts(r);i.modelRange=new wr(s.writer.createPositionBefore(r),s.writer.createPositionAfter(d[d.length-1])),h.cursorParent?i.modelCursor=s.writer.createPositionAt(h.cursorParent,0):i.modelCursor=i.modelRange.end}}(t=Dr(t)),n=Hr(t.view),i=n?"element:"+n:"element";return n=>{n.on(i,e,{priority:t.converterPriority||"normal"})}}function Hr(t){return"string"==typeof t?t:"object"==typeof t&&"string"==typeof t.name?t.name:null}function Kr(t,e=null){const n=null===e||(t=>t.getAttribute(e)),i="object"!=typeof t.model?t.model:t.model.key,s="object"!=typeof t.model||void 0===t.model.value?n:t.model.value;t.model={key:i,value:s}}function Jr(t,e){const n=new Vn(t.view);return(i,s,o)=>{const r=n.match(s.viewItem);if(!r)return;const a=t.model.key,l="function"==typeof t.model.value?t.model.value(s.viewItem):t.model.value;if(null===l)return;if(!function(t,e){const n="function"==typeof t?t(e):t;if("object"==typeof n&&!Hr(n))return!1;return!n.classes&&!n.attributes&&!n.styles}(t.view,s.viewItem)?delete r.match.name:r.match.name=!0,!o.consumable.test(s.viewItem,r.match))return;s.modelRange||(s=Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor)));(function(t,e,n,i){let s=!1;for(const o of Array.from(t.getItems({shallow:n})))i.schema.checkAttribute(o,e.key)&&(i.writer.setAttribute(e.key,e.value,o),s=!0);return s})(s.modelRange,{key:a,value:l},e,o)&&o.consumable.consume(s.viewItem,r.match)}}class $r{constructor(t,e){this.model=t,this.view=new rr(e),this.mapper=new _r,this.downcastDispatcher=new yr({mapper:this.mapper});const n=this.model.document,i=n.selection,s=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(n,"change",()=>{this.view.change(t=>{this.downcastDispatcher.convertChanges(n.differ,s,t),this.downcastDispatcher.convertSelection(i,s,t)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(t,e){return(n,i)=>{const s=i.newSelection,o=new Cr,r=[];for(const t of s.getRanges())r.push(e.toModelRange(t));o.setTo(r,{backward:s.isBackward}),o.isEqual(t.document.selection)||t.change(t=>{t.setSelection(o)})}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",(t,e,n)=>{if(!n.consumable.consume(e.item,"insert"))return;const i=n.writer,s=n.mapper.toViewPosition(e.range.start),o=i.createText(e.item.data);i.insert(s,o)},{priority:"lowest"}),this.downcastDispatcher.on("remove",(t,e,n)=>{const i=n.mapper.toViewPosition(e.position),s=e.position.getShiftedBy(e.length),o=n.mapper.toViewPosition(s,{isPhantom:!0}),r=n.writer.createRange(i,o),a=n.writer.remove(r.getTrimmed());for(const t of n.writer.createRangeIn(a).getItems())n.mapper.unbindViewElement(t)},{priority:"low"}),this.downcastDispatcher.on("selection",(t,e,n)=>{const i=n.writer,s=i.document.selection;for(const t of s.getRanges())t.isCollapsed&&t.end.parent.isAttached()&&n.writer.mergeAttributes(t.start);i.setSelection(null)},{priority:"low"}),this.downcastDispatcher.on("selection",(t,e,n)=>{const i=e.selection;if(i.isCollapsed)return;if(!n.consumable.consume(i,"selection"))return;const s=[];for(const t of i.getRanges()){const e=n.mapper.toViewRange(t);s.push(e)}n.writer.setSelection(s,{backward:i.isBackward})},{priority:"low"}),this.downcastDispatcher.on("selection",(t,e,n)=>{const i=e.selection;if(!i.isCollapsed)return;if(!n.consumable.consume(i,"selection"))return;const s=n.writer,o=i.getFirstPosition(),r=n.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a)},{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(t=>{if("$graveyard"==t.rootName)return null;const e=new Yi(this.view.document,t.name);return e.rootName=t.rootName,this.mapper.bindElements(t,e),e})}destroy(){this.view.destroy(),this.stopListening()}}xn($r,qi);class Gr{constructor(){this._commands=new Map}add(t,e){this._commands.set(t,e)}get(t){return this._commands.get(t)}execute(t,...e){const n=this.get(t);if(!n)throw new un.b("commandcollection-command-not-found: Command does not exist.",this,{commandName:t});n.execute(...e)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class Yr{constructor(){this._consumables=new Map}add(t,e){let n;t.is("text")||t.is("documentFragment")?this._consumables.set(t,!0):(this._consumables.has(t)?n=this._consumables.get(t):(n=new Qr(t),this._consumables.set(t,n)),n.add(e))}test(t,e){const n=this._consumables.get(t);return void 0===n?null:t.is("text")||t.is("documentFragment")?n:n.test(e)}consume(t,e){return!!this.test(t,e)&&(t.is("text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0)}revert(t,e){const n=this._consumables.get(t);void 0!==n&&(t.is("text")||t.is("documentFragment")?this._consumables.set(t,!0):n.revert(e))}static consumablesFromElement(t){const e={element:t,name:!0,attributes:[],classes:[],styles:[]},n=t.getAttributeKeys();for(const t of n)"style"!=t&&"class"!=t&&e.attributes.push(t);const i=t.getClassNames();for(const t of i)e.classes.push(t);const s=t.getStyleNames();for(const t of s)e.styles.push(t);return e}static createFrom(t,e){if(e||(e=new Yr(t)),t.is("text"))return e.add(t),e;t.is("element")&&e.add(t,Yr.consumablesFromElement(t)),t.is("documentFragment")&&e.add(t);for(const n of t.getChildren())e=Yr.createFrom(n,e);return e}}class Qr{constructor(t){this.element=t,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(t){t.name&&(this._canConsumeName=!0);for(const e in this._consumables)e in t&&this._add(e,t[e])}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const e in this._consumables)if(e in t){const n=this._test(e,t[e]);if(!0!==n)return n}return!0}consume(t){t.name&&(this._canConsumeName=!1);for(const e in this._consumables)e in t&&this._consume(e,t[e])}revert(t){t.name&&(this._canConsumeName=!0);for(const e in this._consumables)e in t&&this._revert(e,t[e])}_add(t,e){const n=Lt(e)?e:[e],i=this._consumables[t];for(const e of n){if("attributes"===t&&("class"===e||"style"===e))throw new un.b("viewconsumable-invalid-attribute: Classes and styles should be handled separately.",this);if(i.set(e,!0),"styles"===t)for(const t of this.element.document.stylesProcessor.getRelatedStyles(e))i.set(t,!0)}}_test(t,e){const n=Lt(e)?e:[e],i=this._consumables[t];for(const e of n)if("attributes"!==t||"class"!==e&&"style"!==e){const t=i.get(e);if(void 0===t)return null;if(!t)return!1}else{const t="class"==e?"classes":"styles",n=this._test(t,[...this._consumables[t].keys()]);if(!0!==n)return n}return!0}_consume(t,e){const n=Lt(e)?e:[e],i=this._consumables[t];for(const e of n)if("attributes"!==t||"class"!==e&&"style"!==e){if(i.set(e,!1),"styles"==t)for(const t of this.element.document.stylesProcessor.getRelatedStyles(e))i.set(t,!1)}else{const t="class"==e?"classes":"styles";this._consume(t,[...this._consumables[t].keys()])}}_revert(t,e){const n=Lt(e)?e:[e],i=this._consumables[t];for(const e of n)if("attributes"!==t||"class"!==e&&"style"!==e){!1===i.get(e)&&i.set(e,!0)}else{const t="class"==e?"classes":"styles";this._revert(t,[...this._consumables[t].keys()])}}}class Zr{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(t,e)=>{e[0]=new Xr(e[0])},{priority:"highest"}),this.on("checkChild",(t,e)=>{e[0]=new Xr(e[0]),e[1]=this.getDefinition(e[1])},{priority:"highest"})}register(t,e){if(this._sourceDefinitions[t])throw new un.b("schema-cannot-register-item-twice: A single item cannot be registered twice in the schema.",this,{itemName:t});this._sourceDefinitions[t]=[Object.assign({},e)],this._clearCache()}extend(t,e){if(!this._sourceDefinitions[t])throw new un.b("schema-cannot-extend-missing-item: Cannot extend an item which was not registered yet.",this,{itemName:t});this._sourceDefinitions[t].push(Object.assign({},e)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(t){let e;return e="string"==typeof t?t:t.is&&(t.is("text")||t.is("textProxy"))?"$text":t.name,this.getDefinitions()[e]}isRegistered(t){return!!this.getDefinition(t)}isBlock(t){const e=this.getDefinition(t);return!(!e||!e.isBlock)}isLimit(t){const e=this.getDefinition(t);return!!e&&!(!e.isLimit&&!e.isObject)}isObject(t){const e=this.getDefinition(t);return!(!e||!e.isObject)}isInline(t){const e=this.getDefinition(t);return!(!e||!e.isInline)}checkChild(t,e){return!!e&&this._checkContextMatch(e,t)}checkAttribute(t,e){const n=this.getDefinition(t.last);return!!n&&n.allowAttributes.includes(e)}checkMerge(t,e=null){if(t instanceof gr){const e=t.nodeBefore,n=t.nodeAfter;if(!(e instanceof dr))throw new un.b("schema-check-merge-no-element-before: The node before the merge position must be an element.",this);if(!(n instanceof dr))throw new un.b("schema-check-merge-no-element-after: The node after the merge position must be an element.",this);return this.checkMerge(e,n)}for(const n of e.getChildren())if(!this.checkChild(t,n))return!1;return!0}addChildCheck(t){this.on("checkChild",(e,[n,i])=>{if(!i)return;const s=t(n,i);"boolean"==typeof s&&(e.stop(),e.return=s)},{priority:"high"})}addAttributeCheck(t){this.on("checkAttribute",(e,[n,i])=>{const s=t(n,i);"boolean"==typeof s&&(e.stop(),e.return=s)},{priority:"high"})}setAttributeProperties(t,e){this._attributeProperties[t]=Object.assign(this.getAttributeProperties(t),e)}getAttributeProperties(t){return this._attributeProperties[t]||{}}getLimitElement(t){let e;if(t instanceof gr)e=t.parent;else{e=(t instanceof wr?[t]:Array.from(t.getRanges())).reduce((t,e)=>{const n=e.getCommonAncestor();return t?t.getCommonAncestor(n,{includeSelf:!0}):n},null)}for(;!this.isLimit(e)&&e.parent;)e=e.parent;return e}checkAttributeInSelection(t,e){if(t.isCollapsed){const n=[...t.getFirstPosition().getAncestors(),new lr("",t.getAttributes())];return this.checkAttribute(n,e)}{const n=t.getRanges();for(const t of n)for(const n of t)if(this.checkAttribute(n.item,e))return!0}return!1}*getValidRanges(t,e){t=function*(t){for(const e of t)yield*e.getMinimalFlatRanges()}(t);for(const n of t)yield*this._getValidRangesForRange(n,e)}getNearestSelectionRange(t,e="both"){if(this.checkChild(t,"$text"))return new wr(t);let n,i;const s=t.getAncestors().reverse().find(t=>this.isLimit(t))||t.root;"both"!=e&&"backward"!=e||(n=new ur({boundaries:wr._createIn(s),startPosition:t,direction:"backward"})),"both"!=e&&"forward"!=e||(i=new ur({boundaries:wr._createIn(s),startPosition:t}));for(const t of function*(t,e){let n=!1;for(;!n;){if(n=!0,t){const e=t.next();e.done||(n=!1,yield{walker:t,value:e.value})}if(e){const t=e.next();t.done||(n=!1,yield{walker:e,value:t.value})}}}(n,i)){const e=t.walker==n?"elementEnd":"elementStart",i=t.value;if(i.type==e&&this.isObject(i.item))return wr._createOn(i.item);if(this.checkChild(i.nextPosition,"$text"))return new wr(i.nextPosition)}return null}findAllowedParent(t,e){let n=t.parent;for(;n;){if(this.checkChild(n,e))return n;if(this.isLimit(n))return null;n=n.parent}return null}removeDisallowedAttributes(t,e){for(const n of t)if(n.is("text"))ha(this,n,e);else{const t=wr._createIn(n).getPositions();for(const n of t){ha(this,n.nodeBefore||n.parent,e)}}}createContext(t){return new Xr(t)}_clearCache(){this._compiledDefinitions=null}_compile(){const t={},e=this._sourceDefinitions,n=Object.keys(e);for(const i of n)t[i]=ta(e[i],i);for(const e of n)ea(t,e);for(const e of n)na(t,e);for(const e of n)ia(t,e),sa(t,e);for(const e of n)oa(t,e),ra(t,e);this._compiledDefinitions=t}_checkContextMatch(t,e,n=e.length-1){const i=e.getItem(n);if(t.allowIn.includes(i.name)){if(0==n)return!0;{const t=this.getDefinition(i);return this._checkContextMatch(t,e,n-1)}}return!1}*_getValidRangesForRange(t,e){let n=t.start,i=t.start;for(const s of t.getItems({shallow:!0}))s.is("element")&&(yield*this._getValidRangesForRange(wr._createIn(s),e)),this.checkAttribute(s,e)||(n.isEqual(i)||(yield new wr(n,i)),n=gr._createAfter(s)),i=gr._createAfter(s);n.isEqual(i)||(yield new wr(n,i))}}xn(Zr,qi);class Xr{constructor(t){if(t instanceof Xr)return t;"string"==typeof t?t=[t]:Array.isArray(t)||(t=t.getAncestors({includeSelf:!0})),t[0]&&"string"!=typeof t[0]&&t[0].is("documentFragment")&&t.shift(),this._items=t.map(ca)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const e=new Xr([t]);return e._items=[...this._items,...e._items],e}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function ta(t,e){const n={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],inheritTypesFrom:[]};return function(t,e){for(const n of t){const t=Object.keys(n).filter(t=>t.startsWith("is"));for(const i of t)e[i]=n[i]}}(t,n),aa(t,n,"allowIn"),aa(t,n,"allowContentOf"),aa(t,n,"allowWhere"),aa(t,n,"allowAttributes"),aa(t,n,"allowAttributesOf"),aa(t,n,"inheritTypesFrom"),function(t,e){for(const n of t){const t=n.inheritAllFrom;t&&(e.allowContentOf.push(t),e.allowWhere.push(t),e.allowAttributesOf.push(t),e.inheritTypesFrom.push(t))}}(t,n),n}function ea(t,e){for(const n of t[e].allowContentOf)if(t[n]){la(t,n).forEach(t=>{t.allowIn.push(e)})}delete t[e].allowContentOf}function na(t,e){for(const n of t[e].allowWhere){const i=t[n];if(i){const n=i.allowIn;t[e].allowIn.push(...n)}}delete t[e].allowWhere}function ia(t,e){for(const n of t[e].allowAttributesOf){const i=t[n];if(i){const n=i.allowAttributes;t[e].allowAttributes.push(...n)}}delete t[e].allowAttributesOf}function sa(t,e){const n=t[e];for(const e of n.inheritTypesFrom){const i=t[e];if(i){const t=Object.keys(i).filter(t=>t.startsWith("is"));for(const e of t)e in n||(n[e]=i[e])}}delete n.inheritTypesFrom}function oa(t,e){const n=t[e],i=n.allowIn.filter(e=>t[e]);n.allowIn=Array.from(new Set(i))}function ra(t,e){const n=t[e];n.allowAttributes=Array.from(new Set(n.allowAttributes))}function aa(t,e,n){for(const i of t)"string"==typeof i[n]?e[n].push(i[n]):Array.isArray(i[n])&&e[n].push(...i[n])}function la(t,e){const n=t[e];return(i=t,Object.keys(i).map(t=>i[t])).filter(t=>t.allowIn.includes(n.name));var i}function ca(t){return"string"==typeof t?{name:t,*getAttributeKeys(){},getAttribute(){}}:{name:t.is("element")?t.name:"$text",*getAttributeKeys(){yield*t.getAttributeKeys()},getAttribute:e=>t.getAttribute(e)}}function ha(t,e,n){for(const i of e.getAttributeKeys())t.checkAttribute(e,i)||n.removeAttribute(i,e)}class da{constructor(t={}){this._splitParts=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},t),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(t,e,n=["$root"]){this.fire("viewCleanup",t),this._modelCursor=function(t,e){let n;for(const i of new Xr(t)){const t={};for(const e of i.getAttributeKeys())t[e]=i.getAttribute(e);const s=e.createElement(i.name,t);n&&e.append(s,n),n=gr._createAt(s,0)}return n}(n,e),this.conversionApi.writer=e,this.conversionApi.consumable=Yr.createFrom(t),this.conversionApi.store={};const{modelRange:i}=this._convertItem(t,this._modelCursor),s=e.createDocumentFragment();if(i){this._removeEmptyElements();for(const t of Array.from(this._modelCursor.parent.getChildren()))e.append(t,s);s.markers=function(t,e){const n=new Set,i=new Map,s=wr._createIn(t).getItems();for(const t of s)"$marker"==t.name&&n.add(t);for(const t of n){const n=t.getAttribute("data-name"),s=e.createPositionBefore(t);i.has(n)?i.get(n).end=s.clone():i.set(n,new wr(s.clone())),e.remove(t)}return i}(s,e)}return this._modelCursor=null,this._splitParts.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,s}_convertItem(t,e){const n=Object.assign({viewItem:t,modelCursor:e,modelRange:null});if(t.is("element")?this.fire("element:"+t.name,n,this.conversionApi):t.is("text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof wr))throw new un.b("view-conversion-dispatcher-incorrect-result: Incorrect conversion result was dropped.",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(t,e){const n=new wr(e);let i=e;for(const e of Array.from(t.getChildren())){const t=this._convertItem(e,i);t.modelRange instanceof wr&&(n.end=t.modelRange.end,i=t.modelCursor)}return{modelRange:n,modelCursor:i}}_splitToAllowedParent(t,e){const n=this.conversionApi.schema.findAllowedParent(e,t);if(!n)return null;if(n===e.parent)return{position:e};if(this._modelCursor.parent.getAncestors().includes(n))return null;const i=this.conversionApi.writer.split(e,n),s=[];for(const t of i.range.getWalker())if("elementEnd"==t.type)s.push(t.item);else{const e=s.pop(),n=t.item;this._registerSplitPair(e,n)}return{position:i.position,cursorParent:i.range.end.parent}}_registerSplitPair(t,e){this._splitParts.has(t)||this._splitParts.set(t,[t]);const n=this._splitParts.get(t);this._splitParts.set(e,n),n.push(e)}_getSplitParts(t){let e;return e=this._splitParts.has(t)?this._splitParts.get(t):[t],e}_removeEmptyElements(){let t=!1;for(const e of this._splitParts.keys())e.isEmpty&&(this.conversionApi.writer.remove(e),this._splitParts.delete(e),t=!0);t&&this._removeEmptyElements()}}xn(da,pn);class ua{constructor(t,e){this.model=t,this.stylesProcessor=e,this.processor,this.mapper=new _r,this.downcastDispatcher=new yr({mapper:this.mapper}),this.downcastDispatcher.on("insert:$text",(t,e,n)=>{if(!n.consumable.consume(e.item,"insert"))return;const i=n.writer,s=n.mapper.toViewPosition(e.range.start),o=i.createText(e.item.data);i.insert(s,o)},{priority:"lowest"}),this.upcastDispatcher=new da({schema:t.schema}),this.viewDocument=new ss(e),this._viewWriter=new _s(this.viewDocument),this.upcastDispatcher.on("text",(t,e,n)=>{if(n.schema.checkChild(e.modelCursor,"$text")&&n.consumable.consume(e.viewItem)){const t=n.writer.createText(e.viewItem.data);n.writer.insert(t,e.modelCursor),e.modelRange=wr._createFromPositionAndShift(e.modelCursor,t.offsetSize),e.modelCursor=e.modelRange.end}},{priority:"lowest"}),this.upcastDispatcher.on("element",(t,e,n)=>{if(!e.modelRange&&n.consumable.consume(e.viewItem,{name:!0})){const{modelRange:t,modelCursor:i}=n.convertChildren(e.viewItem,e.modelCursor);e.modelRange=t,e.modelCursor=i}},{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",(t,e,n)=>{if(!e.modelRange&&n.consumable.consume(e.viewItem,{name:!0})){const{modelRange:t,modelCursor:i}=n.convertChildren(e.viewItem,e.modelCursor);e.modelRange=t,e.modelCursor=i}},{priority:"lowest"}),this.decorate("init"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"})}get(t){const{rootName:e="main",trim:n="empty"}=t||{};if(!this._checkIfRootsExists([e]))throw new un.b("datacontroller-get-non-existent-root: Attempting to get data from a non-existing root.",this);const i=this.model.document.getRoot(e);return"empty"!==n||this.model.hasContent(i,{ignoreWhitespaces:!0})?this.stringify(i):""}stringify(t){const e=this.toView(t);return this.processor.toData(e)}toView(t){const e=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();const i=wr._createIn(t),s=new ws(e);if(this.mapper.bindElements(t,s),this.downcastDispatcher.convertInsert(i,n),!t.is("documentFragment")){const e=function(t){const e=[],n=t.root.document;if(!n)return[];const i=wr._createIn(t);for(const t of n.model.markers){const n=i.getIntersection(t.getRange());n&&e.push([t.name,n])}return e}(t);for(const[t,i]of e)this.downcastDispatcher.convertMarkerAdd(t,i,n)}return s}init(t){if(this.model.document.version)throw new un.b("datacontroller-init-document-not-empty: Trying to set initial data to not empty document.",this);let e={};if("string"==typeof t?e.main=t:e=t,!this._checkIfRootsExists(Object.keys(e)))throw new un.b("datacontroller-init-non-existent-root: Attempting to init data on a non-existing root.",this);return this.model.enqueueChange("transparent",t=>{for(const n of Object.keys(e)){const i=this.model.document.getRoot(n);t.insert(this.parse(e[n],i),i,0)}}),Promise.resolve()}set(t){let e={};if("string"==typeof t?e.main=t:e=t,!this._checkIfRootsExists(Object.keys(e)))throw new un.b("datacontroller-set-non-existent-root: Attempting to set data on a non-existing root.",this);this.model.enqueueChange("transparent",t=>{t.setSelection(null),t.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const n of Object.keys(e)){const i=this.model.document.getRoot(n);t.remove(t.createRangeIn(i)),t.insert(this.parse(e[n],i),i,0)}})}parse(t,e="$root"){const n=this.processor.toView(t);return this.toModel(n,e)}toModel(t,e="$root"){return this.model.change(n=>this.upcastDispatcher.convert(t,n,e))}addStyleProcessorRules(t){t(this.stylesProcessor)}destroy(){this.stopListening()}_checkIfRootsExists(t){for(const e of t)if(!this.model.document.getRootNames().includes(e))return!1;return!0}}xn(ua,qi);class fa{constructor(t,e){this._helpers=new Map,this._downcast=Array.isArray(t)?t:[t],this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Array.isArray(e)?e:[e],this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,e){const n=this._downcast.includes(e);if(!this._upcast.includes(e)&&!n)throw new un.b("conversion-add-alias-dispatcher-not-registered: Trying to register and alias for a dispatcher that nas not been registered.",this);this._createConversionHelpers({name:t,dispatchers:[e],isDowncast:n})}for(t){if(!this._helpers.has(t))throw new un.b("conversion-for-unknown-group: Trying to add a converter to an unknown dispatchers group.",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:e,view:n}of ga(t))this.for("upcast").elementToElement({model:e,view:n,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:e,view:n}of ga(t))this.for("upcast").elementToAttribute({view:n,model:e,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:e,view:n}of ga(t))this.for("upcast").attributeToAttribute({view:n,model:e})}_createConversionHelpers({name:t,dispatchers:e,isDowncast:n}){if(this._helpers.has(t))throw new un.b("conversion-group-exists: Trying to register a group name that has already been registered.",this);const i=n?new Vr(e):new Ur(e);this._helpers.set(t,i)}}function*ga(t){if(t.model.values)for(const e of t.model.values){const n={key:t.model.key,value:e},i=t.view[e],s=t.upcastAlso?t.upcastAlso[e]:void 0;yield*pa(n,i,s)}else yield*pa(t.model,t.view,t.upcastAlso)}function*pa(t,e,n){if(yield{model:t,view:e},n){n=Array.isArray(n)?n:[n];for(const e of n)yield{model:t,view:e}}}class ma{constructor(t="default"){this.operations=[],this.type=t}get baseVersion(){for(const t of this.operations)if(null!==t.baseVersion)return t.baseVersion;return null}addOperation(t){return t.batch=this,this.operations.push(t),t}}class ba{constructor(t){this.baseVersion=t,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t){return new this(t.baseVersion)}}class wa{constructor(t){this.markers=new Map,this._children=new hr,t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"model:documentFragment"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const e of this._children)t.push(e.toJSON());return t}static fromJSON(t){const e=[];for(const n of t)n.name?e.push(dr.fromJSON(n)):e.push(lr.fromJSON(n));return new wa(e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new lr(t)];yn(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new lr(t):t instanceof cr?new lr(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}}function _a(t,e){const n=(e=ya(e)).reduce((t,e)=>t+e.offsetSize,0),i=t.parent;Ca(t);const s=t.index;return i._insertChild(s,e),xa(i,s+e.length),xa(i,s),new wr(t,t.getShiftedBy(n))}function ka(t){if(!t.isFlat)throw new un.b("operation-utils-remove-range-not-flat: Trying to remove a range which starts and ends in different element.",this);const e=t.start.parent;Ca(t.start),Ca(t.end);const n=e._removeChildren(t.start.index,t.end.index-t.start.index);return xa(e,t.start.index),n}function va(t,e){if(!t.isFlat)throw new un.b("operation-utils-move-range-not-flat: Trying to move a range which starts and ends in different element.",this);const n=ka(t);return _a(e=e._getTransformedByDeletion(t.start,t.end.offset-t.start.offset),n)}function ya(t){const e=[];t instanceof Array||(t=[t]);for(let n=0;n<t.length;n++)if("string"==typeof t[n])e.push(new lr(t[n]));else if(t[n]instanceof cr)e.push(new lr(t[n].data,t[n].getAttributes()));else if(t[n]instanceof wa||t[n]instanceof hr)for(const i of t[n])e.push(i);else t[n]instanceof ar&&e.push(t[n]);for(let t=1;t<e.length;t++){const n=e[t],i=e[t-1];n instanceof lr&&i instanceof lr&&Ea(n,i)&&(e.splice(t-1,2,new lr(i.data+n.data,i.getAttributes())),t--)}return e}function xa(t,e){const n=t.getChild(e-1),i=t.getChild(e);if(n&&i&&n.is("text")&&i.is("text")&&Ea(n,i)){const s=new lr(n.data+i.data,n.getAttributes());t._removeChildren(e-1,2),t._insertChild(e-1,s)}}function Ca(t){const e=t.textNode,n=t.parent;if(e){const i=t.offset-e.startOffset,s=e.index;n._removeChildren(s,1);const o=new lr(e.data.substr(0,i),e.getAttributes()),r=new lr(e.data.substr(i),e.getAttributes());n._insertChild(s,[o,r])}}function Ea(t,e){const n=t.getAttributes(),i=e.getAttributes();for(const t of n){if(t[1]!==e.getAttribute(t[0]))return!1;i.next()}return i.next().done}var Ta=function(t,e){return Co(t,e)};class Aa extends ba{constructor(t,e,n,i,s){super(s),this.range=t.clone(),this.key=e,this.oldValue=void 0===n?null:n,this.newValue=void 0===i?null:i}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new Aa(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Aa(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new un.b("attribute-operation-range-not-flat: The range to change is not flat.",this);for(const t of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!Ta(t.getAttribute(this.key),this.oldValue))throw new un.b("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{item:t,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&t.hasAttribute(this.key))throw new un.b("attribute-operation-attribute-exists: The attribute with given key already exists.",this,{node:t,key:this.key})}}_execute(){Ta(this.oldValue,this.newValue)||function(t,e,n){Ca(t.start),Ca(t.end);for(const i of t.getItems({shallow:!0})){const t=i.is("textProxy")?i.textNode:i;null!==n?t._setAttribute(e,n):t._removeAttribute(e),xa(t.parent,t.index)}xa(t.end.parent,t.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,e){return new Aa(wr.fromJSON(t.range,e),t.key,t.oldValue,t.newValue,t.baseVersion)}}class Pa extends ba{constructor(t,e){super(null),this.sourcePosition=t.clone(),this.howMany=e}get type(){return"detach"}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t}_validate(){if(this.sourcePosition.root.document)throw new un.b("detach-operation-on-document-node: Cannot detach document node.",this)}_execute(){ka(wr._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Sa extends ba{constructor(t,e,n,i){super(i),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=e,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent,n=this.sourcePosition.offset,i=this.targetPosition.offset;if(n+this.howMany>t.maxOffset)throw new un.b("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.",this);if(t===e&&n<i&&i<n+this.howMany)throw new un.b("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==Mn(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const t=this.sourcePosition.path.length-1;if(this.targetPosition.path[t]>=n&&this.targetPosition.path[t]<n+this.howMany)throw new un.b("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.",this)}}_execute(){va(wr._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,e){const n=gr.fromJSON(t.sourcePosition,e),i=gr.fromJSON(t.targetPosition,e);return new this(n,t.howMany,i,t.baseVersion)}}class Oa extends ba{constructor(t,e,n){super(n),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new hr(ya(e)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const t=new hr([...this.nodes].map(t=>t._clone(!0))),e=new Oa(this.position,t,this.baseVersion);return e.shouldReceiveAttributes=this.shouldReceiveAttributes,e}getReversed(){const t=this.position.root.document.graveyard,e=new gr(t,[0]);return new Sa(this.position,this.nodes.maxOffset,e,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new un.b("insert-operation-position-invalid: Insertion position is invalid.",this)}_execute(){const t=this.nodes;this.nodes=new hr([...t].map(t=>t._clone(!0))),_a(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,e){const n=[];for(const e of t.nodes)e.name?n.push(dr.fromJSON(e)):n.push(lr.fromJSON(e));const i=new Oa(gr.fromJSON(t.position,e),n,t.baseVersion);return i.shouldReceiveAttributes=t.shouldReceiveAttributes,i}}class Ma extends ba{constructor(t,e,n,i,s,o){super(o),this.name=t,this.oldRange=e?e.clone():null,this.newRange=n?n.clone():null,this.affectsData=s,this._markers=i}get type(){return"marker"}clone(){return new Ma(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Ma(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const t=this.newRange?"_set":"_remove";this._markers[t](this.name,this.newRange,!0,this.affectsData)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,e){return new Ma(t.name,t.oldRange?wr.fromJSON(t.oldRange,e):null,t.newRange?wr.fromJSON(t.newRange,e):null,e.model.markers,t.affectsData,t.baseVersion)}}class Na extends ba{constructor(t,e,n,i){super(i),this.position=t,this.position.stickiness="toNext",this.oldName=e,this.newName=n}get type(){return"rename"}clone(){return new Na(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Na(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(!(t instanceof dr))throw new un.b("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.",this);if(t.name!==this.oldName)throw new un.b("rename-operation-wrong-name: Element to change has different name than operation's old name.",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,e){return new Na(gr.fromJSON(t.position,e),t.oldName,t.newName,t.baseVersion)}}class Ia extends ba{constructor(t,e,n,i,s){super(s),this.root=t,this.key=e,this.oldValue=n,this.newValue=i}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new Ia(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ia(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new un.b("rootattribute-operation-not-a-root: The element to change is not a root element.",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new un.b("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new un.b("rootattribute-operation-attribute-exists: The attribute with given key already exists.",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,e){if(!e.getRoot(t.root))throw new un.b("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",this,{rootName:t.root});return new Ia(e.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}}class Ra extends ba{constructor(t,e,n,i,s){super(s),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=e,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=i.clone()}get type(){return"merge"}get deletionPosition(){return new gr(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new wr(this.sourcePosition,t)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),e=this.sourcePosition.path.slice(0,-1),n=new gr(this.sourcePosition.root,e)._getTransformedByMergeOperation(this),i=new La(t,this.howMany,this.graveyardPosition,this.baseVersion+1);return i.insertionPosition=n,i}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent;if(!t.parent)throw new un.b("merge-operation-source-position-invalid: Merge source position is invalid.",this);if(!e.parent)throw new un.b("merge-operation-target-position-invalid: Merge target position is invalid.",this);if(this.howMany!=t.maxOffset)throw new un.b("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.",this)}_execute(){const t=this.sourcePosition.parent;va(wr._createIn(t),this.targetPosition),va(wr._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,e){const n=gr.fromJSON(t.sourcePosition,e),i=gr.fromJSON(t.targetPosition,e),s=gr.fromJSON(t.graveyardPosition,e);return new this(n,t.howMany,i,s,t.baseVersion)}}class La extends ba{constructor(t,e,n,i){super(i),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=e,this.insertionPosition=La.getInsertionPosition(t),this.insertionPosition.stickiness="toNone",this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new gr(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new wr(this.splitPosition,t)}clone(){const t=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return t.insertionPosition=this.insertionPosition,t}getReversed(){const t=this.splitPosition.root.document.graveyard,e=new gr(t,[0]);return new Ra(this.moveTargetPosition,this.howMany,this.splitPosition,e,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent,e=this.splitPosition.offset;if(!t||t.maxOffset<e)throw new un.b("split-operation-position-invalid: Split position is invalid.",this);if(!t.parent)throw new un.b("split-operation-split-in-root: Cannot split root element.",this);if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new un.b("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new un.b("split-operation-graveyard-position-invalid: Graveyard position invalid.",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)va(wr._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const e=t._clone();_a(this.insertionPosition,e)}va(new wr(gr._createAt(t,this.splitPosition.offset),gr._createAt(t,t.maxOffset)),this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const e=t.path.slice(0,-1);return e[e.length-1]++,new gr(t.root,e)}static fromJSON(t,e){const n=gr.fromJSON(t.splitPosition,e),i=gr.fromJSON(t.insertionPosition,e),s=t.graveyardPosition?gr.fromJSON(t.graveyardPosition,e):null,o=new this(n,t.howMany,s,t.baseVersion);return o.insertionPosition=i,o}}class Da extends dr{constructor(t,e,n="main"){super(e),this._document=t,this.rootName=n}get document(){return this._document}is(t,e){return e?e===this.name&&("rootElement"===t||"model:rootElement"===t||"element"===t||"model:element"===t):"rootElement"===t||"model:rootElement"===t||"element"===t||"model:element"===t||t===this.name||t==="model:"+this.name||"node"===t||"model:node"===t}toJSON(){return this.rootName}}class Va{constructor(t,e){this.model=t,this.batch=e}createText(t,e){return new lr(t,e)}createElement(t,e){return new dr(t,e)}createDocumentFragment(){return new wa}insert(t,e,n=0){if(this._assertWriterUsedCorrectly(),t instanceof lr&&""==t.data)return;const i=gr._createAt(e,n);if(t.parent){if(qa(t.root,i.root))return void this.move(wr._createOn(t),i);if(t.root.document)throw new un.b("model-writer-insert-forbidden-move: Cannot move a node from a document to a different tree. It is forbidden to move a node that was already in a document outside of it.",this);this.remove(t)}const s=i.root.document?i.root.document.version:null,o=new Oa(i,t,s);if(t instanceof lr&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),t instanceof wa)for(const[e,n]of t.markers){const t=gr._createAt(n.root,0),s={range:new wr(n.start._getCombined(t,i),n.end._getCombined(t,i)),usingOperation:!0,affectsData:!0};this.model.markers.has(e)?this.updateMarker(e,s):this.addMarker(e,s)}}insertText(t,e,n,i){e instanceof wa||e instanceof dr||e instanceof gr?this.insert(this.createText(t),e,n):this.insert(this.createText(t,e),n,i)}insertElement(t,e,n,i){e instanceof wa||e instanceof dr||e instanceof gr?this.insert(this.createElement(t),e,n):this.insert(this.createElement(t,e),n,i)}append(t,e){this.insert(t,e,"end")}appendText(t,e,n){e instanceof wa||e instanceof dr?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),n,"end")}appendElement(t,e,n){e instanceof wa||e instanceof dr?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),n,"end")}setAttribute(t,e,n){if(this._assertWriterUsedCorrectly(),n instanceof wr){const i=n.getMinimalFlatRanges();for(const n of i)Ba(this,t,e,n)}else Fa(this,t,e,n)}setAttributes(t,e){for(const[n,i]of Dn(t))this.setAttribute(n,i,e)}removeAttribute(t,e){if(this._assertWriterUsedCorrectly(),e instanceof wr){const n=e.getMinimalFlatRanges();for(const e of n)Ba(this,t,null,e)}else Fa(this,t,null,e)}clearAttributes(t){this._assertWriterUsedCorrectly();const e=t=>{for(const e of t.getAttributeKeys())this.removeAttribute(e,t)};if(t instanceof wr)for(const n of t.getItems())e(n);else e(t)}move(t,e,n){if(this._assertWriterUsedCorrectly(),!(t instanceof wr))throw new un.b("writer-move-invalid-range: Invalid range to move.",this);if(!t.isFlat)throw new un.b("writer-move-range-not-flat: Range to move is not flat.",this);const i=gr._createAt(e,n);if(i.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!qa(t.root,i.root))throw new un.b("writer-move-different-document: Range is going to be moved between different documents.",this);const s=t.root.document?t.root.document.version:null,o=new Sa(t.start,t.end.offset-t.start.offset,i,s);this.batch.addOperation(o),this.model.applyOperation(o)}remove(t){this._assertWriterUsedCorrectly();const e=(t instanceof wr?t:wr._createOn(t)).getMinimalFlatRanges().reverse();for(const t of e)this._addOperationForAffectedMarkers("move",t),za(t.start,t.end.offset-t.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const e=t.nodeBefore,n=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(e instanceof dr))throw new un.b("writer-merge-no-element-before: Node before merge position must be an element.",this);if(!(n instanceof dr))throw new un.b("writer-merge-no-element-after: Node after merge position must be an element.",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,e,n){return this.model.createPositionFromPath(t,e,n)}createPositionAt(t,e){return this.model.createPositionAt(t,e)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,e){return this.model.createRange(t,e)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(t,e,n){return this.model.createSelection(t,e,n)}_mergeDetached(t){const e=t.nodeBefore,n=t.nodeAfter;this.move(wr._createIn(n),gr._createAt(e,"end")),this.remove(n)}_merge(t){const e=gr._createAt(t.nodeBefore,"end"),n=gr._createAt(t.nodeAfter,0),i=t.root.document.graveyard,s=new gr(i,[0]),o=t.root.document.version,r=new Ra(n,t.nodeAfter.maxOffset,e,s,o);this.batch.addOperation(r),this.model.applyOperation(r)}rename(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof dr))throw new un.b("writer-rename-not-element-instance: Trying to rename an object which is not an instance of Element.",this);const n=t.root.document?t.root.document.version:null,i=new Na(gr._createBefore(t),t.name,e,n);this.batch.addOperation(i),this.model.applyOperation(i)}split(t,e){this._assertWriterUsedCorrectly();let n,i,s=t.parent;if(!s.parent)throw new un.b("writer-split-element-no-parent: Element with no parent can not be split.",this);if(e||(e=s.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new un.b("writer-split-invalid-limit-element: Limit element is not a position ancestor.",this);do{const e=s.root.document?s.root.document.version:null,o=s.maxOffset-t.offset,r=new La(t,o,null,e);this.batch.addOperation(r),this.model.applyOperation(r),n||i||(n=s,i=t.parent.nextSibling),s=(t=this.createPositionAfter(t.parent)).parent}while(s!==e);return{position:t,range:new wr(gr._createAt(n,"end"),gr._createAt(i,0))}}wrap(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new un.b("writer-wrap-range-not-flat: Range to wrap is not flat.",this);const n=e instanceof dr?e:new dr(e);if(n.childCount>0)throw new un.b("writer-wrap-element-not-empty: Element to wrap with is not empty.",this);if(null!==n.parent)throw new un.b("writer-wrap-element-attached: Element to wrap with is already attached to tree model.",this);this.insert(n,t.start);const i=new wr(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(i,gr._createAt(n,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),null===t.parent)throw new un.b("writer-unwrap-element-no-parent: Trying to unwrap an element which has no parent.",this);this.move(wr._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,e){if(this._assertWriterUsedCorrectly(),!e||"boolean"!=typeof e.usingOperation)throw new un.b("writer-addMarker-no-usingOperation: The options.usingOperation parameter is required when adding a new marker.",this);const n=e.usingOperation,i=e.range,s=void 0!==e.affectsData&&e.affectsData;if(this.model.markers.has(t))throw new un.b("writer-addMarker-marker-exists: Marker with provided name already exists.",this);if(!i)throw new un.b("writer-addMarker-no-range: Range parameter is required when adding a new marker.",this);return n?(ja(this,t,null,i,s),this.model.markers.get(t)):this.model.markers._set(t,i,n,s)}updateMarker(t,e){this._assertWriterUsedCorrectly();const n="string"==typeof t?t:t.name,i=this.model.markers.get(n);if(!i)throw new un.b("writer-updateMarker-marker-not-exists: Marker with provided name does not exists.",this);if(!e)return void this.model.markers._refresh(i);const s="boolean"==typeof e.usingOperation,o="boolean"==typeof e.affectsData,r=o?e.affectsData:i.affectsData;if(!s&&!e.range&&!o)throw new un.b("writer-updateMarker-wrong-options: One of the options is required - provide range, usingOperations or affectsData.",this);const a=i.getRange(),l=e.range?e.range:a;s&&e.usingOperation!==i.managedUsingOperations?e.usingOperation?ja(this,n,null,l,r):(ja(this,n,a,null,r),this.model.markers._set(n,l,void 0,r)):i.managedUsingOperations?ja(this,n,a,l,r):this.model.markers._set(n,l,void 0,r)}removeMarker(t){this._assertWriterUsedCorrectly();const e="string"==typeof t?t:t.name;if(!this.model.markers.has(e))throw new un.b("writer-removeMarker-no-marker: Trying to remove marker which does not exist.",this);const n=this.model.markers.get(e);if(!n.managedUsingOperations)return void this.model.markers._remove(e);ja(this,e,n.getRange(),null,n.affectsData)}setSelection(t,e,n){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(t,e,n)}setSelectionFocus(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}setSelectionAttribute(t,e){if(this._assertWriterUsedCorrectly(),"string"==typeof t)this._setSelectionAttribute(t,e);else for(const[e,n]of Dn(t))this._setSelectionAttribute(e,n)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),"string"==typeof t)this._removeSelectionAttribute(t);else for(const e of t)this._removeSelectionAttribute(e)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,e){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const i=Nr._getStoreAttributeKey(t);this.setAttribute(i,e,n.anchor.parent)}n._setAttribute(t,e)}_removeSelectionAttribute(t){const e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){const n=Nr._getStoreAttributeKey(t);this.removeAttribute(n,e.anchor.parent)}e._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new un.b("writer-incorrect-use: Trying to use a writer outside the change() block.",this)}_addOperationForAffectedMarkers(t,e){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const i=n.getRange();let s=!1;if("move"===t)s=e.containsPosition(i.start)||e.start.isEqual(i.start)||e.containsPosition(i.end)||e.end.isEqual(i.end);else{const t=e.nodeBefore,n=e.nodeAfter,o=i.start.parent==t&&i.start.isAtEnd,r=i.end.parent==n&&0==i.end.offset,a=i.end.nodeAfter==n,l=i.start.nodeAfter==n;s=o||r||a||l}s&&this.updateMarker(n.name,{range:i})}}}function Ba(t,e,n,i){const s=t.model,o=s.document;let r,a,l,c=i.start;for(const t of i.getWalker({shallow:!0}))l=t.item.getAttribute(e),r&&a!=l&&(a!=n&&h(),c=r),r=t.nextPosition,a=l;function h(){const i=new wr(c,r),l=i.root.document?o.version:null,h=new Aa(i,e,a,n,l);t.batch.addOperation(h),s.applyOperation(h)}r instanceof gr&&r!=c&&a!=n&&h()}function Fa(t,e,n,i){const s=t.model,o=s.document,r=i.getAttribute(e);let a,l;if(r!=n){if(i.root===i){const t=i.document?o.version:null;l=new Ia(i,e,r,n,t)}else{a=new wr(gr._createBefore(i),t.createPositionAfter(i));const s=a.root.document?o.version:null;l=new Aa(a,e,r,n,s)}t.batch.addOperation(l),s.applyOperation(l)}}function ja(t,e,n,i,s){const o=t.model,r=o.document,a=new Ma(e,n,i,o.markers,s,r.version);t.batch.addOperation(a),o.applyOperation(a)}function za(t,e,n,i){let s;if(t.root.document){const n=i.document,o=new gr(n.graveyard,[0]);s=new Sa(t,e,o,n.version)}else s=new Pa(t,e);n.addOperation(s),i.applyOperation(s)}function qa(t,e){return t===e||t instanceof Da&&e instanceof Da}class Ua{constructor(t){this._markerCollection=t,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize);const e=wr._createOn(t);for(const t of this._markerCollection.getMarkersIntersectingRange(e)){const e=t.getRange();this.bufferMarkerChange(t.name,e,e,t.affectsData)}this._cachedChanges=null}bufferOperation(t){switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const e of t.range.getItems({shallow:!0}))this._isInInsertedElement(e.parent)||this._markAttribute(e);break;case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const e=this._isInInsertedElement(t.sourcePosition.parent),n=this._isInInsertedElement(t.targetPosition.parent);e||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),n||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const e=wr._createFromPositionAndShift(t.position,1);for(const t of this._markerCollection.getMarkersIntersectingRange(e)){const e=t.getRange();this.bufferMarkerChange(t.name,e,e,t.affectsData)}break}case"split":{const e=t.splitPosition.parent;this._isInInsertedElement(e)||this._markRemove(e,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break}case"merge":{const e=t.sourcePosition.parent;this._isInInsertedElement(e.parent)||this._markRemove(e.parent,e.startOffset,1);const n=t.graveyardPosition.parent;this._markInsert(n,t.graveyardPosition.offset,1);const i=t.targetPosition.parent;this._isInInsertedElement(i)||this._markInsert(i,t.targetPosition.offset,e.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(t,e,n,i){const s=this._changedMarkers.get(t);s?(s.newRange=n,s.affectsData=i,null==s.oldRange&&null==s.newRange&&this._changedMarkers.delete(t)):this._changedMarkers.set(t,{oldRange:e,newRange:n,affectsData:i})}getMarkersToRemove(){const t=[];for(const[e,n]of this._changedMarkers)null!=n.oldRange&&t.push({name:e,range:n.oldRange});return t}getMarkersToAdd(){const t=[];for(const[e,n]of this._changedMarkers)null!=n.newRange&&t.push({name:e,range:n.newRange});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(t=>({name:t[0],data:{oldRange:t[1].oldRange,newRange:t[1].newRange}}))}hasDataChanges(){for(const[,t]of this._changedMarkers)if(t.affectsData)return!0;return this._changesInElement.size>0}getChanges(t={includeChangesInGraveyard:!1}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();const e=[];for(const t of this._changesInElement.keys()){const n=this._changesInElement.get(t).sort((t,e)=>t.offset===e.offset?t.type!=e.type?"remove"==t.type?-1:1:0:t.offset<e.offset?-1:1),i=this._elementSnapshots.get(t),s=Wa(t.getChildren()),o=Ha(i.length,n);let r=0,a=0;for(const n of o)if("i"===n)e.push(this._getInsertDiff(t,r,s[r].name)),r++;else if("r"===n)e.push(this._getRemoveDiff(t,r,i[a].name)),a++;else if("a"===n){const n=s[r].attributes,o=i[a].attributes;let l;if("$text"==s[r].name)l=new wr(gr._createAt(t,r),gr._createAt(t,r+1));else{const e=t.offsetToIndex(r);l=new wr(gr._createAt(t,r),gr._createAt(t.getChild(e),0))}e.push(...this._getAttributesDiff(l,o,n)),r++,a++}else r++,a++}e.sort((t,e)=>t.position.root!=e.position.root?t.position.root.rootName<e.position.root.rootName?-1:1:t.position.isEqual(e.position)?t.changeCount-e.changeCount:t.position.isBefore(e.position)?-1:1);for(let t=1;t<e.length;t++){const n=e[t-1],i=e[t],s="remove"==n.type&&"remove"==i.type&&"$text"==n.name&&"$text"==i.name&&n.position.isEqual(i.position),o="insert"==n.type&&"insert"==i.type&&"$text"==n.name&&"$text"==i.name&&n.position.parent==i.position.parent&&n.position.offset+n.length==i.position.offset,r="attribute"==n.type&&"attribute"==i.type&&n.position.parent==i.position.parent&&n.range.isFlat&&i.range.isFlat&&n.position.offset+n.length==i.position.offset&&n.attributeKey==i.attributeKey&&n.attributeOldValue==i.attributeOldValue&&n.attributeNewValue==i.attributeNewValue;(s||o||r)&&(e[t-1].length++,r&&(e[t-1].range.end=e[t-1].range.end.getShiftedBy(1)),e.splice(t,1),t--)}for(const t of e)delete t.changeCount,"attribute"==t.type&&(delete t.position,delete t.length);return this._changeCount=0,this._cachedChangesWithGraveyard=e.slice(),this._cachedChanges=e.slice().filter(Ka),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(t,e,n){const i={type:"insert",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,i)}_markRemove(t,e,n){const i={type:"remove",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,i),this._removeAllNestedChanges(t,e,n)}_markAttribute(t){const e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}_markChange(t,e){this._makeSnapshot(t);const n=this._getChangesForElement(t);this._handleChange(e,n),n.push(e);for(let t=0;t<n.length;t++)n[t].howMany<1&&(n.splice(t,1),t--)}_getChangesForElement(t){let e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}_makeSnapshot(t){this._elementSnapshots.has(t)||this._elementSnapshots.set(t,Wa(t.getChildren()))}_handleChange(t,e){t.nodesToHandle=t.howMany;for(const n of e){const i=t.offset+t.howMany,s=n.offset+n.howMany;if("insert"==t.type&&("insert"==n.type&&(t.offset<=n.offset?n.offset+=t.howMany:t.offset<s&&(n.howMany+=t.nodesToHandle,t.nodesToHandle=0)),"remove"==n.type&&t.offset<n.offset&&(n.offset+=t.howMany),"attribute"==n.type))if(t.offset<=n.offset)n.offset+=t.howMany;else if(t.offset<s){const s=n.howMany;n.howMany=t.offset-n.offset,e.unshift({type:"attribute",offset:i,howMany:s-n.howMany,count:this._changeCount++})}if("remove"==t.type){if("insert"==n.type)if(i<=n.offset)n.offset-=t.howMany;else if(i<=s)if(t.offset<n.offset){const e=i-n.offset;n.offset=t.offset,n.howMany-=e,t.nodesToHandle-=e}else n.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=n.offset)t.nodesToHandle-=n.howMany,n.howMany=0;else if(t.offset<s){const e=s-t.offset;n.howMany-=e,t.nodesToHandle-=e}if("remove"==n.type&&(i<=n.offset?n.offset-=t.howMany:t.offset<n.offset&&(t.nodesToHandle+=n.howMany,n.howMany=0)),"attribute"==n.type)if(i<=n.offset)n.offset-=t.howMany;else if(t.offset<n.offset){const e=i-n.offset;n.offset=t.offset,n.howMany-=e}else if(t.offset<s)if(i<=s){const i=n.howMany;n.howMany=t.offset-n.offset;const s=i-n.howMany-t.nodesToHandle;e.unshift({type:"attribute",offset:t.offset,howMany:s,count:this._changeCount++})}else n.howMany-=s-t.offset}if("attribute"==t.type){if("insert"==n.type)if(t.offset<n.offset&&i>n.offset){if(i>s){const t={type:"attribute",offset:s,howMany:i-s,count:this._changeCount++};this._handleChange(t,e),e.push(t)}t.nodesToHandle=n.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=n.offset&&t.offset<s&&(i>s?(t.nodesToHandle=i-s,t.offset=s):t.nodesToHandle=0);if("remove"==n.type&&t.offset<n.offset&&i>n.offset){const s={type:"attribute",offset:n.offset,howMany:i-n.offset,count:this._changeCount++};this._handleChange(s,e),e.push(s),t.nodesToHandle=n.offset-t.offset,t.howMany=t.nodesToHandle}"attribute"==n.type&&(t.offset>=n.offset&&i<=s?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=n.offset&&i>=s&&(n.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,e,n){return{type:"insert",position:gr._createAt(t,e),name:n,length:1,changeCount:this._changeCount++}}_getRemoveDiff(t,e,n){return{type:"remove",position:gr._createAt(t,e),name:n,length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,e,n){const i=[];n=new Map(n);for(const[s,o]of e){const e=n.has(s)?n.get(s):null;e!==o&&i.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:s,attributeOldValue:o,attributeNewValue:e,changeCount:this._changeCount++}),n.delete(s)}for(const[e,s]of n)i.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:e,attributeOldValue:null,attributeNewValue:s,changeCount:this._changeCount++});return i}_isInInsertedElement(t){const e=t.parent;if(!e)return!1;const n=this._changesInElement.get(e),i=t.startOffset;if(n)for(const t of n)if("insert"==t.type&&i>=t.offset&&i<t.offset+t.howMany)return!0;return this._isInInsertedElement(e)}_removeAllNestedChanges(t,e,n){const i=new wr(gr._createAt(t,e),gr._createAt(t,e+n));for(const t of i.getItems({shallow:!0}))t.is("element")&&(this._elementSnapshots.delete(t),this._changesInElement.delete(t),this._removeAllNestedChanges(t,0,t.maxOffset))}}function Wa(t){const e=[];for(const n of t)if(n.is("text"))for(let t=0;t<n.data.length;t++)e.push({name:"$text",attributes:new Map(n.getAttributes())});else e.push({name:n.name,attributes:new Map(n.getAttributes())});return e}function Ha(t,e){const n=[];let i=0,s=0;for(const t of e){if(t.offset>i){for(let e=0;e<t.offset-i;e++)n.push("e");s+=t.offset-i}if("insert"==t.type){for(let e=0;e<t.howMany;e++)n.push("i");i=t.offset+t.howMany}else if("remove"==t.type){for(let e=0;e<t.howMany;e++)n.push("r");i=t.offset,s+=t.howMany}else n.push(..."a".repeat(t.howMany).split("")),i=t.offset+t.howMany,s+=t.howMany}if(s<t)for(let e=0;e<t-s-i;e++)n.push("e");return n}function Ka(t){const e=t.position&&"$graveyard"==t.position.root.rootName,n=t.range&&"$graveyard"==t.range.root.rootName;return!e&&!n}class Ja{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(t){this._operations.includes(t)||this._operations.push(t)}getOperations(t=0,e=Number.POSITIVE_INFINITY){return t<0?[]:this._operations.slice(t,e)}getOperation(t){return this._operations[t]}setOperationAsUndone(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}}function $a(t,e){return!!(n=t.charAt(e-1))&&1==n.length&&/[\ud800-\udbff]/.test(n)&&function(t){return!!t&&1==t.length&&/[\udc00-\udfff]/.test(t)}(t.charAt(e));var n}function Ga(t,e){return!!(n=t.charAt(e))&&1==n.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(n);var n}class Ya{constructor(t){this.model=t,this.version=0,this.history=new Ja(this),this.selection=new Nr(this),this.roots=new Cn({idProperty:"rootName"}),this.differ=new Ua(t.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root","$graveyard"),this.listenTo(t,"applyOperation",(t,e)=>{const n=e[0];if(n.isDocumentOperation&&n.baseVersion!==this.version)throw new un.b("model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.",this,{operation:n})},{priority:"highest"}),this.listenTo(t,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&this.differ.bufferOperation(n)},{priority:"high"}),this.listenTo(t,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&(this.version++,this.history.addOperation(n))},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(t.markers,"update",(t,e,n,i)=>{this.differ.bufferMarkerChange(e.name,n,i,e.affectsData),null===n&&e.on("change",(t,n)=>{this.differ.bufferMarkerChange(e.name,n,e.getRange(),e.affectsData)})})}get graveyard(){return this.getRoot("$graveyard")}createRoot(t="$root",e="main"){if(this.roots.get(e))throw new un.b("model-document-createRoot-name-exists: Root with specified name already exists.",this,{name:e});const n=new Da(this,t,e);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(t="main"){return this.roots.get(t)}getRootNames(){return Array.from(this.roots,t=>t.rootName).filter(t=>"$graveyard"!=t)}registerPostFixer(t){this._postFixers.add(t)}toJSON(){const t=Nn(this);return t.selection="[engine.model.DocumentSelection]",t.model="[engine.model.Model]",t}_handleChangeBlock(t){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(t),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",t.batch):this.fire("change",t.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const t of this.roots)if(t!==this.graveyard)return t;return this.graveyard}_getDefaultRange(){const t=this._getDefaultRoot(),e=this.model,n=e.schema,i=e.createPositionFromPath(t,[0]);return n.getNearestSelectionRange(i)||e.createRange(i)}_validateSelectionRange(t){return Qa(t.start)&&Qa(t.end)}_callPostFixers(t){let e=!1;do{for(const n of this._postFixers)if(this.selection.refresh(),e=n(t),e)break}while(e)}}function Qa(t){const e=t.textNode;if(e){const n=e.data,i=t.offset-e.startOffset;return!$a(n,i)&&!Ga(n,i)}return!0}xn(Ya,pn);class Za{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(t){return this._markers.has(t)}get(t){return this._markers.get(t)||null}_set(t,e,n=!1,i=!1){const s=t instanceof Xa?t.name:t,o=this._markers.get(s);if(o){const t=o.getRange();let r=!1;return t.isEqual(e)||(o._attachLiveRange(Sr.fromRange(e)),r=!0),n!=o.managedUsingOperations&&(o._managedUsingOperations=n,r=!0),"boolean"==typeof i&&i!=o.affectsData&&(o._affectsData=i,r=!0),r&&this.fire("update:"+s,o,t,e),o}const r=Sr.fromRange(e),a=new Xa(s,r,n,i);return this._markers.set(s,a),this.fire("update:"+s,a,null,e),a}_remove(t){const e=t instanceof Xa?t.name:t,n=this._markers.get(e);return!!n&&(this._markers.delete(e),this.fire("update:"+e,n,n.getRange(),null),this._destroyMarker(n),!0)}_refresh(t){const e=t instanceof Xa?t.name:t,n=this._markers.get(e);if(!n)throw new un.b("markercollection-refresh-marker-not-exists: Marker with provided name does not exists.",this);const i=n.getRange();this.fire("update:"+e,n,i,i,n.managedUsingOperations,n.affectsData)}*getMarkersAtPosition(t){for(const e of this)e.getRange().containsPosition(t)&&(yield e)}*getMarkersIntersectingRange(t){for(const e of this)null!==e.getRange().getIntersection(t)&&(yield e)}destroy(){for(const t of this._markers.values())this._destroyMarker(t);this._markers=null,this.stopListening()}*getMarkersGroup(t){for(const e of this._markers.values())e.name.startsWith(t+":")&&(yield e)}_destroyMarker(t){t.stopListening(),t._detachLiveRange()}}xn(Za,pn);class Xa{constructor(t,e,n,i){this.name=t,this._liveRange=this._attachLiveRange(e),this._managedUsingOperations=n,this._affectsData=i}get managedUsingOperations(){if(!this._liveRange)throw new un.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new un.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._affectsData}getStart(){if(!this._liveRange)throw new un.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new un.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new un.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.toRange()}is(t){return"marker"===t||"model:marker"===t}_attachLiveRange(t){return this._liveRange&&this._detachLiveRange(),t.delegate("change:range").to(this),t.delegate("change:content").to(this),this._liveRange=t,t}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}xn(Xa,pn);class tl extends ba{get type(){return"noop"}clone(){return new tl(this.baseVersion)}getReversed(){return new tl(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const el={};el[Aa.className]=Aa,el[Oa.className]=Oa,el[Ma.className]=Ma,el[Sa.className]=Sa,el[tl.className]=tl,el[ba.className]=ba,el[Na.className]=Na,el[Ia.className]=Ia,el[La.className]=La,el[Ra.className]=Ra;class nl extends gr{constructor(t,e,n="toNone"){if(super(t,e,n),!this.root.is("rootElement"))throw new un.b("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.",t);il.call(this)}detach(){this.stopListening()}is(t){return"livePosition"===t||"model:livePosition"===t||"position"==t||"model:position"===t}toPosition(){return new gr(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}function il(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&sl.call(this,n)},{priority:"low"})}function sl(t){const e=this.getTransformedByOperation(t);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}xn(nl,pn);class ol{constructor(t,e,n){this.model=t,this.writer=e,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(t,e){t=Array.from(t);for(let n=0;n<t.length;n++){const i=t[n];this._handleNode(i,{isFirst:0===n&&e.isFirst,isLast:n===t.length-1&&e.isLast})}this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}getSelectionRange(){return this.nodeToSelect?wr._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new wr(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t,e){if(this.schema.isObject(t))return void this._handleObject(t,e);this._checkAndSplitToAllowedPosition(t,e)?(this._insert(t),this._mergeSiblingsOf(t,e)):this._handleDisallowedNode(t,e)}_handleObject(t,e){this._checkAndSplitToAllowedPosition(t)?this._insert(t):this._tryAutoparagraphing(t,e)}_handleDisallowedNode(t,e){t.is("element")?this.handleNodes(t.getChildren(),e):this._tryAutoparagraphing(t,e)}_insert(t){if(!this.schema.checkChild(this.position,t))throw new un.b("insertcontent-wrong-position: Given node cannot be inserted on the given position.",this,{node:t,position:this.position});const e=nl.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this.writer.insert(t,this.position),this.position=e.toPosition(),e.detach(),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=t:this.nodeToSelect=null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=nl.fromPosition(t,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(t)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=nl.fromPosition(t,"toNext"))}_mergeSiblingsOf(t,e){if(!(t instanceof dr))return;const n=this._canMergeLeft(t,e),i=this._canMergeRight(t,e),s=nl._createBefore(t);s.stickiness="toNext";const o=nl._createAfter(t);if(o.stickiness="toNext",n){const t=nl.fromPosition(this.position);t.stickiness="toNext",this._affectedStart.isEqual(s)&&(this._affectedStart.detach(),this._affectedStart=nl._createAt(s.nodeBefore,"end","toPrevious")),this.writer.merge(s),s.isEqual(this._affectedEnd)&&e.isLast&&(this._affectedEnd.detach(),this._affectedEnd=nl._createAt(s.nodeBefore,"end","toNext")),this.position=t.toPosition(),t.detach()}if(i){if(!this.position.isEqual(o))throw new un.b("insertcontent-invalid-insertion-position",this);this.position=gr._createAt(o.nodeBefore,"end");const t=nl.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(o)&&(this._affectedEnd.detach(),this._affectedEnd=nl._createAt(o.nodeBefore,"end","toNext")),this.writer.merge(o),o.getShiftedBy(-1).isEqual(this._affectedStart)&&e.isFirst&&(this._affectedStart.detach(),this._affectedStart=nl._createAt(o.nodeBefore,0,"toPrevious")),this.position=t.toPosition(),t.detach()}(n||i)&&this._filterAttributesOf.push(this.position.parent),s.detach(),o.detach()}_canMergeLeft(t,e){const n=t.previousSibling;return e.isFirst&&n instanceof dr&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(n,t)}_canMergeRight(t,e){const n=t.nextSibling;return e.isLast&&n instanceof dr&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(t,n)}_tryAutoparagraphing(t,e){const n=this.writer.createElement("paragraph");this._getAllowedIn(n,this.position.parent)&&this.schema.checkChild(n,t)&&(n._appendChild(t),this._handleNode(n,e))}_checkAndSplitToAllowedPosition(t){const e=this._getAllowedIn(t,this.position.parent);if(!e)return!1;for(;e!=this.position.parent;){if(this.schema.isLimit(this.position.parent))return!1;if(this.position.isAtStart){const t=this.position.parent;this.position=this.writer.createPositionBefore(t),t.isEmpty&&t.parent===e&&this.writer.remove(t)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const t=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=t,this.canMergeWith.add(this.position.nodeAfter)}}return!0}_getAllowedIn(t,e){return this.schema.checkChild(e,t)?e:e.parent?this._getAllowedIn(t,e.parent):null}}function rl(t,e,n={}){if(e.isCollapsed)return;const i=e.getFirstRange();if("$graveyard"==i.root.rootName)return;const s=t.schema;t.change(t=>{if(!n.doNotResetEntireContent&&function(t,e){const n=t.getLimitElement(e);if(!e.containsEntireContent(n))return!1;const i=e.getFirstRange();if(i.start.parent==i.end.parent)return!1;return t.checkChild(n,"paragraph")}(s,e))return void function(t,e){const n=t.model.schema.getLimitElement(e);t.remove(t.createRangeIn(n)),al(t,t.createPositionAt(n,0),e)}(t,e);const o=i.start,r=nl.fromPosition(i.end,"toNext");i.start.isTouching(i.end)||t.remove(i),n.leaveUnmerged||(!function t(e,n,i){const s=n.parent,o=i.parent;if(s==o)return;if(e.model.schema.isLimit(s)||e.model.schema.isLimit(o))return;if(!function(t,e,n){const i=new wr(t,e);for(const t of i.getWalker())if(n.isLimit(t.item))return!1;return!0}(n,i,e.model.schema))return;n=e.createPositionAfter(s),(i=e.createPositionBefore(o)).isEqual(n)||e.insert(o,n);e.merge(n);for(;i.parent.isEmpty;){const t=i.parent;i=e.createPositionBefore(t),e.remove(t)}t(e,n,i)}(t,o,r),s.removeDisallowedAttributes(o.parent.getChildren(),t)),ll(t,e,o),!n.doNotAutoparagraph&&function(t,e){const n=t.checkChild(e,"$text"),i=t.checkChild(e,"paragraph");return!n&&i}(s,o)&&al(t,o,e),r.detach()})}function al(t,e,n){const i=t.createElement("paragraph");t.insert(i,e),ll(t,n,t.createPositionAt(i,0))}function ll(t,e,n){e instanceof Nr?t.setSelection(n):e.setTo(n)}function cl(t,e){if("text"==e.type)return"word"===t.unit?function(t,e){let n=t.position.textNode;if(n){let i=t.position.offset-n.startOffset;for(;!dl(n.data,i,e)&&!ul(n,i,e);){t.next();const s=e?t.position.nodeAfter:t.position.nodeBefore;if(s&&s.is("text")){const i=s.data.charAt(e?0:s.data.length-1);' ,.?!:;"-()'.includes(i)||(t.next(),n=t.position.textNode)}i=t.position.offset-n.startOffset}}return t.position}(t.walker,t.isForward):function(t,e){const n=t.position.textNode;if(n){const i=n.data;let s=t.position.offset-n.startOffset;for(;$a(i,s)||"character"==e&&Ga(i,s);)t.next(),s=t.position.offset-n.startOffset}return t.position}(t.walker,t.unit,t.isForward);if(e.type==(t.isForward?"elementStart":"elementEnd")){if(t.schema.isObject(e.item))return gr._createAt(e.item,t.isForward?"after":"before");if(t.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}else{if(t.schema.isLimit(e.item))return void t.walker.skip(()=>!0);if(t.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}}function hl(t,e){const n=t.root,i=gr._createAt(n,e?"end":0);return e?new wr(t,i):new wr(i,t)}function dl(t,e,n){const i=e+(n?0:-1);return' ,.?!:;"-()'.includes(t.charAt(i))}function ul(t,e,n){return e===(n?t.endOffset:0)}function fl(t,e){const n=[];Array.from(t.getItems({direction:"backward"})).map(t=>e.createRangeOn(t)).filter(e=>(e.start.isAfter(t.start)||e.start.isEqual(t.start))&&(e.end.isBefore(t.end)||e.end.isEqual(t.end))).forEach(t=>{n.push(t.start.parent),e.remove(t)}),n.forEach(t=>{let n=t;for(;n.parent&&n.isEmpty;){const t=e.createRangeOn(n);n=n.parent,e.remove(t)}})}function gl(t){t.document.registerPostFixer(e=>function(t,e){const n=e.document.selection,i=e.schema,s=[];let o=!1;for(const t of n.getRanges()){const e=pl(t,i);e?(s.push(e),o=!0):s.push(t)}o&&t.setSelection(function(t){const e=[];e.push(t.shift());for(const n of t){const t=e.pop();if(n.isIntersecting(t)){const i=t.start.isAfter(n.start)?n.start:t.start,s=t.end.isAfter(n.end)?t.end:n.end,o=new wr(i,s);e.push(o)}else e.push(t),e.push(n)}return e}(s),{backward:n.isBackward})}(e,t))}function pl(t,e){return t.isCollapsed?function(t,e){const n=t.start,i=e.getNearestSelectionRange(n);if(!i)return null;if(!i.isCollapsed)return i;const s=i.start;if(n.isEqual(s))return null;return new wr(s)}(t,e):function(t,e){const n=t.start,i=t.end,s=e.checkChild(n,"$text"),o=e.checkChild(i,"$text"),r=e.getLimitElement(n),a=e.getLimitElement(i);if(r===a){if(s&&o)return null;if(function(t,e,n){const i=t.nodeAfter&&!n.isLimit(t.nodeAfter)||n.checkChild(t,"$text"),s=e.nodeBefore&&!n.isLimit(e.nodeBefore)||n.checkChild(e,"$text");return i||s}(n,i,e)){const t=n.nodeAfter&&e.isObject(n.nodeAfter)?null:e.getNearestSelectionRange(n,"forward"),s=i.nodeBefore&&e.isObject(i.nodeBefore)?null:e.getNearestSelectionRange(i,"backward"),o=t?t.start:n,r=s?s.start:i;return new wr(o,r)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const t=n.nodeAfter&&i.nodeBefore&&n.nodeAfter.parent===i.nodeBefore.parent,s=l&&(!t||!bl(n.nodeAfter,e)),o=c&&(!t||!bl(i.nodeBefore,e));let h=n,d=i;return s&&(h=gr._createBefore(ml(r,e))),o&&(d=gr._createAfter(ml(a,e))),new wr(h,d)}return null}(t,e)}function ml(t,e){let n=t,i=n;for(;e.isLimit(i)&&i.parent;)n=i,i=i.parent;return n}function bl(t,e){return t&&e.isObject(t)}class wl{constructor(){this.markers=new Za,this.document=new Ya(this),this.schema=new Zr,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(t=>this.decorate(t)),this.on("applyOperation",(t,e)=>{e[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",isLimit:!0}),this.schema.extend("$text",{allowIn:"$clipboardHolder"}),this.schema.register("$marker"),this.schema.addChildCheck((t,e)=>{if("$marker"===e.name)return!0}),gl(this)}change(t){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new ma,callback:t}),this._runPendingChanges()[0]):t(this._currentWriter)}catch(t){un.b.rethrowUnexpectedError(t,this)}}enqueueChange(t,e){try{"string"==typeof t?t=new ma(t):"function"==typeof t&&(e=t,t=new ma),this._pendingChanges.push({batch:t,callback:e}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(t){un.b.rethrowUnexpectedError(t,this)}}applyOperation(t){t._execute()}insertContent(t,e,n){return function(t,e,n,i){return t.change(s=>{let o;o=n?n instanceof Cr||n instanceof Nr?n:s.createSelection(n,i):t.document.selection,o.isCollapsed||t.deleteContent(o,{doNotAutoparagraph:!0});const r=new ol(t,s,o.anchor);let a;a=e.is("documentFragment")?e.getChildren():[e],r.handleNodes(a,{isFirst:!0,isLast:!0});const l=r.getSelectionRange();l&&(o instanceof Nr?s.setSelection(l):o.setTo(l));const c=r.getAffectedRange()||t.createRange(o.anchor);return r.destroy(),c})}(this,t,e,n)}deleteContent(t,e){rl(this,t,e)}modifySelection(t,e){!function(t,e,n={}){const i=t.schema,s="backward"!=n.direction,o=n.unit?n.unit:"character",r=e.focus,a=new ur({boundaries:hl(r,s),singleCharacters:!0,direction:s?"forward":"backward"}),l={walker:a,schema:i,isForward:s,unit:o};let c;for(;c=a.next();){if(c.done)return;const n=cl(l,c.value);if(n)return void(e instanceof Nr?t.change(t=>{t.setSelectionFocus(n)}):e.setFocus(n))}}(this,t,e)}getSelectedContent(t){return function(t,e){return t.change(t=>{const n=t.createDocumentFragment(),i=e.getFirstRange();if(!i||i.isCollapsed)return n;const s=i.start.root,o=i.start.getCommonPath(i.end),r=s.getNodeByPath(o);let a;a=i.start.parent==i.end.parent?i:t.createRange(t.createPositionAt(r,i.start.path[o.length]),t.createPositionAt(r,i.end.path[o.length]+1));const l=a.end.offset-a.start.offset;for(const e of a.getItems({shallow:!0}))e.is("textProxy")?t.appendText(e.data,e.getAttributes(),n):t.append(e._clone(!0),n);if(a!=i){const e=i._getTransformedByMove(a.start,t.createPositionAt(n,0),l)[0],s=t.createRange(t.createPositionAt(n,0),e.start);fl(t.createRange(e.end,t.createPositionAt(n,"end")),t),fl(s,t)}return n})}(this,t)}hasContent(t,e){const n=t instanceof dr?wr._createIn(t):t;if(n.isCollapsed)return!1;for(const t of this.markers.getMarkersIntersectingRange(n))if(t.affectsData)return!0;const{ignoreWhitespaces:i=!1}=e||{};for(const t of n.getItems())if(t.is("textProxy")){if(!i)return!0;if(-1!==t.data.search(/\S/))return!0}else if(this.schema.isObject(t))return!0;return!1}createPositionFromPath(t,e,n){return new gr(t,e,n)}createPositionAt(t,e){return gr._createAt(t,e)}createPositionAfter(t){return gr._createAfter(t)}createPositionBefore(t){return gr._createBefore(t)}createRange(t,e){return new wr(t,e)}createRangeIn(t){return wr._createIn(t)}createRangeOn(t){return wr._createOn(t)}createSelection(t,e,n){return new Cr(t,e,n)}createBatch(t){return new ma(t)}createOperationFromJSON(t){return class{static fromJSON(t,e){return el[t.__className].fromJSON(t,e)}}.fromJSON(t,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const t=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){const e=this._pendingChanges[0].batch;this._currentWriter=new Va(this,e);const n=this._pendingChanges[0].callback(this._currentWriter);t.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),t}}xn(wl,qi);class _l extends class{constructor(){this._listener=Object.create(io)}listenTo(t){this._listener.listenTo(t,"keydown",(t,e)=>{this._listener.fire("_keydown:"+fs(e),e)})}set(t,e,n={}){const i=function(t){return"string"==typeof t&&(t=gs(t)),t.map(t=>"string"==typeof t?fs(t):t).reduce((t,e)=>e+t,0)}(t),s=n.priority;this._listener.listenTo(this._listener,"_keydown:"+i,(t,n)=>{e(n,()=>{n.preventDefault(),n.stopPropagation(),t.stop()}),t.return=!0},{priority:s})}press(t){return!!this._listener.fire("_keydown:"+fs(t),t)}destroy(){this._listener.stopListening()}}{constructor(t){super(),this.editor=t}set(t,e,n={}){if("string"==typeof e){const t=e;e=(e,n)=>{this.editor.execute(t),n()}}super.set(t,e,n)}}class kl{constructor(t={}){this._context=t.context||new On({language:t.language}),this._context._addEditor(this,!t.context);const e=Array.from(this.constructor.builtinPlugins||[]);this.config=new sn(t,this.constructor.defaultConfig),this.config.define("plugins",e),this.config.define(this._context._getEditorConfig()),this.plugins=new En(this,e,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new Gr,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.set("isReadOnly",!1),this.model=new wl;const n=new Oi;this.data=new ua(this.model,n),this.editing=new $r(this.model,n),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new fa([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new _l(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const t=this.config,e=t.get("plugins"),n=t.get("removePlugins")||[],i=t.get("extraPlugins")||[];return this.plugins.init(e.concat(i),n)}destroy(){let t=Promise.resolve();return"initializing"==this.state&&(t=new Promise(t=>this.once("ready",t))),t.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(...t){try{this.commands.execute(...t)}catch(t){un.b.rethrowUnexpectedError(t,this)}}}xn(kl,qi);class vl{getHtml(t){const e=document.implementation.createHTMLDocument("").createElement("div");return e.appendChild(t),e.innerHTML}}var yl=n(6);var xl=function(){return function t(){t.called=!0}};class Cl{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=xl(),this.off=xl()}}const El=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));var Tl={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(31);const Al=Symbol("listeningTo"),Pl=Symbol("emitterId");var Sl={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Al]||(this[Al]={});const r=this[Al];Ol(t)||function(t,e){t[Pl]||(t[Pl]=e||function(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+El[t>>0&255]+El[t>>8&255]+El[t>>16&255]+El[t>>24&255]+El[e>>0&255]+El[e>>8&255]+El[e>>16&255]+El[e>>24&255]+El[n>>0&255]+El[n>>8&255]+El[n>>16&255]+El[n>>24&255]+El[i>>0&255]+El[i>>8&255]+El[i>>16&255]+El[i>>24&255]}())}(t);const a=Ol(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Ml(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Nl(t,e),c=Tl.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Al];let s=t&&Ol(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)Rl(t,e,n);else if(r){for(;n=r.pop();)Rl(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Al]}},fire(t,...e){try{const n=t instanceof Cl?t:new Cl(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,Rl(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Il(t,n,e),s&&Il(s,n,e)}return n.return}catch(t){yl.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Ol(t){return t[Pl]}function Ml(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Nl(t,e){const n=Ml(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Nl(t,n.childEvents[e]);i=i.concat(s)}return i}function Il(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Cl(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function Rl(t,e,n){const i=Nl(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function Ll(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}function Dl(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class Vl{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new yl.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=Dl(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}Ll(Vl,Sl);class Bl extends Vl{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof Bl&&(this===t||this.data===t.data)}_clone(){return new Bl(this.document,this.data)}}class Fl{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new yl.a("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new yl.a("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function jl(t){return!(!t||!t[Symbol.iterator])}function zl(t){return jl(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}class ql{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=Ul(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=Ul(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function Ul(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}class Wl{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Hl(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}function Hl(t){return t.replace("-",".")}class Kl extends Vl{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=zl(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");Jl(this._classes,t),this._attrs.delete("class")}this._styles=new Wl(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Kl))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new ql(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Bl(t,e)];jl(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Bl(t,e):e instanceof Fl?new Bl(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?Jl(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function Jl(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class $l{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new yl.a("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new yl.a("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=lc._createAt(t.startPosition):this.position=lc._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof Bl){if(t.isAtEnd)return this.position=lc._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof Kl)return this.shallow?t.offset++:t=new lc(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof Bl){if(this.singleCharacters)return t=new lc(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new Fl(i,0,s),t=lc._createAfter(n)):(n=new Fl(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new Fl(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=lc._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof Bl){if(t.isAtStart)return this.position=lc._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof Kl)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new lc(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof Bl){if(this.singleCharacters)return t=new lc(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new Fl(i,e,i.data.length-e),s=n.data.length,t=lc._createBefore(n)}else n=new Fl(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new Fl(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=lc._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof Fl&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=lc._createAfter(e.textNode):(i=lc._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=lc._createBefore(e.textNode):(i=lc._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class Gl extends Kl{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=Yl}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function Yl(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}const Ql=Symbol("observableProperties"),Zl=Symbol("boundObservables"),Xl=Symbol("boundProperties"),tc={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);nc(this);const n=this[Ql];if(t in this&&!n.has(t))throw new yl.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!oc(t))throw new yl.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new yl.a("observable-bind-duplicate-properties: Properties must be unique.",this);nc(this);const e=this[Xl];t.forEach(t=>{if(e.has(t))throw new yl.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:ic,toMany:sc,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Ql])return;const e=this[Xl],n=this[Zl];if(t.length){if(!oc(t))throw new yl.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new yl.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(tc,Sl);var ec=tc;function nc(t){t[Ql]||(Object.defineProperty(t,Ql,{value:new Map}),Object.defineProperty(t,Zl,{value:new Map}),Object.defineProperty(t,Xl,{value:new Map}))}function ic(...t){const e=function(...t){if(!t.length)throw new yl.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new yl.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new yl.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new yl.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new yl.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Zl];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{rc(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Zl],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{rc(this._observable,t)})}function sc(t,e,n){if(this._bindings.size>1)throw new yl.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function oc(t){return t.every(t=>"string"==typeof t)}function rc(t,e){const n=t[Xl].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class ac extends Gl{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}Ll(ac,ec);class lc{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof ac);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=lc._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new $l(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=Dl(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new $l(t)}clone(){return new lc(this.parent,this.offset)}static _createAt(t,e){if(t instanceof lc)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new yl.a("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new lc(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new lc(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new yl.a("view-position-after-root: You can not make position after root.",t,{root:t});return new lc(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new lc(t.textNode,t.offsetInText);if(!t.parent)throw new yl.a("view-position-before-root: You can not make position before root.",t,{root:t});return new lc(t.parent,t.index)}}class cc{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new $l({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(hc,{direction:"backward"}),e=this.end.getLastMatchingPosition(hc);return t.parent.is("text")&&t.isAtStart&&(t=lc._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=lc._createAfter(e.parent)),new cc(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition(hc);if(t.isAfter(this.end)||t.isEqual(this.end))return new cc(t,t);let e=this.end.getLastMatchingPosition(hc,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new lc(n,0)),i&&i.is("text")&&(e=new lc(i,i.data.length)),new cc(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new cc(this.start,t.start)),this.containsPosition(t.end)&&e.push(new cc(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new cc(e,n)}return null}getWalker(t={}){return t.boundaries=this,new $l(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new cc(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new $l(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new $l(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new lc(t,e),new lc(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(lc._createBefore(t),e)}}function hc(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function dc(t){let e=0;for(const n of t)e++;return e}class uc{constructor(t=null,e,n){this._selection=new fc,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}Ll(uc,Sl);class fc{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=dc(this.getRanges());if(e!=dc(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof fc||t instanceof uc)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof cc)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof lc)this._setRanges([new cc(t)]),this._setFakeOptions(e);else if(t instanceof Vl){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new yl.a("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?cc._createIn(t):"on"==e?cc._createOn(t):new cc(lc._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!jl(t))throw new yl.a("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new yl.a("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=lc._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new cc(n,i),!0):this._addRange(new cc(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof cc))throw new yl.a("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new yl.a("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new cc(t.start,t.end))}}Ll(fc,Sl);class gc{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Bl(t,e)];jl(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Bl(t,e):e instanceof Fl?new Bl(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}Ll(gc,Sl);const pc=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(pc),function(t){t.match(/gecko\/\d+/)}(pc),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(pc),function(t){t.indexOf("android")}(pc),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();!function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e}();function mc(t){return"[object Text]"==Object.prototype.toString.call(t)}const bc=t=>t.createTextNode(" "),wc=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},_c=(()=>{let t="";for(let e=0;e<7;e++)t+="​";return t})();function kc(t){return mc(t)&&t.data.substr(0,7)===_c}function vc(t){return 7==t.data.length&&kc(t)}function yc(t){return kc(t)?t.data.slice(7):t.data}var xc={window:window,document:document};function Cc(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function Ec(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const Tc=wc(document);class Ac{constructor(t,e={}){this.document=t,this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?wc:bc,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new fc(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}viewToDom(t,e,n={}){if(t.is("text")){const n=this._processDataFromViewText(t);return e.createTextNode(n)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let i;if(t.is("documentFragment"))i=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(i,t);else{if(t.is("uiElement"))return i=t.render(e),n.bind&&this.bindElements(i,t),i;i=t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),n.bind&&this.bindElements(i,t);for(const e of t.getAttributeKeys())i.setAttribute(e,t.getAttribute(e))}if(n.withChildren||void 0===n.withChildren)for(const s of this.viewChildrenToDom(t,e,n))i.appendChild(s);return i}}*viewChildrenToDom(t,e,n={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren())i===s&&(yield this._blockFiller(e)),yield this.viewToDom(o,e,n),s++;i===s&&(yield this._blockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),i=document.createRange();return i.setStart(e.parent,e.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(t){const e=t.parent;if(e.is("text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let i=t.offset;return kc(n)&&(i+=7),{parent:n,offset:i}}{let n,i,s;if(0===t.offset){if(n=this.mapViewToDom(e),!n)return null;s=n.childNodes[0]}else{const e=t.nodeBefore;if(i=e.is("text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!i)return null;n=i.parentNode,s=i.nextSibling}if(mc(s)&&kc(s))return{parent:s,offset:7};return{parent:n,offset:i?Cc(i)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t,this.blockFillerMode))return null;const n=this.getParentUIElement(t,this._domToViewMapping);if(n)return n;if(mc(t)){if(vc(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new Bl(this.document,e)}}if(this.isComment(t))return null;{if(this.mapDomToView(t))return this.mapDomToView(t);let n;if(this.isDocumentFragment(t))n=new gc(this.document),e.bind&&this.bindDocumentFragments(t,n);else{const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new Kl(this.document,i),e.bind&&this.bindElements(t,n);const s=t.attributes;for(let t=s.length-1;t>=0;t--)n._setAttribute(s[t].name,s[t].value)}if(e.withChildren||void 0===e.withChildren)for(const i of this.domChildrenToView(t,e))n._appendChild(i);return n}}*domChildrenToView(t,e={}){for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n],s=this.domToView(i,e);null!==s&&(yield s)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;mc(e)&&(e=e.parentNode);const n=this.fakeSelectionToView(e);if(n)return n}const e=this.isDomSelectionBackward(t),n=[];for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e),s=this.domRangeToView(i);s&&n.push(s)}return new fc(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new cc(e,n):null}domPositionToView(t,e){if(this.isBlockFiller(t,this.blockFillerMode))return this.domPositionToView(t.parentNode,Cc(t));const n=this.mapDomToView(t);if(n&&n.is("uiElement"))return lc._createBefore(n);if(mc(t)){if(vc(t))return this.domPositionToView(t.parentNode,Cc(t));const n=this.findCorrespondingViewText(t);let i=e;return n?(kc(t)&&(i-=7,i=i<0?0:i),new lc(n,i)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new lc(e,0)}else{const n=t.childNodes[e-1],i=mc(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new lc(i.parent,i.index+1)}return null}mapDomToView(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(vc(t))return null;const e=this.getParentUIElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const t=this.mapDomToView(n);if(t){return t.nextSibling instanceof Bl?t.nextSibling:null}}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof Bl?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:n}=xc.window,i=[];Sc(e,t=>{const{scrollLeft:e,scrollTop:n}=t;i.push([e,n])}),e.focus(),Sc(e,t=>{const[e,n]=i.shift();t.scrollLeft=e,t.scrollTop=n}),xc.window.scrollTo(t,n)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(Tc):!("BR"!==t.tagName||!Oc(t,this.blockElements)||1!==t.parentNode.childNodes.length)||function(t,e){return mc(t)&&" "==t.data&&Oc(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const n=e.collapsed;return e.detach(),n}getParentUIElement(t){const e=Ec(t);for(e.pop();e.length;){const t=e.pop(),n=this._domToViewMapping.get(t);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}_isDomSelectionPositionCorrect(t,e){if(mc(t)&&kc(t)&&e<7)return!1;if(this.isElement(t)&&kc(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!n||!n.is("uiElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const n=this._getTouchingViewTextNode(t,!1);!(n&&this._nodeEndsWithSpace(n))&&n||(e=" "+e.substr(1))}if(" "==e.charAt(e.length-1)){const n=this._getTouchingViewTextNode(t,!0);" "!=e.charAt(e.length-2)&&n&&" "!=n.data.charAt(0)||(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(Pc(t,this.preElements))return yc(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(t,!1),i=this._getTouchingInlineDomNode(t,!0),s=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,i);return s&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=yc(new Text(e)),e=e.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(e)||!i||i.data&&" "==i.data.charAt(0))&&(e=e.replace(/\u00A0$/," ")),s&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t){return!t||(!!nn(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!kc(t)}_getTouchingViewTextNode(t,e){const n=new $l({startPosition:e?lc._createAfter(t):lc._createBefore(t),direction:e?"forward":"backward"});for(const t of n){if(t.item.is("containerElement"))return null;if(t.item.is("br"))return null;if(t.item.is("textProxy"))return t.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const n=e?"nextNode":"previousNode",i=t.ownerDocument,s=Ec(t)[0],o=i.createTreeWalker(s,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:t=>mc(t)||"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=t;const r=o[n]();if(null!==r){const e=function(t,e){const n=Ec(t),i=Ec(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}(t,r);if(e&&!Pc(t,this.blockElements,e)&&!Pc(r,this.blockElements,e))return r}return null}}function Pc(t,e,n){let i=Ec(t);return n&&(i=i.slice(i.indexOf(n)+1)),i.some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}function Sc(t,e){for(;t&&t!=xc.document;)e(t),t=t.parentNode}function Oc(t,e){const n=t.parentNode;return n&&n.tagName&&e.includes(n.tagName.toLowerCase())}class Mc{constructor(t){this._domParser=new DOMParser,this._domConverter=new Ac(t,{blockFillerMode:"nbsp"}),this._htmlWriter=new vl}toData(t){const e=this._domConverter.viewToDom(t,document);return this._htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this._domConverter.domToView(e)}_toDom(t){const e=this._domParser.parseFromString(t,"text/html"),n=e.createDocumentFragment(),i=e.body.childNodes;for(;i.length>0;)n.appendChild(i[0]);return n}}class Nc{constructor(t){this.editor=t,this.set("isEnabled",!0),this._disableStack=new Set}forceDisabled(t){this._disableStack.add(t),1==this._disableStack.size&&(this.on("set:isEnabled",Ic,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),0==this._disableStack.size&&(this.off("set:isEnabled",Ic),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function Ic(t){t.return=!1,t.stop()}xn(Nc,qi);var Rc=n(3);var Lc=function(){return function t(){t.called=!0}};class Dc{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=Lc(),this.off=Lc()}}const Vc=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Bc(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Vc[t>>0&255]+Vc[t>>8&255]+Vc[t>>16&255]+Vc[t>>24&255]+Vc[e>>0&255]+Vc[e>>8&255]+Vc[e>>16&255]+Vc[e>>24&255]+Vc[n>>0&255]+Vc[n>>8&255]+Vc[n>>16&255]+Vc[n>>24&255]+Vc[i>>0&255]+Vc[i>>8&255]+Vc[i>>16&255]+Vc[i>>24&255]}var Fc={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(42);const jc=Symbol("listeningTo"),zc=Symbol("emitterId");var qc={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[jc]||(this[jc]={});const r=this[jc];Wc(t)||Uc(t);const a=Wc(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Hc(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Kc(t,e),c=Fc.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[jc];let s=t&&Wc(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)$c(t,e,n);else if(r){for(;n=r.pop();)$c(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[jc]}},fire(t,...e){try{const n=t instanceof Dc?t:new Dc(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,$c(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Jc(t,n,e),s&&Jc(s,n,e)}return n.return}catch(t){Rc.b.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Uc(t,e){t[zc]||(t[zc]=e||Bc())}function Wc(t){return t[zc]}function Hc(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Kc(t,e){const n=Hc(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Kc(t,n.childEvents[e]);i=i.concat(s)}return i}function Jc(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Dc(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function $c(t,e,n){const i=Kc(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function Gc(t){return!(!t||!t[Symbol.iterator])}function Yc(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class Qc{constructor(t={},e={}){const n=Gc(t);if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new Rc.b("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new Rc.b("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new Rc.b("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new Rc.b("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new Rc.b("collection-add-invalid-id",this);if(this.get(n))throw new Rc.b("collection-add-item-already-exists",this)}else t[e]=n=Bc();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}Yc(Qc,qc);class Zc extends Qc{constructor(t=[]){super(t,{idProperty:"viewUid"}),this.on("add",(t,e,n)=>{this._renderViewIntoCollectionParent(e,n)}),this.on("remove",(t,e)=>{e.element&&this._parentElement&&e.element.remove()}),this._parentElement=null}destroy(){this.map(t=>t.destroy())}setParent(t){this._parentElement=t;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...t){if(!t.length||!t.every(t=>"string"==typeof t))throw new Rc.b("ui-viewcollection-delegate-wrong-events: All event names must be strings.",this);return{to:e=>{for(const n of this)for(const i of t)n.delegate(i).to(e);this.on("add",(n,i)=>{for(const n of t)i.delegate(n).to(e)}),this.on("remove",(n,i)=>{for(const n of t)i.stopDelegating(n,e)})}}}_renderViewIntoCollectionParent(t,e){t.isRendered||t.render(),t.element&&this._parentElement&&this._parentElement.insertBefore(t.element,this._parentElement.children[e])}}function Xc(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}class th{constructor(t){Object.assign(this,hh(ch(t))),this._isRendered=!1,this._revertData=null}render(){const t=this._renderNode({intoFragment:!0});return this._isRendered=!0,t}apply(t){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:t,isApplying:!0,revertData:this._revertData}),t}revert(t){if(!this._revertData)throw new Rc.b("ui-template-revert-not-applied: Attempting to revert a template which has not been applied yet.",[this,t]);this._revertTemplateFromNode(t,this._revertData)}*getViews(){yield*function*t(e){if(e.children)for(const n of e.children)ph(n)?yield n:mh(n)&&(yield*t(n))}(this)}static bind(t,e){return{to:(n,i)=>new nh({eventNameOrFunction:n,attribute:n,observable:t,emitter:e,callback:i}),if:(n,i,s)=>new ih({observable:t,emitter:e,attribute:n,valueIfTrue:i,callback:s})}}static extend(t,e){if(t._isRendered)throw new Rc.b("template-extend-render: Attempting to extend a template which has already been rendered.",[this,t]);!function t(e,n){n.attributes&&(e.attributes||(e.attributes={}),fh(e.attributes,n.attributes));n.eventListeners&&(e.eventListeners||(e.eventListeners={}),fh(e.eventListeners,n.eventListeners));n.text&&e.text.push(...n.text);if(n.children&&n.children.length){if(e.children.length!=n.children.length)throw new Rc.b("ui-template-extend-children-mismatch: The number of children in extended definition does not match.",e);let i=0;for(const s of n.children)t(e.children[i++],s)}}(t,hh(ch(e)))}_renderNode(t){let e;if(e=t.node?this.tag&&this.text:this.tag?this.text:!this.text,e)throw new Rc.b('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering a new Node.',this);return this.text?this._renderText(t):this._renderElement(t)}_renderElement(t){let e=t.node;return e||(e=t.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(t),this._renderElementChildren(t),this._setUpListeners(t),e}_renderText(t){let e=t.node;return e?t.revertData.text=e.textContent:e=t.node=document.createTextNode(""),sh(this.text)?this._bindToObservable({schema:this.text,updater:rh(e),data:t}):e.textContent=this.text.join(""),e}_renderAttributes(t){let e,n,i,s;if(!this.attributes)return;const o=t.node,r=t.revertData;for(e in this.attributes)if(i=o.getAttribute(e),n=this.attributes[e],r&&(r.attributes[e]=i),s=V(n[0])&&n[0].ns?n[0].ns:null,sh(n)){const a=s?n[0].value:n;r&&wh(e)&&a.unshift(i),this._bindToObservable({schema:a,updater:ah(o,e,s),data:t})}else"style"==e&&"string"!=typeof n[0]?this._renderStyleAttribute(n[0],t):(r&&i&&wh(e)&&n.unshift(i),n=n.map(t=>t&&t.value||t).reduce((t,e)=>t.concat(e),[]).reduce(uh,""),gh(n)||o.setAttributeNS(s,e,n))}_renderStyleAttribute(t,e){const n=e.node;for(const i in t){const s=t[i];sh(s)?this._bindToObservable({schema:[s],updater:lh(n,i),data:e}):n.style[i]=s}}_renderElementChildren(t){const e=t.node,n=t.intoFragment?document.createDocumentFragment():e,i=t.isApplying;let s=0;for(const o of this.children)if(bh(o)){if(!i){o.setParent(e);for(const t of o)n.appendChild(t.element)}}else if(ph(o))i||(o.isRendered||o.render(),n.appendChild(o.element));else if(Xc(o))n.appendChild(o);else if(i){const e={children:[],bindings:[],attributes:{}};t.revertData.children.push(e),o._renderNode({node:n.childNodes[s++],isApplying:!0,revertData:e})}else n.appendChild(o.render());t.intoFragment&&e.appendChild(n)}_setUpListeners(t){if(this.eventListeners)for(const e in this.eventListeners){const n=this.eventListeners[e].map(n=>{const[i,s]=e.split("@");return n.activateDomEventListener(i,s,t)});t.revertData&&t.revertData.bindings.push(n)}}_bindToObservable({schema:t,updater:e,data:n}){const i=n.revertData;oh(t,e,n);const s=t.filter(t=>!gh(t)).filter(t=>t.observable).map(i=>i.activateAttributeListener(t,e,n));i&&i.bindings.push(s)}_revertTemplateFromNode(t,e){for(const t of e.bindings)for(const e of t)e();if(e.text)t.textContent=e.text;else{for(const n in e.attributes){const i=e.attributes[n];null===i?t.removeAttribute(n):t.setAttribute(n,i)}for(let n=0;n<e.children.length;++n)this._revertTemplateFromNode(t.childNodes[n],e.children[n])}}}Yc(th,qc);class eh{constructor(t){Object.assign(this,t)}getValue(t){const e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}activateAttributeListener(t,e,n){const i=()=>oh(t,e,n);return this.emitter.listenTo(this.observable,"change:"+this.attribute,i),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,i)}}}class nh extends eh{activateDomEventListener(t,e,n){const i=(t,n)=>{e&&!n.target.matches(e)||("function"==typeof this.eventNameOrFunction?this.eventNameOrFunction(n):this.observable.fire(this.eventNameOrFunction,n))};return this.emitter.listenTo(n.node,t,i),()=>{this.emitter.stopListening(n.node,t,i)}}}class ih extends eh{getValue(t){return!gh(super.getValue(t))&&(this.valueIfTrue||!0)}}function sh(t){return!!t&&(t.value&&(t=t.value),Array.isArray(t)?t.some(sh):t instanceof eh)}function oh(t,e,{node:n}){let i=function(t,e){return t.map(t=>t instanceof eh?t.getValue(e):t)}(t,n);i=1==t.length&&t[0]instanceof ih?i[0]:i.reduce(uh,""),gh(i)?e.remove():e.set(i)}function rh(t){return{set(e){t.textContent=e},remove(){t.textContent=""}}}function ah(t,e,n){return{set(i){t.setAttributeNS(n,e,i)},remove(){t.removeAttributeNS(n,e)}}}function lh(t,e){return{set(n){t.style[e]=n},remove(){t.style[e]=null}}}function ch(t){return en(t,t=>{if(t&&(t instanceof eh||mh(t)||ph(t)||bh(t)))return t})}function hh(t){if("string"==typeof t?t=function(t){return{text:[t]}}(t):t.text&&function(t){Array.isArray(t.text)||(t.text=[t.text])}(t),t.on&&(t.eventListeners=function(t){for(const e in t)dh(t,e);return t}(t.on),delete t.on),!t.text){t.attributes&&function(t){for(const e in t)t[e].value&&(t[e].value=[].concat(t[e].value)),dh(t,e)}(t.attributes);const e=[];if(t.children)if(bh(t.children))e.push(t.children);else for(const n of t.children)mh(n)||ph(n)||Xc(n)?e.push(n):e.push(new th(n));t.children=e}return t}function dh(t,e){Array.isArray(t[e])||(t[e]=[t[e]])}function uh(t,e){return gh(e)?t:gh(t)?e:`${t} ${e}`}function fh(t,e){for(const n in e)t[n]?t[n].push(...e[n]):t[n]=e[n]}function gh(t){return!t&&0!==t}function ph(t){return t instanceof Ih}function mh(t){return t instanceof th}function bh(t){return t instanceof Zc}function wh(t){return"class"==t||"style"==t}function _h(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var kh=Vi({},qc,{listenTo(t,...e){if(Xc(t)||_h(t)){const n=this._getProxyEmitter(t)||new vh(t);n.attach(...e),t=n}qc.listenTo.call(this,t,...e)},stopListening(t,e,n){if(Xc(t)||_h(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}qc.stopListening.call(this,t,e,n),t instanceof vh&&t.detach(e)},_getProxyEmitter(t){return e=this,n=yh(t),e[jc]&&e[jc][n]?e[jc][n].emitter:null;var e,n}});class vh{constructor(t){Uc(this,yh(t)),this._domNode=t}}function yh(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Bc())}Vi(vh.prototype,qc,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});const xh=Symbol("observableProperties"),Ch=Symbol("boundObservables"),Eh=Symbol("boundProperties"),Th={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);Ph(this);const n=this[xh];if(t in this&&!n.has(t))throw new Rc.b("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!Mh(t))throw new Rc.b("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new Rc.b("observable-bind-duplicate-properties: Properties must be unique.",this);Ph(this);const e=this[Eh];t.forEach(t=>{if(e.has(t))throw new Rc.b("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:Sh,toMany:Oh,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[xh])return;const e=this[Eh],n=this[Ch];if(t.length){if(!Mh(t))throw new Rc.b("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new Rc.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(Th,qc);var Ah=Th;function Ph(t){t[xh]||(Object.defineProperty(t,xh,{value:new Map}),Object.defineProperty(t,Ch,{value:new Map}),Object.defineProperty(t,Eh,{value:new Map}))}function Sh(...t){const e=function(...t){if(!t.length)throw new Rc.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new Rc.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new Rc.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new Rc.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new Rc.b("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Ch];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{Nh(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Ch],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{Nh(this._observable,t)})}function Oh(t,e,n){if(this._bindings.size>1)throw new Rc.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function Mh(t){return t.every(t=>"string"==typeof t)}function Nh(t,e){const n=t[Eh].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}n(43);class Ih{constructor(t){this.element=null,this.isRendered=!1,this.locale=t,this.t=t&&t.t,this._viewCollections=new Qc,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(e,n)=>{n.locale=t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=th.bind(this,this)}createCollection(t){const e=new Zc(t);return this._viewCollections.add(e),e}registerChild(t){Gc(t)||(t=[t]);for(const e of t)this._unboundChildren.add(e)}deregisterChild(t){Gc(t)||(t=[t]);for(const e of t)this._unboundChildren.remove(e)}setTemplate(t){this.template=new th(t)}extendTemplate(t){th.extend(this.template,t)}render(){if(this.isRendered)throw new Rc.b("ui-view-render-already-rendered: This View has already been rendered.",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(t=>t.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}Yc(Ih,kh),Yc(Ih,Ah);var Rh={window:window,document:document};function Lh(t){return"[object Range]"==Object.prototype.toString.apply(t)}function Dh(t){const e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}const Vh=["top","right","bottom","left","width","height"];class Bh{constructor(t){const e=Lh(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),nn(t)||e)Fh(this,e?Bh.getDomRangeRects(t)[0]:t.getBoundingClientRect());else if(_h(t)){const{innerWidth:e,innerHeight:n}=t;Fh(this,{top:0,right:e,bottom:n,left:0,width:e,height:n})}else Fh(this,t)}clone(){return new Bh(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0?null:new Bh(e)}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(!jh(t)){let n=t.parentNode||t.commonAncestorContainer;for(;n&&!jh(n);){const t=new Bh(n),i=e.getIntersection(t);if(!i)return null;i.getArea()<e.getArea()&&(e=i),n=n.parentNode}}return e}isEqual(t){for(const e of Vh)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!(!e||!e.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let e,n,i;if(_h(t))e=t.innerWidth-t.document.documentElement.clientWidth,n=t.innerHeight-t.document.documentElement.clientHeight,i=t.getComputedStyle(t.document.documentElement).direction;else{const s=Dh(this._source);e=t.offsetWidth-t.clientWidth-s.left-s.right,n=t.offsetHeight-t.clientHeight-s.top-s.bottom,i=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=s.left,this.top+=s.top,this.right-=s.right,this.bottom-=s.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,"ltr"===i?this.right-=e:this.left+=e,this.height-=n,this.bottom-=n,this}static getDomRangeRects(t){const e=[],n=Array.from(t.getClientRects());if(n.length)for(const t of n)e.push(new Bh(t));else{let n=t.startContainer;i=n,"[object Text]"==Object.prototype.toString.call(i)&&(n=n.parentNode);const s=new Bh(n.getBoundingClientRect());s.right=s.left,s.width=0,e.push(s)}var i;return e}}function Fh(t,e){for(const n of Vh)t[n]=e[n]}function jh(t){return!!nn(t)&&t===t.ownerDocument.body}function zh({element:t,target:e,positions:n,limiter:i,fitInViewport:s}){F(e)&&(e=e()),F(i)&&(i=i());const o=function(t){return t&&t.parentNode?t.offsetParent===Rh.document.body?null:t.offsetParent:null}(t),r=new Bh(t),a=new Bh(e);let l,c;if(i||s){const t=function(t,e){const{elementRect:n,viewportRect:i}=e,s=n.getArea(),o=function(t,{targetRect:e,elementRect:n,limiterRect:i,viewportRect:s}){const o=[],r=n.getArea();for(const a of t){const t=qh(a,e,n);if(!t)continue;const[l,c]=t;let h=0,d=0;if(i)if(s){const t=i.getIntersection(s);t&&(h=t.getIntersectionArea(c))}else h=i.getIntersectionArea(c);s&&(d=s.getIntersectionArea(c));const u={positionName:l,positionRect:c,limiterIntersectArea:h,viewportIntersectArea:d};if(h===r)return[u];o.push(u)}return o}(t,e);if(i){const t=Uh(o.filter(({viewportIntersectArea:t})=>t===s),s);if(t)return t}return Uh(o,s)}(n,{targetRect:a,elementRect:r,limiterRect:i&&new Bh(i).getVisible(),viewportRect:s&&new Bh(Rh.window)});[c,l]=t||qh(n[0],a,r)}else[c,l]=qh(n[0],a,r);let h=Wh(l);return o&&(h=function({left:t,top:e},n){const i=Wh(new Bh(n)),s=Dh(n);return t-=i.left,e-=i.top,t+=n.scrollLeft,e+=n.scrollTop,t-=s.left,e-=s.top,{left:t,top:e}}(h,o)),{left:h.left,top:h.top,name:c}}function qh(t,e,n){const i=t(e,n);if(!i)return null;const{left:s,top:o,name:r}=i;return[r,n.clone().moveTo(s,o)]}function Uh(t,e){let n,i,s=0;for(const{positionName:o,positionRect:r,limiterIntersectArea:a,viewportIntersectArea:l}of t){if(a===e)return[o,r];const t=l**2+a**2;t>s&&(s=t,n=r,i=o)}return n?[i,n]:null}function Wh({left:t,top:e}){const{scrollX:n,scrollY:i}=Rh.window;return{left:t+n,top:e+i}}function Hh(t){return e=>e+t}n(45);const Kh=Hh("px"),Jh=Rh.document.body;class $h extends Ih{constructor(t){super(t);const e=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",e.to("position",t=>"ck-balloon-panel_"+t),e.if("isVisible","ck-balloon-panel_visible"),e.if("withArrow","ck-balloon-panel_with-arrow"),e.to("class")],style:{top:e.to("top",Kh),left:e.to("left",Kh)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(t){this.show();const e=$h.defaultPositions,n=Object.assign({},{element:this.element,positions:[e.southArrowNorth,e.southArrowNorthMiddleWest,e.southArrowNorthMiddleEast,e.southArrowNorthWest,e.southArrowNorthEast,e.northArrowSouth,e.northArrowSouthMiddleWest,e.northArrowSouthMiddleEast,e.northArrowSouthWest,e.northArrowSouthEast],limiter:Jh,fitInViewport:!0},t),i=$h._getOptimalPosition(n),s=parseInt(i.left),o=parseInt(i.top),r=i.name;Object.assign(this,{top:o,left:s,position:r})}pin(t){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(t):this._stopPinning()},this._startPinning(t),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(t){this.attachTo(t);const e=Gh(t.target),n=t.limiter?Gh(t.limiter):Jh;this.listenTo(Rh.document,"scroll",(i,s)=>{const o=s.target,r=e&&o.contains(e),a=n&&o.contains(n);!r&&!a&&e&&n||this.attachTo(t)},{useCapture:!0}),this.listenTo(Rh.window,"resize",()=>{this.attachTo(t)})}_stopPinning(){this.stopListening(Rh.document,"scroll"),this.stopListening(Rh.window,"resize")}}function Gh(t){return nn(t)?t:Lh(t)?t.commonAncestorContainer:"function"==typeof t?Gh(t()):null}function Yh(t,e){return t.top-e.height-$h.arrowVerticalOffset}function Qh(t){return t.bottom+$h.arrowVerticalOffset}$h.arrowHorizontalOffset=25,$h.arrowVerticalOffset=10,$h._getOptimalPosition=zh,$h.defaultPositions={northWestArrowSouthWest:(t,e)=>({top:Yh(t,e),left:t.left-$h.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouthMiddleWest:(t,e)=>({top:Yh(t,e),left:t.left-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_smw"}),northWestArrowSouth:(t,e)=>({top:Yh(t,e),left:t.left-e.width/2,name:"arrow_s"}),northWestArrowSouthMiddleEast:(t,e)=>({top:Yh(t,e),left:t.left-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_sme"}),northWestArrowSouthEast:(t,e)=>({top:Yh(t,e),left:t.left-e.width+$h.arrowHorizontalOffset,name:"arrow_se"}),northArrowSouthWest:(t,e)=>({top:Yh(t,e),left:t.left+t.width/2-$h.arrowHorizontalOffset,name:"arrow_sw"}),northArrowSouthMiddleWest:(t,e)=>({top:Yh(t,e),left:t.left+t.width/2-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_smw"}),northArrowSouth:(t,e)=>({top:Yh(t,e),left:t.left+t.width/2-e.width/2,name:"arrow_s"}),northArrowSouthMiddleEast:(t,e)=>({top:Yh(t,e),left:t.left+t.width/2-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_sme"}),northArrowSouthEast:(t,e)=>({top:Yh(t,e),left:t.left+t.width/2-e.width+$h.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouthWest:(t,e)=>({top:Yh(t,e),left:t.right-$h.arrowHorizontalOffset,name:"arrow_sw"}),northEastArrowSouthMiddleWest:(t,e)=>({top:Yh(t,e),left:t.right-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_smw"}),northEastArrowSouth:(t,e)=>({top:Yh(t,e),left:t.right-e.width/2,name:"arrow_s"}),northEastArrowSouthMiddleEast:(t,e)=>({top:Yh(t,e),left:t.right-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_sme"}),northEastArrowSouthEast:(t,e)=>({top:Yh(t,e),left:t.right-e.width+$h.arrowHorizontalOffset,name:"arrow_se"}),southWestArrowNorthWest:(t,e)=>({top:Qh(t),left:t.left-$h.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorthMiddleWest:(t,e)=>({top:Qh(t),left:t.left-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_nmw"}),southWestArrowNorth:(t,e)=>({top:Qh(t),left:t.left-e.width/2,name:"arrow_n"}),southWestArrowNorthMiddleEast:(t,e)=>({top:Qh(t),left:t.left-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_nme"}),southWestArrowNorthEast:(t,e)=>({top:Qh(t),left:t.left-e.width+$h.arrowHorizontalOffset,name:"arrow_ne"}),southArrowNorthWest:(t,e)=>({top:Qh(t),left:t.left+t.width/2-$h.arrowHorizontalOffset,name:"arrow_nw"}),southArrowNorthMiddleWest:(t,e)=>({top:Qh(t),left:t.left+t.width/2-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_nmw"}),southArrowNorth:(t,e)=>({top:Qh(t),left:t.left+t.width/2-e.width/2,name:"arrow_n"}),southArrowNorthMiddleEast:(t,e)=>({top:Qh(t),left:t.left+t.width/2-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_nme"}),southArrowNorthEast:(t,e)=>({top:Qh(t),left:t.left+t.width/2-e.width+$h.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorthWest:(t,e)=>({top:Qh(t),left:t.right-$h.arrowHorizontalOffset,name:"arrow_nw"}),southEastArrowNorthMiddleWest:(t,e)=>({top:Qh(t),left:t.right-.25*e.width-$h.arrowHorizontalOffset,name:"arrow_nmw"}),southEastArrowNorth:(t,e)=>({top:Qh(t),left:t.right-e.width/2,name:"arrow_n"}),southEastArrowNorthMiddleEast:(t,e)=>({top:Qh(t),left:t.right-.75*e.width+$h.arrowHorizontalOffset,name:"arrow_nme"}),southEastArrowNorthEast:(t,e)=>({top:Qh(t),left:t.right-e.width+$h.arrowHorizontalOffset,name:"arrow_ne"})};n(47);class Zh extends Ih{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:t.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),e=t.getAttribute("viewBox");for(e&&(this.viewBox=e),this.element.innerHTML="";t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}}n(49);class Xh extends Ih{constructor(t){super(t),this.set("text",""),this.set("position","n");const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",e.to("position",()=>"ck-tooltip_n"),e.if("text","ck-hidden",t=>!t.trim())]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:e.to("text")}]}]})}}const td=navigator.userAgent.toLowerCase();var ed={isMac:function(t){return t.indexOf("macintosh")>-1}(td),isGecko:function(t){return!!t.match(/gecko\/\d+/)}(td),isSafari:function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(td),isAndroid:function(t){return t.indexOf("android")>-1}(td),features:{isRegExpUnicodePropertySupported:function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}()}};const nd={"⌘":"ctrl","⇧":"shift","⌥":"alt"},id={ctrl:"⌘",shift:"⇧",alt:"⌥"},sd=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function od(t){let e;if("string"==typeof t){if(e=sd[t.toLowerCase()],!e)throw new Rc.b("keyboard-unknown-key: Unknown key name.",null,{key:t})}else e=t.keyCode+(t.altKey?sd.alt:0)+(t.ctrlKey?sd.ctrl:0)+(t.shiftKey?sd.shift:0);return e}function rd(t){return ed.isMac?ad(t).map(t=>id[t.toLowerCase()]||t).reduce((t,e)=>t.slice(-1)in nd?t+e:t+"+"+e):t}function ad(t){return t.split(/\s*\+\s*/)}n(51);class ld extends Ih{constructor(t){super(t);const e=this.bindTemplate,n=Bc();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(n),this.iconView=new Zh,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",e.to("class"),e.if("isEnabled","ck-disabled",t=>!t),e.if("isVisible","ck-hidden",t=>!t),e.to("isOn",t=>t?"ck-on":"ck-off"),e.if("withText","ck-button_with-text"),e.if("withKeystroke","ck-button_with-keystroke")],type:e.to("type",t=>t||"button"),tabindex:e.to("tabindex"),"aria-labelledby":"ck-editor__aria-label_"+n,"aria-disabled":e.if("isEnabled",!0,t=>!t),"aria-pressed":e.to("isOn",t=>!!this.isToggleable&&String(t))},children:this.children,on:{mousedown:e.to(t=>{t.preventDefault()}),click:e.to(t=>{this.isEnabled?this.fire("execute"):t.preventDefault()})}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const t=new Xh;return t.bind("text").to(this,"_tooltipString"),t.bind("position").to(this,"tooltipPosition"),t}_createLabelView(t){const e=new Ih,n=this.bindTemplate;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:n.to("labelStyle"),id:"ck-editor__aria-label_"+t},children:[{text:this.bindTemplate.to("label")}]}),e}_createKeystrokeView(){const t=new Ih;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>rd(t))}]}),t}_getTooltipString(t,e,n){return t?"string"==typeof t?t:(n&&(n=rd(n)),t instanceof Function?t(e,n):`${e}${n?` (${n})`:""}`):""}}class cd{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new Rc.b("focusTracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}Yc(cd,kh),Yc(cd,Ah);n(53),n(55);const hd=Hh("px");class dd extends Nc{static get pluginName(){return"ContextualBalloon"}constructor(t){super(t),this.positionLimiter=()=>{const t=this.editor.editing.view,e=t.document.selection.editableElement;return e?t.domConverter.mapViewToDom(e.root):null},this.set("visibleView",null),this.view=new $h(t.locale),t.ui.view.body.add(this.view),t.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(t){return Array.from(this._viewToStack.keys()).includes(t)}add(t){if(this.hasView(t.view))throw new Rc.b("contextualballoon-add-view-exist: Cannot add configuration of the same view twice.",[this,t]);const e=t.stackId||"main";if(!this._idToStack.has(e))return this._idToStack.set(e,new Map([[t.view,t]])),this._viewToStack.set(t.view,this._idToStack.get(e)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!t.singleViewMode||this.showStack(e));const n=this._idToStack.get(e);t.singleViewMode&&this.showStack(e),n.set(t.view,t),this._viewToStack.set(t.view,n),n===this._visibleStack&&this._showView(t)}remove(t){if(!this.hasView(t))throw new Rc.b("contextualballoon-remove-view-not-exist: Cannot remove the configuration of a non-existent view.",[this,t]);const e=this._viewToStack.get(t);this._singleViewMode&&this.visibleView===t&&(this._singleViewMode=!1),this.visibleView===t&&(1===e.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(e.values())[e.size-2])),1===e.size?(this._idToStack.delete(this._getStackId(e)),this._numberOfStacks=this._idToStack.size):e.delete(t),this._viewToStack.delete(t)}updatePosition(t){t&&(this._visibleStack.get(this.visibleView).position=t),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(t){this.visibleStack=t;const e=this._idToStack.get(t);if(!e)throw new Rc.b("contextualballoon-showstack-stack-not-exist: Cannot show a stack that does not exist.",this);this._visibleStack!==e&&this._showView(Array.from(e.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(t){return Array.from(this._idToStack.entries()).find(e=>e[1]===t)[0]}_showNextStack(){const t=Array.from(this._idToStack.values());let e=t.indexOf(this._visibleStack)+1;t[e]||(e=0),this.showStack(this._getStackId(t[e]))}_showPrevStack(){const t=Array.from(this._idToStack.values());let e=t.indexOf(this._visibleStack)-1;t[e]||(e=t.length-1),this.showStack(this._getStackId(t[e]))}_createRotatorView(){const t=new ud(this.editor.locale),e=this.editor.locale.t;return this.view.content.add(t),t.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(t,e)=>!e&&t>1),t.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),t.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(t,n)=>{if(n<2)return"";const i=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return e("%0 of %1",[i,n])}),t.buttonNextView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),t.buttonPrevView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),t}_createFakePanelsView(){const t=new fd(this.editor.locale,this.view);return t.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,e)=>!e&&t>=2?Math.min(t-1,2):0),t.listenTo(this.view,"change:top",()=>t.updatePosition()),t.listenTo(this.view,"change:left",()=>t.updatePosition()),this.editor.ui.view.body.add(t),t}_showView({view:t,balloonClassName:e="",withArrow:n=!0,singleViewMode:i=!1}){this.view.class=e,this.view.withArrow=n,this._rotatorView.showView(t),this.visibleView=t,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),i&&(this._singleViewMode=!0)}_getBalloonPosition(){let t=Array.from(this._visibleStack.values()).pop().position;return t&&!t.limiter&&(t=Object.assign({},t,{limiter:this.positionLimiter})),t}}class ud extends Ih{constructor(t){super(t);const e=t.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new cd,this.buttonPrevView=this._createButtonView(e("Previous"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>'),this.buttonNextView=this._createButtonView(e("Next"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>'),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",t=>t?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(t){this.hideView(),this.content.add(t)}hideView(){this.content.clear()}_createButtonView(t,e){const n=new ld(this.locale);return n.set({label:t,icon:e,tooltip:!0}),n}}class fd extends Ih{constructor(t,e){super(t);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=e,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",t=>t?"":"ck-hidden")],style:{top:n.to("top",hd),left:n.to("left",hd),width:n.to("width",hd),height:n.to("height",hd)}},children:this.content}),this.on("change:numberOfPanels",(t,e,n,i)=>{n>i?this._addPanels(n-i):this._removePanels(i-n),this.updatePosition()})}_addPanels(t){for(;t--;){const t=new Ih;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(t){for(;t--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:t,left:e}=this._balloonPanelView,{width:n,height:i}=new Bh(this._balloonPanelView.element);Object.assign(this,{top:t,left:e,width:n,height:i})}}}class gd{constructor(t){if(Object.assign(this,t),t.actions&&t.keystrokeHandler)for(const e in t.actions){let n=t.actions[e];"string"==typeof n&&(n=[n]);for(const i of n)t.keystrokeHandler.set(i,(t,n)=>{this[e](),n()})}}get first(){return this.focusables.find(pd)||null}get last(){return this.focusables.filter(pd).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let t=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find((e,n)=>{const i=e.element===this.focusTracker.focusedElement;return i&&(t=n),i}),t)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(t){t&&t.focus()}_getFocusableItem(t){const e=this.current,n=this.focusables.length;if(!n)return null;if(null===e)return this[1===t?"first":"last"];let i=(e+n+t)%n;do{const e=this.focusables.get(i);if(pd(e))return e;i=(i+n+t)%n}while(i!==e);return null}}function pd(t){return!(!t.focus||"none"==Rh.window.getComputedStyle(t.element).display)}class md{constructor(){this._listener=Object.create(kh)}listenTo(t){this._listener.listenTo(t,"keydown",(t,e)=>{this._listener.fire("_keydown:"+od(e),e)})}set(t,e,n={}){const i=function(t){return"string"==typeof t&&(t=ad(t)),t.map(t=>"string"==typeof t?od(t):t).reduce((t,e)=>e+t,0)}(t),s=n.priority;this._listener.listenTo(this._listener,"_keydown:"+i,(t,n)=>{e(n,()=>{n.preventDefault(),n.stopPropagation(),t.stop()}),t.return=!0},{priority:s})}press(t){return!!this._listener.fire("_keydown:"+od(t),t)}destroy(){this._listener.stopListening()}}class bd extends Ih{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class wd{constructor(t,e){wd._observerInstance||wd._createObserver(),this._element=t,this._callback=e,wd._addElementCallback(t,e),wd._observerInstance.observe(t)}destroy(){wd._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,e){wd._elementCallbacks||(wd._elementCallbacks=new Map);let n=wd._elementCallbacks.get(t);n||(n=new Set,wd._elementCallbacks.set(t,n)),n.add(e)}static _deleteElementCallback(t,e){const n=wd._getElementCallbacks(t);n&&(n.delete(e),n.size||(wd._elementCallbacks.delete(t),wd._observerInstance.unobserve(t))),wd._elementCallbacks&&!wd._elementCallbacks.size&&(wd._observerInstance=null,wd._elementCallbacks=null)}static _getElementCallbacks(t){return wd._elementCallbacks?wd._elementCallbacks.get(t):null}static _createObserver(){let t;t="function"==typeof Rh.window.ResizeObserver?Rh.window.ResizeObserver:_d,wd._observerInstance=new t(t=>{for(const e of t){if(!e.target.offsetParent)continue;const t=wd._getElementCallbacks(e.target);if(t)for(const n of t)n(e)}})}}wd._observerInstance=null,wd._elementCallbacks=null;class _d{constructor(t){this._callback=t,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(t){this._elements.add(t),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(t){this._elements.delete(t),this._previousRects.delete(t),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const t=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(t,100)};this.listenTo(Rh.window,"resize",()=>{this._checkElementRectsAndExecuteCallback()}),this._periodicCheckTimeout=setTimeout(t,100)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const t=[];for(const e of this._elements)this._hasRectChanged(e)&&t.push({target:e,contentRect:this._previousRects.get(e)});t.length&&this._callback(t)}_hasRectChanged(t){if(!t.ownerDocument.body.contains(t))return!1;const e=new Bh(t),n=this._previousRects.get(t),i=!n||!n.isEqual(e);return this._previousRects.set(t,e),i}}Yc(_d,kh);class kd extends Ih{constructor(t){super(t);const e=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",e.to("position",t=>"ck-dropdown__panel_"+t),e.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:e.to(t=>t.preventDefault())}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const t=this.children.last;"function"==typeof t.focusLast?t.focusLast():t.focus()}}}n(57);class vd extends Ih{constructor(t,e,n){super(t);const i=this.bindTemplate;this.buttonView=e,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new md,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",i.to("class"),i.if("isEnabled","ck-disabled",t=>!t)],id:i.to("id"),"aria-describedby":i.to("ariaDescribedById")},children:[e,n]}),e.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=vd._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)}),this.keystrokes.listenTo(this.element);const t=(t,e)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,e())};this.keystrokes.set("arrowdown",(t,e)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,e())}),this.keystrokes.set("arrowright",(t,e)=>{this.isOpen&&e()}),this.keystrokes.set("arrowleft",t),this.keystrokes.set("esc",t)}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:t,southWest:e,northEast:n,northWest:i}=vd.defaultPanelPositions;return"ltr"===this.locale.uiLanguageDirection?[t,e,n,i]:[e,t,i,n]}}vd.defaultPanelPositions={southEast:t=>({top:t.bottom,left:t.left,name:"se"}),southWest:(t,e)=>({top:t.bottom,left:t.left-e.width+t.width,name:"sw"}),northEast:(t,e)=>({top:t.top-e.height,left:t.left,name:"ne"}),northWest:(t,e)=>({top:t.bottom-e.height,left:t.left-e.width+t.width,name:"nw"})},vd._getOptimalPosition=zh;var yd='<?xml version="1.0" encoding="iso-8859-1"?>\n\x3c!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">\n<g>\n\t<g id="arrow-drop-down">\n\t\t<polygon points="0,63.75 127.5,191.25 255,63.75 \t\t"/>\n\t</g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n</svg>\n';class xd extends ld{constructor(t){super(t),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const t=new Zh;return t.content=yd,t.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),t}}n(59);class Cd extends Ih{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new cd,this.keystrokes=new md,this._focusCycler=new gd({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,e)=>{this.focusTracker.add(e.element)}),this.items.on("remove",(t,e)=>{this.focusTracker.remove(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class Ed extends Ih{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class Td extends Ih{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}n(61);class Ad extends ld{constructor(t){super(t),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const t=new Ih;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),t}}function Pd({emitter:t,activator:e,callback:n,contextElements:i}){t.listenTo(document,"mousedown",(t,{target:s})=>{if(e()){for(const t of i)if(t.contains(s))return;n()}})}n(63),n(65);function Sd(t,e=xd){const n=new e(t),i=new kd(t),s=new vd(t,n,i);return n.bind("isEnabled").to(s),n instanceof xd?n.bind("isOn").to(s,"isOpen"):n.arrowView.bind("isOn").to(s,"isOpen"),function(t){(function(t){t.on("render",()=>{Pd({emitter:t,activator:()=>t.isOpen,callback:()=>{t.isOpen=!1},contextElements:[t.element]})})})(t),function(t){t.on("execute",e=>{e.source instanceof Ad||(t.isOpen=!1)})}(t),function(t){t.keystrokes.set("arrowdown",(e,n)=>{t.isOpen&&(t.panelView.focus(),n())}),t.keystrokes.set("arrowup",(e,n)=>{t.isOpen&&(t.panelView.focusLast(),n())})}(t)}(s),s}function Od(t,e){const n=t.locale,i=n.t,s=t.toolbarView=new Nd(n);s.set("ariaLabel",i("Dropdown toolbar")),t.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.map(t=>s.items.add(t)),t.panelView.children.add(s),s.items.delegate("execute").to(t)}function Md(t,e){const n=t.locale,i=t.listView=new Cd(n);i.items.bindTo(e).using(({type:t,model:e})=>{if("separator"===t)return new Td(n);if("button"===t||"switchbutton"===t){const i=new Ed(n);let s;return s="button"===t?new ld(n):new Ad(n),s.bind(...Object.keys(e)).to(e),s.delegate("execute").to(i),i.children.add(s),i}}),t.panelView.children.add(i),i.items.delegate("execute").to(t)}n(67);class Nd extends Ih{constructor(t,e){super(t);const n=this.bindTemplate,i=this.t;var s;this.options=e||{},this.set("ariaLabel",i("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new cd,this.keystrokes=new md,this.set("class"),this.set("isCompact",!1),this.itemsView=new Id(t),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection(),this._focusCycler=new gd({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["arrowleft","arrowup"],focusNext:["arrowright","arrowdown"]}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact")],role:"toolbar","aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")}},children:this.children,on:{mousedown:(s=this,s.bindTemplate.to(t=>{t.target===s.element&&t.preventDefault()}))}}),this._behavior=this.options.shouldGroupWhenFull?new Ld(this):new Rd(this)}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,e)=>{this.focusTracker.add(e.element)}),this.items.on("remove",(t,e)=>{this.focusTracker.remove(e.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(t,e){t.map(t=>{"|"==t?this.items.add(new bd):e.has(t)?this.items.add(e.create(t)):console.warn(Object(Rc.a)("toolbarview-item-unavailable: The requested toolbar item is unavailable."),{name:t})})}}class Id extends Ih{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class Rd{constructor(t){const e=t.bindTemplate;t.set("isVertical",!1),t.itemsView.children.bindTo(t.items).using(t=>t),t.focusables.bindTo(t.items).using(t=>t),t.extendTemplate({attributes:{class:[e.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class Ld{constructor(t){this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,t.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),t.children.on("add",this._updateFocusCycleableItems.bind(this)),t.children.on("remove",this._updateFocusCycleableItems.bind(this)),t.items.on("add",(t,e,n)=>{n>this.ungroupedItems.length?this.groupedItems.add(e,n-this.ungroupedItems.length):this.ungroupedItems.add(e,n),this._updateGrouping()}),t.items.on("remove",(t,e,n)=>{n>this.ungroupedItems.length?this.groupedItems.remove(e):this.ungroupedItems.remove(e),this._updateGrouping()}),t.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,e=this.viewLocale.uiLanguageDirection,n=new Bh(t.lastChild),i=new Bh(t);if(!this.cachedPadding){const n=Rh.window.getComputedStyle(t),i="ltr"===e?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(n[i])}return"ltr"===e?n.right>i.right-this.cachedPadding:n.left<i.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new wd(this.viewElement,e=>{t&&t===e.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=e.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new bd),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,e=t.t,n=Sd(t);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition="ltr"===t.uiLanguageDirection?"sw":"se",Od(n,[]),n.buttonView.set({label:e("Show more items"),tooltip:!0,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>'}),n.toolbarView.items.bindTo(this.groupedItems).using(t=>t),n}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}const Dd=Hh("px");class Vd extends Nc{static get pluginName(){return"BalloonToolbar"}static get requires(){return[dd]}constructor(t){var e;super(t),this._balloonConfig=(e=t.config.get("balloonToolbar"),Array.isArray(e)?{items:e}:e?Object.assign({items:[]},e):{items:[]}),this.toolbarView=this._createToolbarView(),this.focusTracker=new cd,t.ui.once("ready",()=>{this.focusTracker.add(t.ui.getEditableElement()),this.focusTracker.add(this.toolbarView.element)}),this._resizeObserver=null,this._balloon=t.plugins.get(dd),this._fireSelectionChangeDebounced=Fo(()=>this.fire("_selectionChangeDebounced"),200),this.decorate("show")}init(){const t=this.editor,e=t.model.document.selection;this.listenTo(this.focusTracker,"change:isFocused",(t,e,n)=>{const i=this._balloon.visibleView===this.toolbarView;!n&&i?this.hide():n&&this.show()}),this.listenTo(e,"change:range",(t,n)=>{(n.directChange||e.isCollapsed)&&this.hide(),this._fireSelectionChangeDebounced()}),this.listenTo(this,"_selectionChangeDebounced",()=>{this.editor.editing.view.document.isFocused&&this.show()}),this._balloonConfig.shouldNotGroupWhenFull||this.listenTo(t,"ready",()=>{const e=t.ui.view.editable.element;this._resizeObserver=new wd(e,()=>{this.toolbarView.maxWidth=Dd(.9*new Bh(e).width)})})}afterInit(){const t=this.editor.ui.componentFactory;this.toolbarView.fillFromConfig(this._balloonConfig.items,t)}_createToolbarView(){const t=!this._balloonConfig.shouldNotGroupWhenFull,e=new Nd(this.editor.locale,{shouldGroupWhenFull:t});return e.extendTemplate({attributes:{class:["ck-toolbar_floating"]}}),e.render(),e}show(){const t=this.editor;this._balloon.hasView(this.toolbarView)||t.model.document.selection.isCollapsed||Array.from(this.toolbarView.items).every(t=>void 0!==t.isEnabled&&!t.isEnabled)||(this.listenTo(this.editor.ui,"update",()=>{this._balloon.updatePosition(this._getBalloonPositionData())}),this._balloon.add({view:this.toolbarView,position:this._getBalloonPositionData(),balloonClassName:"ck-toolbar-container"}))}hide(){this._balloon.hasView(this.toolbarView)&&(this.stopListening(this.editor.ui,"update"),this._balloon.remove(this.toolbarView))}_getBalloonPositionData(){const t=this.editor.editing.view,e=t.document,n=e.selection,i=e.selection.isBackward;return{target:()=>{const e=i?n.getFirstRange():n.getLastRange(),s=Bh.getDomRangeRects(t.domConverter.viewRangeToDom(e));return i?s[0]:(s.length>1&&0===s[s.length-1].width&&s.pop(),s[s.length-1])},positions:Bd(i)}}destroy(){super.destroy(),this.stopListening(),this._fireSelectionChangeDebounced.cancel(),this.toolbarView.destroy(),this.focusTracker.destroy(),this._resizeObserver&&this._resizeObserver.destroy()}}function Bd(t){const e=$h.defaultPositions;return t?[e.northWestArrowSouth,e.northWestArrowSouthWest,e.northWestArrowSouthEast,e.northWestArrowSouthMiddleEast,e.northWestArrowSouthMiddleWest,e.southWestArrowNorth,e.southWestArrowNorthWest,e.southWestArrowNorthEast,e.southWestArrowNorthMiddleWest,e.southWestArrowNorthMiddleEast]:[e.southEastArrowNorth,e.southEastArrowNorthEast,e.southEastArrowNorthWest,e.southEastArrowNorthMiddleEast,e.southEastArrowNorthMiddleWest,e.northEastArrowSouth,e.northEastArrowSouthEast,e.northEastArrowSouthWest,e.northEastArrowSouthMiddleEast,e.northEastArrowSouthMiddleWest]}class Fd{constructor(t){this.editor=t,this._components=new Map}*names(){for(const t of this._components.values())yield t.originalName}add(t,e){if(this.has(t))throw new Rc.b("componentfactory-item-exists: The item already exists in the component factory.",this,{name:t});this._components.set(jd(t),{callback:e,originalName:t})}create(t){if(!this.has(t))throw new Rc.b("componentfactory-item-missing: The required component is not registered in the factory.",this,{name:t});return this._components.get(jd(t)).callback(this.editor.locale)}has(t){return this._components.has(jd(t))}}function jd(t){return String(t).toLowerCase()}class zd{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new un.b("focusTracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}xn(zd,io),xn(zd,qi);class qd{constructor(t){this.editor=t,this.componentFactory=new Fd(t),this.focusTracker=new zd,this._editableElementsMap=new Map,this.listenTo(t.editing.view.document,"layoutChanged",()=>this.update())}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const t of this._editableElementsMap.values())t.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(t,e){this._editableElementsMap.set(t,e),e.ckeditorInstance||(e.ckeditorInstance=this.editor)}getEditableElement(t="main"){return this._editableElementsMap.get(t)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}}xn(qd,pn);n(38);const Ud=new WeakMap;function Wd(t,e){return!!e.hasClass("ck-placeholder")&&(t.removeClass("ck-placeholder",e),!0)}function Hd(t,e){const n=Ud.get(t);let i=!1;for(const[t,s]of n)Kd(e,t,s)&&(i=!0);return i}function Kd(t,e,n){const{text:i,isDirectHost:s}=n,o=s?e:function(t){const e=t&&t.childCount;if(1===e&&"p"===t._children[0].name&&0===t._children[0].childCount){const n=t.getChild(e-1);if(n.is("element")&&!n.is("uiElement"))return n}return null}(e);let r=!1;return!!o&&(n.hostElement=o,o.getAttribute("data-placeholder")!==i&&(t.setAttribute("data-placeholder",i,o),r=!0),!function(t){const e=t.document;if(!e)return!1;const n=!Array.from(t.getChildren()).some(t=>!t.is("uiElement"));if(!e.isFocused&&n)return!0;const i=e.selection.anchor;return!(!n||!i||i.parent===t)}(o)?Wd(t,o)&&(r=!0):function(t,e){return!e.hasClass("ck-placeholder")&&(t.addClass("ck-placeholder",e),!0)}(t,o)&&(r=!0),r)}class Jd extends qd{constructor(t,e){super(t),this.view=e}get element(){return this.view.editable.element}init(){const t=this.editor,e=this.view,n=t.plugins.get("BalloonToolbar"),i=t.editing.view,s=e.editable,o=i.document.getRoot();s.name=o.rootName,e.render();const r=s.element;this.setEditableElement(s.name,r),this.focusTracker.add(r),s.bind("isFocused").to(this.focusTracker),i.attachDomRoot(r),function({origin:t,originKeystrokeHandler:e,originFocusTracker:n,toolbar:i,beforeFocus:s,afterBlur:o}){n.add(i.element),e.set("Alt+F10",(t,e)=>{n.isFocused&&!i.focusTracker.isFocused&&(s&&s(),i.focus(),e())}),i.keystrokes.set("Esc",(e,n)=>{i.focusTracker.isFocused&&(t.focus(),o&&o(),n())})}({origin:i,originFocusTracker:this.focusTracker,originKeystrokeHandler:t.keystrokes,toolbar:n.toolbarView,beforeFocus(){n.show()},afterBlur(){n.hide()}}),this._initPlaceholder(),this.fire("ready")}destroy(){const t=this.view;this.editor.editing.view.detachDomRoot(t.editable.name),t.destroy(),super.destroy()}_initPlaceholder(){const t=this.editor,e=t.editing.view,n=e.document.getRoot(),i=t.sourceElement,s=t.config.get("placeholder")||i&&"textarea"===i.tagName.toLowerCase()&&i.getAttribute("placeholder");s&&function(t){const{view:e,element:n,text:i,isDirectHost:s=!0}=t,o=e.document;Ud.has(o)||(Ud.set(o,new Map),o.registerPostFixer(t=>Hd(o,t))),Ud.get(o).set(n,{text:i,isDirectHost:s}),e.change(t=>Hd(o,t))}({view:e,element:n,text:s,isDirectHost:!1})}}var $d=function(t){return"string"==typeof t||!Lt(t)&&m(t)&&"[object String]"==f(t)};class Gd extends Zc{constructor(t,e=[]){super(e),this.locale=t}attachToDom(){this._bodyCollectionContainer=new th({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let t=document.querySelector(".ck-body-wrapper");t||(t=function(t,e,n={},i=[]){const s=n&&n.xmlns,o=s?t.createElementNS(s,e):t.createElement(e);for(const t in n)o.setAttribute(t,n[t]);!$d(i)&&Gc(i)||(i=[i]);for(let e of i)$d(e)&&(e=t.createTextNode(e)),o.appendChild(e);return o}(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(t)),t.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const t=document.querySelector(".ck-body-wrapper");t&&0==t.childElementCount&&t.remove()}}n(70);class Yd extends Ih{constructor(t){super(t),this.body=new Gd(t)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class Qd extends Ih{constructor(t,e,n){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:t.contentLanguage,dir:t.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=e}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const t=this._editingView;function e(e){t.change(n=>{const i=t.document.getRoot(e.name);n.addClass(e.isFocused?"ck-focused":"ck-blurred",i),n.removeClass(e.isFocused?"ck-blurred":"ck-focused",i)})}t.isRenderingInProgress?function n(i){t.once("change:isRenderingInProgress",(t,s,o)=>{o?n(i):e(i)})}(this):e(this)}}class Zd extends Qd{constructor(t,e,n){super(t,e,n),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const t=this._editingView,e=this.t;t.change(n=>{const i=t.document.getRoot(this.name);n.setAttribute("aria-label",e("Rich Text Editor, %0",[this.name]),i)})}}class Xd extends Yd{constructor(t,e,n){super(t),this.editable=new Zd(t,e,n)}render(){super.render(),this.registerChild(this.editable)}}var tu={setData(t){this.data.set(t)},getData(t){return this.data.get(t)}};var eu={updateSourceElement(){if(!this.sourceElement)throw new un.b("editor-missing-sourceelement: Cannot update the source element of a detached editor.",this);var t,e;t=this.sourceElement,e=this.data.get(),t instanceof HTMLTextAreaElement&&(t.value=e),t.innerHTML=e}};class nu extends kl{constructor(t,e){super(e),nn(t)&&(this.sourceElement=t,function(t){const e=t.sourceElement;if(e){if(e.ckeditorInstance)throw new un.b("editor-source-element-already-used: The DOM element cannot be used to create multiple editor instances.",t);e.ckeditorInstance=t,t.once("destroy",()=>{delete e.ckeditorInstance})}}(this));const n=this.config.get("plugins");n.push(Vd),this.config.set("plugins",n),this.config.define("balloonToolbar",this.config.get("toolbar")),this.data.processor=new Mc(this.data.viewDocument),this.model.document.createRoot();const i=new Xd(this.locale,this.editing.view,this.sourceElement);this.ui=new Jd(this,i),function(t){if(!F(t.updateSourceElement))throw new un.b("attachtoform-missing-elementapi-interface: Editor passed to attachToForm() must implement ElementApi.",t);const e=t.sourceElement;if(e&&"textarea"===e.tagName.toLowerCase()&&e.form){let n;const i=e.form,s=()=>t.updateSourceElement();F(i.submit)&&(n=i.submit,i.submit=()=>{s(),n.apply(i)}),i.addEventListener("submit",s),t.on("destroy",()=>{i.removeEventListener("submit",s),n&&(i.submit=n)})}}(this)}destroy(){const t=this.getData();return this.ui.destroy(),super.destroy().then(()=>{this.sourceElement&&function(t,e){t instanceof HTMLTextAreaElement&&(t.value=e),t.innerHTML=e}(this.sourceElement,t)})}static create(t,e={}){return new Promise(n=>{const i=nn(t);if(i&&"TEXTAREA"===t.tagName)throw new yl.a("editor-wrong-element: This type of editor cannot be initialized inside <textarea> element.",null);const s=new this(t,e);n(s.initPlugins().then(()=>{s.ui.init()}).then(()=>{if(!i&&e.initialData)throw new yl.a("editor-create-initial-data: The config.initialData option cannot be used together with initial data passed in Editor.create().",null);const n=e.initialData||function(t){return nn(t)?(e=t,e instanceof HTMLTextAreaElement?e.value:e.innerHTML):t;var e}(t);return s.data.init(n)}).then(()=>s.fire("ready")).then(()=>s))})}}function iu(t){return y(t)?function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t):new Map(t)}Ll(nu,tu),Ll(nu,eu);var su=n(15);function ou(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}n(32);class ru{constructor(t){this.parent=null,this._attrs=iu(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new su.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new su.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}get document(){return this.root==this?null:this.root.document||null}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=ou(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}_clone(){return new ru(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=iu(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}is(t){return"node"==t}}class au extends ru{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"text"==t||super.is(t)}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new au(this.data,this.getAttributes())}static fromJSON(t){return new au(t.data,t.attributes)}}class lu{constructor(t,e,n){if(this.textNode=t,e<0||e>t.offsetSize)throw new su.b("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.offsetSize)throw new su.b("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"==t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class cu{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new su.b("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new su.b("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const t of e)if(!(t instanceof ru))throw new su.b("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class hu extends ru{constructor(t,e,n){super(e),this.name=t,this._children=new cu,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?"element"==t&&e==this.name:"element"==t||t==this.name||super.is(t)}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new hu(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new au(t)];e=t,e&&e[Symbol.iterator]||(t=[t]);var e;return Array.from(t).map(t=>"string"==typeof t?new au(t):t instanceof lu?new au(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}static fromJSON(t){let e=null;if(t.children){e=[];for(const n of t.children)n.name?e.push(hu.fromJSON(n)):e.push(au.fromJSON(n))}return new hu(t.name,t.attributes,e)}}class du{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new su.b("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new su.b("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=fu._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,n,i,s;do{i=this.position,s=this._visitedParent,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const i=e.textNode?e.textNode:e.nodeAfter;if(i instanceof hu)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=i),this.position=e,uu("elementStart",i,t,e,1);if(i instanceof au){let s;if(this.singleCharacters)s=1;else{let t=i.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),s=t-e.offset}const o=e.offset-i.startOffset,r=new lu(i,o,s);return e.offset+=s,this.position=e,uu("text",r,t,e,s)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():uu("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const i=e.textNode?e.textNode:e.nodeBefore;if(i instanceof hu)return e.offset--,this.shallow?(this.position=e,uu("elementStart",i,t,e,1)):(e.path.push(i.maxOffset),this.position=e,this._visitedParent=i,this.ignoreElementEnd?this._previous():uu("elementEnd",i,t,e));if(i instanceof au){let s;if(this.singleCharacters)s=1;else{let t=i.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),s=e.offset-t}const o=e.offset-i.startOffset,r=new lu(i,o-s,s);return e.offset-=s,this.position=e,uu("text",r,t,e,s)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,uu("elementStart",n,t,e,1)}}function uu(t,e,n,i,s){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}class fu{constructor(t,e,n="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new su.b("model-position-root-invalid: Position root invalid.",t);if(!(e instanceof Array)||0===e.length)throw new su.b("model-position-path-incorrect: Position path must be an array with at least one item.",t,{path:e});e=t.getPath().concat(e),t=t.root,this.root=t,this.path=e,this.stickiness=n}get offset(){return ti(this.path)}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)t=t.getChild(t.offsetToIndex(this.path[e]));return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){const t=this.parent.getChild(this.index);return t instanceof au&&t.startOffset<this.offset?t:null}get nodeAfter(){return null===this.textNode?this.parent.getChild(this.index):null}get nodeBefore(){return null===this.textNode?this.parent.getChild(this.index-1):null}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=ou(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new du(e);return n.skip(t),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonPath(t){if(this.root!=t.root)return[];const e=ou(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}getShiftedBy(t){const e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,n=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=fu._createAt(this),n=fu._createAt(t);break;case"after":e=fu._createAt(t),n=fu._createAt(this);break;default:return!1}let i=e.parent;for(;e.path.length+n.path.length;){if(e.isEqual(n))return!0;if(e.path.length>n.path.length){if(e.offset!==i.maxOffset)return!1;e.path=e.path.slice(0,-1),i=i.parent,e.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}hasSameParentAs(t){if(this.root!==t.root)return!1;return"same"==ou(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=fu._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let n;return e.containsPosition(this)||e.start.isEqual(this)?(n=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(n=n._getTransformedByDeletion(t.deletionPosition,1))):n=this.isEqual(t.deletionPosition)?fu._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),n}_getTransformedByDeletion(t,e){const n=fu._createAt(this);if(this.root!=t.root)return n;if("same"==ou(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;n.offset-=e}}else if("prefix"==ou(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;if(t.offset<=this.path[i]){if(t.offset+e>this.path[i])return null;n.path[i]-=e}}return n}_getTransformedByInsertion(t,e){const n=fu._createAt(this);if(this.root!=t.root)return n;if("same"==ou(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=e);else if("prefix"==ou(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;t.offset<=this.path[i]&&(n.path[i]+=e)}return n}_getTransformedByMove(t,e,n){if(e=e._getTransformedByDeletion(t,n),t.isEqual(e))return fu._createAt(this);const i=this._getTransformedByDeletion(t,n);return null===i||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):i._getTransformedByInsertion(e,n)}_getCombined(t,e){const n=t.path.length-1,i=fu._createAt(e);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-t.offset,i.path=i.path.concat(this.path.slice(n+1)),i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,n="toNone"){if(t instanceof fu)return new fu(t.root,t.path,t.stickiness);{const i=t;if("end"==e)e=i.maxOffset;else{if("before"==e)return this._createBefore(i,n);if("after"==e)return this._createAfter(i,n);if(0!==e&&!e)throw new su.b("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,t])}if(!i.is("element")&&!i.is("documentFragment"))throw new su.b("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,t]);const s=i.getPath();return s.push(e),new this(i.root,s,n)}}static _createAfter(t,e){if(!t.parent)throw new su.b("model-position-after-root: You cannot make a position after root.",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new su.b("model-position-before-root: You cannot make a position before root.",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const n=new fu(e.graveyard,t.path);return n.stickiness=t.stickiness,n}if(!e.getRoot(t.root))throw new su.b("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",e,{rootName:t.root});return new fu(e.getRoot(t.root),t.path,t.stickiness)}}class gu{constructor(t,e=null){this.start=fu._createAt(t),this.end=e?fu._createAt(e):fu._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new du({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==ou(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}containsItem(t){const e=fu._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new gu(this.start,t.start)),this.containsPosition(t.end)&&e.push(new gu(t.end,this.end))):e.push(new gu(this.start,this.end)),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new gu(e,n)}return null}getMinimalFlatRanges(){const t=[],e=this.start.getCommonPath(this.end).length,n=fu._createAt(this.start);let i=n.parent;for(;n.path.length>e+1;){const e=i.maxOffset-n.offset;0!==e&&t.push(new gu(n,n.getShiftedBy(e))),n.path=n.path.slice(0,-1),n.offset++,i=i.parent}for(;n.path.length<=this.end.path.length;){const e=this.end.path[n.path.length-1],i=e-n.offset;0!==i&&t.push(new gu(n,n.getShiftedBy(i))),n.offset=e,n.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new du(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new du(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new du(t);yield e.position;for(const t of e)yield t.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new gu(this.start,this.end)]}getTransformedByOperations(t){const e=[new gu(this.start,this.end)];for(const n of t)for(let t=0;t<e.length;t++){const i=e[t].getTransformedByOperation(n);e.splice(t,1,...i),t+=i.length-1}for(let t=0;t<e.length;t++){const n=e[t];for(let i=t+1;i<e.length;i++){const t=e[i];(n.containsRange(t)||t.containsRange(n)||n.isEqual(t))&&e.splice(i,1)}}return e}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,e=!1){return this._getTransformedByInsertion(t.position,t.howMany,e)}_getTransformedByMoveOperation(t,e=!1){const n=t.sourcePosition,i=t.howMany,s=t.targetPosition;return this._getTransformedByMove(n,s,i,e)}_getTransformedBySplitOperation(t){const e=this.start._getTransformedBySplitOperation(t);let n=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(n=this.end.getShiftedBy(1)),e.root!=n.root&&(n=this.end.getShiftedBy(-1)),new gu(e,n)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new gu(this.start);let e=this.start._getTransformedByMergeOperation(t),n=this.end._getTransformedByMergeOperation(t);return e.root!=n.root&&(n=this.end.getShiftedBy(-1)),e.isAfter(n)?(t.sourcePosition.isBefore(t.targetPosition)?(e=fu._createAt(n),e.offset=0):(t.deletionPosition.isEqual(e)||(n=t.deletionPosition),e=t.targetPosition),new gu(e,n)):new gu(e,n)}_getTransformedByInsertion(t,e,n=!1){if(n&&this.containsPosition(t))return[new gu(this.start,t),new gu(t.getShiftedBy(e),this.end._getTransformedByInsertion(t,e))];{const n=new gu(this.start,this.end);return n.start=n.start._getTransformedByInsertion(t,e),n.end=n.end._getTransformedByInsertion(t,e),[n]}}_getTransformedByMove(t,e,n,i=!1){if(this.isCollapsed){const i=this.start._getTransformedByMove(t,e,n);return[new gu(i)]}const s=gu._createFromPositionAndShift(t,n),o=e._getTransformedByDeletion(t,n);if(this.containsPosition(e)&&!i&&(s.containsPosition(this.start)||s.containsPosition(this.end))){const i=this.start._getTransformedByMove(t,e,n),s=this.end._getTransformedByMove(t,e,n);return[new gu(i,s)]}let r;const a=this.getDifference(s);let l=null;const c=this.getIntersection(s);if(1==a.length?l=new gu(a[0].start._getTransformedByDeletion(t,n),a[0].end._getTransformedByDeletion(t,n)):2==a.length&&(l=new gu(this.start,this.end._getTransformedByDeletion(t,n))),r=l?l._getTransformedByInsertion(o,n,null!==c||i):[],c){const t=new gu(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,t):r.push(t)}return r}_getTransformedByDeletion(t,e){let n=this.start._getTransformedByDeletion(t,e),i=this.end._getTransformedByDeletion(t,e);return null==n&&null==i?null:(null==n&&(n=t),null==i&&(i=t),new gu(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return new this(fu._createAt(t,0),fu._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(fu._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(0===t.length)throw new su.b("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(1==t.length)return t[0].clone();const e=t[0];t.sort((t,e)=>t.start.isAfter(e.start)?1:-1);const n=t.indexOf(e),i=new this(e.start,e.end);if(n>0)for(let e=n-1;t[e].end.isEqual(i.start);e++)i.start=fu._createAt(t[e].start);for(let e=n+1;e<t.length&&t[e].start.isEqual(i.end);e++)i.end=fu._createAt(t[e].end);return i}static fromJSON(t,e){return new this(fu.fromJSON(t.start,e),fu.fromJSON(t.end,e))}}var pu=function(){return function t(){t.called=!0}};class mu{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=pu(),this.off=pu()}}function bu(){let t="e";for(let e=0;e<8;e++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}var wu={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};const _u=Symbol("listeningTo"),ku=Symbol("emitterId");var vu={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[_u]||(this[_u]={});const r=this[_u];xu(t)||yu(t);const a=xu(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Cu(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Eu(t,e),c=wu.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[_u];let s=t&&xu(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)Au(t,e,n);else if(r){for(;n=r.pop();)Au(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[_u]}},fire(t,...e){const n=t instanceof mu?t:new mu(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,Au(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Tu(t,n,e),s&&Tu(s,n,e)}return n.return},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function yu(t,e){t[ku]||(t[ku]=e||bu())}function xu(t){return t[ku]}function Cu(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Eu(t,e){const n=Cu(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Eu(t,n.childEvents[e]);i=i.concat(s)}return i}function Tu(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new mu(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function Au(t,e,n){const i=Eu(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function Pu(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class Su extends gu{constructor(t,e){super(t,e),Ou.call(this)}detach(){this.stopListening()}toRange(){return new gu(this.start,this.end)}static fromRange(t){return new Su(t.start,t.end)}}function Ou(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&Mu.call(this,n)},{priority:"low"})}function Mu(t){const e=this.getTransformedByOperation(t),n=gu._createFromRanges(e),i=!n.isEqual(this),s=function(t,e){switch(e.type){case"insert":return t.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return t.containsPosition(e.sourcePosition)||t.start.isEqual(e.sourcePosition)||t.containsPosition(e.targetPosition);case"split":return t.containsPosition(e.splitPosition)||t.containsPosition(e.insertionPosition)}return!1}(this,t);let o=null;if(i){"$graveyard"==n.root.rootName&&(o="remove"==t.type?t.sourcePosition:t.deletionPosition);const e=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",e,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}Pu(Su,vu);class Nu{static get pluginName(){return"BlockAutoformatEditing"}constructor(t,e,n){let i,s=null;"function"==typeof n?i=n:(s=t.commands.get(n),i=()=>{t.execute(n)}),t.model.document.on("change",(n,o)=>{if(s&&!s.isEnabled)return;if("transparent"==o.type)return;const r=Array.from(t.model.document.differ.getChanges()),a=r[0];if(1!=r.length||"insert"!==a.type||"$text"!=a.name||1!=a.length)return;const l=a.position.parent;if(!l.is("paragraph")||1!==l.childCount)return;const c=e.exec(l.getChild(0).data);c&&t.model.enqueueChange(t=>{const e=t.createPositionAt(l,0),n=t.createPositionAt(l,c[0].length),s=new Su(e,n);!1!==i({match:c})&&t.remove(s),s.detach()})})}}function Iu(t,e){let n=t.start;return{text:Array.from(t.getItems()).reduce((t,i)=>i.is("text")||i.is("textProxy")?t+i.data:(n=e.createPositionAfter(i),""),""),range:e.createRange(n,t.end)}}class Ru{static get pluginName(){return"InlineAutoformatEditing"}constructor(t,e,n){let i,s,o,r;e instanceof RegExp?i=e:o=e,"string"==typeof n?s=n:r=n,o=o||(t=>{let e;const n=[],s=[];for(;null!==(e=i.exec(t))&&!(e&&e.length<4);){let{index:t,1:i,2:o,3:r}=e;const a=i+o+r;t+=e[0].length-a.length;const l=[t,t+i.length],c=[t+i.length+o.length,t+i.length+o.length+r.length];n.push(l),n.push(c),s.push([t+i.length,t+i.length+o.length])}return{remove:n,format:s}}),r=r||((e,n)=>{const i=t.model.schema.getValidRanges(n,s);for(const t of i)e.setAttribute(s,!0,t);e.removeSelectionAttribute(s)}),t.model.document.on("change",(e,n)=>{if("transparent"==n.type)return;const i=t.model,s=i.document.selection;if(!s.isCollapsed)return;const a=Array.from(i.document.differ.getChanges()),l=a[0];if(1!=a.length||"insert"!==l.type||"$text"!=l.name||1!=l.length)return;const c=s.focus,h=c.parent,{text:d,range:u}=Iu(i.createRange(i.createPositionAt(h,0),c),i),f=o(d),g=Lu(u.start,f.format,i),p=Lu(u.start,f.remove,i);g.length&&p.length&&i.enqueueChange(t=>{if(!1!==r(t,g))for(const e of p.reverse())t.remove(e)})})}}function Lu(t,e,n){return e.filter(t=>void 0!==t[0]&&void 0!==t[1]).map(e=>n.createRange(t.getShiftedBy(e[0]),t.getShiftedBy(e[1])))}function Du(t,e){return(n,i)=>{if(!t.commands.get(e).isEnabled)return!1;const s=t.model.schema.getValidRanges(i,e);for(const t of s)n.setAttribute(e,!0,t);n.removeSelectionAttribute(e)}}class Vu{constructor(t){this.editor=t,this.set("value",void 0),this.set("isEnabled",!1),this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"}),this.listenTo(t,"change:isReadOnly",(t,e,n)=>{n?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})}refresh(){this.isEnabled=!0}forceDisabled(t){this._disableStack.add(t),1==this._disableStack.size&&(this.on("set:isEnabled",Bu,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),0==this._disableStack.size&&(this.off("set:isEnabled",Bu),this.refresh())}execute(){}destroy(){this.stopListening()}}function Bu(t){t.return=!1,t.stop()}function Fu(t){const e=t.next();return e.done?null:e.value}xn(Vu,qi);const ju=["left","right","center","justify"];function zu(t){return ju.includes(t)}function qu(t,e){return"rtl"==e.contentLanguageDirection?"right"===t:"left"===t}class Uu extends Vu{refresh(){const t=this.editor.locale,e=Fu(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!e&&this._canBeAligned(e),this.isEnabled&&e.hasAttribute("alignment")?this.value=e.getAttribute("alignment"):this.value="rtl"===t.contentLanguageDirection?"right":"left"}execute(t={}){const e=this.editor,n=e.locale,i=e.model,s=i.document,o=t.value;i.change(t=>{const e=Array.from(s.selection.getSelectedBlocks()).filter(t=>this._canBeAligned(t)),i=e[0].getAttribute("alignment");qu(o,n)||i===o||!o?function(t,e){for(const n of t)e.removeAttribute("alignment",n)}(e,t):function(t,e,n){for(const i of t)e.setAttribute("alignment",n,i)}(e,t,o)})}_canBeAligned(t){return this.editor.model.schema.checkAttribute(t,"alignment")}}class Wu extends Nc{static get pluginName(){return"AlignmentEditing"}constructor(t){super(t),t.config.define("alignment",{options:[...ju]})}init(){const t=this.editor,e=t.locale,n=t.model.schema,i=t.config.get("alignment.options").filter(zu);n.extend("$block",{allowAttributes:"alignment"}),t.model.schema.setAttributeProperties("alignment",{isFormatting:!0});const s=function(t){const e={model:{key:"alignment",values:t.slice()},view:{}};for(const n of t)e.view[n]={key:"style",value:{"text-align":n}};return e}(i.filter(t=>!qu(t,e)));t.conversion.attributeToAttribute(s),t.commands.add("alignment",new Uu(t))}}var Hu='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="t-left-a" d="M5,5 L14,5 C14.5522847,5 15,5.44771525 15,6 C15,6.55228475 14.5522847,7 14,7 L5,7 C4.44771525,7 4,6.55228475 4,6 C4,5.44771525 4.44771525,5 5,5 Z M5,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L5,11 C4.44771525,11 4,10.5522847 4,10 C4,9.44771525 4.44771525,9 5,9 Z M5,13 L15,13 C15.5522847,13 16,13.4477153 16,14 C16,14.5522847 15.5522847,15 15,15 L5,15 C4.44771525,15 4,14.5522847 4,14 C4,13.4477153 4.44771525,13 5,13 Z M5,17 L19,17 C19.5522847,17 20,17.4477153 20,18 C20,18.5522847 19.5522847,19 19,19 L5,19 C4.44771525,19 4,18.5522847 4,18 C4,17.4477153 4.44771525,17 5,17 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#t-left-a"/>\n  </g>\n</svg>\n';class Ku extends Ih{constructor(t,e,n){super(n),this.setTemplate({tag:t,children:e,attributes:{class:["ck","ck-dropdown__container"]}})}}function Ju(t,e){const n=t.toolbarView=new Nd;return e.map(t=>n.items.add(t)),n.items.delegate("execute").to(t),n}function $u(t,e){const n=t.locale,i=t.listView=new Cd(n);return i.items.bindTo(e).using(({type:t,model:e})=>{if("separator"===t)return new Td(n);if("button"===t||"switchbutton"===t){const i=new Ed(n);let s;return s="button"===t?new ld(n):new Ad(n),s.bind(...Object.keys(e)).to(e),s.delegate("execute").to(i),i.children.add(s),i}}),i.items.delegate("execute").to(t),i}const Gu=new Map([["left",Hu],["right",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="t-right-a" d="M10,5 L19,5 C19.5522847,5 20,5.44771525 20,6 C20,6.55228475 19.5522847,7 19,7 L10,7 C9.44771525,7 9,6.55228475 9,6 C9,5.44771525 9.44771525,5 10,5 Z M5,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L5,11 C4.44771525,11 4,10.5522847 4,10 C4,9.44771525 4.44771525,9 5,9 Z M9,13 L19,13 C19.5522847,13 20,13.4477153 20,14 C20,14.5522847 19.5522847,15 19,15 L9,15 C8.44771525,15 8,14.5522847 8,14 C8,13.4477153 8.44771525,13 9,13 Z M5,17 L19,17 C19.5522847,17 20,17.4477153 20,18 C20,18.5522847 19.5522847,19 19,19 L5,19 C4.44771525,19 4,18.5522847 4,18 C4,17.4477153 4.44771525,17 5,17 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#t-right-a"/>\n  </g>\n</svg>\n'],["center",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="t-centered-a" d="M9,5 L15,5 C15.5522847,5 16,5.44771525 16,6 C16,6.55228475 15.5522847,7 15,7 L9,7 C8.44771525,7 8,6.55228475 8,6 C8,5.44771525 8.44771525,5 9,5 Z M5,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L5,11 C4.44771525,11 4,10.5522847 4,10 C4,9.44771525 4.44771525,9 5,9 Z M7,13 L17,13 C17.5522847,13 18,13.4477153 18,14 C18,14.5522847 17.5522847,15 17,15 L7,15 C6.44771525,15 6,14.5522847 6,14 C6,13.4477153 6.44771525,13 7,13 Z M5,17 L19,17 C19.5522847,17 20,17.4477153 20,18 C20,18.5522847 19.5522847,19 19,19 L5,19 C4.44771525,19 4,18.5522847 4,18 C4,17.4477153 4.44771525,17 5,17 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#t-centered-a"/>\n  </g>\n</svg>\n'],["justify",'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>']]);class Yu extends Nc{get localizedOptionTitles(){return{left:"Выравнивание по левому краю",right:"Выравнивание по правому краю",center:"Выравнивание по центру",justify:(0,this.editor.t)("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const t=this.editor,e=t.ui.componentFactory,n=t.config.get("alignment.options");n.filter(zu).forEach(t=>this._addButton(t)),e.add("alignment",t=>{const i=Sd(t);i.set({panelPosition:"se"});const s=n.map(t=>e.create("alignment:"+t)),o=new Ku("div",[Ju(i,s)]);i.buttonView.set({label:"Выравнивание текста",tooltip:!0}),i.toolbarView.isVertical=!0,i.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});return i.buttonView.bind("icon").toMany(s,"isOn",(...t)=>{const e=t.findIndex(t=>t);return e<0?'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="t-left-a" d="M5,5 L14,5 C14.5522847,5 15,5.44771525 15,6 C15,6.55228475 14.5522847,7 14,7 L5,7 C4.44771525,7 4,6.55228475 4,6 C4,5.44771525 4.44771525,5 5,5 Z M5,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L5,11 C4.44771525,11 4,10.5522847 4,10 C4,9.44771525 4.44771525,9 5,9 Z M5,13 L15,13 C15.5522847,13 16,13.4477153 16,14 C16,14.5522847 15.5522847,15 15,15 L5,15 C4.44771525,15 4,14.5522847 4,14 C4,13.4477153 4.44771525,13 5,13 Z M5,17 L19,17 C19.5522847,17 20,17.4477153 20,18 C20,18.5522847 19.5522847,19 19,19 L5,19 C4.44771525,19 4,18.5522847 4,18 C4,17.4477153 4.44771525,17 5,17 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#t-left-a"/>\n  </g>\n</svg>\n':s[e].icon}),i.bind("isEnabled").toMany(s,"isEnabled",(...t)=>t.some(t=>t)),i.render(),i.panelView.children.add(o),i})}_addButton(t){const e=this.editor;e.ui.componentFactory.add("alignment:"+t,n=>{const i=e.commands.get("alignment"),s=new ld(n);return s.set({label:this.localizedOptionTitles[t],icon:Gu.get(t),tooltip:!0}),s.bind("isEnabled").to(i),s.bind("isOn").to(i,"value",e=>e===t),this.listenTo(s,"execute",()=>{e.execute("alignment",{value:t}),e.editing.view.focus()}),s})}}function Qu(t){const e=t.next();return e.done?null:e.value}class Zu extends Vu{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const e=this.editor.model,n=e.schema,i=e.document.selection,s=Array.from(i.getSelectedBlocks()),o=void 0===t.forceValue?!this.value:t.forceValue;e.change(t=>{if(o){const e=s.filter(t=>Xu(t)||ef(n,t));this._applyQuote(t,e)}else this._removeQuote(t,s.filter(Xu))})}_getValue(){const t=Qu(this.editor.model.document.selection.getSelectedBlocks());return!(!t||!Xu(t))}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.document.selection,e=this.editor.model.schema,n=Qu(t.getSelectedBlocks());return!!n&&ef(e,n)}_removeQuote(t,e){tf(t,e).reverse().forEach(e=>{if(e.start.isAtStart&&e.end.isAtEnd)return void t.unwrap(e.start.parent);if(e.start.isAtStart){const n=t.createPositionBefore(e.start.parent);return void t.move(e,n)}e.end.isAtEnd||t.split(e.end);const n=t.createPositionAfter(e.end.parent);t.move(e,n)})}_applyQuote(t,e){const n=[];tf(t,e).reverse().forEach(e=>{let i=Xu(e.start);i||(i=t.createElement("blockQuote"),t.wrap(e,i)),n.push(i)}),n.reverse().reduce((e,n)=>e.nextSibling==n?(t.merge(t.createPositionAfter(e)),e):n)}}function Xu(t){return"blockQuote"==t.parent.name?t.parent:null}function tf(t,e){let n,i=0;const s=[];for(;i<e.length;){const o=e[i],r=e[i+1];n||(n=t.createPositionBefore(o)),r&&o.nextSibling==r||(s.push(t.createRange(n,t.createPositionAfter(o))),n=null),i++}return s}function ef(t,e){const n=t.checkChild(e.parent,"blockQuote"),i=t.checkChild(["$root","blockQuote"],e);return n&&i}class nf extends Nc{static get pluginName(){return"BlockQuoteEditing"}init(){const t=this.editor,e=t.model.schema;t.commands.add("blockQuote",new Zu(t)),e.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),e.addChildCheck((t,e)=>{if(t.endsWith("blockQuote")&&"blockQuote"==e.name)return!1}),t.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),t.model.document.registerPostFixer(n=>{const i=t.model.document.differ.getChanges();for(const t of i)if("insert"==t.type){const i=t.position.nodeAfter;if(!i)continue;if(i.is("blockQuote")&&i.isEmpty)return n.remove(i),!0;if(i.is("blockQuote")&&!e.checkChild(t.position,i))return n.unwrap(i),!0;if(i.is("element")){const t=n.createRangeIn(i);for(const i of t.getItems())if(i.is("blockQuote")&&!e.checkChild(n.createPositionBefore(i),i))return n.unwrap(i),!0}}else if("remove"==t.type){const e=t.position.parent;if(e.is("blockQuote")&&e.isEmpty)return n.remove(e),!0}return!1})}afterInit(){const t=this.editor.commands.get("blockQuote");this.listenTo(this.editor.editing.view.document,"enter",(e,n)=>{const i=this.editor.model.document,s=i.selection.getLastPosition().parent;i.selection.isCollapsed&&s.isEmpty&&t.value&&(this.editor.execute("blockQuote"),this.editor.editing.view.scrollToTheSelection(),n.preventDefault(),e.stop())})}}n(72);class sf extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("blockQuote",n=>{const i=t.commands.get("blockQuote"),s=new ld(n);return s.set({label:e("Block quote"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="quote-a" d="M7.87745675,6 C6.28823378,6 5,7.32284848 5,8.95454545 C5,10.5864394 6.28823378,11.9090909 7.87745675,11.9090909 C10.7547161,11.9090909 8.83647742,17.6212121 5,17.6212121 L5,19 C11.8467642,19 14.5302062,6 7.87745675,6 Z M16.1669954,6 C14.5777724,6 13.2895386,7.32284848 13.2895386,8.95454545 C13.2895386,10.5864394 14.5777724,11.9090909 16.1669954,11.9090909 C19.0442548,11.9090909 17.126016,17.6212121 13.2895386,17.6212121 L13.2895386,19 C20.1363028,19 22.8197449,6 16.1669954,6 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use fill-rule="nonzero" xlink:href="#quote-a"/>\n  </g>\n</svg>\n',tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",()=>{t.execute("blockQuote"),t.editing.view.focus()}),s})}}class of extends Vu{constructor(t,e){super(t),this.attributeKey=e}refresh(){const t=this.editor.model,e=t.document;this.value=e.selection.getAttribute(this.attributeKey),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,this.attributeKey)}execute(t={}){const e=this.editor.model,n=e.document.selection,i=t.value;e.change(t=>{if(n.isCollapsed)i?t.setSelectionAttribute(this.attributeKey,i):t.removeSelectionAttribute(this.attributeKey);else{const s=e.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const e of s)i?t.setAttribute(this.attributeKey,i,e):t.removeAttribute(this.attributeKey,e)}})}}n(74);n(76);class rf extends Ih{constructor(t){super(t),this.set("text"),this.set("for"),this.id="ck-editor__label_"+Bc();const e=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:e.to("for")},children:[{text:e.to("text")}]})}}var af=function(){return function t(){t.called=!0}};class lf{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=af(),this.off=af()}}const cf=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function hf(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+cf[t>>0&255]+cf[t>>8&255]+cf[t>>16&255]+cf[t>>24&255]+cf[e>>0&255]+cf[e>>8&255]+cf[e>>16&255]+cf[e>>24&255]+cf[n>>0&255]+cf[n>>8&255]+cf[n>>16&255]+cf[n>>24&255]+cf[i>>0&255]+cf[i>>8&255]+cf[i>>16&255]+cf[i>>24&255]}var df={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},uf=(n(78),n(12));const ff=Symbol("listeningTo"),gf=Symbol("emitterId");var pf={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[ff]||(this[ff]={});const r=this[ff];bf(t)||mf(t);const a=bf(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=wf(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=_f(t,e),c=df.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[ff];let s=t&&bf(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)vf(t,e,n);else if(r){for(;n=r.pop();)vf(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[ff]}},fire(t,...e){try{const n=t instanceof lf?t:new lf(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,vf(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&kf(t,n,e),s&&kf(s,n,e)}return n.return}catch(t){uf.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function mf(t,e){t[gf]||(t[gf]=e||hf())}function bf(t){return t[gf]}function wf(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function _f(t,e){const n=wf(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=_f(t,n.childEvents[e]);i=i.concat(s)}return i}function kf(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new lf(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function vf(t,e,n){const i=_f(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function yf(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class xf{constructor(t={},e={}){const n=!(!(i=t)||!i[Symbol.iterator]);var i;if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new uf.a("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new uf.a("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new uf.a("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new uf.a("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new uf.a("collection-add-invalid-id",this);if(this.get(n))throw new uf.a("collection-add-item-already-exists",this)}else t[e]=n=hf();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}yf(xf,pf);const Cf=Symbol("observableProperties"),Ef=Symbol("boundObservables"),Tf=Symbol("boundProperties"),Af={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);Sf(this);const n=this[Cf];if(t in this&&!n.has(t))throw new uf.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!Nf(t))throw new uf.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new uf.a("observable-bind-duplicate-properties: Properties must be unique.",this);Sf(this);const e=this[Tf];t.forEach(t=>{if(e.has(t))throw new uf.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:Of,toMany:Mf,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Cf])return;const e=this[Tf],n=this[Ef];if(t.length){if(!Nf(t))throw new uf.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new uf.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(Af,pf);var Pf=Af;function Sf(t){t[Cf]||(Object.defineProperty(t,Cf,{value:new Map}),Object.defineProperty(t,Ef,{value:new Map}),Object.defineProperty(t,Tf,{value:new Map}))}function Of(...t){const e=function(...t){if(!t.length)throw new uf.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new uf.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new uf.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new uf.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new uf.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Ef];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{If(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Ef],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{If(this._observable,t)})}function Mf(t,e,n){if(this._bindings.size>1)throw new uf.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function Nf(t){return t.every(t=>"string"==typeof t)}function If(t,e){const n=t[Tf].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class Rf extends xf{constructor(t){super(t),this.set("isEmpty",!0)}add(t,e){this.find(e=>e.color===t.color)||(super.add(t,e),this.set("isEmpty",!1))}remove(t){const e=super.remove(t);return 0===this.length&&this.set("isEmpty",!0),e}hasColor(t){return!!this.find(e=>e.color===t)}}function Lf(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function Df(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}yf(Rf,Pf);var Vf=Vi({},pf,{listenTo(t,...e){if(Lf(t)||Df(t)){const n=this._getProxyEmitter(t)||new Bf(t);n.attach(...e),t=n}pf.listenTo.call(this,t,...e)},stopListening(t,e,n){if(Lf(t)||Df(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}pf.stopListening.call(this,t,e,n),t instanceof Bf&&t.detach(e)},_getProxyEmitter(t){return e=this,n=Ff(t),e[ff]&&e[ff][n]?e[ff][n].emitter:null;var e,n}});class Bf{constructor(t){mf(this,Ff(t)),this._domNode=t}}function Ff(t){return t["data-ck-expando"]||(t["data-ck-expando"]=hf())}Vi(Bf.prototype,pf,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class jf{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new uf.a("focusTracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}yf(jf,Vf),yf(jf,Pf);const zf=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(zf),function(t){t.match(/gecko\/\d+/)}(zf),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(zf),function(t){t.indexOf("android")}(zf),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();!function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e}();var qf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.636 9.531l-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>';n(79);function Uf(t,e){const n={model:{key:t,values:[]},view:{},upcastAlso:{}};for(const t of e)n.model.values.push(t.model),n.view[t.model]=t.view,t.upcastAlso&&(n.upcastAlso[t.model]=t.upcastAlso);return n}class Wf extends of{constructor(t){super(t,"fontSize")}}function Hf(t){return t.map(t=>function(t){if(e=t,"object"==typeof e&&e.title&&e.model&&e.view)return Jf(t);var e;const n=function(t){return Kf[t]||Kf[t.model]}(t);if(n)return Jf(n);if("default"===t)return{model:void 0,title:"Default"};if(function(t){let e;if("object"==typeof t){if(!t.model)throw new uf.a("font-size-invalid-definition: Provided font size definition is invalid.",null,t);e=parseFloat(t.model)}else e=parseFloat(t);return isNaN(e)}(t))return;return function(t){"number"!=typeof t&&"string"!=typeof t||(t={title:String(t),model:parseFloat(t)+"px"});return t.view={name:"span",styles:{"font-size":t.model}},Jf(t)}(t)}(t)).filter(t=>!!t)}const Kf={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function Jf(t){return t.view.priority||(t.view.priority=7),t}class $f extends Nc{static get pluginName(){return"FontSizeEditing"}constructor(t){super(t),t.config.define("fontSize",{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"fontSize"}),t.model.schema.setAttributeProperties("fontSize",{isFormatting:!0,copyOnEnter:!0});const e=t.config.get("fontSize.supportAllValues"),n=Uf("fontSize",Hf(this.editor.config.get("fontSize.options")).filter(t=>t.model));e?this._prepareAnyValueConverters(n):t.conversion.attributeToElement(n),t.commands.add("fontSize",new Wf(t))}_prepareAnyValueConverters(t){const e=this.editor,n=t.model.values.filter(t=>!String(t).match(/[\d.]+[\w%]+/));if(n.length)throw new uf.a("font-size-invalid-use-of-named-presets: If config.fontSize.supportAllValues is set to true, you need to use numerical values as font size options.",null,{presets:n});e.conversion.for("downcast").attributeToElement({model:"fontSize",view:(t,e)=>{if(t)return e.createAttributeElement("span",{style:"font-size:"+t},{priority:7})}}),e.conversion.for("upcast").attributeToAttribute({model:{key:"fontSize",value:t=>t.getStyle("font-size")},view:{name:"span"}})}}class Gf{constructor(t,e){e&&Vi(this,e),t&&this.set(t)}}Yc(Gf,Ah);n(81);class Yf extends Nc{init(){const t=this.editor,e=t.t,n=this._getLocalizedOptions(),i=t.commands.get("fontSize");t.ui.componentFactory.add("fontSize",s=>{const o=Sd(s);return Md(o,function(t,e){const n=new xf;for(const i of t){const t={type:"button",model:new Gf({commandName:"fontSize",commandParam:i.model,label:i.title,class:"ck-fontsize-option",withText:!0})};i.view&&i.view.styles&&t.model.set("labelStyle","font-size:"+i.view.styles["font-size"]),i.view&&i.view.classes&&t.model.set("class",`${t.model.class} ${i.view.classes}`),t.model.bind("isOn").to(e,"value",t=>t===i.model),n.add(t)}return n}(n,i)),o.buttonView.set({label:e("Font Size"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5L7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279l.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>',tooltip:!0}),o.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),o.bind("isEnabled").to(i),this.listenTo(o,"execute",e=>{t.execute(e.source.commandName,{value:e.source.commandParam}),t.editing.view.focus()}),o})}_getLocalizedOptions(){const t=this.editor,e=t.t,n={Default:e("Default"),Tiny:e("Tiny"),Small:e("Small"),Big:e("Big"),Huge:e("Huge")};return Hf(t.config.get("fontSize").options).map(t=>{const e=n[t.title];return e&&e!=t.title&&(t=Object.assign({},t,{title:e})),t})}}class Qf extends of{constructor(t){super(t,"fontFamily")}}function Zf(t){return t.map(Xf).filter(t=>!!t)}function Xf(t){return"object"==typeof t?t:"default"===t?{title:"Default",model:void 0}:"string"==typeof t?function(t){const e=t.replace(/"|'/g,"").split(","),n=e[0],i=e.map(tg).join(", ");return{title:n,model:n,view:{name:"span",styles:{"font-family":i},priority:7}}}(t):void 0}function tg(t){return(t=t.trim()).indexOf(" ")>0&&(t=`'${t}'`),t}class eg extends Nc{static get pluginName(){return"FontFamilyEditing"}constructor(t){super(t),t.config.define("fontFamily",{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"fontFamily"}),t.model.schema.setAttributeProperties("fontFamily",{isFormatting:!0,copyOnEnter:!0});const e=Uf("fontFamily",Zf(t.config.get("fontFamily.options")).filter(t=>t.model));t.config.get("fontFamily.supportAllValues")?this._prepareAnyValueConverters():t.conversion.attributeToElement(e),t.commands.add("fontFamily",new Qf(t))}_prepareAnyValueConverters(){const t=this.editor;t.conversion.for("downcast").attributeToElement({model:"fontFamily",view:(t,e)=>e.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),t.conversion.for("upcast").attributeToAttribute({model:{key:"fontFamily",value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}}class ng extends Nc{init(){const t=this.editor,e=t.t,n=this._getLocalizedOptions(),i=t.commands.get("fontFamily");t.ui.componentFactory.add("fontFamily",s=>{const o=Sd(s);return Md(o,function(t,e){const n=new xf;for(const i of t){const t={type:"button",model:new Gf({commandName:"fontFamily",commandParam:i.model,label:i.title,withText:!0})};t.model.bind("isOn").to(e,"value",t=>t===i.model||!(!t||!i.model)&&t.split(",")[0].replace(/'/g,"").toLowerCase()===i.model.toLowerCase()),i.view&&i.view.styles&&t.model.set("labelStyle","font-family: "+i.view.styles["font-family"]),n.add(t)}return n}(n,i)),o.buttonView.set({label:e("Font Family"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>',tooltip:!0}),o.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),o.bind("isEnabled").to(i),this.listenTo(o,"execute",e=>{t.execute(e.source.commandName,{value:e.source.commandParam}),t.editing.view.focus()}),o})}_getLocalizedOptions(){const t=this.editor,e=t.t;return Zf(t.config.get("fontFamily").options).map(t=>("Default"===t.title&&(t.title=e("Default")),t))}}class ig extends Vu{refresh(){const t=this.editor.model,e=t.document;this.value=e.selection.getAttribute("highlight"),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"highlight")}execute(t={}){const e=this.editor.model,n=e.document.selection,i=t.value;e.change(t=>{const s=e.schema.getValidRanges(n.getRanges(),"highlight");if(n.isCollapsed){const e=n.getFirstPosition();if(n.hasAttribute("highlight")){const n=t=>t.item.hasAttribute("highlight")&&t.item.getAttribute("highlight")===this.value,s=e.getLastMatchingPosition(n,{direction:"backward"}),o=e.getLastMatchingPosition(n),r=t.createRange(s,o);i&&this.value!==i?(t.setAttribute("highlight",i,r),t.setSelectionAttribute("highlight",i)):(t.removeAttribute("highlight",r),t.removeSelectionAttribute("highlight"))}else i&&t.setSelectionAttribute("highlight",i)}else for(const e of s)i?t.setAttribute("highlight",i,e):t.removeAttribute("highlight",e)})}}class sg extends Nc{static get pluginName(){return"HighlightEditing"}constructor(t){super(t),t.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"highlight"});const e=t.config.get("highlight.options");t.conversion.attributeToElement(function(t){const e={model:{key:"highlight",values:[]},view:{}};for(const n of t)e.model.values.push(n.model),e.view[n.model]={name:"mark",classes:n.class};return e}(e)),t.commands.add("highlight",new ig(t))}}n(83);class og extends Ih{constructor(t){super(t);const e=this.bindTemplate;this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new md,this.focusTracker=new cd,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",e.if("isVisible","ck-hidden",t=>!t),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(t,e)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),e())}),this.keystrokes.set("arrowleft",(t,e)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),e())})}focus(){this.actionView.focus()}_createActionView(){const t=new ld;return t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const t=new ld,e=t.bindTemplate;return t.icon=yd,t.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":e.to("isOn",t=>String(t))}}),t.bind("isEnabled").to(this),t.delegate("execute").to(this,"open"),t}}n(85);class rg extends Nc{get localizedOptionTitles(){const t=this.editor.t;return{"Yellow marker":t("Yellow marker"),"Green marker":t("Green marker"),"Pink marker":t("Pink marker"),"Blue marker":t("Blue marker"),"Red pen":t("Red pen"),"Green pen":t("Green pen")}}static get pluginName(){return"HighlightUI"}init(){const t=this.editor.config.get("highlight.options");for(const e of t)this._addHighlighterButton(e);this._addRemoveHighlightButton(),this._addDropdown(t)}_addRemoveHighlightButton(){const t=this.editor.t;this._addButton("removeHighlight",t("Remove highlight"),qf)}_addHighlighterButton(t){const e=this.editor.commands.get("highlight");this._addButton("highlight:"+t.model,t.title,ag(t.type),t.model,(function(n){n.bind("isEnabled").to(e,"isEnabled"),n.bind("isOn").to(e,"value",e=>e===t.model),n.iconView.fillColor=t.color,n.isToggleable=!0}))}_addButton(t,e,n,i,s=(()=>{})){const o=this.editor;o.ui.componentFactory.add(t,t=>{const r=new ld(t),a=this.localizedOptionTitles[e]?this.localizedOptionTitles[e]:e;return r.set({label:a,icon:n,tooltip:!0}),r.on("execute",()=>{o.execute("highlight",{value:i}),o.editing.view.focus()}),s(r),r})}_addDropdown(t){const e=this.editor,n=e.t,i=e.ui.componentFactory,s=t[0],o=t.reduce((t,e)=>(t[e.model]=e,t),{});i.add("highlight",r=>{const a=e.commands.get("highlight"),l=Sd(r,og),c=l.buttonView;c.set({tooltip:n("Highlight"),lastExecuted:s.model,commandValue:s.model,isToggleable:!0}),c.bind("icon").to(a,"value",t=>ag(d(t,"type"))),c.bind("color").to(a,"value",t=>d(t,"color")),c.bind("commandValue").to(a,"value",t=>d(t,"model")),c.bind("isOn").to(a,"value",t=>!!t),c.delegate("execute").to(l);const h=t.map(t=>{const e=i.create("highlight:"+t.model);return this.listenTo(e,"execute",()=>l.buttonView.set({lastExecuted:t.model})),e});function d(t,e){const n=t&&t!==c.lastExecuted?t:c.lastExecuted;return o[n][e]}return l.bind("isEnabled").toMany(h,"isEnabled",(...t)=>t.some(t=>t)),h.push(new bd),h.push(i.create("removeHighlight")),Od(l,h),function(t){t.buttonView.actionView.iconView.bind("fillColor").to(t.buttonView,"color")}(l),l.toolbarView.ariaLabel=n("Text highlight toolbar"),c.on("execute",()=>{e.execute("highlight",{value:c.commandValue}),e.editing.view.focus()}),l})}}function ag(t){return"marker"===t?'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.798 1.59L3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="M2.556 16.727l.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415l1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656l-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5L9.59 17h9.406v1.5H8.245z"/></svg>':'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268L2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="M4.5 18.088l-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166l-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5L9.59 17h9.406v1.5H8.245z"/></svg>'}n(87);const lg=Hh("px");class cg extends ld{constructor(t){super(t);const e=this.bindTemplate;this.isVisible=!1,this.isToggleable=!0,this.set("top",0),this.set("left",0),this.extendTemplate({attributes:{class:"ck-block-toolbar-button",style:{top:e.to("top",t=>lg(t)),left:e.to("left",t=>lg(t))}}})}}var hg={window:window,document:document};function dg(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}function ug(t){const e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}var fg=n(23);const gg=["top","right","bottom","left","width","height"];class pg{constructor(t){const e=(n=t,"[object Range]"==Object.prototype.toString.apply(n));var n;if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),nn(t)||e){const n=e?t.startContainer:t;n.ownerDocument&&n.ownerDocument.body.contains(n)||fg.a.warn("rect-source-not-in-dom: The source of this rect does not belong to any rendered DOM tree.",{source:t}),mg(this,e?pg.getDomRangeRects(t)[0]:t.getBoundingClientRect())}else if(dg(t)){const{innerWidth:e,innerHeight:n}=t;mg(this,{top:0,right:e,bottom:n,left:0,width:e,height:n})}else mg(this,t)}clone(){return new pg(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0?null:new pg(e)}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(!bg(t)){let n=t.parentNode||t.commonAncestorContainer;for(;n&&!bg(n);){const t=new pg(n),i=e.getIntersection(t);if(!i)return null;i.getArea()<e.getArea()&&(e=i),n=n.parentNode}}return e}isEqual(t){for(const e of gg)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!(!e||!e.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let e,n;if(dg(t))e=t.innerWidth-t.document.documentElement.clientWidth,n=t.innerHeight-t.document.documentElement.clientHeight;else{const i=ug(this._source);e=t.offsetWidth-t.clientWidth,n=t.offsetHeight-t.clientHeight,this.moveBy(i.left,i.top)}return this.width-=e,this.right-=e,this.height-=n,this.bottom-=n,this}static getDomRangeRects(t){const e=[],n=Array.from(t.getClientRects());if(n.length)for(const t of n)e.push(new pg(t));else{let n=t.startContainer;i=n,"[object Text]"==Object.prototype.toString.call(i)&&(n=n.parentNode);const s=new pg(n.getBoundingClientRect());s.right=s.left,s.width=0,e.push(s)}var i;return e}}function mg(t,e){for(const n of gg)t[n]=e[n]}function bg(t){return!!nn(t)&&t===t.ownerDocument.body}function wg({element:t,target:e,positions:n,limiter:i,fitInViewport:s}){F(e)&&(e=e()),F(i)&&(i=i());const o=function(t){for(;t&&"html"!=t.tagName.toLowerCase();){if("static"!=hg.window.getComputedStyle(t).position)return t;t=t.parentElement}return null}(t.parentElement),r=new pg(t),a=new pg(e);let l,c;if(i||s){const t=i&&new pg(i).getVisible(),e=s&&new pg(hg.window);[c,l]=function(t,e,n,i,s){let o,r,a=0,l=0;const c=n.getArea();return t.some(t=>{const[h,d]=_g(t,e,n);let u,f;if(i)if(s){const t=i.getIntersection(s);u=t?t.getIntersectionArea(d):0}else u=i.getIntersectionArea(d);function g(){l=f,a=u,o=d,r=h}return s&&(f=s.getIntersectionArea(d)),s&&!i?f>l&&g():!s&&i?u>a&&g():(f>l&&u>=a||f>=l&&u>a)&&g(),u===c}),o?[r,o]:null}(n,a,r,t,e)||_g(n[0],a,r)}else[c,l]=_g(n[0],a,r);let{left:h,top:d}=kg(l);if(o){const t=kg(new pg(o)),e=ug(o);h-=t.left,d-=t.top,h+=o.scrollLeft,d+=o.scrollTop,h-=e.left,d-=e.top}return{left:h,top:d,name:c}}function _g(t,e,n){const{left:i,top:s,name:o}=t(e,n);return[o,n.clone().moveTo(i,s)]}function kg({left:t,top:e}){const{scrollX:n,scrollY:i}=hg.window;return{left:t+n,top:e+i}}class vg extends Vu{constructor(t,e){super(t),this.attributeKey=e}refresh(){const t=this.editor.model,e=t.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,this.attributeKey)}execute(t={}){const e=this.editor.model,n=e.document.selection,i=void 0===t.forceValue?!this.value:t.forceValue;e.change(t=>{if(n.isCollapsed)i?t.setSelectionAttribute(this.attributeKey,!0):t.removeSelectionAttribute(this.attributeKey);else{const s=e.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const e of s)i?t.setAttribute(this.attributeKey,i,e):t.removeAttribute(this.attributeKey,e)}})}_getValueFromFirstAllowedNode(){const t=this.editor.model,e=t.schema,n=t.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const t of n.getRanges())for(const n of t.getItems())if(e.checkAttribute(n,this.attributeKey))return n.hasAttribute(this.attributeKey);return!1}}class yg extends Nc{static get pluginName(){return"BoldEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"bold"}),t.model.schema.setAttributeProperties("bold",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"bold",view:"strong",upcastAlso:["b",t=>{const e=t.getStyle("font-weight");return e?"bold"==e||Number(e)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),t.commands.add("bold",new vg(t,"bold")),t.keystrokes.set("CTRL+B","bold")}}class xg extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("bold",n=>{const i=t.commands.get("bold"),s=new ld(n);return s.set({label:e("Bold"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="bold-a" d="M14.8714735,11.1685233 C15.6330435,10.5590477 16.2961739,9.57810701 16.2961739,8.01003085 L16.2961739,7.96988256 C16.2961739,6.97315983 15.9825068,6.10749222 15.3638218,5.39687273 C15.3608721,5.3934604 15.3578224,5.39010137 15.3547727,5.38679567 C14.5174607,4.47954019 13.2645422,4 11.7314032,4 L7.44995275,4 C7.20142885,4 7,4.21481737 7,4.47986009 L7,18.5201399 C7,18.7851826 7.20142885,19 7.44995275,19 L11.9660286,19 C13.4351243,19 14.6805935,18.6153655 15.5678004,17.887631 C16.504752,17.1191084 17,16.0131375 17,14.6892035 L17,14.6490552 C17,13.0760738 16.2683768,11.8878336 14.8714735,11.1685233 Z M12.0021248,16.6162683 L9.3076077,16.6162683 L9.3076077,12.6217529 L11.7494513,12.6217529 C12.7360977,12.6217529 13.5162658,12.8110844 14.0056644,13.1693266 C14.4434684,13.4898199 14.6563461,13.9410483 14.6563461,14.5487644 L14.6563461,14.5888594 C14.6563461,16.4187259 12.800141,16.6162683 12.0021248,16.6162683 Z M11.4957279,10.2580154 L9.3076077,10.2580154 L9.3076077,6.38378499 L11.6051165,6.38378499 C13.0969098,6.38378499 13.95247,7.042313 13.95247,8.19051157 L13.95247,8.23060654 C13.95242,9.99462557 12.4132316,10.2580154 11.4957279,10.2580154 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use fill-rule="nonzero" xlink:href="#bold-a"/>\n  </g>\n</svg>\n',keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",()=>{t.execute("bold"),t.editing.view.focus()}),s})}}class Cg extends Nc{static get pluginName(){return"CKFinderUI"}init(){const t=this.editor,e=t.ui.componentFactory,n=t.t;e.add("ckfinder",e=>{const i=t.commands.get("ckfinder"),s=new ld(e);return s.set({label:n("Insert image or file"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',tooltip:!0}),s.bind("isEnabled").to(i),s.on("execute",()=>{t.execute("ckfinder"),t.editing.view.focus()}),s})}}var Eg=function(){return function t(){t.called=!0}};class Tg{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=Eg(),this.off=Eg()}}const Ag=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Pg(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Ag[t>>0&255]+Ag[t>>8&255]+Ag[t>>16&255]+Ag[t>>24&255]+Ag[e>>0&255]+Ag[e>>8&255]+Ag[e>>16&255]+Ag[e>>24&255]+Ag[n>>0&255]+Ag[n>>8&255]+Ag[n>>16&255]+Ag[n>>24&255]+Ag[i>>0&255]+Ag[i>>8&255]+Ag[i>>16&255]+Ag[i>>24&255]}var Sg={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},Og=(n(33),n(7));const Mg=Symbol("listeningTo"),Ng=Symbol("emitterId");var Ig={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Mg]||(this[Mg]={});const r=this[Mg];Lg(t)||Rg(t);const a=Lg(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Dg(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Vg(t,e),c=Sg.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Mg];let s=t&&Lg(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)Fg(t,e,n);else if(r){for(;n=r.pop();)Fg(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Mg]}},fire(t,...e){try{const n=t instanceof Tg?t:new Tg(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,Fg(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Bg(t,n,e),s&&Bg(s,n,e)}return n.return}catch(t){Og.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Rg(t,e){t[Ng]||(t[Ng]=e||Pg())}function Lg(t){return t[Ng]}function Dg(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Vg(t,e){const n=Dg(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Vg(t,n.childEvents[e]);i=i.concat(s)}return i}function Bg(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Tg(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function Fg(t,e,n){const i=Vg(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function jg(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function zg(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var qg=Vi({},Ig,{listenTo(t,...e){if(jg(t)||zg(t)){const n=this._getProxyEmitter(t)||new Ug(t);n.attach(...e),t=n}Ig.listenTo.call(this,t,...e)},stopListening(t,e,n){if(jg(t)||zg(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}Ig.stopListening.call(this,t,e,n),t instanceof Ug&&t.detach(e)},_getProxyEmitter(t){return e=this,n=Wg(t),e[Mg]&&e[Mg][n]?e[Mg][n].emitter:null;var e,n}});class Ug{constructor(t){Rg(this,Wg(t)),this._domNode=t}}function Wg(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Pg())}function Hg(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}Vi(Ug.prototype,Ig,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class Kg{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}Hg(Kg,qg);class Jg extends Kg{observe(t){this.listenTo(t,"load",(t,e)=>{"IMG"==e.target.tagName&&this._fireEvents(e)},{useCapture:!0})}_fireEvents(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}}function $g(t){const e=t.next();return e.done?null:e.value}var Gg=function(){return function t(){t.called=!0}};class Yg{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=Gg(),this.off=Gg()}}const Qg=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Zg(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Qg[t>>0&255]+Qg[t>>8&255]+Qg[t>>16&255]+Qg[t>>24&255]+Qg[e>>0&255]+Qg[e>>8&255]+Qg[e>>16&255]+Qg[e>>24&255]+Qg[n>>0&255]+Qg[n>>8&255]+Qg[n>>16&255]+Qg[n>>24&255]+Qg[i>>0&255]+Qg[i>>8&255]+Qg[i>>16&255]+Qg[i>>24&255]}var Xg={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},tp=(n(89),n(22));const ep=Symbol("listeningTo"),np=Symbol("emitterId");var ip={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[ep]||(this[ep]={});const r=this[ep];op(t)||sp(t);const a=op(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=rp(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=ap(t,e),c=Xg.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[ep];let s=t&&op(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)cp(t,e,n);else if(r){for(;n=r.pop();)cp(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[ep]}},fire(t,...e){try{const n=t instanceof Yg?t:new Yg(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,cp(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&lp(t,n,e),s&&lp(s,n,e)}return n.return}catch(t){tp.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function sp(t,e){t[np]||(t[np]=e||Zg())}function op(t){return t[np]}function rp(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function ap(t,e){const n=rp(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=ap(t,n.childEvents[e]);i=i.concat(s)}return i}function lp(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Yg(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function cp(t,e,n){const i=ap(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function hp(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class dp{constructor(){this._stack=[]}add(t,e){const n=this._stack,i=n[0];this._insertDescriptor(t);const s=n[0];i===s||up(i,s)||this.fire("change:top",{oldDescriptor:i,newDescriptor:s,writer:e})}remove(t,e){const n=this._stack,i=n[0];this._removeDescriptor(t);const s=n[0];i===s||up(i,s)||this.fire("change:top",{oldDescriptor:i,newDescriptor:s,writer:e})}_insertDescriptor(t){const e=this._stack,n=e.findIndex(e=>e.id===t.id);if(up(t,e[n]))return;n>-1&&e.splice(n,1);let i=0;for(;e[i]&&fp(e[i],t);)i++;e.splice(i,0,t)}_removeDescriptor(t){const e=this._stack,n=e.findIndex(e=>e.id===t);n>-1&&e.splice(n,1)}}function up(t,e){return t&&e&&t.priority==e.priority&&gp(t.classes)==gp(e.classes)}function fp(t,e){return t.priority>e.priority||!(t.priority<e.priority)&&gp(t.classes)>gp(e.classes)}function gp(t){return Array.isArray(t)?t.sort().join(","):t}function pp(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}hp(dp,ip);const mp=["top","right","bottom","left","width","height"];class bp{constructor(t){const e=(n=t,"[object Range]"==Object.prototype.toString.apply(n));var n;if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),nn(t)||e)wp(this,e?bp.getDomRangeRects(t)[0]:t.getBoundingClientRect());else if(pp(t)){const{innerWidth:e,innerHeight:n}=t;wp(this,{top:0,right:e,bottom:n,left:0,width:e,height:n})}else wp(this,t)}clone(){return new bp(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0?null:new bp(e)}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(!_p(t)){let n=t.parentNode||t.commonAncestorContainer;for(;n&&!_p(n);){const t=new bp(n),i=e.getIntersection(t);if(!i)return null;i.getArea()<e.getArea()&&(e=i),n=n.parentNode}}return e}isEqual(t){for(const e of mp)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!(!e||!e.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let e,n,i;if(pp(t))e=t.innerWidth-t.document.documentElement.clientWidth,n=t.innerHeight-t.document.documentElement.clientHeight,i=t.getComputedStyle(t.document.documentElement).direction;else{const s=function(t){const e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}(this._source);e=t.offsetWidth-t.clientWidth-s.left-s.right,n=t.offsetHeight-t.clientHeight-s.top-s.bottom,i=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=s.left,this.top+=s.top,this.right-=s.right,this.bottom-=s.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,"ltr"===i?this.right-=e:this.left+=e,this.height-=n,this.bottom-=n,this}static getDomRangeRects(t){const e=[],n=Array.from(t.getClientRects());if(n.length)for(const t of n)e.push(new bp(t));else{let n=t.startContainer;i=n,"[object Text]"==Object.prototype.toString.call(i)&&(n=n.parentNode);const s=new bp(n.getBoundingClientRect());s.right=s.left,s.width=0,e.push(s)}var i;return e}}function wp(t,e){for(const n of mp)t[n]=e[n]}function _p(t){return!!nn(t)&&t===t.ownerDocument.body}var kp={window:window,document:document};function vp(t){return!!t.is("element")&&!!t.getCustomProperty("widget")}function yp(t,e,n={}){return e.setAttribute("contenteditable","false",t),e.addClass("ck-widget",t),e.setCustomProperty("widget",!0,t),t.getFillerOffset=Ap,n.label&&function(t,e,n){n.setCustomProperty("widgetLabel",e,t)}(t,n.label,e),n.hasSelectionHandle&&function(t,e){const n=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(t){const e=this.toDomElement(t),n=new Zh;return n.set("content",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>'),n.render(),e.appendChild(n.element),e}));e.insert(e.createPositionAt(t,0),n),e.addClass(["ck-widget_with-selection-handle"],t)}(t,e),function(t,e,n,i){const s=new dp;s.on("change:top",(e,s)=>{s.oldDescriptor&&i(t,s.oldDescriptor,s.writer),s.newDescriptor&&n(t,s.newDescriptor,s.writer)}),e.setCustomProperty("addHighlight",(t,e,n)=>s.add(e,n),t),e.setCustomProperty("removeHighlight",(t,e,n)=>s.remove(e,n),t)}(t,e,(t,e,n)=>n.addClass(i(e.classes),t),(t,e,n)=>n.removeClass(i(e.classes),t)),t;function i(t){return Array.isArray(t)?t:[t]}}function xp(t){const e=t.getCustomProperty("widgetLabel");return e?"function"==typeof e?e():e:""}function Cp(t,e){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],t),e.setAttribute("contenteditable",t.isReadOnly?"false":"true",t),t.on("change:isReadOnly",(n,i,s)=>{e.setAttribute("contenteditable",s?"false":"true",t)}),t.on("change:isFocused",(n,i,s)=>{s?e.addClass("ck-editor__nested-editable_focused",t):e.removeClass("ck-editor__nested-editable_focused",t)}),t}function Ep(t,e){const n=t.getSelectedElement();if(n&&e.schema.isBlock(n))return e.createPositionAfter(n);const i=t.getSelectedBlocks().next().value;if(i){if(i.isEmpty)return e.createPositionAt(i,0);const n=e.createPositionAfter(i);return t.focus.isTouching(n)?n:e.createPositionBefore(i)}return t.focus}function Tp(t,e){const n=new bp(kp.window),i=n.getIntersection(t),s=e.height+$h.arrowVerticalOffset;if(t.top-s>n.top||t.bottom+s<n.bottom)return null;const o=i||t,r=o.left+o.width/2-e.width/2;return{top:Math.max(t.top,0)+$h.arrowVerticalOffset,left:r,name:"arrow_n"}}function Ap(){return null}function Pp(t){const e=t.getSelectedElement();return e&&function(t){return!!t.getCustomProperty("image")&&vp(t)}(e)?e:null}function Sp(t){return!!t&&t.is("image")}function Op(t,e,n={}){const i=t.createElement("image",n),s=Ep(e.document.selection,e);e.insertContent(i,s),i.parent&&t.setSelection(i,"on")}function Mp(t){const e=t.schema,n=t.document.selection;return function(t,e,n){const i=function(t,e){const n=Ep(t,e).parent;if(n.isEmpty&&!n.is("$root"))return n.parent;return n}(t,n);return e.checkChild(i,"image")}(n,e,t)&&!function(t,e){const n=t.getSelectedElement();return n&&e.isObject(n)}(n,e)&&function(t){return[...t.focus.getAncestors()].every(t=>!t.is("image"))}(n)}function Np(t){return Array.from(t.getChildren()).find(t=>t.is("img"))}function Ip(t){return n=>{n.on(`attribute:${t}:image`,e)};function e(t,e,n){if(!n.consumable.consume(e.item,t.name))return;const i=n.writer,s=Np(n.mapper.toViewElement(e.item));null!==e.attributeNewValue?i.setAttribute(e.attributeKey,e.attributeNewValue,s):i.removeAttribute(e.attributeKey,s)}}class Rp extends Vu{refresh(){this.isEnabled=Mp(this.editor.model)}execute(t){const e=this.editor.model;e.change(n=>{const i=Array.isArray(t.source)?t.source:[t.source];for(const t of i)Op(n,e,{src:t})})}}class Lp extends Nc{init(){const t=this.editor,e=t.model.schema,n=t.t,i=t.conversion;t.editing.view.addObserver(Jg),e.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),i.for("dataDowncast").elementToElement({model:"image",view:(t,e)=>Dp(e)}),i.for("editingDowncast").elementToElement({model:"image",view:(t,e)=>{return i=Dp(e),s=e,o=n("image widget"),s.setCustomProperty("image",!0,i),yp(i,s,{label:function(){const t=Np(i).getAttribute("alt");return t?`${t} ${o}`:o}});var i,s,o}}),i.for("downcast").add(Ip("src")).add(Ip("alt")).add(function(){return e=>{e.on("attribute:srcset:image",t)};function t(t,e,n){if(!n.consumable.consume(e.item,t.name))return;const i=n.writer,s=Np(n.mapper.toViewElement(e.item));if(null===e.attributeNewValue){const t=e.attributeOldValue;t.data&&(i.removeAttribute("srcset",s),i.removeAttribute("sizes",s),t.width&&i.removeAttribute("width",s))}else{const t=e.attributeNewValue;t.data&&(i.setAttribute("srcset",t.data,s),i.setAttribute("sizes","100vw",s),t.width&&i.setAttribute("width",t.width,s))}}}()),i.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(t,e)=>e.createElement("image",{src:t.getAttribute("src")})}).attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:t=>{const e={data:t.getAttribute("srcset")};return t.hasAttribute("width")&&(e.width=t.getAttribute("width")),e}}}).add(function(){return e=>{e.on("element:figure",t)};function t(t,e,n){if(!n.consumable.test(e.viewItem,{name:!0,classes:"image"}))return;const i=Np(e.viewItem);if(!i||!i.hasAttribute("src")||!n.consumable.test(i,{name:!0}))return;const s=n.convertItem(i,e.modelCursor),o=$g(s.modelRange.getItems());o&&(n.convertChildren(e.viewItem,n.writer.createPositionAt(o,0)),e.modelRange=s.modelRange,e.modelCursor=s.modelCursor)}}()),t.commands.add("imageInsert",new Rp(t))}}function Dp(t){const e=t.createEmptyElement("img"),n=t.createContainerElement("figure",{class:"ck-content__image"});return t.insert(t.createPositionAt(n,0),e),n}function Vp(t,e,n){return n.createRange(Bp(t,e,!0,n),Bp(t,e,!1,n))}function Bp(t,e,n,i){let s=t.textNode||(n?t.nodeBefore:t.nodeAfter),o=null;for(;s&&s.getAttribute("linkHref")==e;)o=s,s=n?s.previousSibling:s.nextSibling;return o?i.createPositionAt(o,n?"before":"after"):t}function Fp(t){return!(!t||!t[Symbol.iterator])}function jp(t){return Fp(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}var zp=function(){return function t(){t.called=!0}};class qp{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=zp(),this.off=zp()}}const Up=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Wp(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Up[t>>0&255]+Up[t>>8&255]+Up[t>>16&255]+Up[t>>24&255]+Up[e>>0&255]+Up[e>>8&255]+Up[e>>16&255]+Up[e>>24&255]+Up[n>>0&255]+Up[n>>8&255]+Up[n>>16&255]+Up[n>>24&255]+Up[i>>0&255]+Up[i>>8&255]+Up[i>>16&255]+Up[i>>24&255]}var Hp={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},Kp=(n(90),n(19));const Jp=Symbol("listeningTo"),$p=Symbol("emitterId");var Gp={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Jp]||(this[Jp]={});const r=this[Jp];Yp(t)||function(t,e){t[$p]||(t[$p]=e||Wp())}(t);const a=Yp(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Qp(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Zp(t,e),c=Hp.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Jp];let s=t&&Yp(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)tm(t,e,n);else if(r){for(;n=r.pop();)tm(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Jp]}},fire(t,...e){try{const n=t instanceof qp?t:new qp(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,tm(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Xp(t,n,e),s&&Xp(s,n,e)}return n.return}catch(t){Kp.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Yp(t){return t[$p]}function Qp(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Zp(t,e){const n=Qp(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Zp(t,n.childEvents[e]);i=i.concat(s)}return i}function Xp(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new qp(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function tm(t,e,n){const i=Zp(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}class em{constructor(t={},e={}){const n=Fp(t);if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new Kp.a("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new Kp.a("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new Kp.a("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new Kp.a("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new Kp.a("collection-add-invalid-id",this);if(this.get(n))throw new Kp.a("collection-add-item-already-exists",this)}else t[e]=n=Wp();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}!function(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}(em,Gp);class nm extends Vu{constructor(t){super(t),this.manualDecorators=new em}restoreManualDecoratorStates(){for(const t of this.manualDecorators)t.value=this._getDecoratorStateFromModel(t.id)}refresh(){const t=this.editor.model,e=t.document;this.value=e.selection.getAttribute("linkHref");for(const t of this.manualDecorators)t.value=this._getDecoratorStateFromModel(t.id);this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"linkHref")}execute(t,e={}){const n=this.editor.model,i=n.document.selection,s=[],o=[];for(const t in e)e[t]?s.push(t):o.push(t);n.change(e=>{if(i.isCollapsed){const r=i.getFirstPosition();if(i.hasAttribute("linkHref")){const a=Vp(r,i.getAttribute("linkHref"),n);e.setAttribute("linkHref",t,a),s.forEach(t=>{e.setAttribute(t,!0,a)}),o.forEach(t=>{e.removeAttribute(t,a)}),e.setSelection(a)}else if(""!==t){const o=jp(i.getAttributes());o.set("linkHref",t),s.forEach(t=>{o.set(t,!0)});const a=e.createText(t,o);n.insertContent(a,r),e.setSelection(e.createRangeOn(a))}}else{const r=n.schema.getValidRanges(i.getRanges(),"linkHref");for(const n of r)e.setAttribute("linkHref",t,n),s.forEach(t=>{e.setAttribute(t,!0,n)}),o.forEach(t=>{e.removeAttribute(t,n)})}})}_getDecoratorStateFromModel(t){return this.editor.model.document.selection.getAttribute(t)}}class im extends Vu{refresh(){this.isEnabled=this.editor.model.document.selection.hasAttribute("linkHref")}execute(){const t=this.editor,e=this.editor.model,n=e.document.selection,i=t.commands.get("link");e.change(t=>{const s=n.isCollapsed?[Vp(n.getFirstPosition(),n.getAttribute("linkHref"),e)]:n.getRanges();for(const e of s)if(t.removeAttribute("linkHref",e),i)for(const n of i.manualDecorators)t.removeAttribute(n.id,e)})}}const sm=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(sm),function(t){t.match(/edge\/(\d+.?\d*)/)}(sm),function(t){t.match(/gecko\/\d+/)}(sm),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(sm),function(t){t.indexOf("android")}(sm);const om=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();class rm{constructor(t,e,n){this.model=t,this.attribute=n,this._modelSelection=t.document.selection,this._overrideUid=null,this._isNextGravityRestorationSkipped=!1,e.listenTo(this._modelSelection,"change:range",(t,e)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!e.directChange&&am(this._modelSelection.getFirstPosition(),n)||this._restoreGravity())})}handleForwardMovement(t,e){const n=this.attribute;if(!(this._isGravityOverridden||t.isAtStart&&this._hasSelectionAttribute))return hm(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._removeSelectionAttribute(),!0):lm(t,n)||cm(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._overrideGravity(),!0):void 0}handleBackwardMovement(t,e){const n=this.attribute;return this._isGravityOverridden?hm(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._restoreGravity(),this._removeSelectionAttribute(),!0):(this._preventCaretMovement(e),this._restoreGravity(),t.isAtStart&&this._removeSelectionAttribute(),!0):hm(t,n)&&!this._hasSelectionAttribute?(this._preventCaretMovement(e),this._setSelectionAttributeFromTheNodeBefore(t),!0):t.isAtEnd&&cm(t,n)?this._hasSelectionAttribute?void(dm(t,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity())):(this._preventCaretMovement(e),this._setSelectionAttributeFromTheNodeBefore(t),!0):t.isAtStart?this._hasSelectionAttribute?(this._removeSelectionAttribute(),this._preventCaretMovement(e),!0):void 0:void(dm(t,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity()))}get _isGravityOverridden(){return!!this._overrideUid}get _hasSelectionAttribute(){return this._modelSelection.hasAttribute(this.attribute)}_overrideGravity(){this._overrideUid=this.model.change(t=>t.overrideSelectionGravity())}_restoreGravity(){this.model.change(t=>{t.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}_preventCaretMovement(t){t.preventDefault()}_removeSelectionAttribute(){this.model.change(t=>{t.removeSelectionAttribute(this.attribute)})}_setSelectionAttributeFromTheNodeBefore(t){const e=this.attribute;this.model.change(n=>{n.setSelectionAttribute(this.attribute,t.nodeBefore.getAttribute(e))})}_skipNextAutomaticGravityRestoration(){this._isNextGravityRestorationSkipped=!0}}function am(t,e){return lm(t,e)||cm(t,e)}function lm(t,e){const{nodeBefore:n,nodeAfter:i}=t,s=!!n&&n.hasAttribute(e);return!!i&&i.hasAttribute(e)&&(!s||n.getAttribute(e)!==i.getAttribute(e))}function cm(t,e){const{nodeBefore:n,nodeAfter:i}=t,s=!!n&&n.hasAttribute(e),o=!!i&&i.hasAttribute(e);return s&&(!o||n.getAttribute(e)!==i.getAttribute(e))}function hm(t,e){const{nodeBefore:n,nodeAfter:i}=t,s=!!n&&n.hasAttribute(e);if(!!i&&i.hasAttribute(e)&&s)return i.getAttribute(e)!==n.getAttribute(e)}function dm(t,e){return am(t.getShiftedBy(-1),e)}var um=function(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:ii(t,e,n)},fm=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var gm=function(t){return fm.test(t)};var pm=function(t){return t.split("")},mm="[\\ud800-\\udfff]",bm="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",wm="\\ud83c[\\udffb-\\udfff]",_m="[^\\ud800-\\udfff]",km="(?:\\ud83c[\\udde6-\\uddff]){2}",vm="[\\ud800-\\udbff][\\udc00-\\udfff]",ym="(?:"+bm+"|"+wm+")"+"?",xm="[\\ufe0e\\ufe0f]?"+ym+("(?:\\u200d(?:"+[_m,km,vm].join("|")+")[\\ufe0e\\ufe0f]?"+ym+")*"),Cm="(?:"+[_m+bm+"?",bm,km,vm,mm].join("|")+")",Em=RegExp(wm+"(?="+wm+")|"+Cm+xm,"g");var Tm=function(t){return t.match(Em)||[]};var Am=function(t){return gm(t)?Tm(t):pm(t)};Pm="toUpperCase";var Pm;const Sm=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Om=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;function Mm(t,e){const n=e.createAttributeElement("a",{href:t},{priority:5});return e.setCustomProperty("link",!0,n),n}function Nm(t){return function(t){return t.replace(Sm,"").match(Om)}(t=String(t))?t:"#"}n(91);class Im extends Nc{init(){const t=this.editor;var e,n;this._defineSchema(),this._defineConversions(),t.editing.mapper.on("viewToModelPosition",(e=this.editor.model,n=t=>t.hasClass("ck-link"),(t,i)=>{const{mapper:s,viewPosition:o}=i,r=s.findMappedViewAncestor(o);if(!n(r))return;const a=s.toModelElement(r);i.modelPosition=e.createPositionAt(a,o.isAtStart?"before":"after")})),t.commands.add("link",new nm(t)),t.commands.add("unlink",new im(t)),function(t,e,n,i){const s=new rm(e,n,i),o=e.document.selection;n.listenTo(t.document,"keydown",(t,e)=>{if(!o.isCollapsed)return;if(e.shiftKey||e.altKey||e.ctrlKey)return;const n=e.keyCode==om.arrowright,i=e.keyCode==om.arrowleft;if(!n&&!i)return;const r=o.getFirstPosition();let a;a=n?s.handleForwardMovement(r,e):s.handleBackwardMovement(r,e),a&&t.stop()},{priority:wu.get("high")+1})}(t.editing.view,t.model,this,"linkHref"),this._setupLinkHighlight()}_setupLinkHighlight(){const t=this.editor,e=t.editing.view,n=new Set;e.document.registerPostFixer(e=>{const i=t.model.document.selection;if(i.hasAttribute("linkHref")){const s=Vp(i.getFirstPosition(),i.getAttribute("linkHref"),t.model),o=t.editing.mapper.toViewRange(s);for(const t of o.getItems())t.is("a")&&(e.addClass("ck-link_selected",t),n.add(t))}}),t.conversion.for("editingDowncast").add(t=>{function i(){e.change(t=>{for(const e of n.values())t.removeClass("ck-link_selected",e),n.delete(e)})}t.on("insert",i,{priority:"highest"}),t.on("remove",i,{priority:"highest"}),t.on("attribute",i,{priority:"highest"}),t.on("selection",i,{priority:"highest"})})}_defineSchema(){const t=this.editor.model.schema;t.extend("$text",{allowAttributes:"linkHref"}),t.register("preview",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url","routerLink","linkHref","info","href"]}),t.register("previewLinkTitle",{isLimit:!0,allowIn:"previewLinkContainer",allowContentOf:"$block",allowAttributes:["text"]}),t.register("previewLinkDescription",{isLimit:!0,allowIn:"previewLinkContainer",allowContentOf:"$block",allowAttributes:["text"]}),t.register("previewLinkUrl",{isLimit:!0,allowIn:"previewLinkContainer",allowContentOf:"$block",allowAttributes:["href"]}),t.register("previewLinkImage",{isLimit:!0,allowIn:"preview",allowAttributes:["src","src"]}),t.register("previewLinkContainer",{isLimit:!0,allowIn:"preview",allowAttributes:[]})}_defineConversions(){const t=this.editor.conversion;t.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:t=>t.getAttribute("href")}}).elementToElement({model:"preview",view:{name:"section",classes:"ck-link"}}),t.for("dataDowncast").attributeToElement({model:"linkHref",view:(t,e)=>{const n=Mm(t,e);return e.setAttribute("donotparse",!0,n),n}}).elementToElement({model:"preview",view:{name:"section",classes:"ck-link"}}),t.for("editingDowncast").attributeToElement({model:"linkHref",view:(t,e)=>{const n=Mm(Nm(t),e);return e.setAttribute("donotparse",!0,n),n}}).elementToElement({model:"preview",view:(t,e)=>yp(e.createContainerElement("section",{class:"ck-link"}),e,{})}),t.for("upcast").elementToElement({model:"previewLinkTitle",view:{name:"h1",classes:"ck-link__header"}}),t.for("dataDowncast").elementToElement({model:"previewLinkTitle",view:{name:"h1",classes:"ck-link__header"}}),t.for("editingDowncast").elementToElement({model:"previewLinkTitle",view:(t,e)=>Cp(e.createEditableElement("h1",{class:"ck-link__header"}),e)}),t.for("upcast").elementToElement({model:"previewLinkDescription",view:{name:"p",classes:"ck-link__description"}}),t.for("dataDowncast").elementToElement({model:"previewLinkDescription",view:{name:"p",classes:"ck-link__description"}}),t.for("editingDowncast").elementToElement({model:"previewLinkDescription",view:(t,e)=>Cp(e.createEditableElement("p",{class:"ck-link__description"}),e)}),t.for("upcast").attributeToAttribute({view:{name:"a",key:"href"},model:{key:"href",value:t=>({linkHref:t.getAttribute("href")})}}).elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:t=>t.getAttribute("href")}}).elementToElement({view:{name:"a",attributes:{href:!0}},model:(t,e)=>{const n=t.getAttribute("href");return e.createElement("previewLinkUrl",{href:n,linkHref:n})}}),t.for("dataDowncast").attributeToAttribute({view:{name:"a",key:"href"},model:{key:"href",value:t=>{const e=t.getAttribute("href");return{linkHref:e,href:e}}}}).elementToElement({model:"previewLinkUrl",view:{name:"a",classes:"ck-link__url"}}),t.for("editingDowncast").attributeToAttribute({view:{name:"a",key:"href"},model:{key:"href",value:t=>({linkHref:t.getAttribute("href")})}}).elementToElement({model:"previewLinkUrl",view:(t,e)=>{const n=t.getAttribute("href");return Cp(e.createEditableElement("a",{class:"ck-link__url",href:n}),e)}}),t.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(t,e)=>e.createElement("previewLinkImage",{src:t.getAttribute("src")})}),t.for("dataDowncast").elementToElement({model:"previewLinkImage",view:(t,e)=>{const n=t.getAttribute("src");return e.createEmptyElement("img",{src:n,class:"ck-link__image"})}}),t.for("editingDowncast").elementToElement({model:"previewLinkImage",view:(t,e)=>{const n=t.getAttribute("src");return e.createEmptyElement("img",{class:"ck-link__image",src:n})}}),t.for("upcast").elementToElement({model:"previewLinkContainer",view:{name:"div",classes:"ck-link__container"}}),t.for("dataDowncast").elementToElement({model:"previewLinkContainer",view:{name:"div",classes:"ck-link__container"}}),t.for("editingDowncast").elementToElement({model:"previewLinkContainer",view:(t,e)=>e.createContainerElement("div",{class:"ck-link__container"})})}_createPreviewBlock(t,e){return this.editor.model.change(n=>{const i=n.createElement("preview",{href:e,info:t}),s=n.createElement("previewLinkContainer"),o=n.createElement("previewLinkTitle"),r=n.createElement("previewLinkDescription"),a=n.createElement("previewLinkUrl",{href:e}),l=n.createElement("previewLinkImage",{image:t.image});return n.setAttribute("src",t.image,l),n.appendText(t.title,{},o),n.appendText(t.description,{},r),n.appendText(function(t){let e;return t.indexOf("//")>-1&&(e=t.split("/")[2]),e=e.split(":")[0],e=e.split("?")[0],e}(e),{},a),n.append(o,s),n.append(r,s),n.append(a,s),n.append(s,i),n.append(l,i),i})}_getPreviewInfo(t){return function(t,e){const n=new XMLHttpRequest,i=`${t}parser/meta?url=${e}`;return n.open("GET",i,!1),n.send("null"),JSON.parse(n.response)}(this.editor.config.get("link.api"),t)}_isPreview(t){const e=t.getAttribute("href"),n=this.editor.model.document.selection.getFirstPosition();return n&&n.parent&&0===n.parent.childCount&&t.parent&&1===t.parent.childCount&&1===t.childCount&&t._children[0]._textData===e}}class Rm{constructor(t){this.context=t}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}xn(Rm,qi);class Lm extends Rm{static get pluginName(){return"Notification"}init(){this.on("show:warning",(t,e)=>{window.alert(e.message)},{priority:"lowest"})}showSuccess(t,e={}){this._showNotification({message:t,type:"success",namespace:e.namespace,title:e.title})}showInfo(t,e={}){this._showNotification({message:t,type:"info",namespace:e.namespace,title:e.title})}showWarning(t,e={}){this._showNotification({message:t,type:"warning",namespace:e.namespace,title:e.title})}_showNotification(t){const e="show:"+t.type+(t.namespace?":"+t.namespace:"");this.fire(e,{message:t.message,type:t.type,title:t.title||""})}}var Dm=n(13);class Vm extends Vu{constructor(t){super(t),this.stopListening(this.editor.model.document,"change"),this.listenTo(this.editor.model.document,"change",()=>this.refresh(),{priority:"low"})}refresh(){const t=this.editor.commands.get("imageInsert"),e=this.editor.commands.get("link");this.isEnabled=t.isEnabled||e.isEnabled}execute(){const t=this.editor,e=this.editor.config.get("ckfinder.openerMethod")||"modal";if("popup"!=e&&"modal"!=e)throw new Dm.b('ckfinder-unknown-openerMethod: The openerMethod config option must by "popup" or "modal".',t);const n=this.editor.config.get("ckfinder.options")||{};n.chooseFiles=!0;const i=n.onInit;n.language||(n.language=t.locale.uiLanguage),n.onInit=e=>{i&&i(e),e.on("files:choose",n=>{const i=n.data.files.toArray(),s=i.filter(t=>!t.isImage()),o=i.filter(t=>t.isImage());for(const e of s)t.execute("link",e.getUrl());const r=[];for(const t of o){const n=t.getUrl();r.push(n||e.request("file:getProxyUrl",{file:t}))}r.length&&Bm(t,r)}),e.on("file:choose:resizedImage",e=>{const n=e.data.resizedUrl;if(n)Bm(t,[n]);else{const e=t.plugins.get("Notification"),n=t.locale.t;e.showWarning(n("Could not obtain resized image URL."),{title:n("Selecting resized image failed"),namespace:"ckfinder"})}})},window.CKFinder[e](n)}}function Bm(t,e){if(t.commands.get("imageInsert").isEnabled)t.execute("imageInsert",{source:e});else{const e=t.plugins.get("Notification"),n=t.locale.t;e.showWarning(n("Could not insert image at the current position."),{title:n("Inserting image failed"),namespace:"ckfinder"})}}class Fm extends Nc{static get pluginName(){return"CKFinderEditing"}static get requires(){return[Lm,Lp,Im]}init(){const t=this.editor;t.commands.add("ckfinder",new Vm(t))}}class jm extends Rm{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new Cn({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(t){if("string"!=typeof t)throw new un.b("pendingactions-add-invalid-message: The message must be a string.",this);const e=Object.create(qi);return e.set("message",t),this._actions.add(e),this.hasAny=!0,e}remove(t){this._actions.remove(t),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var zm=n(16);var qm=function(){return function t(){t.called=!0}};class Um{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=qm(),this.off=qm()}}const Wm=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Hm(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Wm[t>>0&255]+Wm[t>>8&255]+Wm[t>>16&255]+Wm[t>>24&255]+Wm[e>>0&255]+Wm[e>>8&255]+Wm[e>>16&255]+Wm[e>>24&255]+Wm[n>>0&255]+Wm[n>>8&255]+Wm[n>>16&255]+Wm[n>>24&255]+Wm[i>>0&255]+Wm[i>>8&255]+Wm[i>>16&255]+Wm[i>>24&255]}var Km={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(93);const Jm=Symbol("listeningTo"),$m=Symbol("emitterId");var Gm={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Jm]||(this[Jm]={});const r=this[Jm];Ym(t)||function(t,e){t[$m]||(t[$m]=e||Hm())}(t);const a=Ym(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Qm(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Zm(t,e),c=Km.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Jm];let s=t&&Ym(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)tb(t,e,n);else if(r){for(;n=r.pop();)tb(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Jm]}},fire(t,...e){try{const n=t instanceof Um?t:new Um(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,tb(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Xm(t,n,e),s&&Xm(s,n,e)}return n.return}catch(t){zm.b.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Ym(t){return t[$m]}function Qm(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Zm(t,e){const n=Qm(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Zm(t,n.childEvents[e]);i=i.concat(s)}return i}function Xm(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Um(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function tb(t,e,n){const i=Zm(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}const eb=Symbol("observableProperties"),nb=Symbol("boundObservables"),ib=Symbol("boundProperties"),sb={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);rb(this);const n=this[eb];if(t in this&&!n.has(t))throw new zm.b("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!cb(t))throw new zm.b("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new zm.b("observable-bind-duplicate-properties: Properties must be unique.",this);rb(this);const e=this[ib];t.forEach(t=>{if(e.has(t))throw new zm.b("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:ab,toMany:lb,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[eb])return;const e=this[ib],n=this[nb];if(t.length){if(!cb(t))throw new zm.b("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new zm.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(sb,Gm);var ob=sb;function rb(t){t[eb]||(Object.defineProperty(t,eb,{value:new Map}),Object.defineProperty(t,nb,{value:new Map}),Object.defineProperty(t,ib,{value:new Map}))}function ab(...t){const e=function(...t){if(!t.length)throw new zm.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new zm.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new zm.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new zm.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new zm.b("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[nb];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{hb(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[nb],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{hb(this._observable,t)})}function lb(t,e,n){if(this._bindings.size>1)throw new zm.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function cb(t){return t.every(t=>"string"==typeof t)}function hb(t,e){const n=t[ib].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}function db(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class ub{constructor(t={},e={}){const n=!(!(i=t)||!i[Symbol.iterator]);var i;if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new zm.b("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new zm.b("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new zm.b("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new zm.b("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new zm.b("collection-add-invalid-id",this);if(this.get(n))throw new zm.b("collection-add-item-already-exists",this)}else t[e]=n=Hm();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}db(ub,Gm);class fb{constructor(){const t=new window.FileReader;this._reader=t,this._data=void 0,this.set("loaded",0),t.onprogress=t=>{this.loaded=t.loaded}}get error(){return this._reader.error}get data(){return this._data}read(t){const e=this._reader;return this.total=t.size,new Promise((n,i)=>{e.onload=()=>{const t=e.result;this._data=t,n(t)},e.onerror=()=>{i("error")},e.onabort=()=>{i("aborted")},this._reader.readAsDataURL(t)})}abort(){this._reader.abort()}}db(fb,ob);class gb extends Nc{static get pluginName(){return"FileRepository"}static get requires(){return[jm]}init(){this.loaders=new ub,this.loaders.on("add",()=>this._updatePendingAction()),this.loaders.on("remove",()=>this._updatePendingAction()),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(t,e)=>e?t/e*100:0)}getLoader(t){return this._loadersMap.get(t)||null}createLoader(t){if(!this.createUploadAdapter)return console.warn(Object(zm.a)("filerepository-no-upload-adapter: Upload adapter is not defined.")),null;const e=new pb(Promise.resolve(t),this.createUploadAdapter);return this.loaders.add(e),this._loadersMap.set(t,e),t instanceof Promise&&e.file.then(t=>{this._loadersMap.set(t,e)}).catch(()=>{}),e.on("change:uploaded",()=>{let t=0;for(const e of this.loaders)t+=e.uploaded;this.uploaded=t}),e.on("change:uploadTotal",()=>{let t=0;for(const e of this.loaders)e.uploadTotal&&(t+=e.uploadTotal);this.uploadTotal=t}),e}destroyLoader(t){const e=t instanceof pb?t:this.getLoader(t);e._destroy(),this.loaders.remove(e),this._loadersMap.forEach((t,n)=>{t===e&&this._loadersMap.delete(n)})}_updatePendingAction(){const t=this.editor.plugins.get(jm);if(this.loaders.length){if(!this._pendingAction){const e=this.editor.t,n=t=>`${e("Upload in progress")} ${parseInt(t)}%.`;this._pendingAction=t.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else t.remove(this._pendingAction),this._pendingAction=null}}db(gb,ob);class pb{constructor(t,e){this.id=Hm(),this._filePromiseWrapper=this._createFilePromiseWrapper(t),this._adapter=e(this),this._reader=new fb,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(t,e)=>e?t/e*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(t=>this._filePromiseWrapper?t:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new zm.b("filerepository-read-wrong-status: You cannot call read if the status is different than idle.",this);return this.status="reading",this.file.then(t=>this._reader.read(t)).then(t=>{if("reading"!==this.status)throw this.status;return this.status="idle",t}).catch(t=>{if("aborted"===t)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:t})}upload(){if("idle"!=this.status)throw new zm.b("filerepository-upload-wrong-status: You cannot call upload if the status is different than idle.",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(t=>(this.uploadResponse=t,this.status="idle",t)).catch(t=>{if("aborted"===this.status)throw"aborted";throw this.status="error",t})}abort(){const t=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==t?this._reader.abort():"uploading"==t&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(t){const e={};return e.promise=new Promise((n,i)=>{e.rejecter=i,e.isFulfilled=!1,t.then(t=>{e.isFulfilled=!0,n(t)}).catch(t=>{e.isFulfilled=!0,i(t)})}),e}}db(pb,ob);function mb(){let t=function(t){t=t.toLowerCase();const e=document.cookie.split(";");for(const n of e){const e=n.split("=");if(decodeURIComponent(e[0].trim().toLowerCase())===t)return decodeURIComponent(e[1])}return null}("ckCsrfToken");var e,n;return t&&40==t.length||(t=function(t){let e="";const n=new Uint8Array(t);window.crypto.getRandomValues(n);for(let t=0;t<n.length;t++){const i="abcdefghijklmnopqrstuvwxyz0123456789".charAt(n[t]%"abcdefghijklmnopqrstuvwxyz0123456789".length);e+=Math.random()>.5?i.toUpperCase():i}return e}(40),e="ckCsrfToken",n=t,document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(n)+";path=/"),t}class bb extends Nc{static get requires(){return[gb]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const t=this.editor.config.get("ckfinder.uploadUrl");t&&(this.editor.plugins.get(gb).createUploadAdapter=e=>new wb(e,t,this.editor.t))}}class wb{constructor(t,e,n){this.loader=t,this.url=e,this.t=n}upload(){return this.loader.file.then(t=>new Promise((e,n)=>{this._initRequest(),this._initListeners(e,n,t),this._sendRequest(t)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}_initListeners(t,e,n){const i=this.xhr,s=this.loader,o=(0,this.t)("Cannot upload file:")+` ${n.name}.`;i.addEventListener("error",()=>e(o)),i.addEventListener("abort",()=>e()),i.addEventListener("load",()=>{const n=i.response;if(!n||!n.uploaded)return e(n&&n.error&&n.error.message?n.error.message:o);t({default:n.url})}),i.upload&&i.upload.addEventListener("progress",t=>{t.lengthComputable&&(s.uploadTotal=t.total,s.uploaded=t.loaded)})}_sendRequest(t){const e=new FormData;e.append("upload",t),e.append("ckCsrfToken",mb()),this.xhr.send(e)}}function _b(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}var kb=Vi({},ip,{listenTo(t,...e){if(_b(t)||pp(t)){const n=this._getProxyEmitter(t)||new vb(t);n.attach(...e),t=n}ip.listenTo.call(this,t,...e)},stopListening(t,e,n){if(_b(t)||pp(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}ip.stopListening.call(this,t,e,n),t instanceof vb&&t.detach(e)},_getProxyEmitter(t){return e=this,n=yb(t),e[ep]&&e[ep][n]?e[ep][n].emitter:null;var e,n}});class vb{constructor(t){sp(this,yb(t)),this._domNode=t}}function yb(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Zg())}Vi(vb.prototype,ip,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class xb{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}hp(xb,kb);class Cb{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Eb extends xb{constructor(t){super(t),this.useCapture=!1}observe(t){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(e=>{this.listenTo(t,e,(t,e)=>{this.isEnabled&&this.onDomEvent(e)},{useCapture:this.useCapture})})}fire(t,e,n){this.isEnabled&&this.document.fire(t,new Cb(this.view,e,n))}}class Tb extends Eb{constructor(t){super(t),this.domEventType="mousedown"}onDomEvent(t){this.fire(t.type,t)}}class Ab extends Vu{refresh(){const t=this.editor.model,e=function(t){const e=t.next();return e.done?null:e.value}(t.document.selection.getSelectedBlocks());this.value=!!e&&e.is("paragraph"),this.isEnabled=!!e&&Pb(e,t.schema)}execute(t={}){const e=this.editor.model,n=e.document;e.change(i=>{const s=(t.selection||n.selection).getSelectedBlocks();for(const t of s)!t.is("paragraph")&&Pb(t,e.schema)&&i.rename(t,"paragraph")})}}function Pb(t,e){return e.checkChild(t.parent,"paragraph")&&!e.isObject(t)}class Sb extends Vu{execute(t){const e=this.editor.model;e.schema.checkChild(t.position,"paragraph")&&e.change(n=>{const i=n.createElement("paragraph");e.insertContent(i,t.position),n.setSelection(i,"in")})}}class Ob extends Nc{static get pluginName(){return"Paragraph"}init(){const t=this.editor,e=t.model,n=t.data;t.commands.add("paragraph",new Ab(t)),t.commands.add("insertParagraph",new Sb(t)),e.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(t,e)=>Ob.paragraphLikeElements.has(t.name)?t.isEmpty?null:e.createElement("paragraph"):null,converterPriority:"low"}),n.upcastDispatcher.on("element",(t,e,n)=>{n.consumable.test(e.viewItem,{name:e.viewItem.name})&&Nb(e.viewItem,e.modelCursor,n.schema)&&Object.assign(e,Mb(e.viewItem,e.modelCursor,n))},{priority:"low"}),n.upcastDispatcher.on("text",(t,e,n)=>{e.modelRange||Nb(e.viewItem,e.modelCursor,n.schema)&&Object.assign(e,Mb(e.viewItem,e.modelCursor,n))},{priority:"lowest"}),e.document.registerPostFixer(t=>this._autoparagraphEmptyRoots(t)),t.data.on("ready",()=>{e.enqueueChange("transparent",t=>this._autoparagraphEmptyRoots(t))},{priority:"lowest"})}_autoparagraphEmptyRoots(t){const e=this.editor.model;for(const n of e.document.getRootNames()){const i=e.document.getRoot(n);if(i.isEmpty&&"$graveyard"!=i.rootName&&e.schema.checkChild(i,"paragraph"))return t.insertElement("paragraph",i),!0}}}function Mb(t,e,n){const i=n.writer.createElement("paragraph");return n.writer.insert(i,e),n.convertItem(t,n.writer.createPositionAt(i,0))}function Nb(t,e,n){const i=n.createContext(e);return!!n.checkChild(i,"paragraph")&&!!n.checkChild(i.push("paragraph"),t)}function Ib(t){const e=[];return(!t.previousSibling||function(t){return t.previousSibling&&vp(t.previousSibling)}(t))&&e.push("before"),(function(t){return!t.nextSibling}(t)||function(t){return t.nextSibling&&vp(t.nextSibling)}(t))&&e.push("after"),e}Ob.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td"]);n(94);const Rb=["before","after"],Lb=(new DOMParser).parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><polyline points="8.05541992 0.263427734 8.05541992 4.23461914 1.28417969 4.23461914" transform="translate(1,0)"></polyline><line x1="0" y1="4.21581031" x2="2" y2="2.17810059" transform="translate(1, 0)"></line><line x1="0" y1="6.21581031" x2="2" y2="4.17810059" transform="translate(2, 5.196955) scale(1, -1) translate(-1, -5.196955)"></line></svg>\n',"image/svg+xml").firstChild;class Db extends Nc{static get requires(){return[Ob]}static get pluginName(){return"WidgetTypeAround"}constructor(t){super(t),this._widgetsWithTypeAroundUI=new Set}destroy(){this._widgetsWithTypeAroundUI.clear()}init(){this._enableTypeAroundUIInjection(),this._enableDetectionOfTypeAroundWidgets(),this._enableInsertingParagraphsOnButtonClick()}_insertParagraph(t,e){const n=this.editor,i=n.editing.view,s=n.editing.mapper.toModelElement(t);let o;o="before"===e?n.model.createPositionBefore(s):n.model.createPositionAfter(s),n.execute("insertParagraph",{position:o}),i.focus(),i.scrollToTheSelection()}_enableTypeAroundUIInjection(){const t=this.editor,e=t.model.schema,n=t.locale.t,i={before:n("Insert paragraph before block"),after:n("Insert paragraph after block")};t.editing.downcastDispatcher.on("insert",(t,n,s)=>{const o=s.mapper.toViewElement(n.item);(function(t,e,n){return t&&vp(t)&&!n.isInline(e)})(o,n.item,e)&&(!function(t,e,n){const i=t.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(t){const n=this.toDomElement(t);return function(t,e){for(const n of Rb){const i=new th({tag:"div",attributes:{class:["ck","ck-widget__type-around__button","ck-widget__type-around__button_"+n],title:e[n]},children:[t.ownerDocument.importNode(Lb,!0)]});t.appendChild(i.render())}}(n,e),n}));t.insert(t.createPositionAt(n,"end"),i)}(s.writer,i,o),this._widgetsWithTypeAroundUI.add(o))},{priority:"low"})}_enableDetectionOfTypeAroundWidgets(){function t(t){return"ck-widget_can-type-around_"+t}this.editor.editing.view.document.registerPostFixer(e=>{for(const n of this._widgetsWithTypeAroundUI)if(n.isAttached()){const i=Ib(n);e.removeClass(Rb.map(t),n),e.addClass(i.map(t),n)}else this._widgetsWithTypeAroundUI.delete(n)})}_enableInsertingParagraphsOnButtonClick(){const t=this.editor.editing.view;t.document.on("mousedown",(e,n)=>{const i=n.domTarget.closest(".ck-widget__type-around__button");if(!i)return;const s=function(t){return t.classList.contains("ck-widget__type-around__button_before")?"before":"after"}(i),o=function(t,e){const n=t.closest(".ck-widget");return e.mapDomToView(n)}(i,t.domConverter);this._insertParagraph(o,s),n.preventDefault(),e.stop()})}}const Vb=navigator.userAgent.toLowerCase();var Bb={isMac:function(t){return t.indexOf("macintosh")>-1}(Vb),isGecko:function(t){return!!t.match(/gecko\/\d+/)}(Vb),isSafari:function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(Vb),isAndroid:function(t){return t.indexOf("android")>-1}(Vb),features:{isRegExpUnicodePropertySupported:function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}()}};const Fb=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();n(96);class jb extends Nc{static get pluginName(){return"Widget"}static get requires(){return[Db]}init(){const t=this.editor.editing.view,e=t.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(t,e,n)=>{this._clearPreviouslySelectedWidgets(n.writer);const i=n.writer,s=i.document.selection,o=s.getSelectedElement();let r=null;for(const t of s.getRanges())for(const e of t){const t=e.item;vp(t)&&!zb(t,r)&&(i.addClass("ck-widget_selected",t),this._previouslySelected.add(t),r=t,t==o&&i.setSelection(s.getRanges(),{fake:!0,label:xp(o)}))}},{priority:"low"}),t.addObserver(Tb),this.listenTo(e,"mousedown",(...t)=>this._onMousedown(...t)),this.listenTo(e,"keydown",(...t)=>this._onKeydown(...t),{priority:"high"}),this.listenTo(e,"delete",(t,e)=>{this._handleDelete("forward"==e.direction)&&(e.preventDefault(),t.stop())},{priority:"high"})}_onMousedown(t,e){const n=this.editor,i=n.editing.view,s=i.document;let o=e.target;if(function(t){for(;t;){if(t.is("editableElement")&&!t.is("rootElement"))return!0;if(vp(t))return!1;t=t.parent}return!1}(o)){if(Bb.isSafari&&e.domEvent.detail>=3){const t=n.editing.mapper.toModelElement(o);this.editor.model.change(n=>{e.preventDefault(),n.setSelection(t,"in")})}return}if(!vp(o)&&(o=o.findAncestor(vp),!o))return;e.preventDefault(),s.isFocused||i.focus();const r=n.editing.mapper.toModelElement(o);this._setSelectionOverElement(r)}_onKeydown(t,e){const n=e.keyCode,i="ltr"===this.editor.locale.contentLanguageDirection,s=n==Fb.arrowdown||n==Fb[i?"arrowright":"arrowleft"];let o=!1;!function(t){return t==Fb.arrowright||t==Fb.arrowleft||t==Fb.arrowup||t==Fb.arrowdown}(n)?n===Fb.enter&&(o=this._handleEnterKey(e.shiftKey)):o=this._handleArrowKeys(s),o&&(e.preventDefault(),t.stop())}_handleDelete(t){if(this.editor.isReadOnly)return;const e=this.editor.model.document.selection;if(!e.isCollapsed)return;const n=this._getObjectElementNextToSelection(t);return n?(this.editor.model.change(t=>{let i=e.anchor.parent;for(;i.isEmpty;){const e=i;i=e.parent,t.remove(e)}this._setSelectionOverElement(n)}),!0):void 0}_handleArrowKeys(t){const e=this.editor.model,n=e.schema,i=e.document.selection,s=i.getSelectedElement();if(s&&n.isObject(s)){const s=t?i.getLastPosition():i.getFirstPosition(),o=n.getNearestSelectionRange(s,t?"forward":"backward");return o&&e.change(t=>{t.setSelection(o)}),!0}if(!i.isCollapsed)return;const o=this._getObjectElementNextToSelection(t);return o&&n.isObject(o)?(this._setSelectionOverElement(o),!0):void 0}_handleEnterKey(t){const e=this.editor.model,n=e.document.selection.getSelectedElement();if(i=n,s=e.schema,i&&s.isObject(i)&&!s.isInline(i))return e.change(i=>{let s=i.createPositionAt(n,t?"before":"after");const o=i.createElement("paragraph");if(e.schema.isBlock(n.parent)){const t=e.schema.findAllowedParent(s,o);s=i.split(s,t).position}i.insert(o,s),i.setSelection(o,"in")}),!0;var i,s}_setSelectionOverElement(t){this.editor.model.change(e=>{e.setSelection(e.createRangeOn(t))})}_getObjectElementNextToSelection(t){const e=this.editor.model,n=e.schema,i=e.document.selection,s=e.createSelection(i);e.modifySelection(s,{direction:t?"forward":"backward"});const o=t?s.focus.nodeBefore:s.focus.nodeAfter;return o&&n.isObject(o)?o:null}_clearPreviouslySelectedWidgets(t){for(const e of this._previouslySelected)t.removeClass("ck-widget_selected",e);this._previouslySelected.clear()}}function zb(t,e){return!!e&&Array.from(t.getAncestors()).includes(e)}class qb extends Vu{execute(){this.editor.model.change(t=>{this.checkDelimiterInit(t),this.editor.model.insertContent(this.createDelimiter(t))})}refresh(){const t=this.editor.model,e=t.document.selection,n=t.schema,i=function(t){const e=t.parent;return e===e.root?e:e.parent}(e.getFirstPosition());this.isEnabled=["blockQuote"].indexOf(i.name)<0&&n.checkChild(i,"delimiter")}createDelimiter(t){return this.checkDelimiterInit(t),this.delimiter&&t.remove(this.delimiter),this.delimiter=t.createElement("delimiter"),this.delimiter}checkDelimiterInit(t){const e=this.editor.model.document.getRoot()._children._nodes.find(t=>"delimiter"===t.name);e&&(t.remove(e),this.editor.updateSourceElement())}}class Ub extends Vu{execute(){const t=this.editor.model,e=t.document.selection.focus.nodeBefore;t.change(t=>{t.remove(e)})}refresh(){this.isEnabled=!0}}class Wb extends Nc{static get requires(){return[jb]}init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("insertDelimiter",new qb(this.editor)),this.editor.commands.add("removeDelimiter",new Ub(this.editor))}_defineSchema(){this.editor.model.schema.register("delimiter",{allowIn:"$root",allowWhere:"$root",isObject:!0})}_defineConverters(){const t=this.editor.conversion;t.for("upcast").elementToElement({model:"delimiter",view:{name:"section",classes:"ck-delimiter"}}),t.for("dataDowncast").elementToElement({model:"delimiter",view:{name:"section",classes:"ck-delimiter"}}),t.for("editingDowncast").elementToElement({model:"delimiter",view:(t,e)=>{const n=e.createContainerElement("section",{class:"ck-delimiter"});return e.setCustomProperty("delimiter",!0,n),yp(n,e,{label:"разделитель",hasSelectionHandler:!0})}})}}class Hb extends Nc{init(){const t=this.editor;t.ui.componentFactory.add("delimiter",e=>{const n=t.commands.get("insertDelimiter"),i=new ld(e);return i.set({label:"Разделитель",icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">\n  <defs>\n    <path id="divider-a" d="M3,12 L11,12 L11,13 L3,13 L3,12 Z M13,12 L21,12 L21,13 L13,13 L13,12 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#divider-a"/>\n  </g>\n</svg>\n',tooltip:!0}),i.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(i,"execute",()=>t.execute("insertDelimiter")),i}),t.ui.componentFactory.add("removeDelimiter",e=>{const n=t.commands.get("removeDelimiter"),i=new ld(e);return i.set({label:"Удалить разделитель",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path fill="#f35e5e" d="M6.33048947,7.0021478 L0.133497402,13.2424335 C-0.0386655729,13.4157993 -0.0386655729,13.696665 0.133497402,13.8700308 C0.219469511,13.9568238 0.33234892,14 0.445009571,14 C0.55788898,14 0.670549631,13.9568238 0.756521739,13.8700308 L7.00010938,7.58282392 L13.243697,13.8700308 C13.3298879,13.9568238 13.4425485,14 13.5552092,14 C13.6678698,14 13.7807492,13.9568238 13.8667214,13.8700308 C14.0388843,13.696665 14.0388843,13.4157993 13.8667214,13.2424335 L7.66994804,7.0021478 L13.8708778,0.757456316 C14.0430407,0.584090569 14.0430407,0.303224842 13.8708778,0.129859095 C13.6987148,-0.043286365 13.4197976,-0.043286365 13.2478534,0.129859095 L7.00032814,6.42147167 L0.752146568,0.130079382 C0.579983593,-0.0430660782 0.301285206,-0.0430660782 0.129122231,0.130079382 C-0.0430407438,0.303445129 -0.0430407438,0.584310856 0.129122231,0.757676603 L6.33048947,7.0021478 Z" transform="translate(5 5)"/>\n</svg>\n',tooltip:!1}),i.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(i,"execute",()=>t.execute("removeDelimiter")),i})}}var Kb=function(){return function t(){t.called=!0}};class Jb{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=Kb(),this.off=Kb()}}const $b=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function Gb(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+$b[t>>0&255]+$b[t>>8&255]+$b[t>>16&255]+$b[t>>24&255]+$b[e>>0&255]+$b[e>>8&255]+$b[e>>16&255]+$b[e>>24&255]+$b[n>>0&255]+$b[n>>8&255]+$b[n>>16&255]+$b[n>>24&255]+$b[i>>0&255]+$b[i>>8&255]+$b[i>>16&255]+$b[i>>24&255]}var Yb={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},Qb=(n(34),n(8));const Zb=Symbol("listeningTo"),Xb=Symbol("emitterId");var tw={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Zb]||(this[Zb]={});const r=this[Zb];nw(t)||ew(t);const a=nw(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=iw(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=sw(t,e),c=Yb.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Zb];let s=t&&nw(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)rw(t,e,n);else if(r){for(;n=r.pop();)rw(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Zb]}},fire(t,...e){try{const n=t instanceof Jb?t:new Jb(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,rw(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&ow(t,n,e),s&&ow(s,n,e)}return n.return}catch(t){Qb.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function ew(t,e){t[Xb]||(t[Xb]=e||Gb())}function nw(t){return t[Xb]}function iw(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function sw(t,e){const n=iw(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=sw(t,n.childEvents[e]);i=i.concat(s)}return i}function ow(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Jb(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function rw(t,e,n){const i=sw(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function aw(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function lw(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var cw=Vi({},tw,{listenTo(t,...e){if(aw(t)||lw(t)){const n=this._getProxyEmitter(t)||new hw(t);n.attach(...e),t=n}tw.listenTo.call(this,t,...e)},stopListening(t,e,n){if(aw(t)||lw(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}tw.stopListening.call(this,t,e,n),t instanceof hw&&t.detach(e)},_getProxyEmitter(t){return e=this,n=dw(t),e[Zb]&&e[Zb][n]?e[Zb][n].emitter:null;var e,n}});class hw{constructor(t){ew(this,dw(t)),this._domNode=t}}function dw(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Gb())}function uw(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}Vi(hw.prototype,tw,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class fw{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}uw(fw,cw);class gw{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class pw extends fw{constructor(t){super(t),this.useCapture=!1}observe(t){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(e=>{this.listenTo(t,e,(t,e)=>{this.isEnabled&&this.onDomEvent(e)},{useCapture:this.useCapture})})}fire(t,e,n){this.isEnabled&&this.document.fire(t,new gw(this.view,e,n))}}class mw{constructor(t){this.files=function(t){const e=t.files?Array.from(t.files):[],n=t.items?Array.from(t.items):[];if(e.length)return e;return n.filter(t=>"file"===t.kind).map(t=>t.getAsFile())}(t),this._native=t}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,e){this._native.setData(t,e)}}class bw extends pw{constructor(t){super(t);const e=this.document;function n(t,n){n.preventDefault();const i=n.dropRange?[n.dropRange]:Array.from(e.selection.getRanges()),s=new Jb(e,"clipboardInput");e.fire(s,{dataTransfer:n.dataTransfer,targetRanges:i}),s.stop.called&&n.stopPropagation()}this.domEventType=["paste","copy","cut","drop","dragover"],this.listenTo(e,"paste",n,{priority:"low"}),this.listenTo(e,"drop",n,{priority:"low"})}onDomEvent(t){const e={dataTransfer:new mw(t.clipboardData?t.clipboardData:t.dataTransfer)};"drop"==t.type&&(e.dropRange=function(t,e){const n=e.target.ownerDocument,i=e.clientX,s=e.clientY;let o;n.caretRangeFromPoint&&n.caretRangeFromPoint(i,s)?o=n.caretRangeFromPoint(i,s):e.rangeParent&&(o=n.createRange(),o.setStart(e.rangeParent,e.rangeOffset),o.collapse(!0));return o?t.domConverter.domRangeToView(o):t.document.selection.getFirstRange()}(this.view,t)),this.fire(t.type,t,e)}}const ww=["figcaption","li"];class _w{getHtml(t){const e=document.implementation.createHTMLDocument("").createElement("div");return e.appendChild(t),e.innerHTML}}function kw(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class vw{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new Qb.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=kw(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}uw(vw,tw);class yw extends vw{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof yw&&(this===t||this.data===t.data)}_clone(){return new yw(this.document,this.data)}}class xw{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new Qb.a("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new Qb.a("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function Cw(t){return!(!t||!t[Symbol.iterator])}function Ew(t){return Cw(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}class Tw{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=Aw(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=Aw(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function Aw(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}class Pw{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Sw(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}function Sw(t){return t.replace("-",".")}class Ow extends vw{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=Ew(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");Mw(this._classes,t),this._attrs.delete("class")}this._styles=new Pw(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Ow))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new Tw(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new yw(t,e)];Cw(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new yw(t,e):e instanceof xw?new yw(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?Mw(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function Mw(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class Nw{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new Qb.a("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new Qb.a("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=Kw._createAt(t.startPosition):this.position=Kw._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof yw){if(t.isAtEnd)return this.position=Kw._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof Ow)return this.shallow?t.offset++:t=new Kw(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof yw){if(this.singleCharacters)return t=new Kw(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new xw(i,0,s),t=Kw._createAfter(n)):(n=new xw(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new xw(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=Kw._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof yw){if(t.isAtStart)return this.position=Kw._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof Ow)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new Kw(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof yw){if(this.singleCharacters)return t=new Kw(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new xw(i,e,i.data.length-e),s=n.data.length,t=Kw._createBefore(n)}else n=new xw(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new xw(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=Kw._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof xw&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=Kw._createAfter(e.textNode):(i=Kw._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=Kw._createBefore(e.textNode):(i=Kw._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class Iw extends Ow{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=Rw}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function Rw(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}const Lw=Symbol("observableProperties"),Dw=Symbol("boundObservables"),Vw=Symbol("boundProperties"),Bw={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);jw(this);const n=this[Lw];if(t in this&&!n.has(t))throw new Qb.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!Uw(t))throw new Qb.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new Qb.a("observable-bind-duplicate-properties: Properties must be unique.",this);jw(this);const e=this[Vw];t.forEach(t=>{if(e.has(t))throw new Qb.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:zw,toMany:qw,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Lw])return;const e=this[Vw],n=this[Dw];if(t.length){if(!Uw(t))throw new Qb.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new Qb.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(Bw,tw);var Fw=Bw;function jw(t){t[Lw]||(Object.defineProperty(t,Lw,{value:new Map}),Object.defineProperty(t,Dw,{value:new Map}),Object.defineProperty(t,Vw,{value:new Map}))}function zw(...t){const e=function(...t){if(!t.length)throw new Qb.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new Qb.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new Qb.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new Qb.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new Qb.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Dw];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{Ww(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Dw],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{Ww(this._observable,t)})}function qw(t,e,n){if(this._bindings.size>1)throw new Qb.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function Uw(t){return t.every(t=>"string"==typeof t)}function Ww(t,e){const n=t[Vw].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class Hw extends Iw{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}uw(Hw,Fw);class Kw{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof Hw);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=Kw._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new Nw(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=kw(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new Nw(t)}clone(){return new Kw(this.parent,this.offset)}static _createAt(t,e){if(t instanceof Kw)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new Qb.a("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new Kw(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new Kw(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new Qb.a("view-position-after-root: You can not make position after root.",t,{root:t});return new Kw(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new Kw(t.textNode,t.offsetInText);if(!t.parent)throw new Qb.a("view-position-before-root: You can not make position before root.",t,{root:t});return new Kw(t.parent,t.index)}}class Jw{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new Nw({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition($w,{direction:"backward"}),e=this.end.getLastMatchingPosition($w);return t.parent.is("text")&&t.isAtStart&&(t=Kw._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=Kw._createAfter(e.parent)),new Jw(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition($w);if(t.isAfter(this.end)||t.isEqual(this.end))return new Jw(t,t);let e=this.end.getLastMatchingPosition($w,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new Kw(n,0)),i&&i.is("text")&&(e=new Kw(i,i.data.length)),new Jw(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new Jw(this.start,t.start)),this.containsPosition(t.end)&&e.push(new Jw(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new Jw(e,n)}return null}getWalker(t={}){return t.boundaries=this,new Nw(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new Jw(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new Nw(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new Nw(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new Kw(t,e),new Kw(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Kw._createBefore(t),e)}}function $w(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function Gw(t){let e=0;for(const n of t)e++;return e}class Yw{constructor(t=null,e,n){this._selection=new Qw,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}uw(Yw,tw);class Qw{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=Gw(this.getRanges());if(e!=Gw(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof Qw||t instanceof Yw)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof Jw)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof Kw)this._setRanges([new Jw(t)]),this._setFakeOptions(e);else if(t instanceof vw){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new Qb.a("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?Jw._createIn(t):"on"==e?Jw._createOn(t):new Jw(Kw._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!Cw(t))throw new Qb.a("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new Qb.a("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=Kw._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new Jw(n,i),!0):this._addRange(new Jw(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof Jw))throw new Qb.a("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new Qb.a("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new Jw(t.start,t.end))}}uw(Qw,tw);class Zw{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new yw(t,e)];Cw(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new yw(t,e):e instanceof xw?new yw(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}uw(Zw,tw);const Xw=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(Xw),function(t){t.match(/gecko\/\d+/)}(Xw),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(Xw),function(t){t.indexOf("android")}(Xw),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();!function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e}();function t_(t){return"[object Text]"==Object.prototype.toString.call(t)}const e_=t=>t.createTextNode(" "),n_=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},i_=(()=>{let t="";for(let e=0;e<7;e++)t+="​";return t})();function s_(t){return t_(t)&&t.data.substr(0,7)===i_}function o_(t){return 7==t.data.length&&s_(t)}function r_(t){return s_(t)?t.data.slice(7):t.data}var a_={window:window,document:document};function l_(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function c_(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const h_=n_(document);class d_{constructor(t,e={}){this.document=t,this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?n_:e_,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new Qw(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}viewToDom(t,e,n={}){if(t.is("text")){const n=this._processDataFromViewText(t);return e.createTextNode(n)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let i;if(t.is("documentFragment"))i=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(i,t);else{if(t.is("uiElement"))return i=t.render(e),n.bind&&this.bindElements(i,t),i;i=t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),n.bind&&this.bindElements(i,t);for(const e of t.getAttributeKeys())i.setAttribute(e,t.getAttribute(e))}if(n.withChildren||void 0===n.withChildren)for(const s of this.viewChildrenToDom(t,e,n))i.appendChild(s);return i}}*viewChildrenToDom(t,e,n={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren())i===s&&(yield this._blockFiller(e)),yield this.viewToDom(o,e,n),s++;i===s&&(yield this._blockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),i=document.createRange();return i.setStart(e.parent,e.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(t){const e=t.parent;if(e.is("text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let i=t.offset;return s_(n)&&(i+=7),{parent:n,offset:i}}{let n,i,s;if(0===t.offset){if(n=this.mapViewToDom(e),!n)return null;s=n.childNodes[0]}else{const e=t.nodeBefore;if(i=e.is("text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!i)return null;n=i.parentNode,s=i.nextSibling}if(t_(s)&&s_(s))return{parent:s,offset:7};return{parent:n,offset:i?l_(i)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t,this.blockFillerMode))return null;const n=this.getParentUIElement(t,this._domToViewMapping);if(n)return n;if(t_(t)){if(o_(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new yw(this.document,e)}}if(this.isComment(t))return null;{if(this.mapDomToView(t))return this.mapDomToView(t);let n;if(this.isDocumentFragment(t))n=new Zw(this.document),e.bind&&this.bindDocumentFragments(t,n);else{const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new Ow(this.document,i),e.bind&&this.bindElements(t,n);const s=t.attributes;for(let t=s.length-1;t>=0;t--)n._setAttribute(s[t].name,s[t].value)}if(e.withChildren||void 0===e.withChildren)for(const i of this.domChildrenToView(t,e))n._appendChild(i);return n}}*domChildrenToView(t,e={}){for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n],s=this.domToView(i,e);null!==s&&(yield s)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;t_(e)&&(e=e.parentNode);const n=this.fakeSelectionToView(e);if(n)return n}const e=this.isDomSelectionBackward(t),n=[];for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e),s=this.domRangeToView(i);s&&n.push(s)}return new Qw(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new Jw(e,n):null}domPositionToView(t,e){if(this.isBlockFiller(t,this.blockFillerMode))return this.domPositionToView(t.parentNode,l_(t));const n=this.mapDomToView(t);if(n&&n.is("uiElement"))return Kw._createBefore(n);if(t_(t)){if(o_(t))return this.domPositionToView(t.parentNode,l_(t));const n=this.findCorrespondingViewText(t);let i=e;return n?(s_(t)&&(i-=7,i=i<0?0:i),new Kw(n,i)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new Kw(e,0)}else{const n=t.childNodes[e-1],i=t_(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new Kw(i.parent,i.index+1)}return null}mapDomToView(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(o_(t))return null;const e=this.getParentUIElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const t=this.mapDomToView(n);if(t){return t.nextSibling instanceof yw?t.nextSibling:null}}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof yw?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:n}=a_.window,i=[];f_(e,t=>{const{scrollLeft:e,scrollTop:n}=t;i.push([e,n])}),e.focus(),f_(e,t=>{const[e,n]=i.shift();t.scrollLeft=e,t.scrollTop=n}),a_.window.scrollTo(t,n)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(h_):!("BR"!==t.tagName||!g_(t,this.blockElements)||1!==t.parentNode.childNodes.length)||function(t,e){return t_(t)&&" "==t.data&&g_(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const n=e.collapsed;return e.detach(),n}getParentUIElement(t){const e=c_(t);for(e.pop();e.length;){const t=e.pop(),n=this._domToViewMapping.get(t);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}_isDomSelectionPositionCorrect(t,e){if(t_(t)&&s_(t)&&e<7)return!1;if(this.isElement(t)&&s_(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!n||!n.is("uiElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const n=this._getTouchingViewTextNode(t,!1);!(n&&this._nodeEndsWithSpace(n))&&n||(e=" "+e.substr(1))}if(" "==e.charAt(e.length-1)){const n=this._getTouchingViewTextNode(t,!0);" "!=e.charAt(e.length-2)&&n&&" "!=n.data.charAt(0)||(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(u_(t,this.preElements))return r_(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(t,!1),i=this._getTouchingInlineDomNode(t,!0),s=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,i);return s&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=r_(new Text(e)),e=e.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(e)||!i||i.data&&" "==i.data.charAt(0))&&(e=e.replace(/\u00A0$/," ")),s&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t){return!t||(!!nn(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!s_(t)}_getTouchingViewTextNode(t,e){const n=new Nw({startPosition:e?Kw._createAfter(t):Kw._createBefore(t),direction:e?"forward":"backward"});for(const t of n){if(t.item.is("containerElement"))return null;if(t.item.is("br"))return null;if(t.item.is("textProxy"))return t.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const n=e?"nextNode":"previousNode",i=t.ownerDocument,s=c_(t)[0],o=i.createTreeWalker(s,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:t=>t_(t)||"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=t;const r=o[n]();if(null!==r){const e=function(t,e){const n=c_(t),i=c_(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}(t,r);if(e&&!u_(t,this.blockElements,e)&&!u_(r,this.blockElements,e))return r}return null}}function u_(t,e,n){let i=c_(t);return n&&(i=i.slice(i.indexOf(n)+1)),i.some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}function f_(t,e){for(;t&&t!=a_.document;)e(t),t=t.parentNode}function g_(t,e){const n=t.parentNode;return n&&n.tagName&&e.includes(n.tagName.toLowerCase())}class p_{constructor(t){this._domParser=new DOMParser,this._domConverter=new d_(t,{blockFillerMode:"nbsp"}),this._htmlWriter=new _w}toData(t){const e=this._domConverter.viewToDom(t,document);return this._htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this._domConverter.domToView(e)}_toDom(t){const e=this._domParser.parseFromString(t,"text/html"),n=e.createDocumentFragment(),i=e.body.childNodes;for(;i.length>0;)n.appendChild(i[0]);return n}}class m_ extends Nc{static get pluginName(){return"Clipboard"}init(){const t=this.editor,e=t.model.document,n=t.editing.view,i=n.document;function s(n,s){const o=s.dataTransfer;s.preventDefault();const r=t.data.toView(t.model.getSelectedContent(e.selection));i.fire("clipboardOutput",{dataTransfer:o,content:r,method:n.name})}this._htmlDataProcessor=new p_(i),n.addObserver(bw),this.listenTo(i,"clipboardInput",e=>{t.isReadOnly&&e.stop()},{priority:"highest"}),this.listenTo(i,"clipboardInput",(t,e)=>{const i=e.dataTransfer;let s="";var o;i.getData("text/html")?s=function(t){return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>1==e.length?" ":e)}(i.getData("text/html")):i.getData("text/plain")&&((o=(o=i.getData("text/plain")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).indexOf("</p><p>")>-1&&(o=`<p>${o}</p>`),s=o),s=this._htmlDataProcessor.toView(s);const r=new Jb(this,"inputTransformation");this.fire(r,{content:s,dataTransfer:i}),r.stop.called&&t.stop(),n.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(t,e)=>{if(!e.content.isEmpty){const n=this.editor.data,i=this.editor.model,s=n.toModel(e.content,"$clipboardHolder");if(0==s.childCount)return;i.insertContent(s),t.stop()}},{priority:"low"}),this.listenTo(i,"copy",s,{priority:"low"}),this.listenTo(i,"cut",(e,n)=>{t.isReadOnly?n.preventDefault():s(e,n)},{priority:"low"}),this.listenTo(i,"clipboardOutput",(n,i)=>{i.content.isEmpty||(i.dataTransfer.setData("text/html",this._htmlDataProcessor.toData(i.content)),i.dataTransfer.setData("text/plain",function t(e){let n="";if(e.is("text")||e.is("textProxy"))n=e.data;else if(e.is("img")&&e.hasAttribute("alt"))n=e.getAttribute("alt");else{let i=null;for(const s of e.getChildren()){const e=t(s);i&&(i.is("containerElement")||s.is("containerElement"))&&(ww.includes(i.name)||ww.includes(s.name)?n+="\n":n+="\n\n"),n+=e,i=s}}return n}(i.content))),"cut"==i.method&&t.model.deleteContent(e.selection)},{priority:"low"})}}function*b_(t,e){for(const n of e)n&&t.getAttributeProperties(n[0]).copyOnEnter&&(yield n)}class w_ extends Vu{execute(){const t=this.editor.model,e=t.document;t.change(n=>{!function(t,e,n,i){const s=n.isCollapsed,o=n.getFirstRange(),r=o.start.parent,a=o.end.parent;if(i.isLimit(r)||i.isLimit(a))return void(s||r!=a||t.deleteContent(n));if(s){const t=b_(e.model.schema,n.getAttributes());__(e,o.start),e.setSelectionAttribute(t)}else{const i=!(o.start.isAtStart&&o.end.isAtEnd),s=r==a;t.deleteContent(n,{leaveUnmerged:i}),i&&(s?__(e,n.focus):e.setSelection(a,0))}}(this.editor.model,n,e.selection,t.schema),this.fire("afterExecute",{writer:n})})}}function __(t,e){t.split(e),t.setSelection(e.parent.nextSibling,0)}var k_=function(){return function t(){t.called=!0}};class v_{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=k_(),this.off=k_()}}const y_=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function x_(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+y_[t>>0&255]+y_[t>>8&255]+y_[t>>16&255]+y_[t>>24&255]+y_[e>>0&255]+y_[e>>8&255]+y_[e>>16&255]+y_[e>>24&255]+y_[n>>0&255]+y_[n>>8&255]+y_[n>>16&255]+y_[n>>24&255]+y_[i>>0&255]+y_[i>>8&255]+y_[i>>16&255]+y_[i>>24&255]}var C_={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},E_=(n(98),n(24));const T_=Symbol("listeningTo"),A_=Symbol("emitterId");var P_={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[T_]||(this[T_]={});const r=this[T_];O_(t)||S_(t);const a=O_(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=M_(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=N_(t,e),c=C_.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[T_];let s=t&&O_(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)R_(t,e,n);else if(r){for(;n=r.pop();)R_(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[T_]}},fire(t,...e){try{const n=t instanceof v_?t:new v_(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,R_(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&I_(t,n,e),s&&I_(s,n,e)}return n.return}catch(t){E_.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function S_(t,e){t[A_]||(t[A_]=e||x_())}function O_(t){return t[A_]}function M_(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function N_(t,e){const n=M_(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=N_(t,n.childEvents[e]);i=i.concat(s)}return i}function I_(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new v_(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function R_(t,e,n){const i=N_(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function L_(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function D_(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var V_=Vi({},P_,{listenTo(t,...e){if(L_(t)||D_(t)){const n=this._getProxyEmitter(t)||new B_(t);n.attach(...e),t=n}P_.listenTo.call(this,t,...e)},stopListening(t,e,n){if(L_(t)||D_(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}P_.stopListening.call(this,t,e,n),t instanceof B_&&t.detach(e)},_getProxyEmitter(t){return e=this,n=F_(t),e[T_]&&e[T_][n]?e[T_][n].emitter:null;var e,n}});class B_{constructor(t){S_(this,F_(t)),this._domNode=t}}function F_(t){return t["data-ck-expando"]||(t["data-ck-expando"]=x_())}Vi(B_.prototype,P_,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class j_{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}!function(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}(j_,V_);class z_{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}const q_=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(q_),function(t){t.match(/gecko\/\d+/)}(q_),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(q_),function(t){t.indexOf("android")}(q_),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();const U_=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();class W_ extends j_{constructor(t){super(t);const e=this.document;e.on("keydown",(t,n)=>{if(this.isEnabled&&n.keyCode==U_.enter){let i;e.once("enter",t=>i=t,{priority:"highest"}),e.fire("enter",new z_(e,n.domEvent,{isSoft:n.shiftKey})),i&&i.stop.called&&t.stop()}})}observe(){}}class H_ extends Nc{static get pluginName(){return"Enter"}init(){const t=this.editor,e=t.editing.view,n=e.document;e.addObserver(W_),t.commands.add("enter",new w_(t)),this.listenTo(n,"enter",(n,i)=>{i.preventDefault(),i.isSoft||(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"})}}class K_ extends Vu{execute(){const t=this.editor.model,e=t.document;t.change(n=>{!function(t,e,n){const i=n.isCollapsed,s=n.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(i){const i=b_(t.schema,n.getAttributes());J_(t,e,s.end),e.removeSelectionAttribute(n.getAttributeKeys()),e.setSelectionAttribute(i)}else{const i=!(s.start.isAtStart&&s.end.isAtEnd);t.deleteContent(n,{leaveUnmerged:i}),a?J_(t,e,n.focus):i&&e.setSelection(r,0)}}(t,n,e.selection),this.fire("afterExecute",{writer:n})})}refresh(){const t=this.editor.model,e=t.document;this.isEnabled=function(t,e){if(e.rangeCount>1)return!1;const n=e.anchor;if(!n||!t.checkChild(n,"softBreak"))return!1;const i=e.getFirstRange(),s=i.start.parent,o=i.end.parent;if(($_(s,t)||$_(o,t))&&s!==o)return!1;return!0}(t.schema,e.selection)}}function J_(t,e,n){const i=e.createElement("softBreak");t.insertContent(i,n),e.setSelection(i,"after")}function $_(t,e){return!t.is("rootElement")&&(e.isLimit(t)||$_(t.parent,e))}class G_ extends Nc{static get pluginName(){return"ShiftEnter"}init(){const t=this.editor,e=t.model.schema,n=t.conversion,i=t.editing.view,s=i.document;e.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(t,e)=>e.createEmptyElement("br")}),i.addObserver(W_),t.commands.add("shiftEnter",new K_(t)),this.listenTo(s,"enter",(e,n)=>{n.preventDefault(),n.isSoft&&(t.execute("shiftEnter"),i.scrollToTheSelection())},{priority:"low"})}}class Y_ extends Error{constructor(t,e,n){t=function(t){const e=t.match(/^([^:]+):/);if(!e)return t;return t+` Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-${e[1]}\n`}(t),n&&(t+=" "+JSON.stringify(n)),super(t),this.name="CKEditorError",this.context=e,this.data=n}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const n=new Y_(t.message,e);throw n.stack=t.stack,n}}const Q_=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(Q_),function(t){t.match(/gecko\/\d+/)}(Q_),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(Q_),function(t){t.indexOf("android")}(Q_),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();const Z_=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function X_(t){let e;if("string"==typeof t){if(e=Z_[t.toLowerCase()],!e)throw new Y_("keyboard-unknown-key: Unknown key name.",null,{key:t})}else e=t.keyCode+(t.altKey?Z_.alt:0)+(t.ctrlKey?Z_.ctrl:0)+(t.shiftKey?Z_.shift:0);return e}function tk(t){return t.split(/\s*\+\s*/)}class ek extends Vu{execute(){const t=this.editor.model,e=t.schema.getLimitElement(t.document.selection);t.change(t=>{t.setSelection(e,"in")})}}const nk=("string"==typeof(ik="Ctrl+A")&&(ik=tk(ik)),ik.map(t=>"string"==typeof t?X_(t):t).reduce((t,e)=>e+t,0));var ik;class sk extends Nc{static get pluginName(){return"SelectAllEditing"}init(){const t=this.editor,e=t.editing.view.document;t.commands.add("selectAll",new ek(t)),this.listenTo(e,"keydown",(e,n)=>{X_(n)===nk&&(t.execute("selectAll"),n.preventDefault())})}}class ok extends Nc{static get pluginName(){return"SelectAllUI"}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",e=>{const n=t.commands.get("selectAll"),i=new ld(e),s=e.t;return i.set({label:s("Select all"),icon:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',keystroke:"Ctrl+A",tooltip:!0}),i.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(i,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),i})}}class rk extends Nc{static get requires(){return[sk,ok]}static get pluginName(){return"SelectAll"}}class ak{constructor(t,e=20){this.model=t,this.size=0,this.limit=e,this.isLocked=!1,this._changeCallback=(t,e)=>{"transparent"!=e.type&&e!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(t){this.size+=t,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t){this.isLocked&&!t||(this._batch=null,this.size=0)}}class lk extends Vu{constructor(t,e){super(t),this._buffer=new ak(t.model,e),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(t={}){const e=this.editor.model,n=e.document,i=t.text||"",s=i.length,o=t.range?e.createSelection(t.range):n.selection,r=t.resultRange;e.enqueueChange(this._buffer.batch,t=>{this._buffer.lock(),e.deleteContent(o),i&&e.insertContent(t.createText(i,n.selection.getAttributes()),o),r?t.setSelection(r):o.is("documentSelection")||t.setSelection(o),this._buffer.unlock(),this._buffer.input(s),this._batches.add(this._buffer.batch)})}}var ck=n(9);const hk=navigator.userAgent.toLowerCase();var dk={isMac:function(t){return t.indexOf("macintosh")>-1}(hk),isGecko:function(t){return!!t.match(/gecko\/\d+/)}(hk),isSafari:function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(hk),isAndroid:function(t){return t.indexOf("android")>-1}(hk),features:{isRegExpUnicodePropertySupported:function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}()}};const uk=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function fk(t){let e;if("string"==typeof t){if(e=uk[t.toLowerCase()],!e)throw new ck.a("keyboard-unknown-key: Unknown key name.",null,{key:t})}else e=t.keyCode+(t.altKey?uk.alt:0)+(t.ctrlKey?uk.ctrl:0)+(t.shiftKey?uk.shift:0);return e}function gk(t){let e=null;const n=t.model,i=t.editing.view,s=t.commands.get("input");function o(t){const o=n.document,a=i.document.isComposing,l=e&&e.isEqual(o.selection);e=null,s.isEnabled&&(function(t){if(t.ctrlKey)return!0;return pk.includes(t.keyCode)}(t)||o.selection.isCollapsed||a&&229===t.keyCode||!a&&229===t.keyCode&&l||r())}function r(){const t=s.buffer;t.lock(),n.enqueueChange(t.batch,()=>{n.deleteContent(n.document.selection)}),t.unlock()}dk.isAndroid?i.document.on("beforeinput",(t,e)=>o(e),{priority:"lowest"}):i.document.on("keydown",(t,e)=>o(e),{priority:"lowest"}),i.document.on("compositionstart",(function(){const t=n.document,e=1!==t.selection.rangeCount||t.selection.getFirstRange().isFlat;if(t.selection.isCollapsed||e)return;r()}),{priority:"lowest"}),i.document.on("compositionend",()=>{e=n.createSelection(n.document.selection)},{priority:"lowest"})}const pk=[fk("arrowUp"),fk("arrowRight"),fk("arrowDown"),fk("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let t=112;t<=135;t++)pk.push(t);function mk(t,e,n){for(let i=0;i<Math.max(t.length,e.length);i++)if(void 0===t[i]||void 0===e[i]||!n(t[i],e[i]))return i;return-1}function bk(t,e){return t.slice(e).reverse()}function wk(t,e,n){n=n||function(t,e){return t===e};const i=t.length,s=e.length;if(i>200||s>200||i+s>300)return wk.fastDiff(t,e,n,!0);let o,r;if(s<i){const n=t;t=e,e=n,o="delete",r="insert"}else o="insert",r="delete";const a=t.length,l=e.length,c=l-a,h={},d={};function u(i){const s=(void 0!==d[i-1]?d[i-1]:-1)+1,c=void 0!==d[i+1]?d[i+1]:-1,u=s>c?-1:1;h[i+u]&&(h[i]=h[i+u].slice(0)),h[i]||(h[i]=[]),h[i].push(s>c?o:r);let f=Math.max(s,c),g=f-i;for(;g<a&&f<l&&n(t[g],e[f]);)g++,f++,h[i].push("equal");return f}let f,g=0;do{for(f=-g;f<c;f++)d[f]=u(f);for(f=c+g;f>c;f--)d[f]=u(f);d[c]=u(c),g++}while(d[c]!==l);return h[c].slice(1)}wk.fastDiff=function(t,e,n,i=!1){n=n||function(t,e){return t===e},Array.isArray(t)||(t=Array.prototype.slice.call(t)),Array.isArray(e)||(e=Array.prototype.slice.call(e));const s=function(t,e,n){const i=mk(t,e,n);if(-1===i)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=bk(t,i),o=bk(e,i),r=mk(s,o,n),a=t.length-r,l=e.length-r;return{firstIndex:i,lastIndexOld:a,lastIndexNew:l}}(t,e,n);return i?function(t,e){const{firstIndex:n,lastIndexOld:i,lastIndexNew:s}=t;if(-1===n)return Array(e).fill("equal");let o=[];n>0&&(o=o.concat(Array(n).fill("equal")));s-n>0&&(o=o.concat(Array(s-n).fill("insert")));i-n>0&&(o=o.concat(Array(i-n).fill("delete")));s<e&&(o=o.concat(Array(e-s).fill("equal")));return o}(s,e.length):function(t,e){const n=[],{firstIndex:i,lastIndexOld:s,lastIndexNew:o}=e;o-i>0&&n.push({index:i,type:"insert",values:t.slice(i,o)});s-i>0&&n.push({index:i+(o-i),type:"delete",howMany:s-i});return n}(e,s)};var _k=function(){return function t(){t.called=!0}};class kk{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=_k(),this.off=_k()}}const vk=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function yk(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+vk[t>>0&255]+vk[t>>8&255]+vk[t>>16&255]+vk[t>>24&255]+vk[e>>0&255]+vk[e>>8&255]+vk[e>>16&255]+vk[e>>24&255]+vk[n>>0&255]+vk[n>>8&255]+vk[n>>16&255]+vk[n>>24&255]+vk[i>>0&255]+vk[i>>8&255]+vk[i>>16&255]+vk[i>>24&255]}var xk={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(35);const Ck=Symbol("listeningTo"),Ek=Symbol("emitterId");var Tk={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Ck]||(this[Ck]={});const r=this[Ck];Pk(t)||Ak(t);const a=Pk(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=Sk(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=Ok(t,e),c=xk.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Ck];let s=t&&Pk(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)Nk(t,e,n);else if(r){for(;n=r.pop();)Nk(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Ck]}},fire(t,...e){try{const n=t instanceof kk?t:new kk(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,Nk(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&Mk(t,n,e),s&&Mk(s,n,e)}return n.return}catch(t){ck.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Ak(t,e){t[Ek]||(t[Ek]=e||yk())}function Pk(t){return t[Ek]}function Sk(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Ok(t,e){const n=Sk(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=Ok(t,n.childEvents[e]);i=i.concat(s)}return i}function Mk(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new kk(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function Nk(t,e,n){const i=Ok(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function Ik(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}function Rk(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class Lk{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new ck.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=Rk(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}Ik(Lk,Tk);class Dk extends Lk{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof Dk&&(this===t||this.data===t.data)}_clone(){return new Dk(this.document,this.data)}}class Vk{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new ck.a("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new ck.a("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function Bk(t){return!(!t||!t[Symbol.iterator])}function Fk(t){return Bk(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}class jk{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=zk(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=zk(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function zk(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}class qk{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Uk(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}function Uk(t){return t.replace("-",".")}class Wk extends Lk{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=Fk(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");Hk(this._classes,t),this._attrs.delete("class")}this._styles=new qk(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Wk))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new jk(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Dk(t,e)];Bk(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Dk(t,e):e instanceof Vk?new Dk(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?Hk(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function Hk(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class Kk{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new ck.a("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new ck.a("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=rv._createAt(t.startPosition):this.position=rv._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof Dk){if(t.isAtEnd)return this.position=rv._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof Wk)return this.shallow?t.offset++:t=new rv(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof Dk){if(this.singleCharacters)return t=new rv(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new Vk(i,0,s),t=rv._createAfter(n)):(n=new Vk(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new Vk(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=rv._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof Dk){if(t.isAtStart)return this.position=rv._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof Wk)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new rv(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof Dk){if(this.singleCharacters)return t=new rv(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new Vk(i,e,i.data.length-e),s=n.data.length,t=rv._createBefore(n)}else n=new Vk(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new Vk(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=rv._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof Vk&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=rv._createAfter(e.textNode):(i=rv._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=rv._createBefore(e.textNode):(i=rv._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class Jk extends Wk{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=$k}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function $k(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}const Gk=Symbol("observableProperties"),Yk=Symbol("boundObservables"),Qk=Symbol("boundProperties"),Zk={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);tv(this);const n=this[Gk];if(t in this&&!n.has(t))throw new ck.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!iv(t))throw new ck.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new ck.a("observable-bind-duplicate-properties: Properties must be unique.",this);tv(this);const e=this[Qk];t.forEach(t=>{if(e.has(t))throw new ck.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:ev,toMany:nv,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Gk])return;const e=this[Qk],n=this[Yk];if(t.length){if(!iv(t))throw new ck.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new ck.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(Zk,Tk);var Xk=Zk;function tv(t){t[Gk]||(Object.defineProperty(t,Gk,{value:new Map}),Object.defineProperty(t,Yk,{value:new Map}),Object.defineProperty(t,Qk,{value:new Map}))}function ev(...t){const e=function(...t){if(!t.length)throw new ck.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new ck.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new ck.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new ck.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new ck.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Yk];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{sv(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Yk],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{sv(this._observable,t)})}function nv(t,e,n){if(this._bindings.size>1)throw new ck.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function iv(t){return t.every(t=>"string"==typeof t)}function sv(t,e){const n=t[Qk].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class ov extends Jk{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}Ik(ov,Xk);class rv{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof ov);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=rv._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new Kk(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=Rk(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new Kk(t)}clone(){return new rv(this.parent,this.offset)}static _createAt(t,e){if(t instanceof rv)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new ck.a("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new rv(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new rv(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new ck.a("view-position-after-root: You can not make position after root.",t,{root:t});return new rv(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new rv(t.textNode,t.offsetInText);if(!t.parent)throw new ck.a("view-position-before-root: You can not make position before root.",t,{root:t});return new rv(t.parent,t.index)}}class av{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new Kk({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(lv,{direction:"backward"}),e=this.end.getLastMatchingPosition(lv);return t.parent.is("text")&&t.isAtStart&&(t=rv._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=rv._createAfter(e.parent)),new av(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition(lv);if(t.isAfter(this.end)||t.isEqual(this.end))return new av(t,t);let e=this.end.getLastMatchingPosition(lv,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new rv(n,0)),i&&i.is("text")&&(e=new rv(i,i.data.length)),new av(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new av(this.start,t.start)),this.containsPosition(t.end)&&e.push(new av(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new av(e,n)}return null}getWalker(t={}){return t.boundaries=this,new Kk(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new av(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new Kk(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new Kk(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new rv(t,e),new rv(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(rv._createBefore(t),e)}}function lv(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function cv(t){let e=0;for(const n of t)e++;return e}class hv{constructor(t=null,e,n){this._selection=new dv,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}Ik(hv,Tk);class dv{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=cv(this.getRanges());if(e!=cv(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof dv||t instanceof hv)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof av)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof rv)this._setRanges([new av(t)]),this._setFakeOptions(e);else if(t instanceof Lk){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new ck.a("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?av._createIn(t):"on"==e?av._createOn(t):new av(rv._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!Bk(t))throw new ck.a("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new ck.a("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=rv._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new av(n,i),!0):this._addRange(new av(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof av))throw new ck.a("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new ck.a("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new av(t.start,t.end))}}Ik(dv,Tk);class uv{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new Dk(t,e)];Bk(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new Dk(t,e):e instanceof Vk?new Dk(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}function fv(t){return"[object Text]"==Object.prototype.toString.call(t)}Ik(uv,Tk);const gv=t=>t.createTextNode(" "),pv=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},mv=(()=>{let t="";for(let e=0;e<7;e++)t+="​";return t})();function bv(t){return fv(t)&&t.data.substr(0,7)===mv}function wv(t){return 7==t.data.length&&bv(t)}function _v(t){return bv(t)?t.data.slice(7):t.data}var kv={window:window,document:document};function vv(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function yv(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const xv=pv(document);class Cv{constructor(t,e={}){this.document=t,this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?pv:gv,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new dv(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}viewToDom(t,e,n={}){if(t.is("text")){const n=this._processDataFromViewText(t);return e.createTextNode(n)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let i;if(t.is("documentFragment"))i=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(i,t);else{if(t.is("uiElement"))return i=t.render(e),n.bind&&this.bindElements(i,t),i;i=t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),n.bind&&this.bindElements(i,t);for(const e of t.getAttributeKeys())i.setAttribute(e,t.getAttribute(e))}if(n.withChildren||void 0===n.withChildren)for(const s of this.viewChildrenToDom(t,e,n))i.appendChild(s);return i}}*viewChildrenToDom(t,e,n={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren())i===s&&(yield this._blockFiller(e)),yield this.viewToDom(o,e,n),s++;i===s&&(yield this._blockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),i=document.createRange();return i.setStart(e.parent,e.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(t){const e=t.parent;if(e.is("text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let i=t.offset;return bv(n)&&(i+=7),{parent:n,offset:i}}{let n,i,s;if(0===t.offset){if(n=this.mapViewToDom(e),!n)return null;s=n.childNodes[0]}else{const e=t.nodeBefore;if(i=e.is("text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!i)return null;n=i.parentNode,s=i.nextSibling}if(fv(s)&&bv(s))return{parent:s,offset:7};return{parent:n,offset:i?vv(i)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t,this.blockFillerMode))return null;const n=this.getParentUIElement(t,this._domToViewMapping);if(n)return n;if(fv(t)){if(wv(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new Dk(this.document,e)}}if(this.isComment(t))return null;{if(this.mapDomToView(t))return this.mapDomToView(t);let n;if(this.isDocumentFragment(t))n=new uv(this.document),e.bind&&this.bindDocumentFragments(t,n);else{const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new Wk(this.document,i),e.bind&&this.bindElements(t,n);const s=t.attributes;for(let t=s.length-1;t>=0;t--)n._setAttribute(s[t].name,s[t].value)}if(e.withChildren||void 0===e.withChildren)for(const i of this.domChildrenToView(t,e))n._appendChild(i);return n}}*domChildrenToView(t,e={}){for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n],s=this.domToView(i,e);null!==s&&(yield s)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;fv(e)&&(e=e.parentNode);const n=this.fakeSelectionToView(e);if(n)return n}const e=this.isDomSelectionBackward(t),n=[];for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e),s=this.domRangeToView(i);s&&n.push(s)}return new dv(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new av(e,n):null}domPositionToView(t,e){if(this.isBlockFiller(t,this.blockFillerMode))return this.domPositionToView(t.parentNode,vv(t));const n=this.mapDomToView(t);if(n&&n.is("uiElement"))return rv._createBefore(n);if(fv(t)){if(wv(t))return this.domPositionToView(t.parentNode,vv(t));const n=this.findCorrespondingViewText(t);let i=e;return n?(bv(t)&&(i-=7,i=i<0?0:i),new rv(n,i)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new rv(e,0)}else{const n=t.childNodes[e-1],i=fv(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new rv(i.parent,i.index+1)}return null}mapDomToView(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(wv(t))return null;const e=this.getParentUIElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const t=this.mapDomToView(n);if(t){return t.nextSibling instanceof Dk?t.nextSibling:null}}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof Dk?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:n}=kv.window,i=[];Tv(e,t=>{const{scrollLeft:e,scrollTop:n}=t;i.push([e,n])}),e.focus(),Tv(e,t=>{const[e,n]=i.shift();t.scrollLeft=e,t.scrollTop=n}),kv.window.scrollTo(t,n)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(xv):!("BR"!==t.tagName||!Av(t,this.blockElements)||1!==t.parentNode.childNodes.length)||function(t,e){return fv(t)&&" "==t.data&&Av(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const n=e.collapsed;return e.detach(),n}getParentUIElement(t){const e=yv(t);for(e.pop();e.length;){const t=e.pop(),n=this._domToViewMapping.get(t);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}_isDomSelectionPositionCorrect(t,e){if(fv(t)&&bv(t)&&e<7)return!1;if(this.isElement(t)&&bv(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!n||!n.is("uiElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const n=this._getTouchingViewTextNode(t,!1);!(n&&this._nodeEndsWithSpace(n))&&n||(e=" "+e.substr(1))}if(" "==e.charAt(e.length-1)){const n=this._getTouchingViewTextNode(t,!0);" "!=e.charAt(e.length-2)&&n&&" "!=n.data.charAt(0)||(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(Ev(t,this.preElements))return _v(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(t,!1),i=this._getTouchingInlineDomNode(t,!0),s=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,i);return s&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=_v(new Text(e)),e=e.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(e)||!i||i.data&&" "==i.data.charAt(0))&&(e=e.replace(/\u00A0$/," ")),s&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t){return!t||(!!nn(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!bv(t)}_getTouchingViewTextNode(t,e){const n=new Kk({startPosition:e?rv._createAfter(t):rv._createBefore(t),direction:e?"forward":"backward"});for(const t of n){if(t.item.is("containerElement"))return null;if(t.item.is("br"))return null;if(t.item.is("textProxy"))return t.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const n=e?"nextNode":"previousNode",i=t.ownerDocument,s=yv(t)[0],o=i.createTreeWalker(s,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:t=>fv(t)||"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=t;const r=o[n]();if(null!==r){const e=function(t,e){const n=yv(t),i=yv(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}(t,r);if(e&&!Ev(t,this.blockElements,e)&&!Ev(r,this.blockElements,e))return r}return null}}function Ev(t,e,n){let i=yv(t);return n&&(i=i.slice(i.indexOf(n)+1)),i.some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}function Tv(t,e){for(;t&&t!=kv.document;)e(t),t=t.parentNode}function Av(t,e){const n=t.parentNode;return n&&n.tagName&&e.includes(n.tagName.toLowerCase())}function Pv(t){if(t.newChildren.length-t.oldChildren.length!=1)return;const e=function(t,e){const n=[];let i,s=0;return t.forEach(t=>{"equal"==t?(o(),s++):"insert"==t?(r("insert")?i.values.push(e[s]):(o(),i={type:"insert",index:s,values:[e[s]]}),s++):r("delete")?i.howMany++:(o(),i={type:"delete",index:s,howMany:1})}),o(),n;function o(){i&&(n.push(i),i=null)}function r(t){return i&&i.type==t}}(wk(t.oldChildren,t.newChildren,Sv),t.newChildren);if(e.length>1)return;const n=e[0];return n.values[0]&&n.values[0].is("text")?n:void 0}function Sv(t,e){return t&&t.is("text")&&e&&e.is("text")?t.data===e.data:t===e}class Ov{constructor(t){this.editor=t,this.editing=this.editor.editing}handle(t,e){if(function(t){if(0==t.length)return!1;for(const e of t)if("children"===e.type&&!Pv(e))return!0;return!1}(t))this._handleContainerChildrenMutations(t,e);else for(const n of t)this._handleTextMutation(n,e),this._handleTextNodeInsertion(n)}_handleContainerChildrenMutations(t,e){const n=function(t){const e=t.map(t=>t.node).reduce((t,e)=>t.getCommonAncestor(e,{includeSelf:!0}));if(!e)return;return e.getAncestors({includeSelf:!0,parentFirst:!0}).find(t=>t.is("containerElement")||t.is("rootElement"))}(t);if(!n)return;const i=this.editor.editing.view.domConverter.mapViewToDom(n),s=new Cv(this.editor.editing.view.document),o=this.editor.data.toModel(s.domToView(i)).getChild(0),r=this.editor.editing.mapper.toModelElement(n);if(!r)return;const a=Array.from(o.getChildren()),l=Array.from(r.getChildren()),c=a[a.length-1],h=l[l.length-1];c&&c.is("softBreak")&&h&&!h.is("softBreak")&&a.pop();const d=this.editor.model.schema;if(!Mv(a,d)||!Mv(l,d))return;const u=a.map(t=>t.is("text")?t.data:"@").join("").replace(/\u00A0/g," "),f=l.map(t=>t.is("text")?t.data:"@").join("").replace(/\u00A0/g," ");if(f===u)return;const g=wk(f,u),{firstChangeAt:p,insertions:m,deletions:b}=Nv(g);let w=null;e&&(w=this.editing.mapper.toModelRange(e.getFirstRange()));const _=u.substr(p,m),k=this.editor.model.createRange(this.editor.model.createPositionAt(r,p),this.editor.model.createPositionAt(r,p+b));this.editor.execute("input",{text:_,range:k,resultRange:w})}_handleTextMutation(t,e){if("text"!=t.type)return;const n=t.newText.replace(/\u00A0/g," "),i=t.oldText.replace(/\u00A0/g," ");if(i===n)return;const s=wk(i,n),{firstChangeAt:o,insertions:r,deletions:a}=Nv(s);let l=null;e&&(l=this.editing.mapper.toModelRange(e.getFirstRange()));const c=this.editing.view.createPositionAt(t.node,o),h=this.editing.mapper.toModelPosition(c),d=this.editor.model.createRange(h,h.getShiftedBy(a)),u=n.substr(o,r);this.editor.execute("input",{text:u,range:d,resultRange:l})}_handleTextNodeInsertion(t){if("children"!=t.type)return;const e=Pv(t),n=this.editing.view.createPositionAt(t.node,e.index),i=this.editing.mapper.toModelPosition(n),s=e.values[0].data;this.editor.execute("input",{text:s.replace(/\u00A0/g," "),range:this.editor.model.createRange(i)})}}function Mv(t,e){return t.every(t=>e.isInline(t))}function Nv(t){let e=null,n=null;for(let i=0;i<t.length;i++){"equal"!=t[i]&&(e=null===e?i:e,n=i)}let i=0,s=0;for(let o=e;o<=n;o++)"insert"!=t[o]&&i++,"delete"!=t[o]&&s++;return{insertions:s,deletions:i,firstChangeAt:e}}class Iv extends Nc{static get pluginName(){return"Input"}init(){const t=this.editor,e=new lk(t,t.config.get("typing.undoStep")||20);t.commands.add("input",e),gk(t),function(t){t.editing.view.document.on("mutations",(e,n,i)=>{new Ov(t).handle(n,i)})}(t)}isInput(t){return this.editor.commands.get("input")._batches.has(t)}}class Rv extends Vu{constructor(t,e){super(t),this.direction=e,this._buffer=new ak(t.model,t.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(t={}){const e=this.editor.model,n=e.document;e.enqueueChange(this._buffer.batch,i=>{this._buffer.lock();const s=i.createSelection(t.selection||n.selection),o=s.isCollapsed;if(s.isCollapsed&&e.modifySelection(s,{direction:this.direction,unit:t.unit}),this._shouldEntireContentBeReplacedWithParagraph(t.sequence||1))return void this._replaceEntireContentWithParagraph(i);if(s.isCollapsed)return;let r=0;s.getFirstRange().getMinimalFlatRanges().forEach(t=>{r+=cv(t.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),e.deleteContent(s,{doNotResetEntireContent:o,direction:this.direction}),this._buffer.input(r),i.setSelection(s),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(t){if(t>1)return!1;const e=this.editor.model,n=e.document.selection,i=e.schema.getLimitElement(n);if(!(n.isCollapsed&&n.containsEntireContent(i)))return!1;if(!e.schema.checkChild(i,"paragraph"))return!1;const s=i.getChild(0);return!s||"paragraph"!==s.name}_replaceEntireContentWithParagraph(t){const e=this.editor.model,n=e.document.selection,i=e.schema.getLimitElement(n),s=t.createElement("paragraph");t.remove(t.createRangeIn(i)),t.insert(s,i),t.setSelection(s,0)}}function Lv(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function Dv(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var Vv=Vi({},Tk,{listenTo(t,...e){if(Lv(t)||Dv(t)){const n=this._getProxyEmitter(t)||new Bv(t);n.attach(...e),t=n}Tk.listenTo.call(this,t,...e)},stopListening(t,e,n){if(Lv(t)||Dv(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}Tk.stopListening.call(this,t,e,n),t instanceof Bv&&t.detach(e)},_getProxyEmitter(t){return e=this,n=Fv(t),e[Ck]&&e[Ck][n]?e[Ck][n].emitter:null;var e,n}});class Bv{constructor(t){Ak(this,Fv(t)),this._domNode=t}}function Fv(t){return t["data-ck-expando"]||(t["data-ck-expando"]=yk())}Vi(Bv.prototype,Tk,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class jv{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}Ik(jv,Vv);class zv{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class qv extends jv{constructor(t){super(t);const e=t.document;let n=0;function i(t,n,i){let s;e.once("delete",t=>s=t,{priority:Number.POSITIVE_INFINITY}),e.fire("delete",new zv(e,n,i)),s&&s.stop.called&&t.stop()}e.on("keyup",(t,e)=>{e.keyCode!=uk.delete&&e.keyCode!=uk.backspace||(n=0)}),e.on("keydown",(t,e)=>{const s={};if(e.keyCode==uk.delete)s.direction="forward",s.unit="character";else{if(e.keyCode!=uk.backspace)return;s.direction="backward",s.unit="codePoint"}const o=dk.isMac?e.altKey:e.ctrlKey;s.unit=o?"word":s.unit,s.sequence=++n,i(t,e.domEvent,s)}),dk.isAndroid&&e.on("beforeinput",(e,n)=>{if("deleteContentBackward"!=n.domEvent.inputType)return;const s={unit:"codepoint",direction:"backward",sequence:1},o=n.domTarget.ownerDocument.defaultView.getSelection();o.anchorNode==o.focusNode&&o.anchorOffset+1!=o.focusOffset&&(s.selectionToRemove=t.domConverter.domSelectionToView(o)),i(e,n.domEvent,s)})}observe(){}}class Uv extends Nc{static get pluginName(){return"Delete"}init(){const t=this.editor,e=t.editing.view,n=e.document;if(e.addObserver(qv),t.commands.add("forwardDelete",new Rv(t,"forward")),t.commands.add("delete",new Rv(t,"backward")),this.listenTo(n,"delete",(n,i)=>{const s={unit:i.unit,sequence:i.sequence};if(i.selectionToRemove){const e=t.model.createSelection(),n=[];for(const e of i.selectionToRemove.getRanges())n.push(t.editing.mapper.toModelRange(e));e.setTo(n),s.selection=e}t.execute("forward"==i.direction?"forwardDelete":"delete",s),i.preventDefault(),e.scrollToTheSelection()}),dk.isAndroid){let t=null;this.listenTo(n,"delete",(e,n)=>{const i=n.domTarget.ownerDocument.defaultView.getSelection();t={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}},{priority:"lowest"}),this.listenTo(n,"keyup",(e,n)=>{if(t){const e=n.domTarget.ownerDocument.defaultView.getSelection();e.collapse(t.anchorNode,t.anchorOffset),e.extend(t.focusNode,t.focusOffset),t=null}})}}}class Wv extends Nc{static get requires(){return[Iv,Uv]}static get pluginName(){return"Typing"}}class Hv{constructor(t){this.baseVersion=t,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t){return new this(t.baseVersion)}}function Kv(t){return!(!t||!t[Symbol.iterator])}function Jv(t){return Kv(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}var $v=n(2);function Gv(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}n(39);class Yv{constructor(t){this.parent=null,this._attrs=Jv(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new $v.a("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new $v.a("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=Gv(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}is(t){return"node"===t||"model:node"===t}_clone(){return new Yv(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=Jv(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class Qv extends Yv{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"text"===t||"model:text"===t||"node"===t||"model:node"===t}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new Qv(this.data,this.getAttributes())}static fromJSON(t){return new Qv(t.data,t.attributes)}}class Zv{constructor(t,e,n){if(this.textNode=t,e<0||e>t.offsetSize)throw new $v.a("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.offsetSize)throw new $v.a("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return"textProxy"===t||"model:textProxy"===t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class Xv{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new $v.a("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new $v.a("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const t of e)if(!(t instanceof Yv))throw new $v.a("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class ty extends Yv{constructor(t,e,n){super(e),this.name=t,this._children=new Xv,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?e===this.name&&("element"===t||"model:element"===t):"element"===t||"model:element"===t||t===this.name||t==="model:"+this.name||"node"===t||"model:node"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new ty(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new Qv(t)];Kv(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new Qv(t):t instanceof Zv?new Qv(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}static fromJSON(t){let e=null;if(t.children){e=[];for(const n of t.children)n.name?e.push(ty.fromJSON(n)):e.push(Qv.fromJSON(n))}return new ty(t.name,t.attributes,e)}}class ey{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new $v.a("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new $v.a("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=iy._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,n,i,s;do{i=this.position,s=this._visitedParent,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const i=e.parent,s=sy(e,i),o=s||oy(e,i,s);if(o instanceof ty)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=o),this.position=e,ny("elementStart",o,t,e,1);if(o instanceof Qv){let i;if(this.singleCharacters)i=1;else{let t=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),i=t-e.offset}const s=e.offset-o.startOffset,r=new Zv(o,s,i);return e.offset+=i,this.position=e,ny("text",r,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():ny("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const i=e.parent,s=sy(e,i),o=s||ry(e,i,s);if(o instanceof ty)return e.offset--,this.shallow?(this.position=e,ny("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this.position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():ny("elementEnd",o,t,e));if(o instanceof Qv){let i;if(this.singleCharacters)i=1;else{let t=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),i=e.offset-t}const s=e.offset-o.startOffset,r=new Zv(o,s-i,i);return e.offset-=i,this.position=e,ny("text",r,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,ny("elementStart",n,t,e,1)}}function ny(t,e,n,i,s){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}class iy{constructor(t,e,n="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new $v.a("model-position-root-invalid: Position root invalid.",t);if(!(e instanceof Array)||0===e.length)throw new $v.a("model-position-path-incorrect-format: Position path must be an array with at least one item.",t,{path:e});t.is("rootElement")?e=e.slice():(e=[...t.getPath(),...e],t=t.root),this.root=t,this.path=e,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)if(t=t.getChild(t.offsetToIndex(this.path[e])),!t)throw new $v.a("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(t.is("text"))throw new $v.a("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return sy(this,this.parent)}get nodeAfter(){const t=this.parent;return oy(this,t,sy(this,t))}get nodeBefore(){const t=this.parent;return ry(this,t,sy(this,t))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=Gv(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new ey(e);return n.skip(t),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}getCommonPath(t){if(this.root!=t.root)return[];const e=Gv(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}getShiftedBy(t){const e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,n=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=iy._createAt(this),n=iy._createAt(t);break;case"after":e=iy._createAt(t),n=iy._createAt(this);break;default:return!1}let i=e.parent;for(;e.path.length+n.path.length;){if(e.isEqual(n))return!0;if(e.path.length>n.path.length){if(e.offset!==i.maxOffset)return!1;e.path=e.path.slice(0,-1),i=i.parent,e.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}is(t){return"position"===t||"model:position"===t}hasSameParentAs(t){if(this.root!==t.root)return!1;return"same"==Gv(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=iy._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let n;return e.containsPosition(this)||e.start.isEqual(this)?(n=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(n=n._getTransformedByDeletion(t.deletionPosition,1))):n=this.isEqual(t.deletionPosition)?iy._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),n}_getTransformedByDeletion(t,e){const n=iy._createAt(this);if(this.root!=t.root)return n;if("same"==Gv(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;n.offset-=e}}else if("prefix"==Gv(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;if(t.offset<=this.path[i]){if(t.offset+e>this.path[i])return null;n.path[i]-=e}}return n}_getTransformedByInsertion(t,e){const n=iy._createAt(this);if(this.root!=t.root)return n;if("same"==Gv(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=e);else if("prefix"==Gv(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;t.offset<=this.path[i]&&(n.path[i]+=e)}return n}_getTransformedByMove(t,e,n){if(e=e._getTransformedByDeletion(t,n),t.isEqual(e))return iy._createAt(this);const i=this._getTransformedByDeletion(t,n);return null===i||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):i._getTransformedByInsertion(e,n)}_getCombined(t,e){const n=t.path.length-1,i=iy._createAt(e);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-t.offset,i.path=[...i.path,...this.path.slice(n+1)],i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,n="toNone"){if(t instanceof iy)return new iy(t.root,t.path,t.stickiness);{const i=t;if("end"==e)e=i.maxOffset;else{if("before"==e)return this._createBefore(i,n);if("after"==e)return this._createAfter(i,n);if(0!==e&&!e)throw new $v.a("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,t])}if(!i.is("element")&&!i.is("documentFragment"))throw new $v.a("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,t]);const s=i.getPath();return s.push(e),new this(i.root,s,n)}}static _createAfter(t,e){if(!t.parent)throw new $v.a("model-position-after-root: You cannot make a position after root.",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new $v.a("model-position-before-root: You cannot make a position before root.",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const n=new iy(e.graveyard,t.path);return n.stickiness=t.stickiness,n}if(!e.getRoot(t.root))throw new $v.a("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",e,{rootName:t.root});return new iy(e.getRoot(t.root),t.path,t.stickiness)}}function sy(t,e){const n=e.getChild(e.offsetToIndex(t.offset));return n&&n.is("text")&&n.startOffset<t.offset?n:null}function oy(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset))}function ry(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset)-1)}class ay{constructor(t,e=null){this.start=iy._createAt(t),this.end=e?iy._createAt(e):iy._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new ey({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==Gv(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}containsItem(t){const e=iy._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}is(t){return"range"===t||"model:range"===t}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new ay(this.start,t.start)),this.containsPosition(t.end)&&e.push(new ay(t.end,this.end))):e.push(new ay(this.start,this.end)),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new ay(e,n)}return null}getMinimalFlatRanges(){const t=[],e=this.start.getCommonPath(this.end).length,n=iy._createAt(this.start);let i=n.parent;for(;n.path.length>e+1;){const e=i.maxOffset-n.offset;0!==e&&t.push(new ay(n,n.getShiftedBy(e))),n.path=n.path.slice(0,-1),n.offset++,i=i.parent}for(;n.path.length<=this.end.path.length;){const e=this.end.path[n.path.length-1],i=e-n.offset;0!==i&&t.push(new ay(n,n.getShiftedBy(i))),n.offset=e,n.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new ey(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new ey(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new ey(t);yield e.position;for(const t of e)yield t.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new ay(this.start,this.end)]}getTransformedByOperations(t){const e=[new ay(this.start,this.end)];for(const n of t)for(let t=0;t<e.length;t++){const i=e[t].getTransformedByOperation(n);e.splice(t,1,...i),t+=i.length-1}for(let t=0;t<e.length;t++){const n=e[t];for(let i=t+1;i<e.length;i++){const t=e[i];(n.containsRange(t)||t.containsRange(n)||n.isEqual(t))&&e.splice(i,1)}}return e}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,e=this.end.nodeBefore;return t&&t.is("element")&&t===e?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,e=!1){return this._getTransformedByInsertion(t.position,t.howMany,e)}_getTransformedByMoveOperation(t,e=!1){const n=t.sourcePosition,i=t.howMany,s=t.targetPosition;return this._getTransformedByMove(n,s,i,e)}_getTransformedBySplitOperation(t){const e=this.start._getTransformedBySplitOperation(t);let n=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(n=this.end.getShiftedBy(1)),e.root!=n.root&&(n=this.end.getShiftedBy(-1)),new ay(e,n)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new ay(this.start);let e=this.start._getTransformedByMergeOperation(t),n=this.end._getTransformedByMergeOperation(t);return e.root!=n.root&&(n=this.end.getShiftedBy(-1)),e.isAfter(n)?(t.sourcePosition.isBefore(t.targetPosition)?(e=iy._createAt(n),e.offset=0):(t.deletionPosition.isEqual(e)||(n=t.deletionPosition),e=t.targetPosition),new ay(e,n)):new ay(e,n)}_getTransformedByInsertion(t,e,n=!1){if(n&&this.containsPosition(t))return[new ay(this.start,t),new ay(t.getShiftedBy(e),this.end._getTransformedByInsertion(t,e))];{const n=new ay(this.start,this.end);return n.start=n.start._getTransformedByInsertion(t,e),n.end=n.end._getTransformedByInsertion(t,e),[n]}}_getTransformedByMove(t,e,n,i=!1){if(this.isCollapsed){const i=this.start._getTransformedByMove(t,e,n);return[new ay(i)]}const s=ay._createFromPositionAndShift(t,n),o=e._getTransformedByDeletion(t,n);if(this.containsPosition(e)&&!i&&(s.containsPosition(this.start)||s.containsPosition(this.end))){const i=this.start._getTransformedByMove(t,e,n),s=this.end._getTransformedByMove(t,e,n);return[new ay(i,s)]}let r;const a=this.getDifference(s);let l=null;const c=this.getIntersection(s);if(1==a.length?l=new ay(a[0].start._getTransformedByDeletion(t,n),a[0].end._getTransformedByDeletion(t,n)):2==a.length&&(l=new ay(this.start,this.end._getTransformedByDeletion(t,n))),r=l?l._getTransformedByInsertion(o,n,null!==c||i):[],c){const t=new ay(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,t):r.push(t)}return r}_getTransformedByDeletion(t,e){let n=this.start._getTransformedByDeletion(t,e),i=this.end._getTransformedByDeletion(t,e);return null==n&&null==i?null:(null==n&&(n=t),null==i&&(i=t),new ay(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return new this(iy._createAt(t,0),iy._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(iy._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(0===t.length)throw new $v.a("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(1==t.length)return t[0].clone();const e=t[0];t.sort((t,e)=>t.start.isAfter(e.start)?1:-1);const n=t.indexOf(e),i=new this(e.start,e.end);if(n>0)for(let e=n-1;t[e].end.isEqual(i.start);e++)i.start=iy._createAt(t[e].start);for(let e=n+1;e<t.length&&t[e].start.isEqual(i.end);e++)i.end=iy._createAt(t[e].end);return i}static fromJSON(t,e){return new this(iy.fromJSON(t.start,e),iy.fromJSON(t.end,e))}}class ly{constructor(t){this.markers=new Map,this._children=new Xv,t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"model:documentFragment"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const e of this._children)t.push(e.toJSON());return t}static fromJSON(t){const e=[];for(const n of t)n.name?e.push(ty.fromJSON(n)):e.push(Qv.fromJSON(n));return new ly(e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new Qv(t)];Kv(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new Qv(t):t instanceof Zv?new Qv(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}}function cy(t,e){const n=(e=dy(e)).reduce((t,e)=>t+e.offsetSize,0),i=t.parent;fy(t);const s=t.index;return i._insertChild(s,e),uy(i,s+e.length),uy(i,s),new ay(t,t.getShiftedBy(n))}function hy(t,e){if(!t.isFlat)throw new $v.a("operation-utils-move-range-not-flat: Trying to move a range which starts and ends in different element.",this);const n=function(t){if(!t.isFlat)throw new $v.a("operation-utils-remove-range-not-flat: Trying to remove a range which starts and ends in different element.",this);const e=t.start.parent;fy(t.start),fy(t.end);const n=e._removeChildren(t.start.index,t.end.index-t.start.index);return uy(e,t.start.index),n}(t);return cy(e=e._getTransformedByDeletion(t.start,t.end.offset-t.start.offset),n)}function dy(t){const e=[];t instanceof Array||(t=[t]);for(let n=0;n<t.length;n++)if("string"==typeof t[n])e.push(new Qv(t[n]));else if(t[n]instanceof Zv)e.push(new Qv(t[n].data,t[n].getAttributes()));else if(t[n]instanceof ly||t[n]instanceof Xv)for(const i of t[n])e.push(i);else t[n]instanceof Yv&&e.push(t[n]);for(let t=1;t<e.length;t++){const n=e[t],i=e[t-1];n instanceof Qv&&i instanceof Qv&&gy(n,i)&&(e.splice(t-1,2,new Qv(i.data+n.data,i.getAttributes())),t--)}return e}function uy(t,e){const n=t.getChild(e-1),i=t.getChild(e);if(n&&i&&n.is("text")&&i.is("text")&&gy(n,i)){const s=new Qv(n.data+i.data,n.getAttributes());t._removeChildren(e-1,2),t._insertChild(e-1,s)}}function fy(t){const e=t.textNode,n=t.parent;if(e){const i=t.offset-e.startOffset,s=e.index;n._removeChildren(s,1);const o=new Qv(e.data.substr(0,i),e.getAttributes()),r=new Qv(e.data.substr(i),e.getAttributes());n._insertChild(s,[o,r])}}function gy(t,e){const n=t.getAttributes(),i=e.getAttributes();for(const t of n){if(t[1]!==e.getAttribute(t[0]))return!1;i.next()}return i.next().done}class py extends Hv{constructor(t,e,n,i){super(i),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=e,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent,n=this.sourcePosition.offset,i=this.targetPosition.offset;if(n+this.howMany>t.maxOffset)throw new $v.a("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.",this);if(t===e&&n<i&&i<n+this.howMany)throw new $v.a("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==Gv(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const t=this.sourcePosition.path.length-1;if(this.targetPosition.path[t]>=n&&this.targetPosition.path[t]<n+this.howMany)throw new $v.a("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.",this)}}_execute(){hy(ay._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,e){const n=iy.fromJSON(t.sourcePosition,e),i=iy.fromJSON(t.targetPosition,e);return new this(n,t.howMany,i,t.baseVersion)}}class my extends Hv{constructor(t,e,n){super(n),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new Xv(dy(e)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const t=new Xv([...this.nodes].map(t=>t._clone(!0))),e=new my(this.position,t,this.baseVersion);return e.shouldReceiveAttributes=this.shouldReceiveAttributes,e}getReversed(){const t=this.position.root.document.graveyard,e=new iy(t,[0]);return new py(this.position,this.nodes.maxOffset,e,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new $v.a("insert-operation-position-invalid: Insertion position is invalid.",this)}_execute(){const t=this.nodes;this.nodes=new Xv([...t].map(t=>t._clone(!0))),cy(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,e){const n=[];for(const e of t.nodes)e.name?n.push(ty.fromJSON(e)):n.push(Qv.fromJSON(e));const i=new my(iy.fromJSON(t.position,e),n,t.baseVersion);return i.shouldReceiveAttributes=t.shouldReceiveAttributes,i}}class by extends Hv{constructor(t,e,n,i,s){super(s),this.range=t.clone(),this.key=e,this.oldValue=void 0===n?null:n,this.newValue=void 0===i?null:i}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new by(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new by(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new $v.a("attribute-operation-range-not-flat: The range to change is not flat.",this);for(const t of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!Ta(t.getAttribute(this.key),this.oldValue))throw new $v.a("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{item:t,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&t.hasAttribute(this.key))throw new $v.a("attribute-operation-attribute-exists: The attribute with given key already exists.",this,{node:t,key:this.key})}}_execute(){Ta(this.oldValue,this.newValue)||function(t,e,n){fy(t.start),fy(t.end);for(const i of t.getItems({shallow:!0})){const t=i.is("textProxy")?i.textNode:i;null!==n?t._setAttribute(e,n):t._removeAttribute(e),uy(t.parent,t.index)}uy(t.end.parent,t.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,e){return new by(ay.fromJSON(t.range,e),t.key,t.oldValue,t.newValue,t.baseVersion)}}class wy extends Hv{constructor(t,e,n,i){super(i),this.position=t,this.position.stickiness="toNext",this.oldName=e,this.newName=n}get type(){return"rename"}clone(){return new wy(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new wy(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(!(t instanceof ty))throw new $v.a("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.",this);if(t.name!==this.oldName)throw new $v.a("rename-operation-wrong-name: Element to change has different name than operation's old name.",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,e){return new wy(iy.fromJSON(t.position,e),t.oldName,t.newName,t.baseVersion)}}class _y extends Hv{constructor(t,e,n,i,s,o){super(o),this.name=t,this.oldRange=e?e.clone():null,this.newRange=n?n.clone():null,this.affectsData=s,this._markers=i}get type(){return"marker"}clone(){return new _y(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new _y(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const t=this.newRange?"_set":"_remove";this._markers[t](this.name,this.newRange,!0,this.affectsData)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,e){return new _y(t.name,t.oldRange?ay.fromJSON(t.oldRange,e):null,t.newRange?ay.fromJSON(t.newRange,e):null,e.model.markers,t.affectsData,t.baseVersion)}}class ky extends Hv{constructor(t,e,n,i,s){super(s),this.root=t,this.key=e,this.oldValue=n,this.newValue=i}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new ky(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new ky(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new $v.a("rootattribute-operation-not-a-root: The element to change is not a root element.",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new $v.a("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new $v.a("rootattribute-operation-attribute-exists: The attribute with given key already exists.",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,e){if(!e.getRoot(t.root))throw new $v.a("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",this,{rootName:t.root});return new ky(e.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}}class vy extends Hv{constructor(t,e,n,i){super(i),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=e,this.insertionPosition=vy.getInsertionPosition(t),this.insertionPosition.stickiness="toNone",this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new iy(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new ay(this.splitPosition,t)}clone(){const t=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return t.insertionPosition=this.insertionPosition,t}getReversed(){const t=this.splitPosition.root.document.graveyard,e=new iy(t,[0]);return new yy(this.moveTargetPosition,this.howMany,this.splitPosition,e,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent,e=this.splitPosition.offset;if(!t||t.maxOffset<e)throw new $v.a("split-operation-position-invalid: Split position is invalid.",this);if(!t.parent)throw new $v.a("split-operation-split-in-root: Cannot split root element.",this);if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new $v.a("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new $v.a("split-operation-graveyard-position-invalid: Graveyard position invalid.",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)hy(ay._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const e=t._clone();cy(this.insertionPosition,e)}hy(new ay(iy._createAt(t,this.splitPosition.offset),iy._createAt(t,t.maxOffset)),this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const e=t.path.slice(0,-1);return e[e.length-1]++,new iy(t.root,e)}static fromJSON(t,e){const n=iy.fromJSON(t.splitPosition,e),i=iy.fromJSON(t.insertionPosition,e),s=t.graveyardPosition?iy.fromJSON(t.graveyardPosition,e):null,o=new this(n,t.howMany,s,t.baseVersion);return o.insertionPosition=i,o}}class yy extends Hv{constructor(t,e,n,i,s){super(s),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=e,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=i.clone()}get type(){return"merge"}get deletionPosition(){return new iy(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new ay(this.sourcePosition,t)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),e=this.sourcePosition.path.slice(0,-1),n=new iy(this.sourcePosition.root,e)._getTransformedByMergeOperation(this),i=new vy(t,this.howMany,this.graveyardPosition,this.baseVersion+1);return i.insertionPosition=n,i}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent;if(!t.parent)throw new $v.a("merge-operation-source-position-invalid: Merge source position is invalid.",this);if(!e.parent)throw new $v.a("merge-operation-target-position-invalid: Merge target position is invalid.",this);if(this.howMany!=t.maxOffset)throw new $v.a("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.",this)}_execute(){const t=this.sourcePosition.parent;hy(ay._createIn(t),this.targetPosition),hy(ay._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,e){const n=iy.fromJSON(t.sourcePosition,e),i=iy.fromJSON(t.targetPosition,e),s=iy.fromJSON(t.graveyardPosition,e);return new this(n,t.howMany,i,s,t.baseVersion)}}class xy extends Hv{get type(){return"noop"}clone(){return new xy(this.baseVersion)}getReversed(){return new xy(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const Cy=new Map;function Ey(t,e,n){let i=Cy.get(t);i||(i=new Map,Cy.set(t,i)),i.set(e,n)}function Ty(t){return[t]}function Ay(t,e,n={}){const i=function(t,e){const n=Cy.get(t);return n&&n.has(e)?n.get(e):Ty}(t.constructor,e.constructor);try{return i(t=t.clone(),e,n)}catch(t){throw t}}function Py(t,e,n){t=t.slice(),e=e.slice();const i=new Sy(n.document,n.useRelations,n.forceWeakRemove);i.setOriginalOperations(t),i.setOriginalOperations(e);const s=i.originalOperations;if(0==t.length||0==e.length)return{operationsA:t,operationsB:e,originalOperations:s};const o=new WeakMap;for(const e of t)o.set(e,0);const r={nextBaseVersionA:t[t.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:t.length,originalOperationsBCount:e.length};let a=0;for(;a<t.length;){const n=t[a],s=o.get(n);if(s==e.length){a++;continue}const r=e[s],l=Ay(n,r,i.getContext(n,r,!0)),c=Ay(r,n,i.getContext(r,n,!1));i.updateRelation(n,r),i.setOriginalOperations(l,n),i.setOriginalOperations(c,r);for(const t of l)o.set(t,s+c.length);t.splice(a,1,...l),e.splice(s,1,...c)}if(n.padWithNoOps){const n=t.length-r.originalOperationsACount,i=e.length-r.originalOperationsBCount;My(t,i-n),My(e,n-i)}return Oy(t,r.nextBaseVersionB),Oy(e,r.nextBaseVersionA),{operationsA:t,operationsB:e,originalOperations:s}}class Sy{constructor(t,e,n=!1){this.originalOperations=new Map,this._history=t.history,this._useRelations=e,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(t,e=null){const n=e?this.originalOperations.get(e):null;for(const e of t)this.originalOperations.set(e,n||e)}updateRelation(t,e){switch(t.constructor){case py:switch(e.constructor){case yy:t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter");break;case py:t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter")}break;case vy:switch(e.constructor){case yy:t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");break;case py:(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))&&this._setRelation(t,e,"splitBefore")}break;case yy:switch(e.constructor){case yy:t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.targetPosition)&&this._setRelation(t,e,"mergeSourceNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement");break;case vy:t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource")}break;case _y:{const n=t.newRange;if(!n)return;switch(e.constructor){case py:{const i=ay._createFromPositionAndShift(e.sourcePosition,e.howMany),s=i.containsPosition(n.start)||i.start.isEqual(n.start),o=i.containsPosition(n.end)||i.end.isEqual(n.end);!s&&!o||i.containsRange(n)||this._setRelation(t,e,{side:s?"left":"right",path:s?n.start.path.slice():n.end.path.slice()});break}case yy:{const i=n.start.isEqual(e.targetPosition),s=n.start.isEqual(e.deletionPosition),o=n.end.isEqual(e.deletionPosition),r=n.end.isEqual(e.sourcePosition);(i||s||o||r)&&this._setRelation(t,e,{wasInLeftElement:i,wasStartBeforeMergedElement:s,wasEndBeforeMergedElement:o,wasInRightElement:r});break}}break}}}getContext(t,e,n){return{aIsStrong:n,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const e=this.originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}_getRelation(t,e){const n=this.originalOperations.get(e),i=this._history.getUndoneOperation(n);if(!i)return null;const s=this.originalOperations.get(t),o=this._relations.get(s);return o&&o.get(i)||null}_setRelation(t,e,n){const i=this.originalOperations.get(t),s=this.originalOperations.get(e);let o=this._relations.get(i);o||(o=new Map,this._relations.set(i,o)),o.set(s,n)}}function Oy(t,e){for(const n of t)n.baseVersion=e++}function My(t,e){for(let n=0;n<e;n++)t.push(new xy(0))}function Ny(t,e,n){const i=t.nodes.getNode(0).getAttribute(e);if(i==n)return null;const s=new ay(t.position,t.position.getShiftedBy(t.howMany));return new by(s,e,i,n,0)}function Iy(t,e){return null===t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)}function Ry(t,e){const n=[];for(let i=0;i<t.length;i++){const s=t[i],o=new py(s.start,s.end.offset-s.start.offset,e,0);n.push(o);for(let e=i+1;e<t.length;e++)t[e]=t[e]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];e=e._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return n}Ey(by,by,(t,e,n)=>{if(t.key===e.key&&t.range.start.hasSameParentAs(e.range.start)){const i=t.range.getDifference(e.range).map(e=>new by(e,t.key,t.oldValue,t.newValue,0)),s=t.range.getIntersection(e.range);return s&&n.aIsStrong&&i.push(new by(s,e.key,e.newValue,t.newValue,0)),0==i.length?[new xy(0)]:i}return[t]}),Ey(by,my,(t,e)=>{if(t.range.start.hasSameParentAs(e.position)&&t.range.containsPosition(e.position)){const n=t.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(e=>new by(e,t.key,t.oldValue,t.newValue,t.baseVersion));if(e.shouldReceiveAttributes){const i=Ny(e,t.key,t.oldValue);i&&n.unshift(i)}return n}return t.range=t.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[t]}),Ey(by,yy,(t,e)=>{const n=[];t.range.start.hasSameParentAs(e.deletionPosition)&&(t.range.containsPosition(e.deletionPosition)||t.range.start.isEqual(e.deletionPosition))&&n.push(ay._createFromPositionAndShift(e.graveyardPosition,1));const i=t.range._getTransformedByMergeOperation(e);return i.isCollapsed||n.push(i),n.map(e=>new by(e,t.key,t.oldValue,t.newValue,t.baseVersion))}),Ey(by,py,(t,e)=>function(t,e){const n=ay._createFromPositionAndShift(e.sourcePosition,e.howMany);let i=null,s=[];n.containsRange(t,!0)?i=t:t.start.hasSameParentAs(n.start)?(s=t.getDifference(n),i=t.getIntersection(n)):s=[t];const o=[];for(let t of s){t=t._getTransformedByDeletion(e.sourcePosition,e.howMany);const n=e.getMovedRangeStart(),i=t.start.hasSameParentAs(n);t=t._getTransformedByInsertion(n,e.howMany,i),o.push(...t)}i&&o.push(i._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]);return o}(t.range,e).map(e=>new by(e,t.key,t.oldValue,t.newValue,t.baseVersion))),Ey(by,vy,(t,e)=>{if(t.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.range.end.offset++,[t];if(t.range.start.hasSameParentAs(e.splitPosition)&&t.range.containsPosition(e.splitPosition)){const n=t.clone();return n.range=new ay(e.moveTargetPosition.clone(),t.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),t.range.end=e.splitPosition.clone(),t.range.end.stickiness="toPrevious",[t,n]}return t.range=t.range._getTransformedBySplitOperation(e),[t]}),Ey(my,by,(t,e)=>{const n=[t];if(t.shouldReceiveAttributes&&t.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(t.position)){const i=Ny(t,e.key,e.newValue);i&&n.push(i)}return n}),Ey(my,my,(t,e,n)=>(t.position.isEqual(e.position)&&n.aIsStrong||(t.position=t.position._getTransformedByInsertOperation(e)),[t])),Ey(my,py,(t,e)=>(t.position=t.position._getTransformedByMoveOperation(e),[t])),Ey(my,vy,(t,e)=>(t.position=t.position._getTransformedBySplitOperation(e),[t])),Ey(my,yy,(t,e)=>(t.position=t.position._getTransformedByMergeOperation(e),[t])),Ey(_y,my,(t,e)=>(t.oldRange&&(t.oldRange=t.oldRange._getTransformedByInsertOperation(e)[0]),t.newRange&&(t.newRange=t.newRange._getTransformedByInsertOperation(e)[0]),[t])),Ey(_y,_y,(t,e,n)=>{if(t.name==e.name){if(!n.aIsStrong)return[new xy(0)];t.oldRange=e.newRange?e.newRange.clone():null}return[t]}),Ey(_y,yy,(t,e)=>(t.oldRange&&(t.oldRange=t.oldRange._getTransformedByMergeOperation(e)),t.newRange&&(t.newRange=t.newRange._getTransformedByMergeOperation(e)),[t])),Ey(_y,py,(t,e,n)=>{if(t.oldRange&&(t.oldRange=ay._createFromRanges(t.oldRange._getTransformedByMoveOperation(e))),t.newRange){if(n.abRelation){const i=ay._createFromRanges(t.newRange._getTransformedByMoveOperation(e));if("left"==n.abRelation.side&&e.targetPosition.isEqual(t.newRange.start))return t.newRange.start.path=n.abRelation.path,t.newRange.end=i.end,[t];if("right"==n.abRelation.side&&e.targetPosition.isEqual(t.newRange.end))return t.newRange.start=i.start,t.newRange.end.path=n.abRelation.path,[t]}t.newRange=ay._createFromRanges(t.newRange._getTransformedByMoveOperation(e))}return[t]}),Ey(_y,vy,(t,e,n)=>{if(t.oldRange&&(t.oldRange=t.oldRange._getTransformedBySplitOperation(e)),t.newRange){if(n.abRelation){const i=t.newRange._getTransformedBySplitOperation(e);return t.newRange.start.isEqual(e.splitPosition)&&n.abRelation.wasStartBeforeMergedElement?t.newRange.start=iy._createAt(e.insertionPosition):t.newRange.start.isEqual(e.splitPosition)&&!n.abRelation.wasInLeftElement&&(t.newRange.start=iy._createAt(e.moveTargetPosition)),t.newRange.end.isEqual(e.splitPosition)&&n.abRelation.wasInRightElement?t.newRange.end=iy._createAt(e.moveTargetPosition):t.newRange.end.isEqual(e.splitPosition)&&n.abRelation.wasEndBeforeMergedElement?t.newRange.end=iy._createAt(e.insertionPosition):t.newRange.end=i.end,[t]}t.newRange=t.newRange._getTransformedBySplitOperation(e)}return[t]}),Ey(yy,my,(t,e)=>(t.sourcePosition.hasSameParentAs(e.position)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByInsertOperation(e),t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e),[t])),Ey(yy,yy,(t,e,n)=>{if(t.sourcePosition.isEqual(e.sourcePosition)&&t.targetPosition.isEqual(e.targetPosition)){if(n.bWasUndone){const n=e.graveyardPosition.path.slice();return n.push(0),t.sourcePosition=new iy(e.graveyardPosition.root,n),t.howMany=0,[t]}return[new xy(0)]}if(t.sourcePosition.isEqual(e.sourcePosition)&&!t.targetPosition.isEqual(e.targetPosition)&&!n.bWasUndone&&"splitAtSource"!=n.abRelation){const i="$graveyard"==t.targetPosition.root.rootName,s="$graveyard"==e.targetPosition.root.rootName,o=i&&!s;if(s&&!i||!o&&n.aIsStrong){const n=e.targetPosition._getTransformedByMergeOperation(e),i=t.targetPosition._getTransformedByMergeOperation(e);return[new py(n,t.howMany,i,0)]}return[new xy(0)]}return t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMergeOperation(e),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),t.graveyardPosition.isEqual(e.graveyardPosition)&&n.aIsStrong||(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Ey(yy,py,(t,e,n)=>{const i=ay._createFromPositionAndShift(e.sourcePosition,e.howMany);return"remove"==e.type&&!n.bWasUndone&&!n.forceWeakRemove&&t.deletionPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.sourcePosition)?[new xy(0)]:(t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition.hasSameParentAs(e.sourcePosition)&&(t.howMany-=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMoveOperation(e),t.targetPosition=t.targetPosition._getTransformedByMoveOperation(e),t.graveyardPosition.isEqual(e.targetPosition)||(t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)),[t])}),Ey(yy,vy,(t,e,n)=>{if(e.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),t.deletionPosition.isEqual(e.graveyardPosition)&&(t.howMany=e.howMany)),t.targetPosition.isEqual(e.splitPosition)){const i=0!=e.howMany,s=e.graveyardPosition&&t.deletionPosition.isEqual(e.graveyardPosition);if(i||s||"mergeTargetNotMoved"==n.abRelation)return t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),[t]}if(t.sourcePosition.isEqual(e.splitPosition)){if("mergeSourceNotMoved"==n.abRelation)return t.howMany=0,t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t];if("mergeSameElement"==n.abRelation||t.sourcePosition.offset>0)return t.sourcePosition=e.moveTargetPosition.clone(),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t]}return t.sourcePosition.hasSameParentAs(e.splitPosition)&&(t.howMany=e.splitPosition.offset),t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t]}),Ey(py,my,(t,e)=>{const n=ay._createFromPositionAndShift(t.sourcePosition,t.howMany)._getTransformedByInsertOperation(e,!1)[0];return t.sourcePosition=n.start,t.howMany=n.end.offset-n.start.offset,t.targetPosition.isEqual(e.position)||(t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e)),[t]}),Ey(py,py,(t,e,n)=>{const i=ay._createFromPositionAndShift(t.sourcePosition,t.howMany),s=ay._createFromPositionAndShift(e.sourcePosition,e.howMany);let o,r=n.aIsStrong,a=!n.aIsStrong;if("insertBefore"==n.abRelation||"insertAfter"==n.baRelation?a=!0:"insertAfter"!=n.abRelation&&"insertBefore"!=n.baRelation||(a=!1),o=t.targetPosition.isEqual(e.targetPosition)&&a?t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):t.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Iy(t,e)&&Iy(e,t))return[e.getReversed()];if(i.containsPosition(e.targetPosition)&&i.containsRange(s,!0))return i.start=i.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),i.end=i.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Ry([i],o);if(s.containsPosition(t.targetPosition)&&s.containsRange(i,!0))return i.start=i.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),i.end=i.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),Ry([i],o);const l=Gv(t.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return i.start=i.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),i.end=i.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Ry([i],o);"remove"!=t.type||"remove"==e.type||n.aWasUndone||n.forceWeakRemove?"remove"==t.type||"remove"!=e.type||n.bWasUndone||n.forceWeakRemove||(r=!1):r=!0;const c=[],h=i.getDifference(s);for(const t of h){t.start=t.start._getTransformedByDeletion(e.sourcePosition,e.howMany),t.end=t.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const n="same"==Gv(t.start.getParentPath(),e.getMovedRangeStart().getParentPath()),i=t._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,n);c.push(...i)}const d=i.getIntersection(s);return null!==d&&r&&(d.start=d.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),d.end=d.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),0===c.length?c.push(d):1==c.length?s.start.isBefore(i.start)||s.start.isEqual(i.start)?c.unshift(d):c.push(d):c.splice(1,0,d)),0===c.length?[new xy(t.baseVersion)]:Ry(c,o)}),Ey(py,vy,(t,e,n)=>{let i=t.targetPosition.clone();t.targetPosition.isEqual(e.insertionPosition)&&e.graveyardPosition&&"moveTargetAfter"!=n.abRelation||(i=t.targetPosition._getTransformedBySplitOperation(e));const s=ay._createFromPositionAndShift(t.sourcePosition,t.howMany);if(s.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.howMany++,t.targetPosition=i,[t];if(s.start.hasSameParentAs(e.splitPosition)&&s.containsPosition(e.splitPosition)){let t=new ay(e.splitPosition,s.end);t=t._getTransformedBySplitOperation(e);return Ry([new ay(s.start,e.splitPosition),t],i)}t.targetPosition.isEqual(e.splitPosition)&&"insertAtSource"==n.abRelation&&(i=e.moveTargetPosition),t.targetPosition.isEqual(e.insertionPosition)&&"insertBetween"==n.abRelation&&(i=t.targetPosition);const o=[s._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const i=s.start.isEqual(e.graveyardPosition)||s.containsPosition(e.graveyardPosition);t.howMany>1&&i&&!n.aWasUndone&&o.push(ay._createFromPositionAndShift(e.insertionPosition,1))}return Ry(o,i)}),Ey(py,yy,(t,e,n)=>{const i=ay._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.deletionPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.sourcePosition))if("remove"!=t.type||n.forceWeakRemove){if(1==t.howMany)return n.bWasUndone?(t.sourcePosition=e.graveyardPosition.clone(),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]):[new xy(0)]}else if(!n.aWasUndone){const n=[];let i=e.graveyardPosition.clone(),s=e.targetPosition._getTransformedByMergeOperation(e);t.howMany>1&&(n.push(new py(t.sourcePosition,t.howMany-1,t.targetPosition,0)),i=i._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany-1),s=s._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany-1));const o=e.deletionPosition._getCombined(t.sourcePosition,t.targetPosition),r=new py(i,1,o,0),a=r.getMovedRangeStart().path.slice();a.push(0);const l=new iy(r.targetPosition.root,a);s=s._getTransformedByMove(i,o,1);const c=new py(s,e.howMany,l,0);return n.push(r),n.push(c),n}const s=ay._createFromPositionAndShift(t.sourcePosition,t.howMany)._getTransformedByMergeOperation(e);return t.sourcePosition=s.start,t.howMany=s.end.offset-s.start.offset,t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]}),Ey(wy,my,(t,e)=>(t.position=t.position._getTransformedByInsertOperation(e),[t])),Ey(wy,yy,(t,e)=>t.position.isEqual(e.deletionPosition)?(t.position=e.graveyardPosition.clone(),t.position.stickiness="toNext",[t]):(t.position=t.position._getTransformedByMergeOperation(e),[t])),Ey(wy,py,(t,e)=>(t.position=t.position._getTransformedByMoveOperation(e),[t])),Ey(wy,wy,(t,e,n)=>{if(t.position.isEqual(e.position)){if(!n.aIsStrong)return[new xy(0)];t.oldName=e.newName}return[t]}),Ey(wy,vy,(t,e)=>{if("same"==Gv(t.position.path,e.splitPosition.getParentPath())&&!e.graveyardPosition){const e=new wy(t.position.getShiftedBy(1),t.oldName,t.newName,0);return[t,e]}return t.position=t.position._getTransformedBySplitOperation(e),[t]}),Ey(ky,ky,(t,e,n)=>{if(t.root===e.root&&t.key===e.key){if(!n.aIsStrong||t.newValue===e.newValue)return[new xy(0)];t.oldValue=e.newValue}return[t]}),Ey(vy,my,(t,e)=>(t.splitPosition.hasSameParentAs(e.position)&&t.splitPosition.offset<e.position.offset&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByInsertOperation(e),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),[t])),Ey(vy,yy,(t,e,n)=>{if(!t.graveyardPosition&&!n.bWasUndone&&t.splitPosition.hasSameParentAs(e.sourcePosition)){const n=e.graveyardPosition.path.slice();n.push(0);const i=new iy(e.graveyardPosition.root,n),s=vy.getInsertionPosition(new iy(e.graveyardPosition.root,n)),o=new vy(i,0,null,0);return o.insertionPosition=s,t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),t.graveyardPosition=o.insertionPosition.clone(),t.graveyardPosition.stickiness="toNext",[o,t]}return t.splitPosition.hasSameParentAs(e.deletionPosition)&&!t.splitPosition.isAfter(e.deletionPosition)&&t.howMany--,t.splitPosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Ey(vy,py,(t,e,n)=>{const i=ay._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.graveyardPosition){const s=i.start.isEqual(t.graveyardPosition)||i.containsPosition(t.graveyardPosition);if(!n.bWasUndone&&s){const n=t.splitPosition._getTransformedByMoveOperation(e),i=t.graveyardPosition._getTransformedByMoveOperation(e),s=i.path.slice();s.push(0);const o=new iy(i.root,s);return[new py(n,t.howMany,o,0)]}t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)}if(t.splitPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.splitPosition)){const n=e.howMany-(t.splitPosition.offset-e.sourcePosition.offset);return t.howMany-=n,t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany),t.splitPosition=e.sourcePosition.clone(),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),[t]}return!t.splitPosition.isEqual(e.targetPosition)||"insertAtSource"!=n.baRelation&&"splitBefore"!=n.abRelation?(e.sourcePosition.isEqual(e.targetPosition)||(t.splitPosition.hasSameParentAs(e.sourcePosition)&&t.splitPosition.offset<=e.sourcePosition.offset&&(t.howMany-=e.howMany),t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany)),t.splitPosition.stickiness="toNone",t.splitPosition=t.splitPosition._getTransformedByMoveOperation(e),t.splitPosition.stickiness="toNext",t.graveyardPosition?t.insertionPosition=t.insertionPosition._getTransformedByMoveOperation(e):t.insertionPosition=vy.getInsertionPosition(t.splitPosition),[t]):(t.howMany+=e.howMany,t.splitPosition=t.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),[t])}),Ey(vy,vy,(t,e,n)=>{if(t.splitPosition.isEqual(e.splitPosition)){if(!t.graveyardPosition&&!e.graveyardPosition)return[new xy(0)];if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition))return[new xy(0)];if("splitBefore"==n.abRelation)return t.howMany=0,t.graveyardPosition=t.graveyardPosition._getTransformedBySplitOperation(e),[t]}if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition)){const i="$graveyard"==t.splitPosition.root.rootName,s="$graveyard"==e.splitPosition.root.rootName,o=i&&!s;if(s&&!i||!o&&n.aIsStrong){const n=[];return e.howMany&&n.push(new py(e.moveTargetPosition,e.howMany,e.splitPosition,0)),t.howMany&&n.push(new py(t.splitPosition,t.howMany,t.moveTargetPosition,0)),n}return[new xy(0)]}if(t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedBySplitOperation(e)),t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==n.abRelation)return t.howMany++,[t];if(e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==n.baRelation){const n=e.insertionPosition.path.slice();n.push(0);const i=new iy(e.insertionPosition.root,n);return[t,new py(t.insertionPosition,1,i,0)]}return t.splitPosition.hasSameParentAs(e.splitPosition)&&t.splitPosition.offset<e.splitPosition.offset&&(t.howMany-=e.howMany),t.splitPosition=t.splitPosition._getTransformedBySplitOperation(e),t.insertionPosition=vy.getInsertionPosition(t.splitPosition),[t]});class Ly extends Vu{constructor(t){super(t),this._stack=[],this._createdBatches=new WeakSet,this.refresh()}refresh(){this.isEnabled=this._stack.length>0}addBatch(t){const e=this.editor.model.document.selection,n={ranges:e.hasOwnRange?Array.from(e.getRanges()):[],isBackward:e.isBackward};this._stack.push({batch:t,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(t,e,n){const i=this.editor.model,s=i.document,o=[];for(const e of t){const t=Dy(e,n).find(t=>t.start.root!=s.graveyard);t&&o.push(t)}o.length&&i.change(t=>{t.setSelection(o,{backward:e})})}_undo(t,e){const n=this.editor.model,i=n.document;this._createdBatches.add(e);const s=t.operations.slice().filter(t=>t.isDocumentOperation);s.reverse();for(const t of s){const s=t.baseVersion+1,o=Array.from(i.history.getOperations(s)),r=Py([t.getReversed()],o,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const s of r)e.addOperation(s),n.applyOperation(s),i.history.setOperationAsUndone(t,s)}}}function Dy(t,e){const n=t.getTransformedByOperations(e);n.sort((t,e)=>t.start.isBefore(e.start)?-1:1);for(let t=1;t<n.length;t++){const e=n[t-1],i=n[t];e.end.isTouching(i.start)&&(e.end=i.end,n.splice(t,1),t--)}return n}class Vy extends Ly{execute(t=null){const e=t?this._stack.findIndex(e=>e.batch==t):this._stack.length-1,n=this._stack.splice(e,1)[0],i=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(i,()=>{this._undo(n.batch,i);const t=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,t),this.fire("revert",n.batch,i)}),this.refresh()}}class By extends Ly{execute(){const t=this._stack.pop(),e=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(e,()=>{const n=t.batch.operations[t.batch.operations.length-1].baseVersion+1,i=this.editor.model.document.history.getOperations(n);this._restoreSelection(t.selection.ranges,t.selection.isBackward,i),this._undo(t.batch,e)}),this.refresh()}}class Fy extends Nc{static get pluginName(){return"UndoEditing"}constructor(t){super(t),this._batchRegistry=new WeakSet}init(){const t=this.editor;this._undoCommand=new Vy(t),this._redoCommand=new By(t),t.commands.add("undo",this._undoCommand),t.commands.add("redo",this._redoCommand),this.listenTo(t.model,"applyOperation",(t,e)=>{const n=e[0];if(!n.isDocumentOperation)return;const i=n.batch,s=this._redoCommand._createdBatches.has(i),o=this._undoCommand._createdBatches.has(i);this._batchRegistry.has(i)||"transparent"==i.type&&!s&&!o||(s?this._undoCommand.addBatch(i):o||(this._undoCommand.addBatch(i),this._redoCommand.clearStack()),this._batchRegistry.add(i))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(t,e,n)=>{this._redoCommand.addBatch(n)}),t.keystrokes.set("CTRL+Z","undo"),t.keystrokes.set("CTRL+Y","redo"),t.keystrokes.set("CTRL+SHIFT+Z","redo")}}var jy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',zy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class qy extends Nc{init(){const t=this.editor,e=t.locale,n=t.t,i="ltr"==e.uiLanguageDirection?jy:zy,s="ltr"==e.uiLanguageDirection?zy:jy;this._addButton("undo",n("Undo"),"CTRL+Z",i),this._addButton("redo",n("Redo"),"CTRL+Y",s)}_addButton(t,e,n,i){const s=this.editor;s.ui.componentFactory.add(t,o=>{const r=s.commands.get(t),a=new ld(o);return a.set({label:e,icon:i,keystroke:n,tooltip:!0}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",()=>{s.execute(t),s.editing.view.focus()}),a})}}class Uy extends Nc{static get requires(){return[Fy,qy]}static get pluginName(){return"Undo"}}function Wy(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}var Hy=function(){return function t(){t.called=!0}};class Ky{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=Hy(),this.off=Hy()}}const Jy=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));var $y={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},Gy=(n(99),n(14));const Yy=Symbol("listeningTo"),Qy=Symbol("emitterId");var Zy={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[Yy]||(this[Yy]={});const r=this[Yy];Xy(t)||function(t,e){t[Qy]||(t[Qy]=e||function(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+Jy[t>>0&255]+Jy[t>>8&255]+Jy[t>>16&255]+Jy[t>>24&255]+Jy[e>>0&255]+Jy[e>>8&255]+Jy[e>>16&255]+Jy[e>>24&255]+Jy[n>>0&255]+Jy[n>>8&255]+Jy[n>>16&255]+Jy[n>>24&255]+Jy[i>>0&255]+Jy[i>>8&255]+Jy[i>>16&255]+Jy[i>>24&255]}())}(t);const a=Xy(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=tx(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=ex(t,e),c=$y.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[Yy];let s=t&&Xy(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)ix(t,e,n);else if(r){for(;n=r.pop();)ix(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[Yy]}},fire(t,...e){try{const n=t instanceof Ky?t:new Ky(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,ix(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&nx(t,n,e),s&&nx(s,n,e)}return n.return}catch(t){Gy.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function Xy(t){return t[Qy]}function tx(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function ex(t,e){const n=tx(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=ex(t,n.childEvents[e]);i=i.concat(s)}return i}function nx(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new Ky(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function ix(t,e,n){const i=ex(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}const sx=/^data:(\S*?);base64,/;class ox{constructor(t,e,n){if(!t)throw new Gy.a("fileuploader-missing-file: File must be provided as the first argument",null);if(!e)throw new Gy.a("fileuploader-missing-token: Token must be provided as the second argument.",null);if(!n)throw new Gy.a("fileuploader-missing-api-address: Api address must be provided as the third argument.",null);this.file=function(t){if("string"!=typeof t)return!1;const e=t.match(sx);return!(!e||!e.length)}(t)?function(t,e=512){try{const n=t.match(sx)[1],i=atob(t.replace(sx,"")),s=[];for(let t=0;t<i.length;t+=e){const n=i.slice(t,t+e),o=new Array(n.length);for(let t=0;t<n.length;t++)o[t]=n.charCodeAt(t);s.push(new Uint8Array(o))}return new Blob(s,{type:n})}catch(t){throw new Gy.a("fileuploader-decoding-image-data-error: Problem with decoding Base64 image data.",null)}}(t):t,this._token=e,this._apiAddress=n}onProgress(t){return this.on("progress",(e,n)=>t(n)),this}onError(t){return this.once("error",(e,n)=>t(n)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const t=new XMLHttpRequest;t.open("POST",this._apiAddress),t.setRequestHeader("Authorization",this._token.value),t.responseType="json",this.xhr=t}_attachXHRListeners(){const t=this,e=this.xhr;function n(e){return()=>t.fire("error",e)}e.addEventListener("error",n("Network Error")),e.addEventListener("abort",n("Abort")),e.upload&&e.upload.addEventListener("progress",t=>{t.lengthComputable&&this.fire("progress",{total:t.total,uploaded:t.loaded})}),e.addEventListener("load",()=>{const t=e.status,n=e.response;if(t<200||t>299)return this.fire("error",n.message||n.error)})}_sendRequest(){const t=new FormData,e=this.xhr;return t.append("file",this.file),new Promise((n,i)=>{e.addEventListener("load",()=>{const t=e.status,s=e.response;return t<200||t>299?s.message?i(new Gy.a("fileuploader-uploading-data-failed: Uploading file failed.",this,{message:s.message})):i(s.error):n(s)}),e.addEventListener("error",()=>i(new Error("Network Error"))),e.addEventListener("abort",()=>i(new Error("Abort"))),e.send(t)})}}Wy(ox,Zy);const rx=Symbol("observableProperties"),ax=Symbol("boundObservables"),lx=Symbol("boundProperties"),cx={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);dx(this);const n=this[rx];if(t in this&&!n.has(t))throw new Gy.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!gx(t))throw new Gy.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new Gy.a("observable-bind-duplicate-properties: Properties must be unique.",this);dx(this);const e=this[lx];t.forEach(t=>{if(e.has(t))throw new Gy.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:ux,toMany:fx,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[rx])return;const e=this[lx],n=this[ax];if(t.length){if(!gx(t))throw new Gy.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new Gy.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(cx,Zy);var hx=cx;function dx(t){t[rx]||(Object.defineProperty(t,rx,{value:new Map}),Object.defineProperty(t,ax,{value:new Map}),Object.defineProperty(t,lx,{value:new Map}))}function ux(...t){const e=function(...t){if(!t.length)throw new Gy.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new Gy.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new Gy.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new Gy.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new Gy.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[ax];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{px(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[ax],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{px(this._observable,t)})}function fx(t,e,n){if(this._bindings.size>1)throw new Gy.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function gx(t){return t.every(t=>"string"==typeof t)}function px(t,e){const n=t[lx].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}const mx={refreshInterval:36e5,autoRefresh:!0};class bx{constructor(t,e=mx){if(!t)throw new Gy.a("token-missing-token-url: A `tokenUrl` must be provided as the first constructor argument.",this);this.set("value",e.initValue),this._refresh="function"==typeof t?t:()=>{return e=t,new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",e),i.addEventListener("load",()=>{const e=i.status,s=i.response;return e<200||e>299?n(new Gy.a("token-cannot-download-new-token: Cannot download new token from the provided url.",null)):t(s)}),i.addEventListener("error",()=>n(new Error("Network Error"))),i.addEventListener("abort",()=>n(new Error("Abort"))),i.send()});var e},this._options=Object.assign({},mx,e)}init(){return new Promise((t,e)=>{this._options.autoRefresh&&this._startRefreshing(),this.value?t(this):this.refreshToken().then(t).catch(e)})}refreshToken(){return this._refresh().then(t=>this.set("value",t)).then(()=>this)}destroy(){this._stopRefreshing()}_startRefreshing(){this._refreshInterval=setInterval(()=>this.refreshToken(),this._options.refreshInterval)}_stopRefreshing(){clearInterval(this._refreshInterval)}static create(t,e=mx){return new bx(t,e).init()}}Wy(bx,hx);var wx=bx;class _x extends Rm{static get pluginName(){return"CloudServices"}init(){const t=this.context.config.get("cloudServices")||{};for(const e in t)this[e]=t[e];if(this.tokenUrl)return this.token=new _x.Token(this.tokenUrl),this.token.init();this.token=null}destroy(){super.destroy(),this.token&&this.token.destroy()}}_x.Token=wx;class kx extends Nc{static get requires(){return[gb,_x]}init(){const t=this.editor,e=t.plugins.get(_x),n=e.token,i=e.uploadUrl;n&&(this._uploadGateway=new kx._UploadGateway(n,i),t.plugins.get(gb).createUploadAdapter=t=>new vx(this._uploadGateway,t))}}class vx{constructor(t,e){this.uploadGateway=t,this.loader=e}upload(){return this.loader.file.then(t=>(this.fileUploader=this.uploadGateway.upload(t),this.fileUploader.on("progress",(t,e)=>{this.loader.uploadTotal=e.total,this.loader.uploaded=e.uploaded}),this.fileUploader.send()))}abort(){this.fileUploader.abort()}}kx._UploadGateway=class{constructor(t,e){if(!t)throw new Gy.a("uploadgateway-missing-token: Token must be provided.",null);if(!e)throw new Gy.a("uploadgateway-missing-api-address: Api address must be provided.",null);this._token=t,this._apiAddress=e}upload(t){return new ox(t,this._token,this._apiAddress)}};class yx extends Vu{refresh(){const t=this.editor.model.document.selection.getSelectedElement();this.isEnabled=Sp(t),Sp(t)&&t.hasAttribute("alt")?this.value=t.getAttribute("alt"):this.value=!1}execute(t){const e=this.editor.model,n=e.document.selection.getSelectedElement();e.change(e=>{e.setAttribute("alt",t.newValue,n)})}}class xx extends Nc{static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new yx(this.editor))}}n(100);class Cx extends Ih{constructor(t,e){super(t);const n="ck-labeled-field-view-"+Bc(),i="ck-labeled-field-view-status-"+Bc();this.fieldView=e(this,n,i),this.set("label"),this.set("isEnabled",!0),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.labelView=this._createLabelView(n),this.statusView=this._createStatusView(i),this.bind("_statusText").to(this,"errorText",this,"infoText",(t,e)=>t||e);const s=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",s.to("class"),s.if("isEnabled","ck-disabled",t=>!t)]},children:[this.labelView,this.fieldView,this.statusView]})}_createLabelView(t){const e=new rf(this.locale);return e.for=t,e.bind("text").to(this,"label"),e}_createStatusView(t){const e=new Ih(this.locale),n=this.bindTemplate;return e.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",n.if("errorText","ck-labeled-field-view__status_error"),n.if("_statusText","ck-hidden",t=>!t)],id:t,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),e}focus(){this.fieldView.focus()}}n(102);class Ex extends Ih{constructor(t){super(t),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById");const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",e.if("hasError","ck-error")],id:e.to("id"),placeholder:e.to("placeholder"),readonly:e.to("isReadOnly"),"aria-invalid":e.if("hasError",!0),"aria-describedby":e.to("ariaDescribedById")},on:{input:e.to("input")}})}render(){super.render();const t=t=>{this.element.value=t||0===t?t:""};t(this.value),this.on("change:value",(e,n,i)=>{t(i)})}select(){this.element.select()}focus(){this.element.focus()}}function Tx(t,e,n){const i=new Ex(t.locale);return i.set({id:e,ariaDescribedById:n}),i.bind("isReadOnly").to(t,"isEnabled",t=>!t),i.bind("hasError").to(t,"errorText",t=>!!t),i.on("input",()=>{t.errorText=null}),i}function Ax({view:t}){t.listenTo(t.element,"submit",(e,n)=>{n.preventDefault(),t.fire("submit")},{useCapture:!0})}const Px=navigator.userAgent.toLowerCase();var Sx={isMac:function(t){return t.indexOf("macintosh")>-1}(Px),isGecko:function(t){return!!t.match(/gecko\/\d+/)}(Px),isSafari:function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(Px),isAndroid:function(t){return t.indexOf("android")>-1}(Px),features:{isRegExpUnicodePropertySupported:function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}()}};const Ox=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function Mx(t){let e;if("string"==typeof t){if(e=Ox[t.toLowerCase()],!e)throw new Og.a("keyboard-unknown-key: Unknown key name.",null,{key:t})}else e=t.keyCode+(t.altKey?Ox.alt:0)+(t.ctrlKey?Ox.ctrl:0)+(t.shiftKey?Ox.shift:0);return e}function Nx(t){return t.split(/\s*\+\s*/)}class Ix{constructor(){this._listener=Object.create(qg)}listenTo(t){this._listener.listenTo(t,"keydown",(t,e)=>{this._listener.fire("_keydown:"+Mx(e),e)})}set(t,e,n={}){const i=function(t){return"string"==typeof t&&(t=Nx(t)),t.map(t=>"string"==typeof t?Mx(t):t).reduce((t,e)=>e+t,0)}(t),s=n.priority;this._listener.listenTo(this._listener,"_keydown:"+i,(t,n)=>{e(n,()=>{n.preventDefault(),n.stopPropagation(),t.stop()}),t.return=!0},{priority:s})}press(t){return!!this._listener.fire("_keydown:"+Mx(t),t)}destroy(){this._listener.stopListening()}}const Rx=Symbol("observableProperties"),Lx=Symbol("boundObservables"),Dx=Symbol("boundProperties"),Vx={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);Fx(this);const n=this[Rx];if(t in this&&!n.has(t))throw new Og.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!qx(t))throw new Og.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new Og.a("observable-bind-duplicate-properties: Properties must be unique.",this);Fx(this);const e=this[Dx];t.forEach(t=>{if(e.has(t))throw new Og.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:jx,toMany:zx,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[Rx])return;const e=this[Dx],n=this[Lx];if(t.length){if(!qx(t))throw new Og.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new Og.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(Vx,Ig);var Bx=Vx;function Fx(t){t[Rx]||(Object.defineProperty(t,Rx,{value:new Map}),Object.defineProperty(t,Lx,{value:new Map}),Object.defineProperty(t,Dx,{value:new Map}))}function jx(...t){const e=function(...t){if(!t.length)throw new Og.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new Og.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new Og.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new Og.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new Og.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[Lx];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{Ux(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[Lx],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{Ux(this._observable,t)})}function zx(t,e,n){if(this._bindings.size>1)throw new Og.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function qx(t){return t.every(t=>"string"==typeof t)}function Ux(t,e){const n=t[Dx].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class Wx{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new Og.a("focusTracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}Hg(Wx,qg),Hg(Wx,Bx);n(104);class Hx extends Ih{constructor(t){super(t);const e=this.locale.t;this.focusTracker=new Wx,this.keystrokes=new Ix,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(e("Save"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(e("Cancel"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',"ck-button-cancel","cancel"),this._focusables=new Zc,this._focusCycler=new gd({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),Ax({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)})}_createButton(t,e,n,i){const s=new ld(this.locale);return s.set({label:t,icon:e,tooltip:!0}),s.extendTemplate({attributes:{class:n}}),i&&s.delegate("execute").to(this,i),s}_createLabeledInputView(){const t=this.locale.t,e=new Cx(this.locale,Tx);return e.label=t("Text alternative"),e.fieldView.placeholder=t("Text alternative"),e}}function Kx(t){const e=t.editing.view,n=$h.defaultPositions;return{target:e.domConverter.viewToDom(e.document.selection.getSelectedElement()),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast]}}class Jx extends Nc{static get requires(){return[dd]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const t=this.editor,e=t.t;t.ui.componentFactory.add("imageTextAlternative",n=>{const i=t.commands.get("imageTextAlternative"),s=new ld(n);return s.set({label:e("Change image text alternative"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',tooltip:!0}),s.bind("isEnabled").to(i,"isEnabled"),this.listenTo(s,"execute",()=>{this._showForm()}),s})}_createForm(){const t=this.editor,e=t.editing.view.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Hx(t.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{t.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(t,e)=>{this._hideForm(!0),e()}),this.listenTo(t.ui,"update",()=>{Pp(e.selection)?this._isVisible&&function(t){const e=t.plugins.get("ContextualBalloon");if(Pp(t.editing.view.document.selection)){const n=Kx(t);e.updatePosition(n)}}(t):this._hideForm(!0)}),Pd({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const t=this.editor,e=t.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._isInBalloon||this._balloon.add({view:this._form,position:Kx(t)}),n.fieldView.value=n.fieldView.element.value=e.value||"",this._form.labeledInput.fieldView.select()}_hideForm(t){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),t&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class $x extends Nc{static get requires(){return[xx,Jx]}static get pluginName(){return"ImageTextAlternative"}}n(106);class Gx extends Nc{static get requires(){return[Lp,jb,$x]}static get pluginName(){return"Image"}}class Yx extends Ih{constructor(t){super(t),this.buttonView=new ld(t),this._fileInputView=new Qx(t),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class Qx extends Ih{constructor(t){super(t),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:e.to("acceptedType"),multiple:e.to("allowMultipleFiles")},on:{change:e.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}function Zx(t){const e=t.map(t=>t.replace("+","\\+"));return new RegExp(`^image\\/(${e.join("|")})$`)}class Xx extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("imageUpload",n=>{const i=new Yx(n),s=t.commands.get("imageUpload"),o=t.config.get("image.upload.types"),r=Zx(o);return i.set({acceptedType:o.map(t=>"image/"+t).join(","),allowMultipleFiles:!0}),i.buttonView.set({label:e("Insert image"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="picture-a" d="M19,5.25 C19.2708347,5.25 19.5052073,5.34895734 19.703125,5.546875 C19.9010427,5.74479266 20,5.97916531 20,6.25 L20,17.75 C20,18.0208347 19.9010427,18.2552073 19.703125,18.453125 C19.5052073,18.6510427 19.2708347,18.75 19,18.75 L5,18.75 C4.72916531,18.75 4.49479266,18.6510427 4.296875,18.453125 C4.09895734,18.2552073 4,18.0208347 4,17.75 L4,6.25 C4,5.97916531 4.09895734,5.74479266 4.296875,5.546875 C4.49479266,5.34895734 4.72916531,5.25 5,5.25 L19,5.25 Z M19,17.75 L19,16.828125 L18.9765625,16.8046875 C18.9713541,16.7994791 18.9635417,16.796875 18.953125,16.796875 L15.671875,13.40625 L13.84375,15.0625 C13.7291661,15.1458337 13.6067715,15.1901041 13.4765625,15.1953125 C13.3463535,15.2005209 13.2395837,15.1510422 13.15625,15.046875 L9.015625,10.921875 L5,14.8125 L5,17.75 L19,17.75 Z M19,15.40625 L19,6.25 L5,6.25 L5,13.40625 L8.65625,9.859375 C8.70833359,9.80729141 8.76562469,9.77083344 8.828125,9.75 C8.89062531,9.72916656 8.95833297,9.71875 9.03125,9.71875 C9.09375031,9.71875 9.15624969,9.73437484 9.21875,9.765625 C9.28125031,9.79687516 9.33854141,9.84374969 9.390625,9.90625 L13.515625,14 L15.40625,12.359375 C15.5104172,12.2760413 15.6223952,12.2395833 15.7421875,12.25 C15.8619798,12.2604167 15.9687495,12.3072913 16.0625,12.390625 L19,15.40625 Z M15.5,10.25 C15.2291653,10.25 14.9947927,10.1536468 14.796875,9.9609375 C14.5989573,9.7682282 14.5,9.53125141 14.5,9.25 C14.5,8.97916531 14.5989573,8.74479266 14.796875,8.546875 C14.9947927,8.34895734 15.2291653,8.25 15.5,8.25 C15.7708347,8.25 16.0052073,8.34895734 16.203125,8.546875 C16.4010427,8.74479266 16.5,8.97916531 16.5,9.25 C16.5,9.53125141 16.4010427,9.7682282 16.203125,9.9609375 C16.0052073,10.1536468 15.7708347,10.25 15.5,10.25 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#picture-a"/>\n  </g>\n</svg>\n',tooltip:!0}),i.buttonView.bind("isEnabled").to(s),i.on("done",(e,n)=>{const i=Array.from(n).filter(t=>r.test(t.type));i.length&&t.execute("imageUpload",{file:i})}),i})}}n(108),n(110),n(112);class tC extends Nc{constructor(t){super(t),this.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>')}init(){this.editor.editing.downcastDispatcher.on("attribute:uploadStatus:image",(...t)=>this.uploadStatusChange(...t))}uploadStatusChange(t,e,n){const i=this.editor,s=e.item,o=s.getAttribute("uploadId");if(!n.consumable.consume(e.item,t.name))return;const r=i.plugins.get(gb),a=o?e.attributeNewValue:null,l=this.placeholder,c=i.editing.mapper.toViewElement(s),h=n.writer;if("reading"==a)return eC(c,h),void nC(l,c,h);if("uploading"==a){const t=r.loaders.get(o);return eC(c,h),void(t?(iC(c,h),function(t,e,n,i){const s=function(t){const e=t.createUIElement("div",{class:"ck-progress-bar"});return t.setCustomProperty("progressBar",!0,e),e}(e);e.insert(e.createPositionAt(t,"end"),s),n.on("change:uploadedPercent",(t,e,n)=>{i.change(t=>{t.setStyle("width",n+"%",s)})})}(c,h,t,i.editing.view),function(t,e,n){if(n.data){const i=Np(t);e.setAttribute("src",n.data,i)}}(c,h,t)):nC(l,c,h))}"complete"==a&&r.loaders.get(o)&&function(t,e,n){const i=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(t,"end"),i),setTimeout(()=>{n.change(t=>t.remove(t.createRangeOn(i)))},3e3)}(c,h,i.editing.view),function(t,e){oC(t,e,"progressBar")}(c,h),iC(c,h),function(t,e){e.removeClass("ck-appear",t)}(c,h)}}function eC(t,e){t.hasClass("ck-appear")||e.addClass("ck-appear",t)}function nC(t,e,n){e.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",e);const i=Np(e);i.getAttribute("src")!==t&&n.setAttribute("src",t,i),sC(e,"placeholder")||n.insert(n.createPositionAfter(i),function(t){const e=t.createUIElement("div",{class:"ck-upload-placeholder-loader"});return t.setCustomProperty("placeholder",!0,e),e}(n))}function iC(t,e){t.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",t),oC(t,e,"placeholder")}function sC(t,e){for(const n of t.getChildren())if(n.getCustomProperty(e))return n}function oC(t,e,n){const i=sC(t,n);i&&e.remove(e.createRangeOn(i))}function rC(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class aC{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new Og.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=rC(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}Hg(aC,Ig);class lC extends aC{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof lC&&(this===t||this.data===t.data)}_clone(){return new lC(this.document,this.data)}}class cC{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new Og.a("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new Og.a("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function hC(t){return!(!t||!t[Symbol.iterator])}class dC{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new lC(t,e)];hC(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new lC(t,e):e instanceof cC?new lC(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}function uC(t){return hC(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}Hg(dC,Ig);class fC{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=gC(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=gC(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function gC(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}class pC{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=mC(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}function mC(t){return t.replace("-",".")}class bC extends aC{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=uC(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");wC(this._classes,t),this._attrs.delete("class")}this._styles=new pC(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof bC))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new fC(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new lC(t,e)];hC(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new lC(t,e):e instanceof cC?new lC(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?wC(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function wC(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class _C{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new Og.a("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new Og.a("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=xC._createAt(t.startPosition):this.position=xC._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof lC){if(t.isAtEnd)return this.position=xC._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof bC)return this.shallow?t.offset++:t=new xC(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof lC){if(this.singleCharacters)return t=new xC(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new cC(i,0,s),t=xC._createAfter(n)):(n=new cC(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new cC(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=xC._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof lC){if(t.isAtStart)return this.position=xC._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof bC)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new xC(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof lC){if(this.singleCharacters)return t=new xC(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new cC(i,e,i.data.length-e),s=n.data.length,t=xC._createBefore(n)}else n=new cC(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new cC(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=xC._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof cC&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=xC._createAfter(e.textNode):(i=xC._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=xC._createBefore(e.textNode):(i=xC._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class kC extends bC{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=vC}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function vC(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}class yC extends kC{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}Hg(yC,Bx);class xC{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof yC);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=xC._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new _C(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=rC(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new _C(t)}clone(){return new xC(this.parent,this.offset)}static _createAt(t,e){if(t instanceof xC)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new Og.a("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new xC(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new xC(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new Og.a("view-position-after-root: You can not make position after root.",t,{root:t});return new xC(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new xC(t.textNode,t.offsetInText);if(!t.parent)throw new Og.a("view-position-before-root: You can not make position before root.",t,{root:t});return new xC(t.parent,t.index)}}class CC{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new _C({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(EC,{direction:"backward"}),e=this.end.getLastMatchingPosition(EC);return t.parent.is("text")&&t.isAtStart&&(t=xC._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=xC._createAfter(e.parent)),new CC(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition(EC);if(t.isAfter(this.end)||t.isEqual(this.end))return new CC(t,t);let e=this.end.getLastMatchingPosition(EC,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new xC(n,0)),i&&i.is("text")&&(e=new xC(i,i.data.length)),new CC(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new CC(this.start,t.start)),this.containsPosition(t.end)&&e.push(new CC(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new CC(e,n)}return null}getWalker(t={}){return t.boundaries=this,new _C(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new CC(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new _C(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new _C(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new xC(t,e),new xC(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(xC._createBefore(t),e)}}function EC(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function TC(t){let e=0;for(const n of t)e++;return e}class AC{constructor(t=null,e,n){this._selection=new PC,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}Hg(AC,Ig);class PC{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=TC(this.getRanges());if(e!=TC(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof PC||t instanceof AC)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof CC)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof xC)this._setRanges([new CC(t)]),this._setFakeOptions(e);else if(t instanceof aC){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new Og.a("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?CC._createIn(t):"on"==e?CC._createOn(t):new CC(xC._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!hC(t))throw new Og.a("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new Og.a("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=xC._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new CC(n,i),!0):this._addRange(new CC(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof CC))throw new Og.a("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new Og.a("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new CC(t.start,t.end))}}Hg(PC,Ig);class SC{constructor(t){this.document=t}createDocumentFragment(t){return new dC(this.document,t)}createElement(t,e,n){return new bC(this.document,t,e,n)}createText(t){return new lC(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,n){return n._insertChild(t,e)}removeChildren(t,e,n){return n._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const n=t.parent;if(n){const i=n.getChildIndex(t);return this.removeChildren(i,1,n),this.insertChild(i,e,n),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const n=e.getChildIndex(t);this.remove(t),this.insertChild(n,t.getChildren(),e)}}rename(t,e){const n=new bC(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,n)?n:null}setAttribute(t,e,n){n._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,n){y(t)&&void 0===n&&(n=e),n._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,n){n._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return xC._createAt(t,e)}createPositionAfter(t){return xC._createAfter(t)}createPositionBefore(t){return xC._createBefore(t)}createRange(t,e){return new CC(t,e)}createRangeOn(t){return CC._createOn(t)}createRangeIn(t){return CC._createIn(t)}createSelection(t,e,n){return new PC(t,e,n)}}class OC extends Vu{refresh(){this.isEnabled=Mp(this.editor.model)}execute(t){const e=this.editor,n=e.model,i=e.plugins.get(gb);n.change(e=>{const s=Array.isArray(t.file)?t.file:[t.file];for(const t of s)MC(e,n,i,t)})}}function MC(t,e,n,i){const s=n.createLoader(i);s&&Op(t,e,{uploadId:s.id})}class NC extends Nc{static get requires(){return[gb,Lm,m_]}static get pluginName(){return"ImageUploadEditing"}constructor(t){super(t),t.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}})}init(){const t=this.editor,e=t.model.document,n=t.model.schema,i=t.conversion,s=t.plugins.get(gb),o=Zx(t.config.get("image.upload.types"));n.extend("image",{allowAttributes:["uploadId","uploadStatus"]}),t.commands.add("imageUpload",new OC(t)),i.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(t.editing.view.document,"clipboardInput",(e,n)=>{if(i=n.dataTransfer,Array.from(i.types).includes("text/html")&&""!==i.getData("text/html"))return;var i;const s=Array.from(n.dataTransfer.files).filter(t=>!!t&&o.test(t.type)),r=n.targetRanges.map(e=>t.editing.mapper.toModelRange(e));t.model.change(n=>{n.setSelection(r),s.length&&(e.stop(),t.model.enqueueChange("default",()=>{t.execute("imageUpload",{file:s})}))})}),this.listenTo(t.plugins.get(m_),"inputTransformation",(e,n)=>{const i=Array.from(t.editing.view.createRangeIn(n.content)).filter(t=>{return!(!(e=t.item).is("element","img")||!e.getAttribute("src"))&&(e.getAttribute("src").match(/^data:image\/\w+;base64,/g)||e.getAttribute("src").match(/^blob:/g))&&!t.item.getAttribute("uploadProcessed");var e}).map(t=>{return{promise:(e=t.item,new Promise((t,n)=>{const i=e.getAttribute("src");fetch(i).then(t=>t.blob()).then(e=>{const n=function(t,e){return t.type?t.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}(e,i),s=n.replace("image/",""),o=new File([e],"image."+s,{type:n});t(o)}).catch(n)})),imageElement:t.item};var e});if(!i.length)return;const o=new SC(t.editing.view.document);for(const t of i){o.setAttribute("uploadProcessed",!0,t.imageElement);const e=s.createLoader(t.promise);e&&(o.setAttribute("src","",t.imageElement),o.setAttribute("uploadId",e.id,t.imageElement))}}),t.editing.view.document.on("dragover",(t,e)=>{e.preventDefault()}),e.on("change",()=>{const n=e.differ.getChanges({includeChangesInGraveyard:!0});for(const e of n)if("insert"==e.type&&"$text"!=e.name){const n=e.position.nodeAfter,i="$graveyard"==e.position.root.rootName;for(const e of IC(t,n)){const t=e.getAttribute("uploadId");if(!t)continue;const n=s.loaders.get(t);n&&(i?n.abort():"idle"==n.status&&this._readAndUpload(n,e))}}})}_readAndUpload(t,e){const n=this.editor,i=n.model,s=n.locale.t,o=n.plugins.get(gb),r=n.plugins.get(Lm);return i.enqueueChange("transparent",t=>{t.setAttribute("uploadStatus","reading",e)}),t.read().then(()=>{const s=t.upload();if(Sx.isSafari){const t=Np(n.editing.mapper.toViewElement(e));n.editing.view.once("render",()=>{if(!t.parent)return;const e=n.editing.view.domConverter.mapViewToDom(t.parent);if(!e)return;const i=e.style.display;e.style.display="none",e._ckHack=e.offsetHeight,e.style.display=i})}return i.enqueueChange("transparent",t=>{t.setAttribute("uploadStatus","uploading",e)}),s}).then(t=>{i.enqueueChange("transparent",n=>{n.setAttributes({uploadStatus:"complete",src:t.default},e),this._parseAndSetSrcsetAttributeOnImage(t,e,n)}),a()}).catch(n=>{if("error"!==t.status&&"aborted"!==t.status)throw n;"error"==t.status&&n&&r.showWarning(n,{title:s("Upload failed"),namespace:"upload"}),a(),i.enqueueChange("transparent",t=>{t.remove(e)})});function a(){i.enqueueChange("transparent",t=>{t.removeAttribute("uploadId",e),t.removeAttribute("uploadStatus",e)}),o.destroyLoader(t)}}_parseAndSetSrcsetAttributeOnImage(t,e,n){let i=0;const s=Object.keys(t).filter(t=>{const e=parseInt(t,10);if(!isNaN(e))return i=Math.max(i,e),!0}).map(e=>`${t[e]} ${e}w`).join(", ");""!=s&&n.setAttribute("srcset",{data:s,width:i},e)}}function IC(t,e){return Array.from(t.model.createRangeOn(e)).filter(t=>t.item.is("image")).map(t=>t.item)}class RC extends Nc{static get pluginName(){return"ImageUpload"}static get requires(){return[NC,Xx,tC]}}class LC extends Vu{constructor(t,e){super(t),this.modelElements=e}refresh(){const t=function(t){const e=t.next();return e.done?null:e.value}(this.editor.model.document.selection.getSelectedBlocks());this.value=!!t&&this.modelElements.includes(t.name)&&t.name,this.isEnabled=!!t&&this.modelElements.some(e=>DC(t,e,this.editor.model.schema))}execute(t){const e=this.editor.model,n=e.document,i=t.value;e.change(t=>{const s=Array.from(n.selection.getSelectedBlocks()).filter(t=>DC(t,i,e.schema));for(const e of s)e.is(i)||t.rename(e,i)})}}function DC(t,e,n){return n.checkChild(t.parent,e)&&!n.isObject(t)}var VC={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};class BC extends Nc{static get pluginName(){return"HeadingEditing"}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Ob]}init(){const t=this.editor,e=t.config.get("heading.options"),n=[];for(const i of e)"paragraph"!==i.model&&(t.model.schema.register(i.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(i),n.push(i.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new LC(t,n))}afterInit(){const t=this.editor,e=t.commands.get("enter"),n=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",(e,i)=>{const s=t.model.document.selection.getFirstPosition().parent;n.some(t=>s.is(t.model))&&!s.is("paragraph")&&0===s.childCount&&i.writer.rename(s,"paragraph")})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:VC.get("low")+1})}}var FC=function(){return function t(){t.called=!0}};class jC{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=FC(),this.off=FC()}}function zC(){let t="e";for(let e=0;e<8;e++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}var qC={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(114);const UC=Symbol("listeningTo"),WC=Symbol("emitterId");var HC={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[UC]||(this[UC]={});const r=this[UC];JC(t)||KC(t);const a=JC(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=$C(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=GC(t,e),c=qC.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[UC];let s=t&&JC(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)QC(t,e,n);else if(r){for(;n=r.pop();)QC(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[UC]}},fire(t,...e){const n=t instanceof jC?t:new jC(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,QC(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&YC(t,n,e),s&&YC(s,n,e)}return n.return},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function KC(t,e){t[WC]||(t[WC]=e||zC())}function JC(t){return t[WC]}function $C(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function GC(t,e){const n=$C(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=GC(t,n.childEvents[e]);i=i.concat(s)}return i}function YC(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new jC(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function QC(t,e,n){const i=GC(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function ZC(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class XC{constructor(t={}){this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[]}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){let n;const i=this._idProperty;if(i in t){if(n=t[i],"string"!=typeof n)throw new Dm.b("collection-add-invalid-id");if(this.get(n))throw new Dm.b("collection-add-item-already-exists")}else t[i]=n=zC();if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new Dm.b("collection-add-item-invalid-index");return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new Dm.b("collection-get-invalid-arg: Index or id must be given.");e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new Dm.b("collection-remove-404: Item not found.");this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new Dm.b("collection-bind-to-rebind: The collection cannot be bound more than once.");return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}[Symbol.iterator](){return this._items[Symbol.iterator]()}}ZC(XC,HC);class tE extends Nc{init(){const t=this.editor,e=function(t){const e={Paragraph:"Параграф","Heading 1":"Заголовок H1","Heading 2":"Заголовок H2","Heading 3":"Заголовок H3","Heading 4":"Заголовок H4","Heading 5":"Заголовок H5","Heading 6":"Заголовок H6"};return t.config.get("heading.options").map(t=>{const n=e[t.title];return n&&n!=t.title&&(t.title=n),t})}(t);t.ui.componentFactory.add("heading",n=>{const i={},s=new XC,o=t.commands.get("heading"),r=t.commands.get("paragraph"),a=[o];for(const t of e){const e={type:"button",model:new Gf({label:t.title,class:t.class,withText:!0})};"paragraph"===t.model?(e.model.bind("isOn").to(r,"value"),e.model.set("commandName","paragraph"),a.push(r)):(e.model.bind("isOn").to(o,"value",e=>e===t.model),e.model.set({commandName:"heading",commandValue:t.model})),s.add(e),i[t.model]=t.title}const l=Sd(n);return Md(l,s),l.buttonView.set({isOn:!1,icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <polygon id="styles-2-a" points="16.964 18 16.964 6 15.477 6 15.477 11.163 8.487 11.163 8.487 6 7 6 7 18 8.487 18 8.487 12.495 15.477 12.495 15.477 18"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#styles-2-a"/>\n  </g>\n</svg>\n',tooltip:"Заголовок"}),l.extendTemplate({attributes:{panelPosition:"se",class:["ck-heading-dropdown"]}}),l.bind("isEnabled").toMany(a,"isEnabled",(...t)=>t.some(t=>t)),this.listenTo(l,"execute",e=>{t.execute(e.source.commandName,e.source.commandValue?{value:e.source.commandValue}:void 0),t.editing.view.focus()}),l})}}n(115);const eE=new WeakMap;function nE(t,e){return!!e.hasClass("ck-placeholder")&&(t.removeClass("ck-placeholder",e),!0)}function iE(t,e){const n=eE.get(t);let i=!1;for(const[t,s]of n)sE(e,t,s)&&(i=!0);return i}function sE(t,e,n){const{text:i,isDirectHost:s}=n,o=s?e:function(t){const e=t&&t.childCount;if(1===e&&"p"===t._children[0].name&&0===t._children[0].childCount){const n=t.getChild(e-1);if(n.is("element")&&!n.is("uiElement"))return n}return null}(e);let r=!1;return!!o&&(n.hostElement=o,o.getAttribute("data-placeholder")!==i&&(t.setAttribute("data-placeholder",i,o),r=!0),!function(t){const e=t.document;if(!e)return!1;const n=!Array.from(t.getChildren()).some(t=>!t.is("uiElement"));if(!e.isFocused&&n)return!0;const i=e.selection.anchor;return!(!n||!i||i.parent===t)}(o)?nE(t,o)&&(r=!0):function(t,e){return!e.hasClass("ck-placeholder")&&(t.addClass("ck-placeholder",e),!0)}(t,o)&&(r=!0),r)}function oE(t,e){return n=>{const i=n.createEditableElement("figcaption");return n.setCustomProperty("imageCaption",!0,i),function(t){const{view:e,element:n,text:i,isDirectHost:s=!0}=t,o=e.document;eE.has(o)||(eE.set(o,new Map),o.registerPostFixer(t=>iE(o,t))),eE.get(o).set(n,{text:i,isDirectHost:s}),e.change(t=>iE(o,t))}({view:t,element:i,text:e}),Cp(i,n)}}function rE(t){for(const e of t.getChildren())if(e&&e.is("caption"))return e;return null}function aE(t){const e=t.parent;return"figcaption"==t.name&&e&&"figure"==e.name&&e.hasClass("image")?{name:!0}:null}class lE extends Nc{init(){const t=this.editor,e=t.editing.view,n=t.model.schema,i=t.data,s=t.editing;n.register("caption",{allowIn:"image",allowContentOf:"$block",isLimit:!0}),t.model.document.registerPostFixer(t=>this._insertMissingModelCaptionElement(t)),t.conversion.for("upcast").elementToElement({view:aE,model:"caption"});i.downcastDispatcher.on("insert:caption",cE(t=>t.createContainerElement("figcaption"),!1));const o=oE(e,"Подпись");s.downcastDispatcher.on("insert:caption",cE(o)),s.downcastDispatcher.on("insert",this._fixCaptionVisibility(t=>t.item),{priority:"high"}),s.downcastDispatcher.on("remove",this._fixCaptionVisibility(t=>t.position.parent),{priority:"high"}),e.document.registerPostFixer(t=>this._updateCaptionVisibility(t))}_updateCaptionVisibility(t){const e=this.editor.editing.mapper,n=this._lastSelectedCaption;let i;const s=this.editor.model.document.selection,o=s.getSelectedElement();if(o&&o.is("image")){const t=rE(o);i=e.toViewElement(t)}const r=hE(s.getFirstPosition().parent);if(r&&(i=e.toViewElement(r)),i)return n?(n===i||(dE(n,t),this._lastSelectedCaption=i),uE(i,t)):(this._lastSelectedCaption=i,uE(i,t));if(n){const e=dE(n,t);return this._lastSelectedCaption=null,e}return!1}_fixCaptionVisibility(t){return(e,n,i)=>{const s=hE(t(n)),o=this.editor.editing.mapper,r=i.writer;if(s){const t=o.toViewElement(s);t&&(s.childCount?r.removeClass("ck-hidden",t):r.addClass("ck-hidden",t))}}}_insertMissingModelCaptionElement(t){const e=this.editor.model,n=e.document.differ.getChanges(),i=[];for(const t of n)if("insert"==t.type&&"$text"!=t.name){const n=t.position.nodeAfter;if(n.is("image")&&!rE(n)&&i.push(n),!n.is("image")&&n.childCount)for(const t of e.createRangeIn(n).getItems())t.is("image")&&!rE(t)&&i.push(t)}for(const e of i)t.appendElement("caption",e);return!!i.length}}function cE(t,e=!0){return(n,i,s)=>{const o=i.item;if((o.childCount||e)&&Sp(o.parent)){if(!s.consumable.consume(i.item,"insert"))return;const e=s.mapper.toViewElement(i.range.start.parent),n=t(s.writer),r=s.writer;o.childCount||r.addClass("ck-hidden",n),function(t,e,n,i){const s=i.writer.createPositionAt(n,"end");i.writer.insert(s,t),i.mapper.bindElements(e,t)}(n,i.item,e,s)}}}function hE(t){const e=t.getAncestors({includeSelf:!0}).find(t=>"caption"==t.name);return e&&e.parent&&"image"==e.parent.name?e:null}function dE(t,e){return!t.childCount&&!t.hasClass("ck-hidden")&&(e.addClass("ck-hidden",t),!0)}function uE(t,e){return!!t.hasClass("ck-hidden")&&(e.removeClass("ck-hidden",t),!0)}n(117);class fE extends Vu{constructor(t,e){super(t),this.defaultStyle=!1,this.styles=e.reduce((t,e)=>(t[e.name]=e,e.isDefault&&(this.defaultStyle=e.name),t),{})}refresh(){const t=this.editor.model.document.selection.getSelectedElement();if(this.isEnabled=Sp(t),t)if(t.hasAttribute("imageStyle")){const e=t.getAttribute("imageStyle");this.value=!!this.styles[e]&&e}else this.value=this.defaultStyle;else this.value=!1}execute(t){const e=t.value,n=this.editor.model,i=n.document.selection.getSelectedElement();n.change(t=>{this.styles[e].isDefault?t.removeAttribute("imageStyle",i):t.setAttribute("imageStyle",e,i)})}}function gE(t,e){for(const n of e)if(n.name===t)return n}var pE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>',mE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>',bE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>',wE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>';const _E={full:{name:"full",title:"Full size image",icon:pE,isDefault:!0},side:{name:"side",title:"Side image",icon:wE,className:"ck-content__image_side"},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:mE,className:"ck-content__image_align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:bE,className:"ck-content__image_align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:wE,className:"ck-content__image_align-right"}},kE={full:pE,left:mE,right:wE,center:bE};function vE(t=[]){return t.map(yE)}function yE(t){if("string"==typeof t){const e=t;_E[e]?t=Object.assign({},_E[e]):(fg.a.warn("image-style-not-found: There is no such image style of given name.",{name:e}),t={name:e})}else if(_E[t.name]){const e=_E[t.name],n=Object.assign({},t);for(const i in e)t.hasOwnProperty(i)||(n[i]=e[i]);t=n}return"string"==typeof t.icon&&kE[t.icon]&&(t.icon=kE[t.icon]),t}class xE extends Nc{static get pluginName(){return"ImageStyleEditing"}init(){const t=this.editor,e=t.model.schema,n=t.data,i=t.editing;t.config.define("image.styles",["full","side"]);const s=vE(t.config.get("image.styles"));e.extend("image",{allowAttributes:"imageStyle"});const o=function(t){return(e,n,i)=>{if(!i.consumable.consume(n.item,e.name))return;const s=gE(n.attributeNewValue,t),o=gE(n.attributeOldValue,t),r=i.mapper.toViewElement(n.item),a=i.writer;o&&a.removeClass(o.className,r),s&&a.addClass(s.className,r)}}(s);i.downcastDispatcher.on("attribute:imageStyle:image",o),n.downcastDispatcher.on("attribute:imageStyle:image",o),n.upcastDispatcher.on("element:figure",function(t){const e=t.filter(t=>!t.isDefault);return(t,n,i)=>{if(!n.modelRange)return;const s=n.viewItem,o=$g(n.modelRange.getItems());if(i.schema.checkAttribute(o,"imageStyle"))for(const t of e)i.consumable.consume(s,{classes:t.className})&&i.writer.setAttribute("imageStyle",t.name,o)}}(s),{priority:"low"}),t.commands.add("imageStyle",new fE(t,s))}}n(119);class CE extends Nc{static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const t=this.editor.t;return{"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}init(){const t=function(t,e){for(const n of t)e[n.title]&&(n.title=e[n.title]);return t}(vE(this.editor.config.get("image.styles")),this.localizedDefaultStylesTitles);for(const e of t)this._createButton(e)}_createButton(t){const e=this.editor,n="imageStyle:"+t.name;e.ui.componentFactory.add(n,n=>{const i=e.commands.get("imageStyle"),s=new ld(n);return s.set({label:t.title,icon:t.icon,tooltip:!0}),s.bind("isEnabled").to(i,"isEnabled"),s.bind("isOn").to(i,"value",e=>e===t.name),this.listenTo(s,"execute",()=>e.execute("imageStyle",{value:t.name})),s})}}class EE extends Nc{static get requires(){return[dd]}static get pluginName(){return"WidgetToolbarRepository"}init(){const t=this.editor;if(t.plugins.has("BalloonToolbar")){const e=t.plugins.get("BalloonToolbar");this.listenTo(e,"show",e=>{(function(t){const e=t.getSelectedElement();return!(!e||!vp(e))})(t.editing.view.document.selection)&&e.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const t of this._toolbarDefinitions.values())t.view.destroy()}register(t,{ariaLabel:e,items:n,getRelatedElement:i,balloonClassName:s="ck-toolbar-container"}){const o=this.editor,r=o.t,a=new Nd(o.locale);if(a.ariaLabel=e||r("Widget toolbar"),this._toolbarDefinitions.has(t))throw new tp.a("widget-toolbar-duplicated: Toolbar with the given id was already added.",this,{toolbarId:t});a.fillFromConfig(n,o.ui.componentFactory),this._toolbarDefinitions.set(t,{view:a,getRelatedElement:i,balloonClassName:s})}_updateToolbarsVisibility(){let t=0,e=null,n=null;for(const i of this._toolbarDefinitions.values()){const s=i.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&s)if(this.editor.ui.focusTracker.isFocused){const o=s.getAncestors().length;o>t&&(t=o,e=s,n=i)}else this._isToolbarVisible(i)&&this._hideToolbar(i);else this._isToolbarInBalloon(i)&&this._hideToolbar(i)}n&&this._showToolbar(n,e)}_hideToolbar(t){this._balloon.remove(t.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(t,e){this._isToolbarVisible(t)?TE(this.editor,e):this._isToolbarInBalloon(t)||(this._balloon.add({view:t.view,position:AE(this.editor,e),balloonClassName:t.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const t of this._toolbarDefinitions.values())if(this._isToolbarVisible(t)){const e=t.getRelatedElement(this.editor.editing.view.document.selection);TE(this.editor,e)}}))}_isToolbarVisible(t){return this._balloon.visibleView===t.view}_isToolbarInBalloon(t){return this._balloon.hasView(t.view)}}function TE(t,e){const n=t.plugins.get("ContextualBalloon"),i=AE(t,e);n.updatePosition(i)}function AE(t,e){const n=t.editing.view,i=$h.defaultPositions;return{target:n.domConverter.mapViewToDom(e),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,Tp]}}class PE extends Nc{static get pluginName(){return"ItalicEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"italic"}),t.model.schema.setAttributeProperties("italic",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"italic",view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add("italic",new vg(t,"italic")),t.keystrokes.set("CTRL+I","italic")}}class SE extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("italic",n=>{const i=t.commands.get("italic"),s=new ld(n);return s.set({label:e("Italic"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="italic-a" d="M16.6382223,4 L10.4423635,4 C10.2425391,4 10.0805376,4.16460731 10.0805376,4.36764586 C10.0805376,4.57068441 10.2425391,4.73529171 10.4423635,4.73529171 L13.0937274,4.73529171 L10.2701826,18.2646593 L7.36182592,18.2646593 C7.16200152,18.2646593 7,18.4292666 7,18.6323051 C7,18.8353437 7.16200152,18.999951 7.36182592,18.999951 L10.5622485,18.999951 C10.5626827,18.999951 10.5631652,19 10.5635993,19 C10.5638888,19 10.56413,18.999951 10.5644195,18.999951 L13.5576365,18.999951 C13.7574609,18.999951 13.9194624,18.8353437 13.9194624,18.6323051 C13.9194624,18.4292666 13.7574609,18.2646593 13.5576365,18.2646593 L11.0098513,18.2646593 L13.833396,4.73529171 L16.6381741,4.73529171 C16.8379985,4.73529171 17,4.57068441 17,4.36764586 C17,4.16460731 16.8380467,4 16.6382223,4 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#italic-a"/>\n  </g>\n</svg>\n',keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",()=>{t.execute("italic"),t.editing.view.focus()}),s})}}class OE extends Vu{constructor(t){super(t),this._childCommands=[]}refresh(){}execute(...t){this._getFirstEnabledCommand().execute(t)}registerChildCommand(t){this._childCommands.push(t),t.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find(t=>t.isEnabled)}}class ME extends Nc{static get pluginName(){return"IndentEditing"}init(){const t=this.editor;t.commands.add("indent",new OE(t)),t.commands.add("outdent",new OE(t))}}var NE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95L5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',IE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';class RE extends Nc{static get pluginName(){return"IndentUI"}init(){const t=this.editor,e=t.locale,n=t.t,i="ltr"==e.uiLanguageDirection?NE:IE,s="ltr"==e.uiLanguageDirection?IE:NE;this._defineButton("indent",n("Increase indent"),i),this._defineButton("outdent",n("Decrease indent"),s)}_defineButton(t,e,n){const i=this.editor;i.ui.componentFactory.add(t,s=>{const o=i.commands.get(t),r=new ld(s);return r.set({label:e,icon:n,tooltip:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(r,"execute",()=>{i.execute(t),i.editing.view.focus()}),r})}}function LE(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}function DE(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var VE=Vi({},vu,{listenTo(t,...e){if(LE(t)||DE(t)){const n=this._getProxyEmitter(t)||new BE(t);n.attach(...e),t=n}vu.listenTo.call(this,t,...e)},stopListening(t,e,n){if(LE(t)||DE(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}vu.stopListening.call(this,t,e,n),t instanceof BE&&t.detach(e)},_getProxyEmitter(t){return e=this,n=FE(t),e[_u]&&e[_u][n]?e[_u][n].emitter:null;var e,n}});class BE{constructor(t){yu(this,FE(t)),this._domNode=t}}function FE(t){return t["data-ck-expando"]||(t["data-ck-expando"]=bu())}Vi(BE.prototype,vu,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});class jE{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}Pu(jE,VE);class zE{constructor(t,e,n){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Vi(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class qE extends jE{constructor(t){super(t),this.useCapture=!1}observe(t){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(e=>{this.listenTo(t,e,(t,e)=>{this.isEnabled&&this.onDomEvent(e)},{useCapture:this.useCapture})})}fire(t,e,n){this.isEnabled&&this.document.fire(t,new zE(this.view,e,n))}}class UE extends qE{constructor(t){super(t),this.domEventType="click"}onDomEvent(t){this.fire(t.type,t)}}n(121);class WE extends Ih{constructor(t,e){super(t);const n="ck-input-"+Bc(),i="ck-status-"+Bc();this.set("label"),this.set("value"),this.set("isReadOnly",!1),this.set("errorText",null),this.set("infoText",null),this.labelView=this._createLabelView(n),this.inputView=this._createInputView(e,n,i),this.statusView=this._createStatusView(i),this.bind("_statusText").to(this,"errorText",this,"infoText",(t,e)=>t||e);const s=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input",s.if("isReadOnly","ck-disabled")]},children:[this.labelView,this.inputView,this.statusView]})}_createLabelView(t){const e=new rf(this.locale);return e.for=t,e.bind("text").to(this,"label"),e}_createInputView(t,e,n){const i=new t(this.locale,n);return i.id=e,i.ariaDescribedById=n,i.bind("value").to(this),i.bind("isReadOnly").to(this),i.bind("hasError").to(this,"errorText",t=>!!t),i.on("input",()=>{this.errorText=null}),i}_createStatusView(t){const e=new Ih(this.locale),n=this.bindTemplate;return e.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input__status",n.if("errorText","ck-labeled-input__status_error"),n.if("_statusText","ck-hidden",t=>!t)],id:t,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),e}select(){this.inputView.select()}focus(){this.inputView.focus()}}function HE(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}var KE=Vi({},HC,{listenTo(t,...e){if(HE(t)||dg(t)){const n=this._getProxyEmitter(t)||new JE(t);n.attach(...e),t=n}HC.listenTo.call(this,t,...e)},stopListening(t,e,n){if(HE(t)||dg(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}HC.stopListening.call(this,t,e,n),t instanceof JE&&t.detach(e)},_getProxyEmitter(t){return e=this,n=$E(t),e[UC]&&e[UC][n]?e[UC][n].emitter:null;var e,n}});class JE{constructor(t){KC(this,$E(t)),this._domNode=t}}function $E(t){return t["data-ck-expando"]||(t["data-ck-expando"]=zC())}Vi(JE.prototype,HC,{attach(t,e,n={}){if(this._domListeners&&this._domListeners[t])return;const i=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,i,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=i},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const n=e=>{this.fire(t,e)};return n.removeListener=()=>{this._domNode.removeEventListener(t,n,e),delete this._domListeners[t]},n}});const GE=Symbol("observableProperties"),YE=Symbol("boundObservables"),QE=Symbol("boundProperties"),ZE={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);tT(this);const n=this[GE];if(t in this&&!n.has(t))throw new Dm.b("observable-set-cannot-override: Cannot override an existing property.");Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!iT(t))throw new Dm.b("observable-bind-wrong-properties: All properties must be strings.");if(new Set(t).size!==t.length)throw new Dm.b("observable-bind-duplicate-properties: Properties must be unique.");tT(this);const e=this[QE];t.forEach(t=>{if(e.has(t))throw new Dm.b("observable-bind-rebind: Cannot bind the same property more that once.")});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:eT,toMany:nT,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!(GE in this))return;const e=this[QE],n=this[YE];if(t.length){if(!iT(t))throw new Dm.b("observable-unbind-wrong-properties: Properties must be strings.");t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new Dm.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(ZE,HC);var XE=ZE;function tT(t){GE in t||(Object.defineProperty(t,GE,{value:new Map}),Object.defineProperty(t,YE,{value:new Map}),Object.defineProperty(t,QE,{value:new Map}))}function eT(...t){const e=function(...t){if(!t.length)throw new Dm.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new Dm.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new Dm.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.");if(i>1&&e.callback)throw new Dm.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.");var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new Dm.b("observable-bind-to-properties-length: The number of properties must match.");t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[YE];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{sT(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[YE],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{sT(this._observable,t)})}function nT(t,e,n){if(this._bindings.size>1)throw new Dm.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().");this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function iT(t){return t.every(t=>"string"==typeof t)}function sT(t,e){const n=t[QE].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class oT{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new Dm.b("focusTracker-add-element-already-exist");this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}ZC(oT,KE),ZC(oT,XE);const rT=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(rT),function(t){t.match(/edge\/(\d+.?\d*)/)}(rT),function(t){t.match(/gecko\/\d+/)}(rT),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(rT);const aT=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;return t}();function lT(t){let e;if("string"==typeof t){if(e=aT[t.toLowerCase()],!e)throw new Dm.b("keyboard-unknown-key: Unknown key name.",{key:t})}else e=t.keyCode+(t.altKey?aT.alt:0)+(t.ctrlKey?aT.ctrl:0)+(t.shiftKey?aT.shift:0);return e}function cT(t){return t.split(/\s*\+\s*/)}class hT{constructor(){this._listener=Object.create(KE)}listenTo(t){this._listener.listenTo(t,"keydown",(t,e)=>{this._listener.fire("_keydown:"+lT(e),e)})}set(t,e,n={}){const i=function(t){return"string"==typeof t&&(t=cT(t)),t.map(t=>"string"==typeof t?lT(t):t).reduce((t,e)=>e+t,0)}(t),s=n.priority;this._listener.listenTo(this._listener,"_keydown:"+i,(t,n)=>{e(n,()=>{n.preventDefault(),n.stopPropagation(),t.stop()}),t.return=!0},{priority:s})}press(t){return!!this._listener.fire("_keydown:"+lT(t),t)}destroy(){this._listener.stopListening()}}class dT extends Ih{constructor(t,e){super(e),this.setTemplate({tag:"p",children:[{text:t}],attributes:{class:["ck","ck-dropdown__header"]}})}}class uT extends Ih{constructor(t){super(t),this.focusTracker=new oT,this.keystrokes=new hT,this.headerView=this._createHeader(),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton("Вставить","ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Отменить ","ck-button-cancel","cancel"),this._focusables=new Zc,this._focusCycler=new gd({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-link-form"],tabindex:"-1"},children:[this.headerView,this.urlInputView,this.saveButtonView]})}render(){super.render(),Ax({view:this});[this.urlInputView,this.saveButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createHeader(){return new dT("Вставка ссылки",this.locale)}_createUrlInput(){const t=new WE(this.locale,Ex);return t.extendTemplate({attributes:{class:["ck-input_link","form__row"]}}),t.label="Ссылка",t.labelView.extendTemplate({attributes:{class:"label"}}),t.inputView.placeholder="https://example.com",t.labelView.extendTemplate({attributes:{class:"input"}}),t}_createButton(t,e,n){const i=new ld(this.locale);return i.set({label:t,withText:!0,tooltip:!1}),i.extendTemplate({attributes:{class:[e,"button","button_theme-1"]}}),n&&i.delegate("execute").to(this,n),i}}class fT extends Ih{constructor(t){super(t),this.focusTracker=new oT,this.keystrokes=new hT,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton("Убрать ссылку",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="trash-a" d="M18.015625,6.484375 C18.1510423,6.484375 18.2682287,6.53385367 18.3671875,6.6328125 C18.4661463,6.73177133 18.515625,6.84895766 18.515625,6.984375 C18.515625,7.11979234 18.4661463,7.23697867 18.3671875,7.3359375 C18.2682287,7.43489633 18.1510423,7.484375 18.015625,7.484375 L17.328125,7.484375 L16.15625,19.046875 C16.1354166,19.3177097 16.0234385,19.5468741 15.8203125,19.734375 C15.6171865,19.9218759 15.3802097,20.015625 15.109375,20.015625 L8.890625,20.015625 C8.61979031,20.015625 8.38281352,19.9218759 8.1796875,19.734375 C7.97656148,19.5468741 7.85937516,19.3177097 7.828125,19.046875 L6.671875,7.484375 L5.984375,7.484375 C5.84895766,7.484375 5.73177133,7.43489633 5.6328125,7.3359375 C5.53385367,7.23697867 5.484375,7.11979234 5.484375,6.984375 C5.484375,6.84895766 5.53385367,6.73177133 5.6328125,6.6328125 C5.73177133,6.53385367 5.84895766,6.484375 5.984375,6.484375 L9.5,6.484375 L9.5,5.125 C9.5,4.80208172 9.61458219,4.53125109 9.84375,4.3125 C10.0729178,4.09374891 10.3437484,3.984375 10.65625,3.984375 L13.34375,3.984375 C13.6562516,3.984375 13.9270822,4.09374891 14.15625,4.3125 C14.3854178,4.53125109 14.5,4.80208172 14.5,5.125 L14.5,6.484375 L18.015625,6.484375 Z M10.5,5.125 L10.5,6.484375 L13.5,6.484375 L13.5,5.125 C13.5,5.08333312 13.4843752,5.04687516 13.453125,5.015625 C13.4218748,4.98437484 13.3854169,4.96875 13.34375,4.96875 L10.65625,4.96875 C10.6145831,4.96875 10.5781252,4.98437484 10.546875,5.015625 C10.5156248,5.04687516 10.5,5.08333312 10.5,5.125 Z M15.171875,18.953125 L16.3125,7.484375 L7.6875,7.484375 L8.828125,18.953125 C8.828125,18.9635417 8.83593742,18.9765624 8.8515625,18.9921875 C8.86718758,19.0078126 8.88020828,19.015625 8.890625,19.015625 L15.109375,19.015625 C15.1197917,19.015625 15.1328124,19.0104167 15.1484375,19 C15.1640626,18.9895833 15.171875,18.9739584 15.171875,18.953125 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#trash-a"/>\n  </g>\n</svg>\n',"unlink"),this.editButtonView=this._createButton("Редактировать ссылку",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="edit-a" d="M19.0625,4.78125 C19.3750016,5.07291813 19.6093742,5.37760258 19.765625,5.6953125 C19.9218758,6.01302242 20.0052083,6.33333172 20.015625,6.65625 C20.0260417,7.00000172 19.9531258,7.33593586 19.796875,7.6640625 C19.6406242,7.99218914 19.4114598,8.31249844 19.109375,8.625 C18.9635409,8.78125078 18.3802134,9.36457828 17.359375,10.375 C16.3385366,11.3854217 15.2369851,12.4765566 14.0546875,13.6484375 C12.8723899,14.8203184 11.7864633,15.8958284 10.796875,16.875 C9.80728672,17.8541716 9.26562547,18.3906245 9.171875,18.484375 C9.14062484,18.5156252 9.10677102,18.5416666 9.0703125,18.5625 C9.03385398,18.5833334 8.99479188,18.5989583 8.953125,18.609375 C8.80729094,18.6510419 8.50000234,18.7473951 8.03125,18.8984375 C7.56249766,19.0494799 7.08073164,19.2031242 6.5859375,19.359375 C6.09114336,19.5156258 5.64583531,19.6588535 5.25,19.7890625 C4.85416469,19.9192715 4.65104172,19.984375 4.640625,19.984375 C4.61979156,19.9947917 4.5963543,20.0026041 4.5703125,20.0078125 C4.5442707,20.0130209 4.51562516,20.015625 4.484375,20.015625 C4.42187469,20.015625 4.35937531,20.0026043 4.296875,19.9765625 C4.23437469,19.9505207 4.18229187,19.9114586 4.140625,19.859375 C4.06770797,19.7968747 4.02083344,19.7187505 4,19.625 C3.97916656,19.5312495 3.97916656,19.4375005 4,19.34375 C4.01041672,19.3333333 4.07291609,19.1380227 4.1875,18.7578125 C4.30208391,18.3776023 4.43489508,17.9375025 4.5859375,17.4375 C4.73697992,16.9374975 4.8828118,16.4505232 5.0234375,15.9765625 C5.1640632,15.5026018 5.26041641,15.1614594 5.3125,14.953125 C5.33333344,14.9114581 5.35416656,14.872396 5.375,14.8359375 C5.39583344,14.799479 5.42187484,14.7656252 5.453125,14.734375 L10.296875,9.890625 C11.5156311,8.67186891 12.643224,7.54167188 13.6796875,6.5 C14.716151,5.45832812 15.270833,4.90625031 15.34375,4.84375 C15.4479172,4.73958281 15.6718733,4.57031367 16.015625,4.3359375 C16.3593767,4.10156133 16.7812475,3.984375 17.28125,3.984375 C17.6041683,3.984375 17.914061,4.05208266 18.2109375,4.1875 C18.507814,4.32291734 18.7916653,4.52083203 19.0625,4.78125 Z M15.1875,6.4375 C14.6979142,6.91666906 14.0729205,7.53645453 13.3125,8.296875 C12.5520795,9.05729547 11.7682332,9.84374594 10.9609375,10.65625 C10.1536418,11.4687541 9.38021203,12.244788 8.640625,12.984375 L6.875,14.75 C7.08333437,14.8333338 7.31510289,14.9531242 7.5703125,15.109375 C7.82552211,15.2656258 8.08333203,15.473957 8.34375,15.734375 C8.55208437,15.9531261 8.7265618,16.174478 8.8671875,16.3984375 C9.0078132,16.622397 9.11979125,16.8281241 9.203125,17.015625 C9.64062719,16.5781228 10.2265588,15.9973995 10.9609375,15.2734375 C11.6953162,14.5494755 12.4635377,13.7890665 13.265625,12.9921875 C14.0677123,12.1953085 14.8463504,11.4218787 15.6015625,10.671875 C16.3567746,9.92187125 16.9791642,9.30729406 17.46875,8.828125 C17.4583333,8.74479125 17.398438,8.5494807 17.2890625,8.2421875 C17.179687,7.9348943 16.9687516,7.62500156 16.65625,7.3125 C16.3437484,7.01041516 16.0520847,6.79687563 15.78125,6.671875 C15.5104153,6.54687438 15.3125006,6.46875016 15.1875,6.4375 Z M6.1875,15.59375 C6.07291609,15.9791686 5.91406352,16.4895802 5.7109375,17.125 C5.50781148,17.7604198 5.33333406,18.3124977 5.1875,18.78125 C5.67708578,18.6249992 6.24478844,18.4375011 6.890625,18.21875 C7.53646156,17.9999989 8.03124828,17.8333339 8.375,17.71875 C8.32291641,17.5624992 8.23958391,17.3697928 8.125,17.140625 C8.01041609,16.9114572 7.84375109,16.6875011 7.625,16.46875 C7.33333187,16.1770819 7.05729297,15.9661465 6.796875,15.8359375 C6.53645703,15.7057285 6.33333406,15.6250002 6.1875,15.59375 Z M18.375,7.90625 C18.5833344,7.69791563 18.7395828,7.48958437 18.84375,7.28125 C18.9479172,7.07291563 19,6.87500094 19,6.6875 C19,6.49999906 18.945313,6.30729266 18.8359375,6.109375 C18.726562,5.91145734 18.5677094,5.71354266 18.359375,5.515625 C18.1927075,5.3489575 18.0182301,5.22395875 17.8359375,5.140625 C17.6536449,5.05729125 17.4687509,5.015625 17.28125,5.015625 C16.9583317,5.015625 16.6796887,5.0989575 16.4453125,5.265625 C16.2109363,5.4322925 16.0833334,5.53124984 16.0625,5.5625 L15.984375,5.640625 C16.1822927,5.72395875 16.4010405,5.84114508 16.640625,5.9921875 C16.8802095,6.14322992 17.1249987,6.34374875 17.375,6.59375 C17.6145845,6.83333453 17.8072909,7.07812375 17.953125,7.328125 C18.0989591,7.57812625 18.208333,7.80729063 18.28125,8.015625 C18.3020834,7.99479156 18.3203124,7.97395844 18.3359375,7.953125 C18.3515626,7.93229156 18.3645833,7.91666672 18.375,7.90625 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#edit-a"/>\n  </g>\n</svg>\n',"edit"),this.set("href"),this._focusables=new Zc,this._focusCycler=new gd({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render();[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(t,e,n){const i=new ld(this.locale);return i.set({label:t,icon:e,tooltip:!0}),i.delegate("execute").to(this,n),i}_createPreviewButton(){const t=new ld(this.locale),e=this.bindTemplate;return t.set({icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="open-a" d="M18.09375,18.828125 L18.09375,11.96875 L19.09375,11.015625 L19.09375,18.828125 C19.09375,19.1093764 18.9947927,19.3463532 18.796875,19.5390625 C18.5989573,19.7317718 18.3645847,19.828125 18.09375,19.828125 L5.09375,19.828125 C4.81249859,19.828125 4.5755218,19.7317718 4.3828125,19.5390625 C4.1901032,19.3463532 4.09375,19.1093764 4.09375,18.828125 L4.09375,8.828125 C4.09375,8.55729031 4.1901032,8.32291766 4.3828125,8.125 C4.5755218,7.92708234 4.81249859,7.828125 5.09375,7.828125 L10.09375,7.828125 L10.125,7.859375 L9.109375,8.828125 L5.09375,8.828125 L5.09375,18.828125 L18.09375,18.828125 Z M8.21875,14.828125 C8.39583422,13.7031194 8.76301805,12.6510466 9.3203125,11.671875 C9.87760695,10.6927034 10.5703084,9.84635773 11.3984375,9.1328125 C12.2265666,8.41926727 13.1692655,7.85677289 14.2265625,7.4453125 C15.2838595,7.03385211 16.4062441,6.828125 17.59375,6.828125 C17.6770838,6.828125 17.7578121,6.828125 17.8359375,6.828125 C17.9140629,6.828125 17.989583,6.828125 18.0625,6.828125 L16.25,5.015625 C16.1562495,4.92187453 16.109375,4.8046882 16.109375,4.6640625 C16.109375,4.5234368 16.1562495,4.40625047 16.25,4.3125 C16.3437505,4.21874953 16.4609368,4.171875 16.6015625,4.171875 C16.7421882,4.171875 16.8593745,4.21874953 16.953125,4.3125 L19.90625,7.34375 L16.953125,10.375 C16.9010414,10.4270836 16.8463545,10.4635416 16.7890625,10.484375 C16.7317705,10.5052084 16.6718753,10.515625 16.609375,10.515625 C16.536458,10.515625 16.4713545,10.5052084 16.4140625,10.484375 C16.3567705,10.4635416 16.3020836,10.4270836 16.25,10.375 C16.1562495,10.2812495 16.109375,10.1640632 16.109375,10.0234375 C16.109375,9.8828118 16.1562495,9.76562547 16.25,9.671875 L18.078125,7.84375 C17.9947912,7.83333328 17.9114588,7.828125 17.828125,7.828125 C17.7447912,7.828125 17.6562505,7.828125 17.5625,7.828125 C16.5208281,7.828125 15.5338588,8.0078107 14.6015625,8.3671875 C13.6692662,8.7265643 12.833337,9.21874688 12.09375,9.84375 C11.354163,10.4687531 10.7343775,11.2083291 10.234375,12.0625 C9.7343725,12.9166709 9.4010425,13.8385367 9.234375,14.828125 L8.21875,14.828125 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#open-a"/>\n  </g>\n</svg>\n',withText:!1,tooltip:"Открыть ссылку в новой вкладке"}),t.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:e.to("href",t=>t&&Nm(t)),target:"_blank"}}),t.bind("label").to(this,"href",t=>t||"Для этой ссылки не установлен адрес URL"),t.bind("isEnabled").to(this,"href",t=>!!t),t.template.tag="a",t.template.eventListeners={},t}}class gT extends Nc{static get requires(){return[dd]}static get pluginName(){return"LinkUI"}init(){const t=this.editor;t.editing.view.addObserver(UE),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=t.plugins.get(dd),this._createToolbarLinkButton(),this._enableUserBalloonInteractions()}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const t=this.editor,e=new fT(t.locale),n=t.commands.get("link"),i=t.commands.get("unlink");return e.bind("href").to(n,"value"),e.editButtonView.bind("isEnabled").to(n),e.unlinkButtonView.bind("isEnabled").to(i),this.listenTo(e,"edit",()=>{this._addFormView()}),this.listenTo(e,"unlink",()=>{t.execute("unlink"),this._hideUI()}),e.keystrokes.set("Esc",(t,e)=>{this._hideUI(),e()}),e.keystrokes.set("Ctrl+K",(t,e)=>{this._addFormView(),e()}),e}_createFormView(){const t=this.editor,e=new uT(t.locale),n=t.commands.get("link");return e.urlInputView.bind("value").to(n,"value"),e.urlInputView.bind("isReadOnly").to(n,"isEnabled",t=>!t),this.listenTo(e,"submit",()=>{t.execute("link",e.urlInputView.inputView.element.value),this._removeFormView()}),this.listenTo(e,"cancel",()=>{this._removeFormView()}),e.keystrokes.set("Esc",(t,e)=>{this._removeFormView(),e()}),e}_createToolbarLinkButton(){const t=this.editor,e=t.commands.get("link");t.keystrokes.set("Ctrl+K",(t,n)=>{n(),e.isEnabled&&this._showUI()}),t.ui.componentFactory.add("link",t=>{const n=new ld(t);return n.isEnabled=!0,n.label="Ссылка",n.icon='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="link-a" d="M8.625,15.4375 C8.52083281,15.3437495 8.46875,15.2291673 8.46875,15.09375 C8.46875,14.9583327 8.52083281,14.8385422 8.625,14.734375 L14.671875,8.640625 C14.7760422,8.53645781 14.8958327,8.484375 15.03125,8.484375 C15.1666673,8.484375 15.2864578,8.53645781 15.390625,8.640625 C15.4843755,8.73437547 15.53125,8.84895766 15.53125,8.984375 C15.53125,9.11979234 15.4843755,9.23958281 15.390625,9.34375 L9.328125,15.4375 C9.27604141,15.4895836 9.21875031,15.5286457 9.15625,15.5546875 C9.09374969,15.5807293 9.03125031,15.59375 8.96875,15.59375 C8.90624969,15.59375 8.84375031,15.5807293 8.78125,15.5546875 C8.71874969,15.5286457 8.66666688,15.4895836 8.625,15.4375 Z M11.4375,14.375 L12.234375,13.59375 C12.4843763,14.187503 12.5572922,14.799476 12.453125,15.4296875 C12.3489578,16.059899 12.0520858,16.6145809 11.5625,17.09375 L9.546875,19.046875 C9.23437344,19.3697933 8.87760617,19.6093742 8.4765625,19.765625 C8.07551883,19.9218758 7.66666875,20 7.25,20 C6.83333125,20 6.42448117,19.9218758 6.0234375,19.765625 C5.62239383,19.6093742 5.26562656,19.3697933 4.953125,19.046875 C4.63020672,18.7343734 4.39062578,18.3776062 4.234375,17.9765625 C4.07812422,17.5755188 4,17.1666687 4,16.75 C4,16.3333313 4.07812422,15.9270853 4.234375,15.53125 C4.39062578,15.1354147 4.63020672,14.7760433 4.953125,14.453125 L6.921875,12.421875 C7.23437656,12.1093734 7.59114383,11.8723966 7.9921875,11.7109375 C8.39323117,11.5494784 8.80208125,11.46875 9.21875,11.46875 C9.45833453,11.46875 9.69270719,11.4947914 9.921875,11.546875 C10.1510428,11.5989586 10.3749989,11.6770828 10.59375,11.78125 L9.8125,12.5625 C9.71874953,12.5312498 9.62239633,12.5078126 9.5234375,12.4921875 C9.42447867,12.4765624 9.32291719,12.46875 9.21875,12.46875 C8.91666516,12.46875 8.62760555,12.5260411 8.3515625,12.640625 C8.07551945,12.7552089 7.83333437,12.9166656 7.625,13.125 L5.65625,15.171875 C5.21874781,15.5989605 5,16.1249969 5,16.75 C5,17.3750031 5.21874781,17.9062478 5.65625,18.34375 C5.87500109,18.5520844 6.11979031,18.7135411 6.390625,18.828125 C6.66145969,18.9427089 6.94791516,19 7.25,19 C7.55208484,19 7.83854031,18.9427089 8.109375,18.828125 C8.38020969,18.7135411 8.62499891,18.5520844 8.84375,18.34375 L10.859375,16.390625 C11.1406264,16.1093736 11.3281245,15.7942726 11.421875,15.4453125 C11.5156255,15.0963524 11.5208337,14.7395852 11.4375,14.375 Z M19.046875,4.953125 C19.3697933,5.26562656 19.6093742,5.62239383 19.765625,6.0234375 C19.9218758,6.42448117 20,6.83333125 20,7.25 C20,7.66666875 19.9218758,8.07291469 19.765625,8.46875 C19.6093742,8.86458531 19.3697933,9.22395672 19.046875,9.546875 L17.03125,11.5625 C16.7187484,11.8750016 16.3619812,12.1119784 15.9609375,12.2734375 C15.5598938,12.4348966 15.1510437,12.515625 14.734375,12.515625 C14.5260406,12.515625 14.3177094,12.5000002 14.109375,12.46875 C13.9010406,12.4374998 13.6979177,12.3802087 13.5,12.296875 L14.296875,11.5 C14.369792,11.5104167 14.442708,11.515625 14.515625,11.515625 L14.734375,11.515625 C15.0364598,11.515625 15.3255195,11.4583339 15.6015625,11.34375 C15.8776055,11.2291661 16.1197906,11.0677094 16.328125,10.859375 L18.34375,8.828125 C18.7812522,8.40103953 19,7.87500312 19,7.25 C19,6.62499688 18.7812522,6.09375219 18.34375,5.65625 C18.1249989,5.44791563 17.8802097,5.28645891 17.609375,5.171875 C17.3385403,5.05729109 17.0520848,5 16.75,5 C16.4479152,5 16.1614597,5.05729109 15.890625,5.171875 C15.6197903,5.28645891 15.3750011,5.44791563 15.15625,5.65625 L13.140625,7.609375 C12.8385402,7.91145984 12.6432296,8.26301883 12.5546875,8.6640625 C12.4661454,9.06510617 12.4791661,9.45833141 12.59375,9.84375 L11.8125,10.625 C11.5208319,10.0208303 11.4270828,9.37500344 11.53125,8.6875 C11.6354172,7.99999656 11.9374975,7.4062525 12.4375,6.90625 L14.453125,4.953125 C14.7656266,4.63020672 15.1223938,4.39062578 15.5234375,4.234375 C15.9244812,4.07812422 16.3333313,4 16.75,4 C17.1666687,4 17.5755188,4.07812422 17.9765625,4.234375 C18.3776062,4.39062578 18.7343734,4.63020672 19.046875,4.953125 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#link-a"/>\n  </g>\n</svg>\n',n.keystroke="Ctrl+K",n.tooltip=!0,n.bind("isOn","isEnabled").to(e,"value","isEnabled"),this.listenTo(n,"execute",()=>this._showUI()),n})}_enableUserBalloonInteractions(){const t=this.editor.editing.view.document;this.listenTo(t,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(t,e)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),e())},{priority:"high"}),this.editor.keystrokes.set("Esc",(t,e)=>{this._isUIVisible&&(this._hideUI(),e())}),Pd({emitter:this.formView,activator:()=>this._isUIVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const t=this.editor.commands.get("link");this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.select(),this.formView.urlInputView.inputView.element.value=t.value||""}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus())}_showUI(){this.editor.commands.get("link").isEnabled&&(this._getSelectedLinkElement()?this._areActionsVisible?this._addFormView():this._addActionsView():(this._addActionsView(),this._addFormView()),this._startUpdatingUI())}_hideUI(){if(!this._isUIInPanel)return;const t=this.editor;this.stopListening(t.ui,"update"),t.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView)}_startUpdatingUI(){const t=this.editor,e=t.editing.view.document;let n=this._getSelectedLinkElement(),i=s();function s(){return e.selection.focus.getAncestors().reverse().find(t=>t.is("element"))}this.listenTo(t.ui,"update",()=>{const t=this._getSelectedLinkElement(),e=s();n&&!t||!n&&e!==i?this._hideUI():this._balloon.updatePosition(this._getBalloonPositionData()),n=t,i=e})}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const t=this.editor.editing.view,e=t.document,n=this._getSelectedLinkElement();return{target:n?t.domConverter.mapViewToDom(n):t.domConverter.viewRangeToDom(e.selection.getFirstRange())}}_getSelectedLinkElement(){const t=this.editor.editing.view,e=t.document.selection;if(e.isCollapsed)return pT(e.getFirstPosition());{const n=e.getFirstRange().getTrimmed(),i=pT(n.start),s=pT(n.end);return i&&i==s&&t.createRangeIn(i).getTrimmed().isEqual(n)?i:null}}}function pT(t){return t.getAncestors().find(t=>{return(e=t).is("attributeElement")&&!!e.getCustomProperty("link");var e})}class mT{constructor(t,e){this.loader=t,this.options=e}upload(){return this.loader.file.then(t=>new Promise((e,n)=>{this._initRequest(),this._initListeners(e,n,t),this._sendRequest(t)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const t=this.xhr=new XMLHttpRequest;t.open("POST",this.options.urlUpload,!0),t.responseType="json"}_initListeners(t,e,n){const i=this.xhr,s=this.loader,o=`Couldn't upload file: ${n.name}.`;i.addEventListener("error",()=>e(o)),i.addEventListener("abort",()=>e()),i.addEventListener("load",()=>{const n=i.response;if(!n||n.error)return e(n&&n.error?n.error.message:o);t({default:n.file.url})}),i.upload&&i.upload.addEventListener("progress",t=>{t.lengthComputable&&(s.uploadTotal=t.total,s.uploaded=t.loaded)})}_sendRequest(t){const e=new FormData;e.append("file",t),e.append("forObject","articleContentImage"),this.xhr.send(e)}}function bT(t){const e=t.next();return e.done?null:e.value}class wT extends Vu{constructor(t,e){super(t),this.type=e}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model,e=t.document,n=Array.from(e.selection.getSelectedBlocks()).filter(e=>kT(e,t.schema)),i=!0===this.value;t.change(t=>{if(i){let e=n[n.length-1].nextSibling,i=Number.POSITIVE_INFINITY,s=[];for(;e&&"listItem"==e.name&&0!==e.getAttribute("listIndent");){const t=e.getAttribute("listIndent");t<i&&(i=t);const n=t-i;s.push({element:e,listIndent:n}),e=e.nextSibling}s=s.reverse();for(const e of s)t.setAttribute("listIndent",e.listIndent,e.element)}if(!i){let t=Number.POSITIVE_INFINITY;for(const e of n)e.is("listItem")&&e.getAttribute("listIndent")<t&&(t=e.getAttribute("listIndent"));t=0===t?1:t,_T(n,!0,t),_T(n,!1,t)}for(const e of n.reverse())i&&"listItem"==e.name?t.rename(e,"paragraph"):i||"listItem"==e.name?i||"listItem"!=e.name||e.getAttribute("listType")==this.type||t.setAttribute("listType",this.type,e):(t.setAttributes({listType:this.type,listIndent:0},e),t.rename(e,"listItem"))})}_getValue(){const t=bT(this.editor.model.document.selection.getSelectedBlocks());return!!t&&t.is("listItem")&&t.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.document.selection,e=this.editor.model.schema,n=bT(t.getSelectedBlocks());return!!n&&kT(n,e)}}function _T(t,e,n){const i=e?t[0]:t[t.length-1];if(i.is("listItem")){let s=i[e?"previousSibling":"nextSibling"],o=i.getAttribute("listIndent");for(;s&&s.is("listItem")&&s.getAttribute("listIndent")>=n;)o>s.getAttribute("listIndent")&&(o=s.getAttribute("listIndent")),s.getAttribute("listIndent")==o&&t[e?"unshift":"push"](s),s=s[e?"previousSibling":"nextSibling"]}}function kT(t,e){return e.checkChild(t.parent,"listItem")&&!e.isObject(t)}class vT extends Vu{constructor(t,e){super(t),this._indentBy="forward"==e?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model,e=t.document;let n=Array.from(e.selection.getSelectedBlocks());t.change(t=>{const e=n[n.length-1];let i=e.nextSibling;for(;i&&"listItem"==i.name&&i.getAttribute("listIndent")>e.getAttribute("listIndent");)n.push(i),i=i.nextSibling;this._indentBy<0&&(n=n.reverse());for(const e of n){const n=e.getAttribute("listIndent")+this._indentBy;n<0?t.rename(e,"paragraph"):t.setAttribute("listIndent",n,e)}})}_checkEnabled(){const t=bT(this.editor.model.document.selection.getSelectedBlocks());if(!t||!t.is("listItem"))return!1;if(this._indentBy>0){const e=t.getAttribute("listIndent"),n=t.getAttribute("listType");let i=t.previousSibling;for(;i&&i.is("listItem")&&i.getAttribute("listIndent")>=e;){if(i.getAttribute("listIndent")==e)return i.getAttribute("listType")==n;i=i.previousSibling}return!1}return!0}}var yT=n(11);var xT=function(){return function t(){t.called=!0}};class CT{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=xT(),this.off=xT()}}const ET=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));var TT={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(26);const AT=Symbol("listeningTo"),PT=Symbol("emitterId");var ST={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[AT]||(this[AT]={});const r=this[AT];OT(t)||function(t,e){t[PT]||(t[PT]=e||function(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+ET[t>>0&255]+ET[t>>8&255]+ET[t>>16&255]+ET[t>>24&255]+ET[e>>0&255]+ET[e>>8&255]+ET[e>>16&255]+ET[e>>24&255]+ET[n>>0&255]+ET[n>>8&255]+ET[n>>16&255]+ET[n>>24&255]+ET[i>>0&255]+ET[i>>8&255]+ET[i>>16&255]+ET[i>>24&255]}())}(t);const a=OT(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=MT(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=NT(t,e),c=TT.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[AT];let s=t&&OT(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)RT(t,e,n);else if(r){for(;n=r.pop();)RT(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[AT]}},fire(t,...e){try{const n=t instanceof CT?t:new CT(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,RT(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&IT(t,n,e),s&&IT(s,n,e)}return n.return}catch(t){yT.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function OT(t){return t[PT]}function MT(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function NT(t,e){const n=MT(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=NT(t,n.childEvents[e]);i=i.concat(s)}return i}function IT(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new CT(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function RT(t,e,n){const i=NT(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function LT(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class DT{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new yT.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=LT(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}!function(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}(DT,ST);function VT(t){return!(!t||!t[Symbol.iterator])}function BT(t){return VT(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}function FT(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}function jT(t,e){const n=e.mapper,i=e.writer,s="numbered"==t.getAttribute("listType")?"ol":"ul",o=function(t){const e=t.createContainerElement("li");return e.getFillerOffset=KT,e}(i),r=i.createContainerElement(s,null);return i.insert(i.createPositionAt(r,0),o),n.bindElements(t,o),o}function zT(t,e,n,i){const s=e.parent,o=n.mapper,r=n.writer;let a=o.toViewPosition(i.createPositionBefore(t));const l=WT(t.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:t.getAttribute("listIndent")}),c=t.previousSibling;if(l&&l.getAttribute("listIndent")==t.getAttribute("listIndent")){const t=o.toViewElement(l);a=r.breakContainer(r.createPositionAfter(t))}else a=c&&"listItem"==c.name?o.toViewPosition(i.createPositionAt(c,"end")):o.toViewPosition(i.createPositionBefore(t));if(a=UT(a),r.insert(a,s),c&&"listItem"==c.name){const t=o.toViewElement(c),n=r.createRange(r.createPositionAt(t,0),a).getWalker({ignoreElementEnd:!0});for(const t of n)if(t.item.is("li")){const i=r.breakContainer(r.createPositionBefore(t.item)),s=t.item.parent,o=r.createPositionAt(e,"end");qT(r,o.nodeBefore,o.nodeAfter),r.move(r.createRangeOn(s),o),n.position=i}}else{const n=s.nextSibling;if(n&&(n.is("ul")||n.is("ol"))){let i=null;for(const e of n.getChildren()){const n=o.toModelElement(e);if(!(n&&n.getAttribute("listIndent")>t.getAttribute("listIndent")))break;i=e}i&&(r.breakContainer(r.createPositionAfter(i)),r.move(r.createRangeOn(i.parent),r.createPositionAt(e,"end")))}}qT(r,s,s.nextSibling),qT(r,s.previousSibling,s)}function qT(t,e,n){return!e||!n||"ul"!=e.name&&"ol"!=e.name||e.name!=n.name||e.getAttribute("class")!==n.getAttribute("class")?null:t.mergeContainers(t.createPositionAfter(e))}function UT(t){return t.getLastMatchingPosition(t=>t.item.is("uiElement"))}function WT(t,e){const n=!!e.sameIndent,i=!!e.smallerIndent,s=e.listIndent;let o=t;for(;o&&"listItem"==o.name;){const t=o.getAttribute("listIndent");if(n&&s==t||i&&s>t)return o;o=o.previousSibling}return null}function HT(t,e,n,i){t.ui.componentFactory.add(e,s=>{const o=t.commands.get(e),r=new ld(s);return r.set({label:n,icon:i,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",()=>{t.execute(e),t.editing.view.focus()}),r})}function KT(){const t=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||t?0:FT.call(this)}class JT{constructor(t){this.parent=null,this._attrs=BT(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new yT.a("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new yT.a("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=LT(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}is(t){return"node"===t||"model:node"===t}_clone(){return new JT(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=BT(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class $T extends JT{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"text"===t||"model:text"===t||"node"===t||"model:node"===t}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new $T(this.data,this.getAttributes())}static fromJSON(t){return new $T(t.data,t.attributes)}}class GT{constructor(t,e,n){if(this.textNode=t,e<0||e>t.offsetSize)throw new yT.a("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.offsetSize)throw new yT.a("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return"textProxy"===t||"model:textProxy"===t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class YT{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new yT.a("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new yT.a("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const t of e)if(!(t instanceof JT))throw new yT.a("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class QT extends JT{constructor(t,e,n){super(e),this.name=t,this._children=new YT,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?e===this.name&&("element"===t||"model:element"===t):"element"===t||"model:element"===t||t===this.name||t==="model:"+this.name||"node"===t||"model:node"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new QT(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new $T(t)];VT(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new $T(t):t instanceof GT?new $T(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}static fromJSON(t){let e=null;if(t.children){e=[];for(const n of t.children)n.name?e.push(QT.fromJSON(n)):e.push($T.fromJSON(n))}return new QT(t.name,t.attributes,e)}}class ZT{constructor(t,e,n="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new yT.a("model-position-root-invalid: Position root invalid.",t);if(!(e instanceof Array)||0===e.length)throw new yT.a("model-position-path-incorrect-format: Position path must be an array with at least one item.",t,{path:e});t.is("rootElement")?e=e.slice():(e=[...t.getPath(),...e],t=t.root),this.root=t,this.path=e,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)if(t=t.getChild(t.offsetToIndex(this.path[e])),!t)throw new yT.a("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(t.is("text"))throw new yT.a("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return XT(this,this.parent)}get nodeAfter(){const t=this.parent;return tA(this,t,XT(this,t))}get nodeBefore(){const t=this.parent;return eA(this,t,XT(this,t))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=LT(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new nA(e);return n.skip(t),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}getCommonPath(t){if(this.root!=t.root)return[];const e=LT(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}getShiftedBy(t){const e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,n=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=ZT._createAt(this),n=ZT._createAt(t);break;case"after":e=ZT._createAt(t),n=ZT._createAt(this);break;default:return!1}let i=e.parent;for(;e.path.length+n.path.length;){if(e.isEqual(n))return!0;if(e.path.length>n.path.length){if(e.offset!==i.maxOffset)return!1;e.path=e.path.slice(0,-1),i=i.parent,e.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}is(t){return"position"===t||"model:position"===t}hasSameParentAs(t){if(this.root!==t.root)return!1;return"same"==LT(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=ZT._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let n;return e.containsPosition(this)||e.start.isEqual(this)?(n=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(n=n._getTransformedByDeletion(t.deletionPosition,1))):n=this.isEqual(t.deletionPosition)?ZT._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),n}_getTransformedByDeletion(t,e){const n=ZT._createAt(this);if(this.root!=t.root)return n;if("same"==LT(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;n.offset-=e}}else if("prefix"==LT(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;if(t.offset<=this.path[i]){if(t.offset+e>this.path[i])return null;n.path[i]-=e}}return n}_getTransformedByInsertion(t,e){const n=ZT._createAt(this);if(this.root!=t.root)return n;if("same"==LT(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=e);else if("prefix"==LT(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;t.offset<=this.path[i]&&(n.path[i]+=e)}return n}_getTransformedByMove(t,e,n){if(e=e._getTransformedByDeletion(t,n),t.isEqual(e))return ZT._createAt(this);const i=this._getTransformedByDeletion(t,n);return null===i||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):i._getTransformedByInsertion(e,n)}_getCombined(t,e){const n=t.path.length-1,i=ZT._createAt(e);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-t.offset,i.path=[...i.path,...this.path.slice(n+1)],i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,n="toNone"){if(t instanceof ZT)return new ZT(t.root,t.path,t.stickiness);{const i=t;if("end"==e)e=i.maxOffset;else{if("before"==e)return this._createBefore(i,n);if("after"==e)return this._createAfter(i,n);if(0!==e&&!e)throw new yT.a("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,t])}if(!i.is("element")&&!i.is("documentFragment"))throw new yT.a("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,t]);const s=i.getPath();return s.push(e),new this(i.root,s,n)}}static _createAfter(t,e){if(!t.parent)throw new yT.a("model-position-after-root: You cannot make a position after root.",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new yT.a("model-position-before-root: You cannot make a position before root.",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const n=new ZT(e.graveyard,t.path);return n.stickiness=t.stickiness,n}if(!e.getRoot(t.root))throw new yT.a("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",e,{rootName:t.root});return new ZT(e.getRoot(t.root),t.path,t.stickiness)}}function XT(t,e){const n=e.getChild(e.offsetToIndex(t.offset));return n&&n.is("text")&&n.startOffset<t.offset?n:null}function tA(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset))}function eA(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset)-1)}class nA{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new yT.a("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new yT.a("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=ZT._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,n,i,s;do{i=this.position,s=this._visitedParent,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const i=e.parent,s=XT(e,i),o=s||tA(e,i,s);if(o instanceof QT)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=o),this.position=e,iA("elementStart",o,t,e,1);if(o instanceof $T){let i;if(this.singleCharacters)i=1;else{let t=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),i=t-e.offset}const s=e.offset-o.startOffset,r=new GT(o,s,i);return e.offset+=i,this.position=e,iA("text",r,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():iA("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const i=e.parent,s=XT(e,i),o=s||eA(e,i,s);if(o instanceof QT)return e.offset--,this.shallow?(this.position=e,iA("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this.position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():iA("elementEnd",o,t,e));if(o instanceof $T){let i;if(this.singleCharacters)i=1;else{let t=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),i=e.offset-t}const s=e.offset-o.startOffset,r=new GT(o,s-i,i);return e.offset-=i,this.position=e,iA("text",r,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,iA("elementStart",n,t,e,1)}}function iA(t,e,n,i,s){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}function sA(t){return(e,n,i)=>{const s=i.consumable;if(!s.test(n.item,"insert")||!s.test(n.item,"attribute:listType")||!s.test(n.item,"attribute:listIndent"))return;s.consume(n.item,"insert"),s.consume(n.item,"attribute:listType"),s.consume(n.item,"attribute:listIndent");const o=n.item;zT(o,jT(o,i),i,t)}}function oA(t,e,n){if(!n.consumable.consume(e.item,"attribute:listType"))return;const i=n.mapper.toViewElement(e.item),s=n.writer;s.breakContainer(s.createPositionBefore(i)),s.breakContainer(s.createPositionAfter(i));const o=i.parent,r="numbered"==e.attributeNewValue?"ol":"ul";s.rename(r,o)}function rA(t,e,n){const i=n.mapper.toViewElement(e.item).parent,s=n.writer;qT(s,i,i.nextSibling),qT(s,i.previousSibling,i);for(const t of e.item.getChildren())n.consumable.consume(t,"insert")}function aA(t,e,n){if("listItem"!=e.item.name){let t=n.mapper.toViewPosition(e.range.start);const i=n.writer,s=[];for(;("ul"==t.parent.name||"ol"==t.parent.name)&&(t=i.breakContainer(t),"li"==t.parent.name);){const e=t,n=i.createPositionAt(t.parent,"end");if(!e.isEqual(n)){const t=i.remove(i.createRange(e,n));s.push(t)}t=i.createPositionAfter(t.parent)}if(s.length>0){for(let e=0;e<s.length;e++){const n=t.nodeBefore;if(t=i.insert(t,s[e]).end,e>0){const e=qT(i,n,n.nextSibling);e&&e.parent==n&&t.offset--}}qT(i,t.nodeBefore,t.nodeAfter)}}}function lA(t,e,n){const i=n.mapper.toViewPosition(e.position),s=i.nodeBefore,o=i.nodeAfter;qT(n.writer,s,o)}function cA(t,e,n){if(n.consumable.consume(e.viewItem,{name:!0})){const t=n.writer,i=t.createElement("listItem"),s=function(t){let e=0,n=t.parent;for(;n;){if(n.is("li"))e++;else{const t=n.previousSibling;t&&t.is("li")&&e++}n=n.parent}return e}(e.viewItem);t.setAttribute("listIndent",s,i);const o=e.viewItem.parent&&"ol"==e.viewItem.parent.name?"numbered":"bulleted";t.setAttribute("listType",o,i);const r=n.splitToAllowedParent(i,e.modelCursor);if(!r)return;t.insert(i,r.position);const a=function(t,e,n){const{writer:i,schema:s}=n;let o=i.createPositionAfter(t);for(const r of e)if("ul"==r.name||"ol"==r.name)o=n.convertItem(r,o).modelCursor;else{const e=n.convertItem(r,i.createPositionAt(t,"end")),a=e.modelRange.start.nodeAfter;a&&a.is("element")&&!s.checkChild(t,a.name)&&(t=e.modelCursor.parent.is("listItem")?e.modelCursor.parent:gA(e.modelCursor),o=i.createPositionAfter(t))}return o}(i,e.viewItem.getChildren(),n);e.modelRange=t.createRange(e.modelCursor,a),r.cursorParent?e.modelCursor=t.createPositionAt(r.cursorParent,0):e.modelCursor=e.modelRange.end}}function hA(t,e,n){if(n.consumable.test(e.viewItem,{name:!0})){const t=Array.from(e.viewItem.getChildren());for(const e of t){!(e.is("li")||mA(e))&&e._remove()}}}function dA(t,e,n){if(n.consumable.test(e.viewItem,{name:!0})){if(0===e.viewItem.childCount)return;const t=[...e.viewItem.getChildren()];let n=!1,i=!0;for(const e of t)n&&!mA(e)&&e._remove(),e.is("text")?(i&&(e._data=e.data.replace(/^\s+/,"")),e.nextSibling&&!mA(e.nextSibling)||(e._data=e.data.replace(/\s+$/,""))):mA(e)&&(n=!0),i=!1}}function uA(t){return(e,n)=>{if(n.isPhantom)return;const i=n.modelPosition.nodeBefore;if(i&&i.is("listItem")){const e=n.mapper.toViewElement(i),s=e.getAncestors().find(mA),o=t.createPositionAt(e,0).getWalker();for(const t of o){if("elementStart"==t.type&&t.item.is("li")){n.viewPosition=t.previousPosition;break}if("elementEnd"==t.type&&t.item==s){n.viewPosition=t.nextPosition;break}}}}}function fA(t,[e,n]){let i,s=e.is("documentFragment")?e.getChild(0):e;if(i=n?this.createSelection(n):this.document.selection,s&&s.is("listItem")){const t=i.getFirstPosition();let e=null;if(t.parent.is("listItem")?e=t.parent:t.nodeBefore&&t.nodeBefore.is("listItem")&&(e=t.nodeBefore),e){const t=e.getAttribute("listIndent");if(t>0)for(;s&&s.is("listItem");)s._setAttribute("listIndent",s.getAttribute("listIndent")+t),s=s.nextSibling}}}function gA(t){const e=new nA({startPosition:t});let n;do{n=e.next()}while(!n.value.item.is("listItem"));return n.value.item}function pA(t,e,n,i,s,o){const r=WT(e.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:t,foo:"b"}),a=s.mapper,l=s.writer,c=r?r.getAttribute("listIndent"):null;let h;if(r)if(c==t){const t=a.toViewElement(r).parent;h=l.createPositionAfter(t)}else{const t=o.createPositionAt(r,"end");h=a.toViewPosition(t)}else h=n;h=UT(h);for(const t of[...i.getChildren()])mA(t)&&(h=l.move(l.createRangeOn(t),h).end,qT(l,t,t.nextSibling),qT(l,t.previousSibling,t))}function mA(t){return t.is("ol")||t.is("ul")}class bA extends Nc{static get pluginName(){return"ListEditing"}static get requires(){return[Ob]}init(){const t=this.editor;t.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const e=t.data,n=t.editing;var i;t.model.document.registerPostFixer(e=>function(t,e){const n=t.document.differ.getChanges(),i=new Map;let s=!1;for(const i of n)if("insert"==i.type&&"listItem"==i.name)o(i.position);else if("insert"==i.type&&"listItem"!=i.name){if("$text"!=i.name){const n=i.position.nodeAfter;n.hasAttribute("listIndent")&&(e.removeAttribute("listIndent",n),s=!0),n.hasAttribute("listType")&&(e.removeAttribute("listType",n),s=!0);for(const e of Array.from(t.createRangeIn(n)).filter(t=>t.item.is("listItem")))o(e.previousPosition)}o(i.position.getShiftedBy(i.length))}else"remove"==i.type&&"listItem"==i.name?o(i.position):("attribute"==i.type&&"listIndent"==i.attributeKey||"attribute"==i.type&&"listType"==i.attributeKey)&&o(i.range.start);for(const t of i.values())r(t),a(t);return s;function o(t){const e=t.nodeBefore;if(e&&e.is("listItem")){let t=e;if(i.has(t))return;for(let e=t.previousSibling;e&&e.is("listItem");e=t.previousSibling)if(t=e,i.has(t))return;i.set(e,t)}else{const e=t.nodeAfter;e&&e.is("listItem")&&i.set(e,e)}}function r(t){let n=0,i=null;for(;t&&t.is("listItem");){const o=t.getAttribute("listIndent");if(o>n){let r;null===i?(i=o-n,r=n):(i>o&&(i=o),r=o-i),e.setAttribute("listIndent",r,t),s=!0}else i=null,n=t.getAttribute("listIndent")+1;t=t.nextSibling}}function a(t){let n=[],i=null;for(;t&&t.is("listItem");){const o=t.getAttribute("listIndent");if(i&&i.getAttribute("listIndent")>o&&(n=n.slice(0,o+1)),0!=o)if(n[o]){const i=n[o];t.getAttribute("listType")!=i&&(e.setAttribute("listType",i,t),s=!0)}else n[o]=t.getAttribute("listType");i=t,t=t.nextSibling}}}(t.model,e)),n.mapper.registerViewToModelLength("li",wA),e.mapper.registerViewToModelLength("li",wA),n.mapper.on("modelToViewPosition",uA(n.view)),n.mapper.on("viewToModelPosition",(i=t.model,(t,e)=>{const n=e.viewPosition,s=n.parent,o=e.mapper;if("ul"==s.name||"ol"==s.name){if(n.isAtEnd){const t=o.toModelElement(n.nodeBefore),s=o.getModelLength(n.nodeBefore);e.modelPosition=i.createPositionBefore(t).getShiftedBy(s)}else{const t=o.toModelElement(n.nodeAfter);e.modelPosition=i.createPositionBefore(t)}t.stop()}else if("li"==s.name&&n.nodeBefore&&("ul"==n.nodeBefore.name||"ol"==n.nodeBefore.name)){const r=o.toModelElement(s);let a=1,l=n.nodeBefore;for(;l&&mA(l);)a+=o.getModelLength(l),l=l.previousSibling;e.modelPosition=i.createPositionBefore(r).getShiftedBy(a),t.stop()}})),e.mapper.on("modelToViewPosition",uA(n.view)),t.conversion.for("editingDowncast").add(e=>{e.on("insert",aA,{priority:"high"}),e.on("insert:listItem",sA(t.model)),e.on("attribute:listType:listItem",oA,{priority:"high"}),e.on("attribute:listType:listItem",rA,{priority:"low"}),e.on("attribute:listIndent:listItem",function(t){return(e,n,i)=>{if(!i.consumable.consume(n.item,"attribute:listIndent"))return;const s=i.mapper.toViewElement(n.item),o=i.writer;o.breakContainer(o.createPositionBefore(s)),o.breakContainer(o.createPositionAfter(s));const r=s.parent,a=r.previousSibling,l=o.createRangeOn(r);o.remove(l),a&&a.nextSibling&&qT(o,a,a.nextSibling),pA(n.attributeOldValue+1,n.range.start,l.start,s,i,t),zT(n.item,s,i,t);for(const t of n.item.getChildren())i.consumable.consume(t,"insert")}}(t.model)),e.on("remove:listItem",function(t){return(e,n,i)=>{const s=i.mapper.toViewPosition(n.position).getLastMatchingPosition(t=>!t.item.is("li")).nodeAfter,o=i.writer;o.breakContainer(o.createPositionBefore(s)),o.breakContainer(o.createPositionAfter(s));const r=s.parent,a=r.previousSibling,l=o.createRangeOn(r),c=o.remove(l);a&&a.nextSibling&&qT(o,a,a.nextSibling);pA(i.mapper.toModelElement(s).getAttribute("listIndent")+1,n.position,l.start,s,i,t);for(const t of o.createRangeIn(c).getItems())i.mapper.unbindViewElement(t);e.stop()}}(t.model)),e.on("remove",lA,{priority:"low"})}),t.conversion.for("dataDowncast").add(e=>{e.on("insert",aA,{priority:"high"}),e.on("insert:listItem",sA(t.model))}),t.conversion.for("upcast").add(t=>{t.on("element:ul",hA,{priority:"high"}),t.on("element:ol",hA,{priority:"high"}),t.on("element:li",dA,{priority:"high"}),t.on("element:li",cA)}),t.model.on("insertContent",fA,{priority:"high"}),t.commands.add("numberedList",new wT(t,"numbered")),t.commands.add("bulletedList",new wT(t,"bulleted")),t.commands.add("indentList",new vT(t,"forward")),t.commands.add("outdentList",new vT(t,"backward"));const s=n.view.document;this.listenTo(s,"enter",(t,e)=>{const n=this.editor.model.document,i=n.selection.getLastPosition().parent;n.selection.isCollapsed&&"listItem"==i.name&&i.isEmpty&&(this.editor.execute("outdentList"),e.preventDefault(),t.stop())}),this.listenTo(s,"delete",(t,e)=>{if("backward"!==e.direction)return;const n=this.editor.model.document.selection;if(!n.isCollapsed)return;const i=n.getFirstPosition();if(!i.isAtStart)return;const s=i.parent;if("listItem"!==s.name)return;s.previousSibling&&"listItem"===s.previousSibling.name||(this.editor.execute("outdentList"),e.preventDefault(),t.stop())},{priority:"high"});const o=t=>(e,n)=>{this.editor.commands.get(t).isEnabled&&(this.editor.execute(t),n())};t.keystrokes.set("Tab",o("indentList")),t.keystrokes.set("Shift+Tab",o("outdentList"))}afterInit(){const t=this.editor.commands,e=t.get("indent"),n=t.get("outdent");e&&e.registerChildCommand(t.get("indentList")),n&&n.registerChildCommand(t.get("outdentList"))}}function wA(t){let e=1;for(const n of t.getChildren())if("ul"==n.name||"ol"==n.name)for(const t of n.getChildren())e+=wA(t);return e}class _A extends Nc{init(){const t=this.editor.t;HT(this.editor,"numberedList",t("Numbered List"),'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="list-numbers-a" d="M5.76,9 L4.624,9 L4.624,5.128 L3.736,6.032 L3.088,5.352 L4.768,3.664 L5.76,3.664 L5.76,9 Z M7.392,16 L3.376,16 L3.376,15.112 C5.56,13.496 6.2,12.944 6.2,12.288 C6.2,11.824 5.776,11.592 5.336,11.592 C4.728,11.592 4.264,11.832 3.904,12.208 L3.256,11.456 C3.776,10.856 4.568,10.584 5.312,10.584 C6.448,10.584 7.352,11.224 7.352,12.288 C7.352,13.2 6.6,13.992 5.216,15 L7.392,15 L7.392,16 Z M9,7.5 C9,7.22385763 9.22975063,7 9.50123084,7 L19.4987692,7 C19.7755913,7 20,7.23193359 20,7.5 C20,7.77614237 19.7702494,8 19.4987692,8 L9.50123084,8 C9.22440869,8 9,7.76806641 9,7.5 Z M9,12.5 C9,12.2238576 9.22975063,12 9.50123084,12 L19.4987692,12 C19.7755913,12 20,12.2319336 20,12.5 C20,12.7761424 19.7702494,13 19.4987692,13 L9.50123084,13 C9.22440869,13 9,12.7680664 9,12.5 Z M9,17.5 C9,17.2238576 9.22975063,17 9.50123084,17 L19.4987692,17 C19.7755913,17 20,17.2319336 20,17.5 C20,17.7761424 19.7702494,18 19.4987692,18 L9.50123084,18 C9.22440869,18 9,17.7680664 9,17.5 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#list-numbers-a"/>\n  </g>\n</svg>\n'),HT(this.editor,"bulletedList",t("Bulleted List"),'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n  <g fill-rule="evenodd" transform="translate(4 6)">\n    <path d="M5 1.5C5 1.22385763 5.22975063 1 5.50123084 1L15.4987692 1C15.7755913 1 16 1.23193359 16 1.5 16 1.77614237 15.7702494 2 15.4987692 2L5.50123084 2C5.22440869 2 5 1.76806641 5 1.5zM5 6.5C5 6.22385763 5.22975063 6 5.50123084 6L15.4987692 6C15.7755913 6 16 6.23193359 16 6.5 16 6.77614237 15.7702494 7 15.4987692 7L5.50123084 7C5.22440869 7 5 6.76806641 5 6.5zM5 11.5C5 11.2238576 5.22975063 11 5.50123084 11L15.4987692 11C15.7755913 11 16 11.2319336 16 11.5 16 11.7761424 15.7702494 12 15.4987692 12L5.50123084 12C5.22440869 12 5 11.7680664 5 11.5zM1.5 3C.671572875 3 0 2.32842712 0 1.5 0 .671572875.671572875 0 1.5 0 2.32842712 0 3 .671572875 3 1.5 3 2.32842712 2.32842712 3 1.5 3zM1.5 8C.671572875 8 0 7.32842712 0 6.5 0 5.67157288.671572875 5 1.5 5 2.32842712 5 3 5.67157288 3 6.5 3 7.32842712 2.32842712 8 1.5 8zM1.5 13C.671572875 13 0 12.3284271 0 11.5 0 10.6715729.671572875 10 1.5 10 2.32842712 10 3 10.6715729 3 11.5 3 12.3284271 2.32842712 13 1.5 13z"/>\n  </g>\n</svg>\n')}}function kA(t,e){return t=>{t.on("attribute:url:media",n)};function n(n,i,s){if(!s.consumable.consume(i.item,n.name))return;const o=i.attributeNewValue,r=s.writer,a=s.mapper.toViewElement(i.item),l=[...a.getChildren()].find(t=>t.getCustomProperty("media-content"));r.remove(l);const c=t.getMediaViewElement(r,o,e);r.insert(r.createPositionAt(a,0),c)}}function vA(t,e,n,i){const s=t.createContainerElement("figure",{class:"media"});return s.getFillerOffset=CA,t.insert(t.createPositionAt(s,0),e.getMediaViewElement(t,n,i)),s}function yA(t){const e=t.getSelectedElement();return e&&e.is("media")?e:null}function xA(t,e,n){t.change(i=>{const s=i.createElement("media",{url:e});t.insertContent(s,n),i.setSelection(s,"on")})}function CA(){return null}class EA extends Vu{refresh(){const t=this.editor.model,e=t.document.selection,n=t.schema,i=e.getFirstPosition(),s=yA(e);let o=i.parent;o!=o.root&&(o=o.parent),this.value=s?s.getAttribute("url"):null,this.isEnabled=n.checkChild(o,"media")}execute(t){const e=this.editor.model,n=e.document.selection,i=yA(n);if(i)e.change(e=>{e.setAttribute("url",t,i)});else{const i=Ep(n,e);xA(e,t,i)}}}var TA=n(10);class AA{constructor(t,e){const n=e.providers,i=e.extraProviders||[],s=new Set(e.removeProviders),o=n.concat(i).filter(t=>{const e=t.name;return e?!s.has(e):(console.warn(Object(TA.a)("media-embed-no-provider-name: The configured media provider has no name and cannot be used."),{provider:t}),!1)});this.locale=t,this.providerDefinitions=o}hasMedia(t){return!!this._getMedia(t)}getMediaViewElement(t,e,n){return this._getMedia(e).getViewElement(t,n)}_getMedia(t){if(!t)return new PA(this.locale);t=t.trim();for(const e of this.providerDefinitions){const n=e.html;let i=e.url;Array.isArray(i)||(i=[i]);for(const e of i){const i=this._getUrlMatches(t,e);if(i)return new PA(this.locale,t,i,n)}}return null}_getUrlMatches(t,e){let n=t.match(e);if(n)return n;let i=t.replace(/^https?:\/\//,"");return n=i.match(e),n||(i=i.replace(/^www\./,""),n=i.match(e),n||null)}}class PA{constructor(t,e,n,i){this.url=this._getValidUrl(e),this._t=t.t,this._match=n,this._previewRenderer=i}getViewElement(t,e){const n={};let i;if(e.renderForEditingView||e.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(n["data-oembed-url"]=this.url),e.renderForEditingView&&(n.class="ck-media__wrapper");const s=this._getPreviewHtml(e);i=t.createUIElement("div",n,(function(t){const e=this.toDomElement(t);return e.innerHTML=s,e}))}else this.url&&(n.url=this.url),i=t.createEmptyElement("oembed",n);return t.setCustomProperty("media-content",!0,i),i}_getPreviewHtml(t){return this._previewRenderer?this._previewRenderer(this._match):this.url&&t.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const t=new Xh,e=new Zh;t.text=this._t("Open media in new tab"),e.content='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>',e.viewBox="0 0 64 42";return new th({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[e]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},t]}]}).render().outerHTML}_getValidUrl(t){return t?t.match(/^https?/)?t:"https://"+t:null}}n(123);class SA extends Nc{static get pluginName(){return"MediaEmbedEditing"}constructor(t){super(t),t.config.define("mediaEmbed",{providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:/^google\.com\/maps/},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new AA(t.locale,t.config.get("mediaEmbed"))}init(){const t=this.editor,e=t.model.schema,n=t.t,i=t.conversion,s=t.config.get("mediaEmbed.previewsInData"),o=this.registry;t.commands.add("mediaEmbed",new EA(t)),e.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),i.for("dataDowncast").elementToElement({model:"media",view:(t,e)=>{const n=t.getAttribute("url");return vA(e,o,n,{renderMediaPreview:n&&s})}}),i.for("dataDowncast").add(kA(o,{renderMediaPreview:s})),i.for("editingDowncast").elementToElement({model:"media",view:(t,e)=>{const i=t.getAttribute("url"),s=vA(e,o,i,{renderForEditingView:!0});return r=s,a=e,l=n("media widget"),a.setCustomProperty("media",!0,r),yp(r,a,{label:l});var r,a,l}}),i.for("editingDowncast").add(kA(o,{renderForEditingView:!0})),i.for("upcast").elementToElement({view:{name:"oembed",attributes:{url:!0}},model:(t,e)=>{const n=t.getAttribute("url");if(o.hasMedia(n))return e.createElement("media",{url:n})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(t,e)=>{const n=t.getAttribute("data-oembed-url");if(o.hasMedia(n))return e.createElement("media",{url:n})}})}}function OA(t){return!(!t||!t[Symbol.iterator])}function MA(t){return OA(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}function NA(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}n(36);class IA{constructor(t){this.parent=null,this._attrs=MA(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new TA.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new TA.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=NA(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}is(t){return"node"===t||"model:node"===t}_clone(){return new IA(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=MA(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class RA extends IA{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"text"===t||"model:text"===t||"node"===t||"model:node"===t}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new RA(this.data,this.getAttributes())}static fromJSON(t){return new RA(t.data,t.attributes)}}class LA{constructor(t,e,n){if(this.textNode=t,e<0||e>t.offsetSize)throw new TA.b("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.offsetSize)throw new TA.b("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return"textProxy"===t||"model:textProxy"===t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class DA{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new TA.b("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new TA.b("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const t of e)if(!(t instanceof IA))throw new TA.b("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class VA extends IA{constructor(t,e,n){super(e),this.name=t,this._children=new DA,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?e===this.name&&("element"===t||"model:element"===t):"element"===t||"model:element"===t||t===this.name||t==="model:"+this.name||"node"===t||"model:node"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const n of t)e=e.getChild(e.offsetToIndex(n));return e}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new VA(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const n=function(t){if("string"==typeof t)return[new RA(t)];OA(t)||(t=[t]);return Array.from(t).map(t=>"string"==typeof t?new RA(t):t instanceof LA?new RA(t.data,t.getAttributes()):t)}(e);for(const t of n)null!==t.parent&&t._remove(),t.parent=this;this._children._insertNodes(t,n)}_removeChildren(t,e=1){const n=this._children._removeNodes(t,e);for(const t of n)t.parent=null;return n}static fromJSON(t){let e=null;if(t.children){e=[];for(const n of t.children)n.name?e.push(VA.fromJSON(n)):e.push(RA.fromJSON(n))}return new VA(t.name,t.attributes,e)}}class BA{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new TA.b("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new TA.b("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=jA._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,n,i,s;do{i=this.position,s=this._visitedParent,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const i=e.parent,s=zA(e,i),o=s||qA(e,i,s);if(o instanceof VA)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=o),this.position=e,FA("elementStart",o,t,e,1);if(o instanceof RA){let i;if(this.singleCharacters)i=1;else{let t=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),i=t-e.offset}const s=e.offset-o.startOffset,r=new LA(o,s,i);return e.offset+=i,this.position=e,FA("text",r,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():FA("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const i=e.parent,s=zA(e,i),o=s||UA(e,i,s);if(o instanceof VA)return e.offset--,this.shallow?(this.position=e,FA("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this.position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():FA("elementEnd",o,t,e));if(o instanceof RA){let i;if(this.singleCharacters)i=1;else{let t=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),i=e.offset-t}const s=e.offset-o.startOffset,r=new LA(o,s-i,i);return e.offset-=i,this.position=e,FA("text",r,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,FA("elementStart",n,t,e,1)}}function FA(t,e,n,i,s){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}class jA{constructor(t,e,n="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new TA.b("model-position-root-invalid: Position root invalid.",t);if(!(e instanceof Array)||0===e.length)throw new TA.b("model-position-path-incorrect-format: Position path must be an array with at least one item.",t,{path:e});t.is("rootElement")?e=e.slice():(e=[...t.getPath(),...e],t=t.root),this.root=t,this.path=e,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)if(t=t.getChild(t.offsetToIndex(this.path[e])),!t)throw new TA.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(t.is("text"))throw new TA.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return zA(this,this.parent)}get nodeAfter(){const t=this.parent;return qA(this,t,zA(this,t))}get nodeBefore(){const t=this.parent;return UA(this,t,zA(this,t))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=NA(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new BA(e);return n.skip(t),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}getCommonPath(t){if(this.root!=t.root)return[];const e=NA(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}getShiftedBy(t){const e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,n=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=jA._createAt(this),n=jA._createAt(t);break;case"after":e=jA._createAt(t),n=jA._createAt(this);break;default:return!1}let i=e.parent;for(;e.path.length+n.path.length;){if(e.isEqual(n))return!0;if(e.path.length>n.path.length){if(e.offset!==i.maxOffset)return!1;e.path=e.path.slice(0,-1),i=i.parent,e.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}is(t){return"position"===t||"model:position"===t}hasSameParentAs(t){if(this.root!==t.root)return!1;return"same"==NA(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=jA._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let n;return e.containsPosition(this)||e.start.isEqual(this)?(n=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(n=n._getTransformedByDeletion(t.deletionPosition,1))):n=this.isEqual(t.deletionPosition)?jA._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),n}_getTransformedByDeletion(t,e){const n=jA._createAt(this);if(this.root!=t.root)return n;if("same"==NA(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;n.offset-=e}}else if("prefix"==NA(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;if(t.offset<=this.path[i]){if(t.offset+e>this.path[i])return null;n.path[i]-=e}}return n}_getTransformedByInsertion(t,e){const n=jA._createAt(this);if(this.root!=t.root)return n;if("same"==NA(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=e);else if("prefix"==NA(t.getParentPath(),this.getParentPath())){const i=t.path.length-1;t.offset<=this.path[i]&&(n.path[i]+=e)}return n}_getTransformedByMove(t,e,n){if(e=e._getTransformedByDeletion(t,n),t.isEqual(e))return jA._createAt(this);const i=this._getTransformedByDeletion(t,n);return null===i||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):i._getTransformedByInsertion(e,n)}_getCombined(t,e){const n=t.path.length-1,i=jA._createAt(e);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-t.offset,i.path=[...i.path,...this.path.slice(n+1)],i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,n="toNone"){if(t instanceof jA)return new jA(t.root,t.path,t.stickiness);{const i=t;if("end"==e)e=i.maxOffset;else{if("before"==e)return this._createBefore(i,n);if("after"==e)return this._createAfter(i,n);if(0!==e&&!e)throw new TA.b("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,t])}if(!i.is("element")&&!i.is("documentFragment"))throw new TA.b("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,t]);const s=i.getPath();return s.push(e),new this(i.root,s,n)}}static _createAfter(t,e){if(!t.parent)throw new TA.b("model-position-after-root: You cannot make a position after root.",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new TA.b("model-position-before-root: You cannot make a position before root.",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const n=new jA(e.graveyard,t.path);return n.stickiness=t.stickiness,n}if(!e.getRoot(t.root))throw new TA.b("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",e,{rootName:t.root});return new jA(e.getRoot(t.root),t.path,t.stickiness)}}function zA(t,e){const n=e.getChild(e.offsetToIndex(t.offset));return n&&n.is("text")&&n.startOffset<t.offset?n:null}function qA(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset))}function UA(t,e,n){return null!==n?null:e.getChild(e.offsetToIndex(t.offset)-1)}class WA{constructor(t,e=null){this.start=jA._createAt(t),this.end=e?jA._createAt(e):jA._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new BA({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==NA(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}containsItem(t){const e=jA._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}is(t){return"range"===t||"model:range"===t}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new WA(this.start,t.start)),this.containsPosition(t.end)&&e.push(new WA(t.end,this.end))):e.push(new WA(this.start,this.end)),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new WA(e,n)}return null}getMinimalFlatRanges(){const t=[],e=this.start.getCommonPath(this.end).length,n=jA._createAt(this.start);let i=n.parent;for(;n.path.length>e+1;){const e=i.maxOffset-n.offset;0!==e&&t.push(new WA(n,n.getShiftedBy(e))),n.path=n.path.slice(0,-1),n.offset++,i=i.parent}for(;n.path.length<=this.end.path.length;){const e=this.end.path[n.path.length-1],i=e-n.offset;0!==i&&t.push(new WA(n,n.getShiftedBy(i))),n.offset=e,n.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new BA(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new BA(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new BA(t);yield e.position;for(const t of e)yield t.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new WA(this.start,this.end)]}getTransformedByOperations(t){const e=[new WA(this.start,this.end)];for(const n of t)for(let t=0;t<e.length;t++){const i=e[t].getTransformedByOperation(n);e.splice(t,1,...i),t+=i.length-1}for(let t=0;t<e.length;t++){const n=e[t];for(let i=t+1;i<e.length;i++){const t=e[i];(n.containsRange(t)||t.containsRange(n)||n.isEqual(t))&&e.splice(i,1)}}return e}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,e=this.end.nodeBefore;return t&&t.is("element")&&t===e?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,e=!1){return this._getTransformedByInsertion(t.position,t.howMany,e)}_getTransformedByMoveOperation(t,e=!1){const n=t.sourcePosition,i=t.howMany,s=t.targetPosition;return this._getTransformedByMove(n,s,i,e)}_getTransformedBySplitOperation(t){const e=this.start._getTransformedBySplitOperation(t);let n=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(n=this.end.getShiftedBy(1)),e.root!=n.root&&(n=this.end.getShiftedBy(-1)),new WA(e,n)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new WA(this.start);let e=this.start._getTransformedByMergeOperation(t),n=this.end._getTransformedByMergeOperation(t);return e.root!=n.root&&(n=this.end.getShiftedBy(-1)),e.isAfter(n)?(t.sourcePosition.isBefore(t.targetPosition)?(e=jA._createAt(n),e.offset=0):(t.deletionPosition.isEqual(e)||(n=t.deletionPosition),e=t.targetPosition),new WA(e,n)):new WA(e,n)}_getTransformedByInsertion(t,e,n=!1){if(n&&this.containsPosition(t))return[new WA(this.start,t),new WA(t.getShiftedBy(e),this.end._getTransformedByInsertion(t,e))];{const n=new WA(this.start,this.end);return n.start=n.start._getTransformedByInsertion(t,e),n.end=n.end._getTransformedByInsertion(t,e),[n]}}_getTransformedByMove(t,e,n,i=!1){if(this.isCollapsed){const i=this.start._getTransformedByMove(t,e,n);return[new WA(i)]}const s=WA._createFromPositionAndShift(t,n),o=e._getTransformedByDeletion(t,n);if(this.containsPosition(e)&&!i&&(s.containsPosition(this.start)||s.containsPosition(this.end))){const i=this.start._getTransformedByMove(t,e,n),s=this.end._getTransformedByMove(t,e,n);return[new WA(i,s)]}let r;const a=this.getDifference(s);let l=null;const c=this.getIntersection(s);if(1==a.length?l=new WA(a[0].start._getTransformedByDeletion(t,n),a[0].end._getTransformedByDeletion(t,n)):2==a.length&&(l=new WA(this.start,this.end._getTransformedByDeletion(t,n))),r=l?l._getTransformedByInsertion(o,n,null!==c||i):[],c){const t=new WA(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,t):r.push(t)}return r}_getTransformedByDeletion(t,e){let n=this.start._getTransformedByDeletion(t,e),i=this.end._getTransformedByDeletion(t,e);return null==n&&null==i?null:(null==n&&(n=t),null==i&&(i=t),new WA(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return new this(jA._createAt(t,0),jA._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(jA._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(0===t.length)throw new TA.b("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(1==t.length)return t[0].clone();const e=t[0];t.sort((t,e)=>t.start.isAfter(e.start)?1:-1);const n=t.indexOf(e),i=new this(e.start,e.end);if(n>0)for(let e=n-1;t[e].end.isEqual(i.start);e++)i.start=jA._createAt(t[e].start);for(let e=n+1;e<t.length&&t[e].start.isEqual(i.end);e++)i.end=jA._createAt(t[e].end);return i}static fromJSON(t,e){return new this(jA.fromJSON(t.start,e),jA.fromJSON(t.end,e))}}var HA=function(){return function t(){t.called=!0}};class KA{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=HA(),this.off=HA()}}const JA=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));var $A={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};const GA=Symbol("listeningTo"),YA=Symbol("emitterId");var QA={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[GA]||(this[GA]={});const r=this[GA];ZA(t)||function(t,e){t[YA]||(t[YA]=e||function(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+JA[t>>0&255]+JA[t>>8&255]+JA[t>>16&255]+JA[t>>24&255]+JA[e>>0&255]+JA[e>>8&255]+JA[e>>16&255]+JA[e>>24&255]+JA[n>>0&255]+JA[n>>8&255]+JA[n>>16&255]+JA[n>>24&255]+JA[i>>0&255]+JA[i>>8&255]+JA[i>>16&255]+JA[i>>24&255]}())}(t);const a=ZA(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=XA(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=tP(t,e),c=$A.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[GA];let s=t&&ZA(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)nP(t,e,n);else if(r){for(;n=r.pop();)nP(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[GA]}},fire(t,...e){try{const n=t instanceof KA?t:new KA(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,nP(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&eP(t,n,e),s&&eP(s,n,e)}return n.return}catch(t){TA.b.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function ZA(t){return t[YA]}function XA(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function tP(t,e){const n=XA(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=tP(t,n.childEvents[e]);i=i.concat(s)}return i}function eP(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new KA(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function nP(t,e,n){const i=tP(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function iP(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}class sP extends WA{constructor(t,e){super(t,e),oP.call(this)}detach(){this.stopListening()}is(t){return"liveRange"===t||"model:liveRange"===t||"range"==t||"model:range"===t}toRange(){return new WA(this.start,this.end)}static fromRange(t){return new sP(t.start,t.end)}}function oP(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&rP.call(this,n)},{priority:"low"})}function rP(t){const e=this.getTransformedByOperation(t),n=WA._createFromRanges(e),i=!n.isEqual(this),s=function(t,e){switch(e.type){case"insert":return t.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return t.containsPosition(e.sourcePosition)||t.start.isEqual(e.sourcePosition)||t.containsPosition(e.targetPosition);case"split":return t.containsPosition(e.splitPosition)||t.containsPosition(e.insertionPosition)}return!1}(this,t);let o=null;if(i){"$graveyard"==n.root.rootName&&(o="remove"==t.type?t.sourcePosition:t.deletionPosition);const e=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",e,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}iP(sP,QA);class aP extends jA{constructor(t,e,n="toNone"){if(super(t,e,n),!this.root.is("rootElement"))throw new TA.b("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.",t);lP.call(this)}detach(){this.stopListening()}is(t){return"livePosition"===t||"model:livePosition"===t||"position"==t||"model:position"===t}toPosition(){return new jA(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}function lP(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const n=e[0];n.isDocumentOperation&&cP.call(this,n)},{priority:"low"})}function cP(t){const e=this.getTransformedByOperation(t);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}iP(aP,QA);var hP={window:window,document:document};const dP=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=]+$/;class uP extends Nc{static get requires(){return[m_,Uy]}static get pluginName(){return"AutoMediaEmbed"}constructor(t){super(t),this._timeoutId=null,this._positionToInsert=null}init(){const t=this.editor,e=t.model.document;this.listenTo(t.plugins.get(m_),"inputTransformation",()=>{const t=e.selection.getFirstRange(),n=aP.fromPosition(t.start);n.stickiness="toPrevious";const i=aP.fromPosition(t.end);i.stickiness="toNext",e.once("change:data",()=>{this._embedMediaBetweenPositions(n,i),n.detach(),i.detach()},{priority:"high"})}),t.commands.get("undo").on("execute",()=>{this._timeoutId&&(hP.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(t,e){const n=this.editor,i=n.plugins.get(SA).registry,s=new sP(t,e),o=s.getWalker({ignoreElementEnd:!0});let r="";for(const t of o)t.item.is("textProxy")&&(r+=t.item.data);if(r=r.trim(),!r.match(dP))return void s.detach();if(!i.hasMedia(r))return void s.detach();n.commands.get("mediaEmbed").isEnabled?(this._positionToInsert=aP.fromPosition(t),this._timeoutId=hP.window.setTimeout(()=>{n.model.change(t=>{let e;this._timeoutId=null,t.remove(s),s.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(e=this._positionToInsert),xA(n.model,r,e),this._positionToInsert.detach(),this._positionToInsert=null})},100)):s.detach()}}class fP extends Ih{constructor(t,e){super(e),this.focusTracker=new oT,this.keystrokes=new hT,this.header=this._createHeader(),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton("Вставить","ck-button-save"),this.saveButtonView.type="submit",this._focusables=new Zc,this._focusCycler=new gd({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=t,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form"],tabindex:"-1"},children:[this.header,this.urlInputView,this.saveButtonView]})}render(){super.render(),Ax({view:this});[this.header,this.urlInputView,this.saveButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element);const t=t=>t.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",(t,e)=>{e.stopPropagation()},{priority:"high"})}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.inputView.element.value.trim()}set url(t){this.urlInputView.inputView.element.value=t.trim()}isValid(){this.resetFormStatus();for(const t of this._validators){const e=t(this);if(e)return this.urlInputView.errorText=e,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createHeader(){return new dT("Вставка видео",this.locale)}_createUrlInput(){const t=new WE(this.locale,Ex);return t.extendTemplate({attributes:{class:["ck-media-embed_link","form__row"]}}),t.label="Ссылка",t.labelView.extendTemplate({attributes:{class:"label"}}),t.inputView.placeholder="https://example.com",t.labelView.extendTemplate({attributes:{class:"input"}}),t}_createButton(t,e,n){const i=new ld(this.locale);return i.set({label:t,tooltip:!0,withText:!0}),i.extendTemplate({attributes:{class:[e,"button","button_theme-1"]}}),n&&i.delegate("execute").to(this,n),i}}class gP extends Nc{static get requires(){return[SA]}static get pluginName(){return"MediaEmbedUI"}init(){const t=this.editor,e=t.commands.get("mediaEmbed"),n=t.plugins.get(SA).registry;this.form=new fP(function(t,e){return[t=>{if(!t.url.length)return"Поле не может быть пустым"},t=>{if(!e.hasMedia(t.url))return"Эта ссылка не поддерживается"}]}(t.t,n),t.locale),t.ui.componentFactory.add("mediaEmbed",n=>{const i=Sd(n);return this._setUpDropdown(i,this.form,e,t),this._setUpForm(this.form,i,e),i})}_setUpDropdown(t,e,n){const i=this.editor,s=t.buttonView;t.set({class:"ck-media-embed-dropdown"}),t.bind("isEnabled").to(n);const o=new Ku("div",[e]);function r(){i.editing.view.focus(),t.isOpen=!1}s.set({label:"Вставить видео",icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="video-a" d="M13.96875,7.484375 L5.03125,7.484375 C5.02083328,7.484375 5.01302086,7.48958328 5.0078125,7.5 C5.00260414,7.51041672 5,7.52083328 5,7.53125 L5,16.46875 C5,16.4791667 5.00260414,16.4895833 5.0078125,16.5 C5.01302086,16.5104167 5.02083328,16.515625 5.03125,16.515625 L13.96875,16.515625 C13.9791667,16.515625 13.9869791,16.5104167 13.9921875,16.5 C13.9973959,16.4895833 14,16.4791667 14,16.46875 L14,14.515625 C14,14.3281241 14.0494787,14.1536466 14.1484375,13.9921875 C14.2473963,13.8307284 14.3802075,13.7083337 14.546875,13.625 C14.619792,13.5833331 14.6953121,13.5546876 14.7734375,13.5390625 C14.8515629,13.5234374 14.927083,13.515625 15,13.515625 C15.1041672,13.515625 15.2057287,13.5286457 15.3046875,13.5546875 C15.4036463,13.5807293 15.4947913,13.6249997 15.578125,13.6875 L19,15.5625 L19,8.421875 L15.59375,10.34375 C15.5104163,10.4062503 15.4166672,10.4505207 15.3125,10.4765625 C15.2083328,10.5026043 15.1041672,10.515625 15,10.515625 C14.927083,10.515625 14.8515629,10.5078126 14.7734375,10.4921875 C14.6953121,10.4765624 14.6145837,10.4479169 14.53125,10.40625 C14.3749992,10.3229162 14.2473963,10.2005216 14.1484375,10.0390625 C14.0494787,9.87760336 14,9.70312594 14,9.515625 L14,7.53125 C14,7.52083328 13.9973959,7.51041672 13.9921875,7.5 C13.9869791,7.48958328 13.9791667,7.484375 13.96875,7.484375 Z M19.46875,6.984375 C19.5312503,6.984375 19.580729,6.99218742 19.6171875,7.0078125 C19.653646,7.02343758 19.6770833,7.03125 19.6875,7.03125 C19.7812505,7.07291688 19.8567705,7.13541625 19.9140625,7.21875 C19.9713545,7.30208375 20,7.40104109 20,7.515625 L20,16.5 C20,16.6041672 19.9713545,16.6979162 19.9140625,16.78125 C19.8567705,16.8645838 19.7812505,16.9270831 19.6875,16.96875 C19.6770833,16.96875 19.653646,16.9765624 19.6171875,16.9921875 C19.580729,17.0078126 19.5364586,17.015625 19.484375,17.015625 C19.4218747,17.015625 19.3593753,17.0130209 19.296875,17.0078125 C19.2343747,17.0026041 19.1718753,16.9687503 19.109375,16.90625 L15,14.515625 L15,16.46875 C15,16.7604181 14.8984385,17.0078115 14.6953125,17.2109375 C14.4921865,17.4140635 14.2500014,17.515625 13.96875,17.515625 L5.03125,17.515625 C4.74999859,17.515625 4.50781352,17.4140635 4.3046875,17.2109375 C4.10156148,17.0078115 4,16.7604181 4,16.46875 L4,7.53125 C4,7.23958188 4.10156148,6.99218852 4.3046875,6.7890625 C4.50781352,6.58593648 4.74999859,6.484375 5.03125,6.484375 L13.96875,6.484375 C14.2604181,6.484375 14.5052073,6.58593648 14.703125,6.7890625 C14.9010427,6.99218852 15,7.23958188 15,7.53125 L15,9.515625 L19.03125,7.140625 C19.0937503,7.07812469 19.1692704,7.03645844 19.2578125,7.015625 C19.3463546,6.99479156 19.4166664,6.984375 19.46875,6.984375 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#video-a"/>\n  </g>\n</svg>\n',tooltip:!0}),s.on("open",()=>{e.url=n.value||"",e.urlInputView.select(),e.focus()},{priority:"low"}),t.on("submit",()=>{e.isValid()&&(i.execute("mediaEmbed",e.url),r())}),t.on("change:isOpen",()=>e.resetFormStatus()),t.on("cancel",()=>r()),t.render(),t.panelView.children.add(o)}_setUpForm(t,e,n){t.delegate("submit","cancel").to(e),t.urlInputView.bind("value").to(n,"value"),t.urlInputView.bind("isReadOnly").to(n,"isEnabled",t=>!t),t.saveButtonView.bind("isEnabled").to(n)}}n(125);class pP{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),e.classes&&("string"==typeof e.classes||e.classes instanceof RegExp)&&(e.classes=[e.classes]),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const n=mP(e,t);if(n)return{element:e,pattern:t,match:n}}return null}matchAll(...t){const e=[];for(const n of t)for(const t of this._patterns){const i=mP(n,t);i&&e.push({element:n,pattern:t,match:i})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function mP(t,e){if("function"==typeof e)return e(t);const n={};return e.name&&(n.name=function(t,e){if(t instanceof RegExp)return t.test(e);return t===e}(e.name,t.name),!n.name)||e.attributes&&(n.attributes=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasAttribute(i))return null;{const t=e.getAttribute(i);if(!0===s)n.push(i);else if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=function(t,e){const n=[];for(const i of t)if(i instanceof RegExp){const t=e.getClassNames();for(const e of t)i.test(e)&&n.push(e);if(0===n.length)return null}else{if(!e.hasClass(i))return null;n.push(i)}return n}(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=function(t,e){const n=[];for(const i in t){const s=t[i];if(!e.hasStyle(i))return null;{const t=e.getStyle(i);if(s instanceof RegExp){if(!s.test(t))return null;n.push(i)}else{if(t!==s)return null;n.push(i)}}}return n}(e.styles,t),!n.styles))&&n)}var bP=n(5);var wP=function(){return function t(){t.called=!0}};class _P{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=wP(),this.off=wP()}}const kP=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function vP(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0;return"e"+kP[t>>0&255]+kP[t>>8&255]+kP[t>>16&255]+kP[t>>24&255]+kP[e>>0&255]+kP[e>>8&255]+kP[e>>16&255]+kP[e>>24&255]+kP[n>>0&255]+kP[n>>8&255]+kP[n>>16&255]+kP[n>>24&255]+kP[i>>0&255]+kP[i>>8&255]+kP[i>>16&255]+kP[i>>24&255]}var yP={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(37);const xP=Symbol("listeningTo"),CP=Symbol("emitterId");var EP={on(t,e,n={}){this.listenTo(this,t,e,n)},once(t,e,n){let i=!1;this.listenTo(this,t,(function(t,...n){i||(i=!0,t.off(),e.call(this,t,...n))}),n)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,n,i={}){let s,o;this[xP]||(this[xP]={});const r=this[xP];TP(t)||function(t,e){t[CP]||(t[CP]=e||vP())}(t);const a=TP(t);(s=r[a])||(s=r[a]={emitter:t,callbacks:{}}),(o=s.callbacks[e])||(o=s.callbacks[e]=[]),o.push(n),function(t,e){const n=AP(t);if(n[e])return;let i=e,s=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),s&&n[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const t of o)t.callbacks=n[i].callbacks.slice();n[i].childEvents.push(s)}}(t,e);const l=PP(t,e),c=yP.get(i.priority),h={callback:n,priority:c};for(const t of l){let e=!1;for(let n=0;n<t.length;n++)if(t[n].priority<c){t.splice(n,0,h),e=!0;break}e||t.push(h)}},stopListening(t,e,n){const i=this[xP];let s=t&&TP(t);const o=i&&s&&i[s],r=o&&e&&o.callbacks[e];if(!(!i||t&&!o||e&&!r))if(n)OP(t,e,n);else if(r){for(;n=r.pop();)OP(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete i[s]}else{for(s in i)this.stopListening(i[s].emitter);delete this[xP]}},fire(t,...e){try{const n=t instanceof _P?t:new _P(this,t),i=n.name;let s=function t(e,n){let i;if(!e._events||!(i=e._events[n])||!i.callbacks.length)return n.indexOf(":")>-1?t(e,n.substr(0,n.lastIndexOf(":"))):null;return i.callbacks}(this,i);if(n.path.push(this),s){const t=[n,...e];s=Array.from(s);for(let e=0;e<s.length&&(s[e].callback.apply(this,t),n.off.called&&(delete n.off.called,OP(this,i,s[e].callback)),!n.stop.called);e++);}if(this._delegations){const t=this._delegations.get(i),s=this._delegations.get("*");t&&SP(t,n,e),s&&SP(s,n,e)}return n.return}catch(t){bP.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,n)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const i=this._delegations.get(t);i?i.set(e,n):this._delegations.set(t,new Map([[e,n]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}};function TP(t){return t[CP]}function AP(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function PP(t,e){const n=AP(t)[e];if(!n)return[];let i=[n.callbacks];for(let e=0;e<n.childEvents.length;e++){const s=PP(t,n.childEvents[e]);i=i.concat(s)}return i}function SP(t,e,n){for(let[i,s]of t){s?"function"==typeof s&&(s=s(e.name)):s=e.name;const t=new _P(e.source,s);t.path=[...e.path],i.fire(t,...n)}}function OP(t,e,n){const i=PP(t,e);for(const t of i)for(let e=0;e<t.length;e++)t[e].callback==n&&(t.splice(e,1),e--)}function MP(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(n=>{if(n in t.prototype)return;const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable=!1,Object.defineProperty(t.prototype,n,i)})})}function NP(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(t[i]!=e[i])return i;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}class IP{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new bP.a("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this:this.parent;for(;n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}getCommonAncestor(t,e={}){const n=this.getAncestors(e),i=t.getAncestors(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),n=t.getPath(),i=NP(e,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return e[i]<n[i]}}isAfter(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=Nn(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}MP(IP,EP);class RP extends IP{constructor(t,e){super(t),this._textData=e}is(t){return"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof RP&&(this===t||this.data===t.data)}_clone(){return new RP(this.document,this.data)}}class LP{constructor(t,e,n){if(this.textNode=t,e<0||e>t.data.length)throw new bP.a("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||e+n>t.data.length)throw new bP.a("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=t.data.substring(e,e+n),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let n=t.includeSelf?this.textNode:this.parent;for(;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}function DP(t){return!(!t||!t[Symbol.iterator])}class VP{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new RP(t,e)];DP(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new RP(t,e):e instanceof LP?new RP(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}function BP(t){return DP(t)?new Map(t):function(t){const e=new Map;for(const n in t)e.set(n,t[n]);return e}(t)}MP(VP,EP);class FP{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,n=0,i=0,s=null;const o=new Map;if(""===t)return o;";"!=t.charAt(t.length-1)&&(t+=";");for(let r=0;r<t.length;r++){const a=t.charAt(r);if(null===e)switch(a){case":":s||(s=t.substr(n,r-n),i=r+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(i,r-i);s&&o.set(s.trim(),e.trim()),s=null,n=r+1;break}}else a===e&&(e=null)}return o}(t).entries());for(const[t,n]of e)this._styleProcessor.toNormalizedForm(t,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(V(t))for(const[e,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(e,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=jP(t);ri(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!V(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(){if(this.isEmpty)return[];return this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),i=ai(this._styles,n);if(!i)return;!Array.from(Object.keys(i)).length&&this.remove(n)}}function jP(t){return t.replace("-",".")}class zP extends IP{constructor(t,e,n,i){if(super(t),this.name=e,this._attrs=function(t){t=BP(t);for(const[e,n]of t)null===n?t.delete(e):"string"!=typeof n&&t.set(e,String(n));return t}(n),this._children=[],i&&this._insertChild(0,i),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");qP(this._classes,t),this._attrs.delete("class")}this._styles=new FP(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof zP))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,n]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==n)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new pP(...t);let n=this.parent;for(;n;){if(e.match(n))return n;n=n.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),n=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==n?"":" "+n)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const n=new this.constructor(this.document,this.name,this._attrs,e);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let n=0;const i=function(t,e){if("string"==typeof e)return[new RP(t,e)];DP(e)||(e=[e]);return Array.from(e).map(e=>"string"==typeof e?new RP(t,e):e instanceof LP?new RP(t,e.data):e)}(this.document,e);for(const e of i)null!==e.parent&&e._remove(),e.parent=this,e.document=this.document,this._children.splice(t,0,e),t++,n++;return n}_removeChildren(t,e=1){this._fireChange("children",this);for(let n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?qP(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.add(t))}_removeClass(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._classes.delete(t))}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this),(t=Array.isArray(t)?t:[t]).forEach(t=>this._styles.remove(t))}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function qP(t,e){const n=e.split(/\s+/);t.clear(),n.forEach(e=>t.add(e))}class UP{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new bP.a("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new bP.a("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=iS._createAt(t.startPosition):this.position=iS._createAt(t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,n,i;do{i=this.position,({done:e,value:n}=this.next())}while(!e&&t(n));e||(this.position=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&t.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let i;if(n instanceof RP){if(t.isAtEnd)return this.position=iS._createAfter(n),this._next();i=n.data[t.offset]}else i=n.getChild(t.offset);if(i instanceof zP)return this.shallow?t.offset++:t=new iS(i,0),this.position=t,this._formatReturnValue("elementStart",i,e,t,1);if(i instanceof RP){if(this.singleCharacters)return t=new iS(i,0),this.position=t,this._next();{let n,s=i.data.length;return i==this._boundaryEndParent?(s=this.boundaries.end.offset,n=new LP(i,0,s),t=iS._createAfter(n)):(n=new LP(i,0,i.data.length),t.offset++),this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset}const s=new LP(n,t.offset,i);return t.offset+=i,this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=iS._createAfter(n),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let i;if(n instanceof RP){if(t.isAtStart)return this.position=iS._createBefore(n),this._previous();i=n.data[t.offset-1]}else i=n.getChild(t.offset-1);if(i instanceof zP)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",i,e,t,1)):(t=new iS(i,i.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,e,t));if(i instanceof RP){if(this.singleCharacters)return t=new iS(i,i.data.length),this.position=t,this._previous();{let n,s=i.data.length;if(i==this._boundaryStartParent){const e=this.boundaries.start.offset;n=new LP(i,e,i.data.length-e),s=n.data.length,t=iS._createBefore(n)}else n=new LP(i,0,i.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",n,e,t,s)}}if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const e=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=t.offset-e}t.offset-=i;const s=new LP(n,t.offset,i);return this.position=t,this._formatReturnValue("text",s,e,t,i)}return t=iS._createBefore(n),this.position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,i,s){return e instanceof LP&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=iS._createAfter(e.textNode):(i=iS._createAfter(e.textNode),this.position=i)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=iS._createBefore(e.textNode):(i=iS._createBefore(e.textNode),this.position=i))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:i,length:s}}}}class WP extends zP{constructor(t,e,n,i){super(t,e,n,i),this.getFillerOffset=HP}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function HP(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const e of t)if(!e.is("uiElement"))return null;return this.childCount}const KP=Symbol("observableProperties"),JP=Symbol("boundObservables"),$P=Symbol("boundProperties"),GP={set(t,e){if(V(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);QP(this);const n=this[KP];if(t in this&&!n.has(t))throw new bP.a("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>n.get(t),set(e){const i=n.get(t);let s=this.fire("set:"+t,t,e,i);void 0===s&&(s=e),i===s&&n.has(t)||(n.set(t,s),this.fire("change:"+t,t,s,i))}}),this[t]=e},bind(...t){if(!t.length||!tS(t))throw new bP.a("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(t).size!==t.length)throw new bP.a("observable-bind-duplicate-properties: Properties must be unique.",this);QP(this);const e=this[$P];t.forEach(t=>{if(e.has(t))throw new bP.a("observable-bind-rebind: Cannot bind the same property more than once.",this)});const n=new Map;return t.forEach(t=>{const i={property:t,to:[]};e.set(t,i),n.set(t,i)}),{to:ZP,toMany:XP,_observable:this,_bindProperties:t,_to:[],_bindings:n}},unbind(...t){if(!this[KP])return;const e=this[$P],n=this[JP];if(t.length){if(!tS(t))throw new bP.a("observable-unbind-wrong-properties: Properties must be strings.",this);t.forEach(t=>{const i=e.get(t);if(!i)return;let s,o,r,a;i.to.forEach(t=>{s=t[0],o=t[1],r=n.get(s),a=r[o],a.delete(i),a.size||delete r[o],Object.keys(r).length||(n.delete(s),this.stopListening(s,"change"))}),e.delete(t)})}else n.forEach((t,e)=>{this.stopListening(e,"change")}),n.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new bP.a("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:t});this.on(t,(t,n)=>{t.return=e.apply(this,n)}),this[t]=function(...e){return this.fire(t,e)}}};Vi(GP,EP);var YP=GP;function QP(t){t[KP]||(Object.defineProperty(t,KP,{value:new Map}),Object.defineProperty(t,JP,{value:new Map}),Object.defineProperty(t,$P,{value:new Map}))}function ZP(...t){const e=function(...t){if(!t.length)throw new bP.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let n;"function"==typeof t[t.length-1]&&(e.callback=t.pop());return t.forEach(t=>{if("string"==typeof t)n.properties.push(t);else{if("object"!=typeof t)throw new bP.a("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:t,properties:[]},e.to.push(n)}}),e}(...t),n=Array.from(this._bindings.keys()),i=n.length;if(!e.callback&&e.to.length>1)throw new bP.a("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(i>1&&e.callback)throw new bP.a("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var s;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==i)throw new bP.a("observable-bind-to-properties-length: The number of properties must match.",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),s=this._observable,this._to.forEach(t=>{const e=s[JP];let n;e.get(t.observable)||s.listenTo(t.observable,"change",(i,o)=>{n=e.get(t.observable)[o],n&&n.forEach(t=>{eS(s,t.property)})})}),function(t){let e;t._bindings.forEach((n,i)=>{t._to.forEach(s=>{e=s.properties[n.callback?0:t._bindProperties.indexOf(i)],n.to.push([s.observable,e]),function(t,e,n,i){const s=t[JP],o=s.get(n),r=o||{};r[i]||(r[i]=new Set);r[i].add(e),o||s.set(n,r)}(t._observable,n,s.observable,e)})})}(this),this._bindProperties.forEach(t=>{eS(this._observable,t)})}function XP(t,e,n){if(this._bindings.size>1)throw new bP.a("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(t,e){const n=t.map(t=>[t,e]);return Array.prototype.concat.apply([],n)}(t,e),n)}function tS(t){return t.every(t=>"string"==typeof t)}function eS(t,e){const n=t[$P].get(e);let i;n.callback?i=n.callback.apply(t,n.to.map(t=>t[0][t[1]])):(i=n.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}class nS extends WP{constructor(t,e,n,i){super(t,e,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}MP(nS,YP);class iS{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof nS);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=iS._createAt(this),n=e.offset+t;return e.offset=n<0?0:n,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const n=new UP(e);return n.skip(t),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),n=t.getAncestors();let i=0;for(;e[i]==n[i]&&e[i];)i++;return 0===i?null:e[i-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);const i=NP(e,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return e[i]<n[i]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new UP(t)}clone(){return new iS(this.parent,this.offset)}static _createAt(t,e){if(t instanceof iS)return new this(t.parent,t.offset);{const n=t;if("end"==e)e=n.is("text")?n.data.length:n.childCount;else{if("before"==e)return this._createBefore(n);if("after"==e)return this._createAfter(n);if(0!==e&&!e)throw new bP.a("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new iS(n,e)}}static _createAfter(t){if(t.is("textProxy"))return new iS(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new bP.a("view-position-after-root: You can not make position after root.",t,{root:t});return new iS(t.parent,t.index+1)}static _createBefore(t){if(t.is("textProxy"))return new iS(t.textNode,t.offsetInText);if(!t.parent)throw new bP.a("view-position-before-root: You can not make position before root.",t,{root:t});return new iS(t.parent,t.index)}}class sS{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new UP({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(oS,{direction:"backward"}),e=this.end.getLastMatchingPosition(oS);return t.parent.is("text")&&t.isAtStart&&(t=iS._createBefore(t.parent)),e.parent.is("text")&&e.isAtEnd&&(e=iS._createAfter(e.parent)),new sS(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition(oS);if(t.isAfter(this.end)||t.isEqual(this.end))return new sS(t,t);let e=this.end.getLastMatchingPosition(oS,{direction:"backward"});const n=t.nodeAfter,i=e.nodeBefore;return n&&n.is("text")&&(t=new iS(n,0)),i&&i.is("text")&&(e=new iS(i,i.data.length)),new sS(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),i=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&i}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new sS(this.start,t.start)),this.containsPosition(t.end)&&e.push(new sS(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,n=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(n=t.end),new sS(e,n)}return null}getWalker(t={}){return t.boundaries=this,new UP(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new sS(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new UP(t);for(const t of e)yield t.item}*getPositions(t={}){t.boundaries=this;const e=new UP(t);yield e.position;for(const t of e)yield t.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,n,i){return new this(new iS(t,e),new iS(n,i))}static _createFromPositionAndShift(t,e){const n=t,i=t.getShiftedBy(e);return e>0?new this(n,i):new this(i,n)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(iS._createBefore(t),e)}}function oS(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function rS(t){let e=0;for(const n of t)e++;return e}class aS{constructor(t=null,e,n){this._selection=new lS,this._selection.delegate("change").to(this),this._selection.setTo(t,e,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,n){this._selection.setTo(t,e,n)}_setFocus(t,e){this._selection.setFocus(t,e)}}MP(aS,EP);class lS{constructor(t=null,e,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let n=!1;for(const i of t._ranges)if(e.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=rS(this.getRanges());if(e!=rS(t.getRanges()))return!1;if(0==e)return!0;for(let e of this.getRanges()){e=e.getTrimmed();let n=!1;for(let i of t.getRanges())if(i=i.getTrimmed(),e.start.isEqual(i.start)&&e.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,n){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof lS||t instanceof aS)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof sS)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof iS)this._setRanges([new sS(t)]),this._setFakeOptions(e);else if(t instanceof IP){const i=!!n&&!!n.backward;let s;if(void 0===e)throw new bP.a("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);s="in"==e?sS._createIn(t):"on"==e?sS._createOn(t):new sS(iS._createAt(t,e)),this._setRanges([s],i),this._setFakeOptions(n)}else{if(!DP(t))throw new bP.a("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new bP.a("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=iS._createAt(t,e);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new sS(n,i),!0):this._addRange(new sS(i,n)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const e of t)this._addRange(e);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof sS))throw new bP.a("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new bP.a("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:t,intersectingRange:e});this._ranges.push(new sS(t.start,t.end))}}MP(lS,EP);class cS{constructor(t){this.document=t}createDocumentFragment(t){return new VP(this.document,t)}createElement(t,e,n){return new zP(this.document,t,e,n)}createText(t){return new RP(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,n){return n._insertChild(t,e)}removeChildren(t,e,n){return n._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const n=t.parent;if(n){const i=n.getChildIndex(t);return this.removeChildren(i,1,n),this.insertChild(i,e,n),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const n=e.getChildIndex(t);this.remove(t),this.insertChild(n,t.getChildren(),e)}}rename(t,e){const n=new zP(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,n)?n:null}setAttribute(t,e,n){n._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,n){y(t)&&void 0===n&&(n=e),n._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,n){n._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return iS._createAt(t,e)}createPositionAfter(t){return iS._createAfter(t)}createPositionBefore(t){return iS._createBefore(t)}createRange(t,e){return new sS(t,e)}createRangeOn(t){return sS._createOn(t)}createRangeIn(t){return sS._createIn(t)}createSelection(t,e,n){return new lS(t,e,n)}}function hS(t,e){if(!t.childCount)return;const n=new cS(t.document),i=function(t,e){const n=e.createRangeIn(t),i=new pP({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),s=[];for(const t of n)if("elementStart"===t.type&&i.match(t.item)){const e=uS(t.item);s.push({element:t.item,id:e.id,order:e.order,indent:e.indent})}return s}(t,n);if(!i.length)return;let s=null,o=1;i.forEach((t,r)=>{const a=function(t,e){if(!t)return!0;if(t.id!==e.id)return!0;const n=e.element.previousSibling;if(!n)return!0;return i=n,!(i.is("ol")||i.is("ul"));var i}(i[r-1],t),l=a?null:i[r-1],c=(d=t,(h=l)?d.indent-h.indent:d.indent-1);var h,d;if(a&&(s=null,o=1),!s||0!==c){const i=function(t,e){const n=new RegExp(`@list l${t.id}:level${t.indent}\\s*({[^}]*)`,"gi"),i=/mso-level-number-format:([^;]*);/gi,s=n.exec(e);let o="decimal";if(s&&s[1]){const t=i.exec(s[1]);t&&t[1]&&(o=t[1].trim())}return{type:"bullet"!==o&&"image"!==o?"ol":"ul",style:o}}(t,e);if(s){if(t.indent>o){const t=s.getChild(s.childCount-1),e=t.getChild(t.childCount-1);s=dS(i,e,n),o+=1}else if(t.indent<o){const e=o-t.indent;s=function(t,e){const n=t.getAncestors({parentFirst:!0});let i=null,s=0;for(const t of n)if("ul"!==t.name&&"ol"!==t.name||s++,s===e){i=t;break}return i}(s,e),o=parseInt(t.indent)}}else s=dS(i,t.element,n);t.indent<=o&&(s.is(i.type)||(s=n.rename(i.type,s)))}const u=function(t,e){return function(t,e){const n=new pP({name:"span",styles:{"mso-list":"Ignore"}}),i=e.createRangeIn(t);for(const t of i)"elementStart"===t.type&&n.match(t.item)&&e.remove(t.item)}(t,e),e.rename("li",t)}(t.element,n);n.appendChild(u,s)})}function dS(t,e,n){const i=e.parent,s=n.createElement(t.type),o=i.getChildIndex(e)+1;return n.insertChild(o,s,i),s}function uS(t){const e={},n=t.getStyle("mso-list");if(n){const t=n.match(/(^|\s+)l(\d+)/i),i=n.match(/\s*lfo(\d+)/i),s=n.match(/\s*level(\d+)/i);t&&i&&s&&(e.id=t[2],e.order=i[1],e.indent=s[1])}return e}const fS=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class gS{constructor(t){this.document=t}isActive(t){return fS.test(t)}execute(t){const e=new cS(this.document);!function(t,e){for(const n of t.getChildren())if(n.is("b")&&"normal"===n.getStyle("font-weight")){const i=t.getChildIndex(n);e.remove(n),e.insertChild(i,n.getChildren(),t)}}(t.content,e),function(t,e){for(const n of e.createRangeIn(t)){const t=n.item;if(t.is("li")){const n=t.getChild(0);n.is("p")&&e.unwrapElement(n)}}}(t.content,e)}}const pS=navigator.userAgent.toLowerCase();(function(t){t.indexOf("macintosh")})(pS),function(t){t.match(/gecko\/\d+/)}(pS),function(t){t.indexOf(" applewebkit/")>-1&&t.indexOf("chrome")}(pS),function(t){t.indexOf("android")}(pS),function(){let t=!1;try{t=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(t){}}();!function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e}();function mS(t){return"[object Text]"==Object.prototype.toString.call(t)}const bS=t=>t.createTextNode(" "),wS=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},_S=(()=>{let t="";for(let e=0;e<7;e++)t+="​";return t})();function kS(t){return mS(t)&&t.data.substr(0,7)===_S}function vS(t){return 7==t.data.length&&kS(t)}function yS(t){return kS(t)?t.data.slice(7):t.data}var xS={window:window,document:document};function CS(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function ES(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const TS=wS(document);class AS{constructor(t,e={}){this.document=t,this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?wS:bS,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new lS(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}viewToDom(t,e,n={}){if(t.is("text")){const n=this._processDataFromViewText(t);return e.createTextNode(n)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let i;if(t.is("documentFragment"))i=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(i,t);else{if(t.is("uiElement"))return i=t.render(e),n.bind&&this.bindElements(i,t),i;i=t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),n.bind&&this.bindElements(i,t);for(const e of t.getAttributeKeys())i.setAttribute(e,t.getAttribute(e))}if(n.withChildren||void 0===n.withChildren)for(const s of this.viewChildrenToDom(t,e,n))i.appendChild(s);return i}}*viewChildrenToDom(t,e,n={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren())i===s&&(yield this._blockFiller(e)),yield this.viewToDom(o,e,n),s++;i===s&&(yield this._blockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),i=document.createRange();return i.setStart(e.parent,e.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(t){const e=t.parent;if(e.is("text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let i=t.offset;return kS(n)&&(i+=7),{parent:n,offset:i}}{let n,i,s;if(0===t.offset){if(n=this.mapViewToDom(e),!n)return null;s=n.childNodes[0]}else{const e=t.nodeBefore;if(i=e.is("text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!i)return null;n=i.parentNode,s=i.nextSibling}if(mS(s)&&kS(s))return{parent:s,offset:7};return{parent:n,offset:i?CS(i)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t,this.blockFillerMode))return null;const n=this.getParentUIElement(t,this._domToViewMapping);if(n)return n;if(mS(t)){if(vS(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new RP(this.document,e)}}if(this.isComment(t))return null;{if(this.mapDomToView(t))return this.mapDomToView(t);let n;if(this.isDocumentFragment(t))n=new VP(this.document),e.bind&&this.bindDocumentFragments(t,n);else{const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new zP(this.document,i),e.bind&&this.bindElements(t,n);const s=t.attributes;for(let t=s.length-1;t>=0;t--)n._setAttribute(s[t].name,s[t].value)}if(e.withChildren||void 0===e.withChildren)for(const i of this.domChildrenToView(t,e))n._appendChild(i);return n}}*domChildrenToView(t,e={}){for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n],s=this.domToView(i,e);null!==s&&(yield s)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;mS(e)&&(e=e.parentNode);const n=this.fakeSelectionToView(e);if(n)return n}const e=this.isDomSelectionBackward(t),n=[];for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e),s=this.domRangeToView(i);s&&n.push(s)}return new lS(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new sS(e,n):null}domPositionToView(t,e){if(this.isBlockFiller(t,this.blockFillerMode))return this.domPositionToView(t.parentNode,CS(t));const n=this.mapDomToView(t);if(n&&n.is("uiElement"))return iS._createBefore(n);if(mS(t)){if(vS(t))return this.domPositionToView(t.parentNode,CS(t));const n=this.findCorrespondingViewText(t);let i=e;return n?(kS(t)&&(i-=7,i=i<0?0:i),new iS(n,i)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new iS(e,0)}else{const n=t.childNodes[e-1],i=mS(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new iS(i.parent,i.index+1)}return null}mapDomToView(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(vS(t))return null;const e=this.getParentUIElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const t=this.mapDomToView(n);if(t){return t.nextSibling instanceof RP?t.nextSibling:null}}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof RP?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:n}=xS.window,i=[];SS(e,t=>{const{scrollLeft:e,scrollTop:n}=t;i.push([e,n])}),e.focus(),SS(e,t=>{const[e,n]=i.shift();t.scrollLeft=e,t.scrollTop=n}),xS.window.scrollTo(t,n)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(TS):!("BR"!==t.tagName||!OS(t,this.blockElements)||1!==t.parentNode.childNodes.length)||function(t,e){return mS(t)&&" "==t.data&&OS(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const n=e.collapsed;return e.detach(),n}getParentUIElement(t){const e=ES(t);for(e.pop();e.length;){const t=e.pop(),n=this._domToViewMapping.get(t);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}_isDomSelectionPositionCorrect(t,e){if(mS(t)&&kS(t)&&e<7)return!1;if(this.isElement(t)&&kS(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!n||!n.is("uiElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const n=this._getTouchingViewTextNode(t,!1);!(n&&this._nodeEndsWithSpace(n))&&n||(e=" "+e.substr(1))}if(" "==e.charAt(e.length-1)){const n=this._getTouchingViewTextNode(t,!0);" "!=e.charAt(e.length-2)&&n&&" "!=n.data.charAt(0)||(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(PS(t,this.preElements))return yS(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(t,!1),i=this._getTouchingInlineDomNode(t,!0),s=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,i);return s&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=yS(new Text(e)),e=e.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(e)||!i||i.data&&" "==i.data.charAt(0))&&(e=e.replace(/\u00A0$/," ")),s&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t){return!t||(!!nn(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!kS(t)}_getTouchingViewTextNode(t,e){const n=new UP({startPosition:e?iS._createAfter(t):iS._createBefore(t),direction:e?"forward":"backward"});for(const t of n){if(t.item.is("containerElement"))return null;if(t.item.is("br"))return null;if(t.item.is("textProxy"))return t.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const n=e?"nextNode":"previousNode",i=t.ownerDocument,s=ES(t)[0],o=i.createTreeWalker(s,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:t=>mS(t)||"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=t;const r=o[n]();if(null!==r){const e=function(t,e){const n=ES(t),i=ES(e);let s=0;for(;n[s]==i[s]&&n[s];)s++;return 0===s?null:n[s-1]}(t,r);if(e&&!PS(t,this.blockElements,e)&&!PS(r,this.blockElements,e))return r}return null}}function PS(t,e,n){let i=ES(t);return n&&(i=i.slice(i.indexOf(n)+1)),i.some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}function SS(t,e){for(;t&&t!=xS.document;)e(t),t=t.parentNode}function OS(t,e){const n=t.parentNode;return n&&n.tagName&&e.includes(n.tagName.toLowerCase())}class MS{constructor(t={},e={}){const n=DP(t);if(n||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const e of t)this._items.push(e),this._itemMap.set(this._getItemIdBeforeAdding(e),e)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){const n=this._getItemIdBeforeAdding(t);if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new bP.a("collection-add-item-invalid-index",this);return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new bP.a("collection-get-invalid-arg: Index or id must be given.",this);e=this._items[t]}return e||null}has(t){if("string"==typeof t)return this._itemMap.has(t);{const e=t[this._idProperty];return this._itemMap.has(e)}}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){let e,n,i,s=!1;const o=this._idProperty;if("string"==typeof t?(n=t,i=this._itemMap.get(n),s=!i,i&&(e=this._items.indexOf(i))):"number"==typeof t?(e=t,i=this._items[e],s=!i,i&&(n=i[o])):(i=t,n=i[o],e=this._items.indexOf(i),s=-1==e||!this._itemMap.get(n)),s)throw new bP.a("collection-remove-404: Item not found.",this);this._items.splice(e,1),this._itemMap.delete(n);const r=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(r),this.fire("remove",i,e),i}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(t){if(this._bindToCollection)throw new bP.a("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{"function"==typeof t?this._setUpBindToBinding(e=>t(e)):this._setUpBindToBinding(e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,n=(n,i,s)=>{const o=e._bindToCollection==this,r=e._bindToInternalToExternalMap.get(i);if(o&&r)this._bindToExternalToInternalMap.set(i,r),this._bindToInternalToExternalMap.set(r,i);else{const n=t(i);if(!n)return void this._skippedIndexesFromExternal.push(s);let o=s;for(const t of this._skippedIndexesFromExternal)s>t&&o--;for(const t of e._skippedIndexesFromExternal)o>=t&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)o<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const t of e)n(0,t,e.getIndex(t));this.listenTo(e,"add",n),this.listenTo(e,"remove",(t,e,n)=>{const i=this._bindToExternalToInternalMap.get(e);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(n<e&&t.push(e-1),n>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let n;if(e in t){if(n=t[e],"string"!=typeof n)throw new bP.a("collection-add-invalid-id",this);if(this.get(n))throw new bP.a("collection-add-item-already-exists",this)}else t[e]=n=vP();return n}[Symbol.iterator](){return this._items[Symbol.iterator]()}}MP(MS,EP);class NS{constructor(t){this.selection=new aS,this.roots=new MS({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.map(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let e=!1;do{for(const n of this._postFixers)if(e=n(t),e)break}while(e)}}function IS(t){return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>1===e.length?" ":Array(e.length+1).join("  ").substr(0,e.length))}function RS(t,e){const n=new DOMParser,i=function(t){return IS(IS(t)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[\s]*?)[\r\n]+(\s*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>(\s*[\r\n]\s*)</g,"><")}(function(t){const e=t.match(/<\/body>(.*?)(<\/html>|$)/);e&&e[1]&&(t=t.slice(0,e.index)+t.slice(e.index).replace(e[1],""));return t}(t=t.replace(/<!--\[if gte vml 1]>/g,""))),s=n.parseFromString(i,"text/html");!function(t){t.querySelectorAll("span[style*=spacerun]").forEach(t=>{const e=t.innerText.length||0;t.innerHTML=Array(e+1).join("  ").substr(0,e)})}(s);const o=s.body.innerHTML,r=function(t,e){const n=new NS(e),i=new AS(n,{blockFillerMode:"nbsp"}),s=t.createDocumentFragment(),o=t.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);return i.domToView(s)}(s,e),a=function(t){const e=[],n=[],i=Array.from(t.getElementsByTagName("style"));for(const t of i)t.sheet&&t.sheet.cssRules&&t.sheet.cssRules.length&&(e.push(t.sheet),n.push(t.innerHTML));return{styles:e,stylesString:n.join(" ")}}(s);return{body:r,bodyString:o,styles:a.styles,stylesString:a.stylesString}}function LS(t,e){if(!t.childCount)return;const n=new cS;!function(t,e,n){const i=n.createRangeIn(e),s=new pP({name:"img"}),o=[];for(const e of i)if(s.match(e.item)){const n=e.item,i=n.getAttribute("v:shapes")?n.getAttribute("v:shapes").split(" "):[];i.length&&i.every(e=>t.indexOf(e)>-1)?o.push(n):n.getAttribute("src")||o.push(n)}for(const t of o)n.remove(t)}(function(t,e){const n=e.createRangeIn(t),i=new pP({name:/v:(.+)/}),s=[];for(const t of n){const e=t.item,n=e.previousSibling&&e.previousSibling.name||null;i.match(e)&&e.getAttribute("o:gfxdata")&&"v:shapetype"!==n&&s.push(t.item.getAttribute("id"))}return s}(t,n),t,n),function(t,e){const n=e.createRangeIn(t),i=new pP({name:/v:(.+)/}),s=[];for(const t of n)i.match(t.item)&&s.push(t.item);for(const t of s)e.remove(t)}(t,n);const i=function(t,e){const n=e.createRangeIn(t),i=new pP({name:"img"}),s=[];for(const t of n)i.match(t.item)&&t.item.getAttribute("src").startsWith("file://")&&s.push(t.item);return s}(t,n);i.length&&function(t,e,n){if(t.length===e.length)for(let s=0;s<t.length;s++){const o=`data:${e[s].type};base64,${i=e[s].hex,btoa(i.match(/\w{2}/g).map(t=>String.fromCharCode(parseInt(t,16))).join(""))}`;n.setAttribute("src",o,t[s])}var i}(i,function(t){if(!t)return[];const e=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,n=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),i=t.match(n),s=[];if(i)for(const t of i){let n=!1;t.includes("\\pngblip")?n="image/png":t.includes("\\jpegblip")&&(n="image/jpeg"),n&&s.push({hex:t.replace(e,"").replace(/[^\da-fA-F]/g,""),type:n})}return s}(e),n)}MP(NS,YP);const DS=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,VS=/xmlns:o="urn:schemas-microsoft-com/i;class BS{constructor(t){this.document=t}isActive(t){return DS.test(t)||VS.test(t)}execute(t){const{body:e,stylesString:n}=RS(t.dataTransfer.getData("text/html"),this.document.stylesProcessor);hS(e,n),LS(e,t.dataTransfer.getData("text/rtf")),t.content=e}}class FS extends Nc{static get pluginName(){return"StrikethroughEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"strikethrough"}),t.model.schema.setAttributeProperties("strikethrough",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"strikethrough",view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),t.commands.add("strikethrough",new vg(t,"strikethrough")),t.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}class jS extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("strikethrough",n=>{const i=t.commands.get("strikethrough"),s=new ld(n);return s.set({label:e("Strikethrough"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="crossed-a" d="M13.9704691,13.9008224 L16.6850081,13.9008224 C16.7095355,14.0948621 16.7223077,14.2994264 16.7223077,14.5152395 C16.7223077,16.9317852 15.1023077,19 11.3638462,19 C8.80923077,19 6.96076923,18.0638607 5.73538462,16.6923077 L7.08538462,14.7329463 C8.04076923,15.7997097 9.53615385,16.7358491 11.4676923,16.7358491 C13.4615385,16.7358491 14.2507692,15.712627 14.2507692,14.754717 C14.2507692,14.4140082 14.1498122,14.1350533 13.9704691,13.9008224 Z M6.57325069,10.0474117 C6.31868077,9.55875902 6.17153846,8.96803772 6.17153846,8.24528302 C6.17153846,5.85050798 8.18615385,4 11.2184615,4 C13.3784615,4 15.1230769,4.71843251 16.4107692,6.02467344 L15.0192308,7.91872279 C13.9392308,6.78664731 12.4646154,6.26415094 11.0107692,6.26415094 C9.57769231,6.26415094 8.66384615,6.98258345 8.66384615,8.07111756 C8.66384615,9.23955529 10.1734946,9.58822345 11.8859659,10.0474117 L6.57325069,10.0474117 Z M4,11.256894 L19,11.256894 L19,12.4663764 L4,12.4663764 L4,11.256894 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#crossed-a"/>\n  </g>\n</svg>\n',keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",()=>{t.execute("strikethrough"),t.editing.view.focus()}),s})}}function zS(t,e){let n=e.parent;for(;n;){if(n.name===t)return n;n=n.parent}}function qS(t,e,n,i,s=1){e>s?i.setAttribute(t,e,n):i.removeAttribute(t,n)}function US(t,e,n={}){const i=t.createElement("tableCell",n);t.insertElement("paragraph",i),t.insert(i,e)}function WS(t,e){const n=e.parent.parent,i=parseInt(n.getAttribute("headingColumns")||0),{column:s}=t.getCellLocation(e);return!!i&&s<i}function HS(){return t=>{t.on("element:table",(t,e,n)=>{const i=e.viewItem;if(!n.consumable.test(i,{name:!0}))return;const{rows:s,headingRows:o,headingColumns:r}=function(t){const e={headingRows:0,headingColumns:0},n=[],i=[];let s;for(const o of Array.from(t.getChildren()))if("tbody"===o.name||"thead"===o.name||"tfoot"===o.name){"thead"!==o.name||s||(s=o);const t=Array.from(o.getChildren()).filter(t=>t.is("element","tr"));for(const o of t)if("thead"===o.parent.name&&o.parent===s)e.headingRows++,n.push(o);else{i.push(o);const t=JS(o);t>e.headingColumns&&(e.headingColumns=t)}}return e.rows=[...n,...i],e}(i),a={};r&&(a.headingColumns=r),o&&(a.headingRows=o);const l=n.writer.createElement("table",a),c=n.splitToAllowedParent(l,e.modelCursor);if(c){if(n.writer.insert(l,c.position),n.consumable.consume(i,{name:!0}),s.forEach(t=>n.convertItem(t,n.writer.createPositionAt(l,"end"))),l.isEmpty){const t=n.writer.createElement("tableRow");n.writer.insert(t,n.writer.createPositionAt(l,"end")),US(n.writer,n.writer.createPositionAt(t,"end"))}e.modelRange=n.writer.createRange(n.writer.createPositionBefore(l),n.writer.createPositionAfter(l)),c.cursorParent?e.modelCursor=n.writer.createPositionAt(c.cursorParent,0):e.modelCursor=e.modelRange.end}})}}function KS(t){return e=>{e.on("element:"+t,(t,e,n)=>{const i=e.viewItem;if(!n.consumable.test(i,{name:!0}))return;const s=n.writer.createElement("tableCell"),o=n.splitToAllowedParent(s,e.modelCursor);if(!o)return;n.writer.insert(s,o.position),n.consumable.consume(i,{name:!0});const r=n.writer.createPositionAt(s,0);n.convertChildren(i,r),s.childCount||n.writer.insertElement("paragraph",r),e.modelRange=n.writer.createRange(n.writer.createPositionBefore(s),n.writer.createPositionAfter(s)),e.modelCursor=e.modelRange.end})}}function JS(t){let e=0,n=0;const i=Array.from(t.getChildren()).filter(t=>"th"===t.name||"td"===t.name);for(;n<i.length&&"th"===i[n].name;){const t=i[n];e+=parseInt(t.getAttribute("colspan")||1),n++}return e}class $S{constructor(t,e={}){this.table=t,this.startRow=e.startRow||0,this.endRow="number"==typeof e.endRow?e.endRow:void 0,this.includeSpanned=!!e.includeSpanned,this.column="number"==typeof e.column?e.column:void 0,this._skipRows=new Set,this._row=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const t=this.table.getChild(this._row);if(!t||this._isOverEndRow())return{done:!0};let e,n,i;if(this._isSpanned(this._row,this._column))e=this._getSpanned(this._row,this._column),n=!this.includeSpanned||this._shouldSkipRow()||this._shouldSkipColumn(),i=this._formatOutValue(e,this._column,!0);else{if(e=t.getChild(this._cellIndex),!e)return this._row++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next();const s=parseInt(e.getAttribute("colspan")||1),o=parseInt(e.getAttribute("rowspan")||1);(s>1||o>1)&&this._recordSpans(this._row,this._column,o,s,e),this._nextCellAtColumn=this._column+s,n=this._shouldSkipRow()||this._shouldSkipColumn(),i=this._formatOutValue(e,this._column,!1,o,s)}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,n?this.next():i}skipRow(t){this._skipRows.add(t)}_isOverEndRow(){return void 0!==this.endRow&&this._row>this.endRow}_formatOutValue(t,e,n,i=1,s=1){return{done:!1,value:{cell:t,row:this._row,column:e,isSpanned:n,rowspan:i,colspan:s,cellIndex:this._cellIndex}}}_shouldSkipRow(){const t=this._row<this.startRow,e=this._skipRows.has(this._row);return t||e}_shouldSkipColumn(){return void 0!==this.column&&this.column!=this._column}_isSpanned(t,e){if(!this._spannedCells.has(t))return!1;return this._spannedCells.get(t).has(e)}_getSpanned(t,e){return this._spannedCells.get(t).get(e)}_recordSpans(t,e,n,i,s){for(let n=e+1;n<=e+i-1;n++)this._markSpannedCell(t,n,s);for(let o=t+1;o<t+n;o++)for(let t=e;t<=e+i-1;t++)this._markSpannedCell(o,t,s)}_markSpannedCell(t,e,n){this._spannedCells.has(t)||this._spannedCells.set(t,new Map);this._spannedCells.get(t).set(e,n)}}function GS(t){return!!t.getCustomProperty("table")&&vp(t)}function YS(t){const e=t.getSelectedElement();return e&&GS(e)?e:null}function QS(t){const e=zS("table",t.getFirstPosition());return e&&GS(e.parent)?e.parent:null}function ZS(t){const e=[];for(const i of(n=t.getRanges(),Array.from(n).sort(cO))){const t=i.getContainedElement();t&&t.is("tableCell")&&e.push(t)}var n;return e}function XS(t){const e=[];for(const n of t.getRanges()){const t=zS("tableCell",n.start);t&&e.push(t)}return e}function tO(t){const e=ZS(t);return e.length?e:XS(t)}function eO(t){return lO(t.map(t=>t.parent.index))}function nO(t){const e=zS("table",t[0]);return lO([...new $S(e)].filter(e=>t.includes(e.cell)).map(t=>t.column))}function iO(t,e){if(t.length<2||!function(t){const e=zS("table",t[0]),n=eO(t),i=parseInt(e.getAttribute("headingRows")||0);if(!hO(n,i))return!1;const s=parseInt(e.getAttribute("headingColumns")||0);return hO(nO(t),s)}(t))return!1;const n=new Set,i=new Set;let s=0;for(const o of t){const{row:t,column:r}=e.getCellLocation(o),a=parseInt(o.getAttribute("rowspan")||1),l=parseInt(o.getAttribute("colspan")||1);n.add(t),i.add(r),a>1&&n.add(t+a-1),l>1&&i.add(r+l-1),s+=a*l}return function(t,e){const n=Array.from(t.values()),i=Array.from(e.values()),s=Math.max(...n),o=Math.min(...n),r=Math.max(...i),a=Math.min(...i);return(s-o+1)*(r-a+1)}(n,i)==s}function sO(t,e,n=0){const i=[],s=new $S(t,{startRow:n,endRow:e-1});for(const t of s){const{row:n,rowspan:s}=t,o=n+s-1;n<e&&e<=o&&i.push(t)}return i}function oO(t,e,n){const i=t.parent,s=i.parent,o=i.index,r=e-o,a={},l=parseInt(t.getAttribute("rowspan"))-r;l>1&&(a.rowspan=l);const c=parseInt(t.getAttribute("colspan")||1);c>1&&(a.colspan=c);const h=o+r,d=[...new $S(s,{startRow:o,endRow:h,includeSpanned:!0})];let u;for(const{row:e,column:i,cell:o,cellIndex:r}of d)if(o===t&&void 0===u&&(u=i),void 0!==u&&u===i&&e===h){const t=s.getChild(e),i=n.createPositionAt(t,r);US(n,i,a)}qS("rowspan",r,t,n)}function rO(t,e){const n=[],i=new $S(t);for(const t of i){const{column:i,colspan:s}=t,o=i+s-1;i<e&&e<=o&&n.push(t)}return n}function aO(t,e,n,i){const s=n-e,o={},r=parseInt(t.getAttribute("colspan"))-s;r>1&&(o.colspan=r);const a=parseInt(t.getAttribute("rowspan")||1);a>1&&(o.rowspan=a),US(i,i.createPositionAfter(t),o),qS("colspan",s,t,i)}function lO(t){const e=t.sort((t,e)=>t-e);return{first:e[0],last:e[e.length-1]}}function cO(t,e){const n=t.start,i=e.start;return n.isBefore(i)?-1:1}function hO({first:t,last:e},n){return t<n===e<n}function dO(t={}){return e=>e.on("insert:table",(e,n,i)=>{const s=n.item;if(!i.consumable.consume(s,"insert"))return;i.consumable.consume(s,"attribute:headingRows:table"),i.consumable.consume(s,"attribute:headingColumns:table");const o=t&&t.asWidget,r=i.writer.createContainerElement("figure",{class:"table"}),a=i.writer.createContainerElement("table");let l;var c,h;i.writer.insert(i.writer.createPositionAt(r,0),a),o&&(c=r,(h=i.writer).setCustomProperty("table",!0,c),l=yp(c,h,{hasSelectionHandle:!0}));const d=new $S(s),u={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0},f=new Map;for(const e of d){const{row:n,cell:o}=e,r=yO(vO(n,u),a,i),l=s.getChild(n),c=f.get(n)||_O(l,n,r,i);f.set(n,c),i.consumable.consume(o,"insert");wO(e,u,i.writer.createPositionAt(c,"end"),i,t)}const g=i.mapper.toViewPosition(n.range.start);i.mapper.bindElements(s,o?l:r),i.writer.insert(g,o?l:r)})}function uO(t={}){return e=>e.on("insert:tableRow",(e,n,i)=>{const s=n.item;if(!i.consumable.consume(s,"insert"))return;const o=s.parent,r=TO(i.mapper.toViewElement(o)),a=o.getChildIndex(s),l=new $S(o,{startRow:a,endRow:a}),c={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},h=new Map;for(const e of l){const n=yO(vO(a,c),r,i),o=h.get(a)||_O(s,a,n,i);h.set(a,o),i.consumable.consume(e.cell,"insert");wO(e,c,i.writer.createPositionAt(o,"end"),i,t)}})}function fO(t={}){return e=>e.on("insert:tableCell",(e,n,i)=>{const s=n.item;if(!i.consumable.consume(s,"insert"))return;const o=s.parent,r=o.parent,a=r.getChildIndex(o),l=new $S(r,{startRow:a,endRow:a}),c={headingRows:r.getAttribute("headingRows")||0,headingColumns:r.getAttribute("headingColumns")||0};for(const e of l)if(e.cell===s){const n=i.mapper.toViewElement(o);return void wO(e,c,i.writer.createPositionAt(n,o.getChildIndex(s)),i,t)}})}function gO(t={}){const e=!!t.asWidget;return t=>t.on("attribute:headingRows:table",(t,n,i)=>{const s=n.item;if(!i.consumable.consume(n.item,t.name))return;const o=TO(i.mapper.toViewElement(s)),r=n.attributeOldValue,a=n.attributeNewValue;if(a>r){const t=Array.from(s.getChildren()).filter(({index:t})=>l(t,r-1,a));EO(t,yO("thead",o,i),i,"end");for(const n of t)for(const t of n.getChildren())mO(t,"th",i,e)}else{EO(Array.from(s.getChildren()).filter(({index:t})=>l(t,a-1,r)).reverse(),yO("tbody",o,i),i,0);const t=new $S(s,{startRow:a?a-1:a,endRow:r-1}),n={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0};for(const s of t)bO(s,n,i,e)}function l(t,e,n){return t>e&&t<n}CO("thead",o,i),CO("tbody",o,i)})}function pO(t={}){const e=!!t.asWidget;return t=>t.on("attribute:headingColumns:table",(t,n,i)=>{const s=n.item;if(!i.consumable.consume(n.item,t.name))return;const o={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0},r=n.attributeOldValue,a=n.attributeNewValue,l=(r>a?r:a)-1;for(const t of new $S(s))t.column>l||bO(t,o,i,e)})}function mO(t,e,n,i){const s=n.writer,o=n.mapper.toViewElement(t);if(!o)return;let r;if(i){r=Cp(s.createEditableElement(e,o.getAttributes()),s),s.insert(s.createPositionAfter(o),r),s.move(s.createRangeIn(o),s.createPositionAt(r,0)),s.remove(s.createRangeOn(o))}else r=s.rename(e,o);n.mapper.unbindViewElement(o),n.mapper.bindElements(t,r)}function bO(t,e,n,i){const{cell:s}=t,o=kO(t,e),r=n.mapper.toViewElement(s);r&&r.name!==o&&mO(s,o,n,i)}function wO(t,e,n,i,s){const o=s&&s.asWidget,r=kO(t,e),a=o?Cp(i.writer.createEditableElement(r),i.writer):i.writer.createContainerElement(r),l=t.cell,c=l.getChild(0),h=1===l.childCount&&"paragraph"===c.name;if(i.writer.insert(n,a),h&&![...c.getAttributeKeys()].length){const t=l.getChild(0),e=i.writer.createPositionAt(a,"end");if(i.consumable.consume(t,"insert"),s.asWidget){const n=i.writer.createContainerElement("span",{style:"display:inline-block"});i.mapper.bindElements(t,n),i.writer.insert(e,n),i.mapper.bindElements(l,a)}else i.mapper.bindElements(l,a),i.mapper.bindElements(t,a)}else i.mapper.bindElements(l,a)}function _O(t,e,n,i){i.consumable.consume(t,"insert");const s=i.writer.createContainerElement("tr");i.mapper.bindElements(t,s);const o=t.parent.getAttribute("headingRows")||0,r=o>0&&e>=o?e-o:e,a=i.writer.createPositionAt(n,r);return i.writer.insert(a,s),s}function kO(t,e){const{row:n,column:i}=t,{headingColumns:s,headingRows:o}=e;if(o&&o>n)return"th";return s&&s>i?"th":"td"}function vO(t,e){return t<e.headingRows?"thead":"tbody"}function yO(t,e,n){const i=xO(t,e);return i||function(t,e,n){const i=n.writer.createContainerElement(t),s=n.writer.createPositionAt(e,"tbody"==t?"end":0);return n.writer.insert(s,i),i}(t,e,n)}function xO(t,e){for(const n of e.getChildren())if(n.name==t)return n}function CO(t,e,n){const i=xO(t,e);i&&0===i.childCount&&n.writer.remove(n.writer.createRangeOn(i))}function EO(t,e,n,i){for(const s of t){const t=n.mapper.toViewElement(s);t&&n.writer.move(n.writer.createRangeOn(t),n.writer.createPositionAt(e,i))}}function TO(t){for(const e of t.getChildren())if("table"===e.name)return e}class AO extends Vu{refresh(){const t=this.editor.model,e=t.document.selection,n=t.schema,i=function(t){const e=t.parent;return e===e.root?e:e.parent}(e.getFirstPosition());this.isEnabled=n.checkChild(i,"table")}execute(t={}){const e=this.editor.model,n=e.document.selection,i=this.editor.plugins.get("TableUtils"),s=parseInt(t.rows)||2,o=parseInt(t.columns)||2,r=Ep(n,e);e.change(t=>{const n=i.createTable(t,s,o);e.insertContent(n,r),t.setSelection(t.createPositionAt(n.getNodeByPath([0,0,0]),0))})}}class PO extends Vu{constructor(t,e={}){super(t),this.order=e.order||"below"}refresh(){const t=zS("table",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!t}execute(){const t=this.editor,e=t.model.document.selection,n=t.plugins.get("TableUtils"),i="above"===this.order,s=tO(e),o=eO(s),r=i?o.first:o.last,a=zS("table",s[0]);n.insertRows(a,{at:i?r:r+1,copyStructureFromAbove:!i})}}class SO extends Vu{constructor(t,e={}){super(t),this.order=e.order||"right"}refresh(){const t=zS("table",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!t}execute(){const t=this.editor,e=t.model.document.selection,n=t.plugins.get("TableUtils"),i="left"===this.order,s=tO(e),o=nO(s),r=i?o.first:o.last,a=zS("table",s[0]);n.insertColumns(a,{columns:1,at:i?r:r+1})}}class OO extends Vu{constructor(t,e={}){super(t),this.direction=e.direction||"horizontally"}refresh(){const t=tO(this.editor.model.document.selection);this.isEnabled=1===t.length}execute(){const t=tO(this.editor.model.document.selection)[0],e="horizontally"===this.direction,n=this.editor.plugins.get("TableUtils");e?n.splitCellHorizontally(t,2):n.splitCellVertically(t,2)}}class MO extends Vu{constructor(t,e){super(t),this.direction=e.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const t=this._getMergeableCell();this.value=t,this.isEnabled=!!t}execute(){const t=this.editor.model,e=XS(t.document.selection)[0],n=this.value,i=this.direction;t.change(t=>{const s="right"==i||"down"==i,o=s?e:n,r=s?n:e,a=r.parent;!function(t,e,n){NO(t)||(NO(e)&&n.remove(n.createRangeIn(e)),n.move(n.createRangeIn(t),n.createPositionAt(e,"end")));n.remove(t)}(r,o,t);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(e.getAttribute(l)||1),h=parseInt(n.getAttribute(l)||1);if(t.setAttribute(l,c+h,o),t.setSelection(t.createRangeIn(o)),!a.childCount){const e=this.editor.plugins.get("TableUtils"),n=zS("table",a);e.removeRows(n,{at:a.index,batch:t.batch})}})}_getMergeableCell(){const t=XS(this.editor.model.document.selection)[0];if(!t)return;const e=this.editor.plugins.get("TableUtils"),n=this.isHorizontal?function(t,e,n){const i=t.parent.parent,s="right"==e?t.nextSibling:t.previousSibling,o=(i.getAttribute("headingColumns")||0)>0;if(!s)return;const r="right"==e?t:s,a="right"==e?s:t,{column:l}=n.getCellLocation(r),{column:c}=n.getCellLocation(a),h=parseInt(r.getAttribute("colspan")||1),d=WS(n,r),u=WS(n,a);if(o&&d!=u)return;return l+h===c?s:void 0}(t,this.direction,e):function(t,e){const n=t.parent,i=n.parent,s=i.getChildIndex(n);if("down"==e&&s===i.childCount-1||"up"==e&&0===s)return;const o=parseInt(t.getAttribute("rowspan")||1),r=i.getAttribute("headingRows")||0,a="down"==e&&s+o===r,l="up"==e&&s===r;if(r&&(a||l))return;const c=parseInt(t.getAttribute("rowspan")||1),h="down"==e?s+c:s,d=[...new $S(i,{endRow:h})],u=d.find(e=>e.cell===t).column,f=d.find(({row:t,rowspan:n,column:i})=>i===u&&("down"==e?t===h:h===t+n));return f&&f.cell}(t,this.direction);if(!n)return;const i=this.isHorizontal?"rowspan":"colspan",s=parseInt(t.getAttribute(i)||1);return parseInt(n.getAttribute(i)||1)===s?n:void 0}}function NO(t){return 1==t.childCount&&t.getChild(0).is("paragraph")&&t.getChild(0).isEmpty}class IO extends Vu{refresh(){const t=tO(this.editor.model.document.selection),e=t[0];if(e){const n=zS("table",e),i=this.editor.plugins.get("TableUtils").getRows(n)-1,s=eO(t),o=0===s.first&&s.last===i;this.isEnabled=!o}else this.isEnabled=!1}execute(){const t=this.editor.model,e=tO(t.document.selection),n=eO(e),i=e[0],s=zS("table",i),o=this.editor.plugins.get("TableUtils").getCellLocation(i).column,r=t.createBatch();t.enqueueChange(r,t=>{t.setSelection(t.createSelection(s,"on"));const e=n.last-n.first+1;this.editor.plugins.get("TableUtils").removeRows(s,{at:n.first,rows:e,batch:r})}),t.enqueueChange(r,t=>{const e=function(t,e,n){const i=t.getChild(e)||t.getChild(t.childCount-1);let s=i.getChild(0),o=0;for(const t of i.getChildren()){if(o>n)return s;s=t,o+=parseInt(t.getAttribute("colspan")||1)}return s}(s,n.first,o);t.setSelection(t.createPositionAt(e,0))})}}class RO extends Vu{refresh(){const t=tO(this.editor.model.document.selection),e=t[0];if(e){const n=zS("table",e),i=this.editor.plugins.get("TableUtils").getColumns(n),{first:s,last:o}=nO(t);this.isEnabled=o-s<i-1}else this.isEnabled=!1}execute(){const[t,e]=function(t){const e=tO(t),n=e[0],i=e.pop(),s=[n,i];return n.isBefore(i)?s:s.reverse()}(this.editor.model.document.selection),n=t.parent.parent,i=[...new $S(n)],s={first:i.find(e=>e.cell===t).column,last:i.find(t=>t.cell===e).column},o=function(t,e,n,i){return parseInt(n.getAttribute("colspan")||1)>1?n:e.previousSibling||n.nextSibling?n.nextSibling||e.previousSibling:i.first?t.reverse().find(({column:t})=>t<i.first).cell:t.reverse().find(({column:t})=>t>i.last).cell}(i,t,e,s);this.editor.model.change(t=>{const e=s.last-s.first+1;this.editor.plugins.get("TableUtils").removeColumns(n,{at:s.first,columns:e}),t.setSelection(t.createPositionAt(o,0))})}}class LO extends Vu{refresh(){const t=tO(this.editor.model.document.selection),e=t.length>0;this.isEnabled=e,this.value=e&&t.every(t=>this._isInHeading(t,t.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.model,n=tO(e.document.selection),i=zS("table",n[0]),{first:s,last:o}=eO(n),r=this.value?s:o+1,a=i.getAttribute("headingRows")||0;e.change(t=>{if(r){const e=sO(i,r,r>a?a:0);for(const{cell:n}of e)oO(n,r,t)}qS("headingRows",r,i,t,0)})}_isInHeading(t,e){const n=parseInt(e.getAttribute("headingRows")||0);return!!n&&t.parent.index<n}}class DO extends Vu{refresh(){const t=tO(this.editor.model.document.selection),e=this.editor.plugins.get("TableUtils"),n=t.length>0;this.isEnabled=n,this.value=n&&t.every(t=>WS(e,t))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.model,n=tO(e.document.selection),i=zS("table",n[0]),{first:s,last:o}=nO(n),r=this.value?s:o+1;e.change(t=>{if(r){const e=rO(i,r);for(const{cell:n,column:i}of e)aO(n,i,r,t)}qS("headingColumns",r,i,t,0)})}}class VO extends Nc{static get pluginName(){return"TableUtils"}getCellLocation(t){const e=t.parent,n=e.parent,i=n.getChildIndex(e),s=new $S(n,{startRow:i,endRow:i});for(const{cell:e,row:n,column:i}of s)if(e===t)return{row:n,column:i}}createTable(t,e,n){const i=t.createElement("table");return BO(t,i,0,e,n),i}insertRows(t,e={}){const n=this.editor.model,i=e.at||0,s=e.rows||1,o=void 0!==e.copyStructureFromAbove,r=e.copyStructureFromAbove?i-1:i,a=this.getRows(t),l=this.getColumns(t);n.change(e=>{const n=t.getAttribute("headingRows")||0;if(n>i&&e.setAttribute("headingRows",n+s,t),!o&&(0===i||i===a))return void BO(e,t,i,s,l);const c=o?Math.max(i,r):i,h=new $S(t,{endRow:c}),d=new Array(l).fill(1);for(const{row:t,column:n,rowspan:a,colspan:l,cell:c}of h){const h=t+a-1,u=t<=r&&r<=h;t<i&&i<=h?(e.setAttribute("rowspan",a+s,c),d[n]=-l):o&&u&&(d[n]=l)}for(let n=0;n<s;n++){const n=e.createElement("tableRow");e.insert(n,t,i);for(let t=0;t<d.length;t++){const i=d[t],s=e.createPositionAt(n,"end");i>0&&US(e,s,i>1?{colspan:i}:null),t+=Math.abs(i)-1}}})}insertColumns(t,e={}){const n=this.editor.model,i=e.at||0,s=e.columns||1;n.change(e=>{const n=t.getAttribute("headingColumns");i<n&&e.setAttribute("headingColumns",n+s,t);const o=this.getColumns(t);if(0===i||o===i){for(const n of t.getChildren())FO(s,e,e.createPositionAt(n,i?"end":0));return}const r=new $S(t,{column:i,includeSpanned:!0});for(const{row:n,cell:o,cellIndex:a}of r){const l=parseInt(o.getAttribute("rowspan")||1),c=parseInt(o.getAttribute("colspan")||1);if(a!==i&&c>1){if(e.setAttribute("colspan",c+s,o),r.skipRow(n),l>1)for(let t=n+1;t<n+l;t++)r.skipRow(t)}else{const i=e.createPositionAt(t.getChild(n),a);FO(s,e,i)}}})}removeRows(t,e){const n=this.editor.model,i=e.rows||1,s=e.at,o=s+i-1,r=e.batch||"default";n.enqueueChange(r,e=>{const{cellsToMove:i,cellsToTrim:a}=function(t,e,n){const i=new Map,s=[];for(const{row:o,column:r,rowspan:a,cell:l}of new $S(t,{endRow:n})){const t=o+a-1;if(o>=e&&o<=n&&t>n){const t=a-(n-o+1);i.set(r,{cell:l,rowspan:t})}if(o<e&&t>=e){let i;i=t>=n?n-e+1:t-e+1,s.push({cell:l,rowspan:a-i})}}return{cellsToMove:i,cellsToTrim:s}}(t,s,o);if(i.size){!function(t,e,n,i){const s=[...new $S(t,{includeSpanned:!0,startRow:e,endRow:e})],o=t.getChild(e);let r;for(const{column:t,cell:e,isSpanned:a}of s)if(n.has(t)){const{cell:e,rowspan:s}=n.get(t),a=r?i.createPositionAfter(r):i.createPositionAt(o,0);i.move(i.createRangeOn(e),a),qS("rowspan",s,e,i),r=e}else a||(r=e)}(t,o+1,i,e)}for(let n=o;n>=s;n--)e.remove(t.getChild(n));for(const{rowspan:t,cell:n}of a)qS("rowspan",t,n,e);!function(t,e,n,i,s){i.enqueueChange(s,i=>{const s=t.getAttribute("headingRows")||0;if(e<s){qS("headingRows",n<s?s-(n-e+1):e,t,i,0)}})}(t,s,o,n,r)})}removeColumns(t,e){const n=this.editor.model,i=e.at,s=e.columns||1,o=e.at+s-1;n.change(e=>{!function(t,e,n){const i=t.getAttribute("headingColumns")||0;if(i&&e.first<i){const s=Math.min(i-1,e.last)-e.first+1;n.setAttribute("headingColumns",i-s,t)}}(t,{first:i,last:o},e);const n=[];for(let s=o;s>=i;s--)for(const{cell:i,column:o,colspan:r}of[...new $S(t)])if(o<=s&&r>1&&o+r>s)qS("colspan",r-1,i,e);else if(o===s){const t=i.parent;e.remove(i),t.childCount||n.push(t.index)}n.reverse().forEach(n=>this.removeRows(t,{at:n,batch:e.batch}))})}splitCellVertically(t,e=2){const n=this.editor.model,i=t.parent.parent,s=parseInt(t.getAttribute("rowspan")||1),o=parseInt(t.getAttribute("colspan")||1);n.change(n=>{if(o>1){const{newCellsSpan:i,updatedSpan:r}=jO(o,e);qS("colspan",r,t,n);const a={};i>1&&(a.colspan=i),s>1&&(a.rowspan=s);FO(o>e?e-1:o-1,n,n.createPositionAfter(t),a)}if(o<e){const r=e-o,a=[...new $S(i)],{column:l}=a.find(({cell:e})=>e===t),c=a.filter(({cell:e,colspan:n,column:i})=>e!==t&&i===l||i<l&&i+n>l);for(const{cell:t,colspan:e}of c)n.setAttribute("colspan",e+r,t);const h={};s>1&&(h.rowspan=s),FO(r,n,n.createPositionAfter(t),h);const d=i.getAttribute("headingColumns")||0;d>l&&qS("headingColumns",d+r,i,n)}})}splitCellHorizontally(t,e=2){const n=this.editor.model,i=t.parent,s=i.parent,o=s.getChildIndex(i),r=parseInt(t.getAttribute("rowspan")||1),a=parseInt(t.getAttribute("colspan")||1);n.change(n=>{if(r>1){const i=[...new $S(s,{startRow:o,endRow:o+r-1,includeSpanned:!0})],{newCellsSpan:l,updatedSpan:c}=jO(r,e);qS("rowspan",c,t,n);const{column:h}=i.find(({cell:e})=>e===t),d={};l>1&&(d.rowspan=l),a>1&&(d.colspan=a);for(const{column:t,row:e,cellIndex:r}of i){const i=t===h,a=(e+o+c)%l==0;if(e>=o+c&&i&&a){const t=n.createPositionAt(s.getChild(e),r);FO(1,n,t,d)}}}if(r<e){const i=e-r,l=[...new $S(s,{startRow:0,endRow:o})];for(const{cell:e,rowspan:s,row:r}of l)if(e!==t&&r+s>o){const t=s+i;n.setAttribute("rowspan",t,e)}const c={};a>1&&(c.colspan=a),BO(n,s,o+1,i,1,c);const h=s.getAttribute("headingRows")||0;h>o&&qS("headingRows",h+i,s,n)}})}getColumns(t){return[...t.getChild(0).getChildren()].reduce((t,e)=>t+parseInt(e.getAttribute("colspan")||1),0)}getRows(t){return t.childCount}}function BO(t,e,n,i,s,o={}){for(let r=0;r<i;r++){const i=t.createElement("tableRow");t.insert(i,e,n),FO(s,t,t.createPositionAt(i,"end"),o)}}function FO(t,e,n,i={}){for(let s=0;s<t;s++)US(e,n,i)}function jO(t,e){if(t<e)return{newCellsSpan:1,updatedSpan:1};const n=Math.floor(t/e);return{newCellsSpan:n,updatedSpan:t-n*e+n}}class zO extends Vu{refresh(){const t=ZS(this.editor.model.document.selection);this.isEnabled=iO(t,this.editor.plugins.get(VO))}execute(){const t=this.editor.model,e=this.editor.plugins.get(VO);t.change(n=>{const i=ZS(t.document.selection),s=i.shift();n.setSelection(s,0);const{mergeWidth:o,mergeHeight:r}=function(t,e,n){let i=0,s=0;for(const t of e){const{row:e,column:o}=n.getCellLocation(t);i=WO(t,o,i,"colspan"),s=WO(t,e,s,"rowspan")}const{row:o,column:r}=n.getCellLocation(t);return{mergeWidth:i-r,mergeHeight:s-o}}(s,i,e);qS("colspan",o,s,n),qS("rowspan",r,s,n);const a=[];for(const t of i){const e=t.parent;qO(t,s,n),e.childCount||a.push(e.index)}if(a.length){const t=zS("table",s);a.reverse().forEach(i=>e.removeRows(t,{at:i,batch:n.batch}))}n.setSelection(s,"in")})}}function qO(t,e,n){UO(t)||(UO(e)&&n.remove(n.createRangeIn(e)),n.move(n.createRangeIn(t),n.createPositionAt(e,"end"))),n.remove(t)}function UO(t){return 1==t.childCount&&t.getChild(0).is("paragraph")&&t.getChild(0).isEmpty}function WO(t,e,n,i){const s=parseInt(t.getAttribute(i)||1);return Math.max(n,e+s)}class HO extends Vu{refresh(){const t=tO(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,e=tO(t.document.selection),n=eO(e),i=zS("table",e[0]),s=[];for(let e=n.first;e<=n.last;e++)for(const n of i.getChild(e).getChildren())s.push(t.createRangeOn(n));t.change(t=>{t.setSelection(s)})}}class KO extends Vu{refresh(){const t=tO(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,e=tO(t.document.selection),n=e[0],i=e.pop(),s=this.editor.plugins.get("TableUtils"),o=s.getCellLocation(n),r=s.getCellLocation(i),a=Math.min(o.column,r.column),l=Math.max(o.column,r.column),c=[];for(const e of new $S(zS("table",n)))e.column>=a&&e.column<=l&&c.push(t.createRangeOn(e.cell));t.change(t=>{t.setSelection(c)})}}function JO(t){t.document.registerPostFixer(e=>function(t,e){const n=e.document.differ.getChanges();let i=!1;const s=new Set;for(const e of n){let n;"table"==e.name&&"insert"==e.type&&(n=e.position.nodeAfter),"tableRow"!=e.name&&"tableCell"!=e.name||(n=zS("table",e.position)),YO(e)&&(n=zS("table",e.range.start)),n&&!s.has(n)&&(i=$O(n,t)||i,i=GO(n,t)||i,s.add(n))}return i}(e,t))}function $O(t,e){let n=!1;const i=function(t){const e=parseInt(t.getAttribute("headingRows")||0),n=t.childCount,i=[];for(const{row:s,rowspan:o,cell:r}of new $S(t)){if(o<2)continue;const t=s<e?e:n;if(s+o>t){const e=t-s;i.push({cell:r,rowspan:e})}}return i}(t);if(i.length){n=!0;for(const t of i)qS("rowspan",t.rowspan,t.cell,e,1)}return n}function GO(t,e){let n=!1;const i=function(t){const e=new Array(t.childCount).fill(0);for(const{row:n}of new $S(t,{includeSpanned:!0}))e[n]++;return e}(t),s=[];for(const[t,e]of i.entries())e||s.push(t);if(s.length){n=!0;for(const n of s.reverse())e.remove(t.getChild(n)),i.splice(n,1)}const o=i[0];if(!i.every(t=>t===o)){const s=i.reduce((t,e)=>e>t?e:t,0);for(const[o,r]of i.entries()){const i=s-r;if(i){for(let n=0;n<i;n++)US(e,e.createPositionAt(t.getChild(o),"end"));n=!0}}}return n}function YO(t){const e="attribute"===t.type,n=t.attributeKey;return e&&("headingRows"===n||"colspan"===n||"rowspan"===n)}function QO(t){t.document.registerPostFixer(e=>function(t,e){const n=e.document.differ.getChanges();let i=!1;for(const e of n)"insert"==e.type&&"table"==e.name&&(i=ZO(e.position.nodeAfter,t)||i),"insert"==e.type&&"tableRow"==e.name&&(i=XO(e.position.nodeAfter,t)||i),"insert"==e.type&&"tableCell"==e.name&&(i=tM(e.position.nodeAfter,t)||i),eM(e)&&(i=tM(e.position.parent,t)||i);return i}(e,t))}function ZO(t,e){let n=!1;for(const i of t.getChildren())n=XO(i,e)||n;return n}function XO(t,e){let n=!1;for(const i of t.getChildren())n=tM(i,e)||n;return n}function tM(t,e){if(0==t.childCount)return e.insertElement("paragraph",t),!0;const n=Array.from(t.getChildren()).filter(t=>t.is("text"));for(const t of n)e.wrap(e.createRangeOn(t),"paragraph");return!!n.length}function eM(t){return!(!t.position||!t.position.parent.is("tableCell"))&&("insert"==t.type&&"$text"==t.name||"remove"==t.type)}function nM(t){t.document.registerPostFixer(()=>function(t){const e=t.document.differ,n=new Set;let i=0;for(const t of e.getChanges()){const e="insert"==t.type||"remove"==t.type?t.position.parent:t.range.start.parent;e.is("tableCell")&&("insert"==t.type&&i++,iM(e,t.type,i)&&n.add(e))}if(n.size){for(const t of n.values())e.refreshItem(t);return!0}return!1}(t))}function iM(t,e,n){if(!Array.from(t.getChildren()).some(t=>t.is("paragraph")))return!1;if("attribute"==e){const e=Array.from(t.getChild(0).getAttributeKeys()).length;return 1===t.childCount&&e<2}return t.childCount<=("insert"==e?n+1:1)}n(127);class sM extends Nc{static get pluginName(){return"TableEditing"}init(){const t=this.editor,e=t.model,n=e.schema,i=t.conversion;n.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isLimit:!0,isObject:!0,isBlock:!0}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isObject:!0}),n.extend("$block",{allowIn:"tableCell"}),n.addChildCheck((t,e)=>{if("table"==e.name&&Array.from(t.getNames()).includes("table"))return!1}),i.for("upcast").add(HS()),i.for("editingDowncast").add(dO({asWidget:!0})),i.for("dataDowncast").add(dO()),i.for("upcast").elementToElement({model:"tableRow",view:"tr"}),i.for("upcast").add(t=>{t.on("element:tr",(t,e)=>{e.viewItem.isEmpty&&t.stop()},{priority:"high"})}),i.for("editingDowncast").add(uO({asWidget:!0})),i.for("dataDowncast").add(uO()),i.for("downcast").add(t=>t.on("remove:tableRow",(t,e,n)=>{t.stop();const i=n.writer,s=n.mapper,o=s.toViewPosition(e.position).getLastMatchingPosition(t=>!t.item.is("tr")).nodeAfter,r=o.parent.parent,a=i.createRangeOn(o),l=i.remove(a);for(const t of i.createRangeIn(l).getItems())s.unbindViewElement(t);CO("thead",r,n),CO("tbody",r,n)},{priority:"higher"})),i.for("upcast").add(KS("td")),i.for("upcast").add(KS("th")),i.for("editingDowncast").add(fO({asWidget:!0})),i.for("dataDowncast").add(fO()),i.attributeToAttribute({model:"colspan",view:"colspan"}),i.attributeToAttribute({model:"rowspan",view:"rowspan"}),i.for("editingDowncast").add(pO({asWidget:!0})),i.for("dataDowncast").add(pO()),i.for("editingDowncast").add(gO({asWidget:!0})),i.for("dataDowncast").add(gO()),t.commands.add("insertTable",new AO(t)),t.commands.add("insertTableRowAbove",new PO(t,{order:"above"})),t.commands.add("insertTableRowBelow",new PO(t,{order:"below"})),t.commands.add("insertTableColumnLeft",new SO(t,{order:"left"})),t.commands.add("insertTableColumnRight",new SO(t,{order:"right"})),t.commands.add("removeTableRow",new IO(t)),t.commands.add("removeTableColumn",new RO(t)),t.commands.add("splitTableCellVertically",new OO(t,{direction:"vertically"})),t.commands.add("splitTableCellHorizontally",new OO(t,{direction:"horizontally"})),t.commands.add("mergeTableCells",new zO(t)),t.commands.add("mergeTableCellRight",new MO(t,{direction:"right"})),t.commands.add("mergeTableCellLeft",new MO(t,{direction:"left"})),t.commands.add("mergeTableCellDown",new MO(t,{direction:"down"})),t.commands.add("mergeTableCellUp",new MO(t,{direction:"up"})),t.commands.add("setTableColumnHeader",new DO(t)),t.commands.add("setTableRowHeader",new LO(t)),t.commands.add("selectTableRow",new HO(t)),t.commands.add("selectTableColumn",new KO(t)),JO(e),nM(e),QO(e)}static get requires(){return[VO]}}n(129);class oM extends Ih{constructor(t){super(t);const e=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(t,e)=>`${e} × ${t}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":e.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:e.to("label")}]}],on:{mousedown:e.to(t=>{t.preventDefault()}),click:e.to(()=>{this.fire("execute")})}}),this.on("boxover",(t,e)=>{const{row:n,column:i}=e.target.dataset;this.set({rows:parseInt(n),columns:parseInt(i)})}),this.on("change:columns",()=>{this._highlightGridBoxes()}),this.on("change:rows",()=>{this._highlightGridBoxes()})}focus(){}focusLast(){}_highlightGridBoxes(){const t=this.rows,e=this.columns;this.items.map((n,i)=>{const s=Math.floor(i/10)<t&&i%10<e;n.set("isOn",s)})}_createGridCollection(){const t=[];for(let e=0;e<100;e++){const n=Math.floor(e/10),i=e%10;t.push(new rM(this.locale,n+1,i+1))}return this.createCollection(t)}}class rM extends Ih{constructor(t,e,n){super(t);const i=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",i.if("isOn","ck-on")],"data-row":e,"data-column":n}})}}class aM extends Nc{init(){const t=this.editor;t.ui.componentFactory.add("insertTable",e=>{const n=t.commands.get("insertTable"),i=Sd(e);i.set({panelPosition:"se",class:["ck-custom-table-dropdown"]}),i.bind("isEnabled").to(n),i.buttonView.set({icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="table-a" d="M12,18 L19,18 L19,13 L12,13 L12,18 Z M11,18 L11,13 L4,13 L4,18 L11,18 Z M12,7 L12,12 L19,12 L19,7 L12,7 Z M11,7 L4,7 L4,12 L11,12 L11,7 Z M19,19 L3,19 L3,18 L3,7 L3,6 L19,6 L20,6 L20,19 L19,19 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#table-a"/>\n  </g>\n</svg>\n',label:"Вставить таблицу",tooltip:!0});const s=new oM(e),o=new Ku("div",[s]);return s.delegate("execute").to(i),i.buttonView.on("open",()=>{s.rows=0,s.columns=0}),i.on("execute",()=>{t.execute("insertTable",{rows:s.rows,columns:s.columns}),t.editing.view.focus()}),i.render(),i.panelView.children.add(o),i}),t.ui.componentFactory.add("tableColumn",t=>this._prepareDropdown("Столбец",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="table-column-a" d="M5.5,6.5 L18.5,6.5 C19.0522847,6.5 19.5,6.94771525 19.5,7.5 C19.5,8.05228475 19.0522847,8.5 18.5,8.5 L5.5,8.5 C4.94771525,8.5 4.5,8.05228475 4.5,7.5 C4.5,6.94771525 4.94771525,6.5 5.5,6.5 Z M5.5,10.5 L18.5,10.5 C19.0522847,10.5 19.5,10.9477153 19.5,11.5 C19.5,12.0522847 19.0522847,12.5 18.5,12.5 L5.5,12.5 C4.94771525,12.5 4.5,12.0522847 4.5,11.5 C4.5,10.9477153 4.94771525,10.5 5.5,10.5 Z M5.5,14.5 L18.5,14.5 C19.0522847,14.5 19.5,14.9477153 19.5,15.5 C19.5,16.0522847 19.0522847,16.5 18.5,16.5 L5.5,16.5 C4.94771525,16.5 4.5,16.0522847 4.5,15.5 C4.5,14.9477153 4.94771525,14.5 5.5,14.5 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use transform="rotate(90 12 11.5)" xlink:href="#table-column-a"/>\n  </g>\n</svg>\n',[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:"Столбец заголовков",bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableColumnLeft",label:"Вставить столбец слева"}},{type:"button",model:{commandName:"insertTableColumnRight",label:"Вставить столбец справа"}},{type:"button",model:{commandName:"removeTableColumn",label:"Удалить столбец"}}],t)),t.ui.componentFactory.add("tableRow",t=>this._prepareDropdown("Строка",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="table-row-a" d="M5,7 L19,7 C19.5522847,7 20,7.44771525 20,8 C20,8.55228475 19.5522847,9 19,9 L5,9 C4.44771525,9 4,8.55228475 4,8 C4,7.44771525 4.44771525,7 5,7 Z M5,11 L19,11 C19.5522847,11 20,11.4477153 20,12 C20,12.5522847 19.5522847,13 19,13 L5,13 C4.44771525,13 4,12.5522847 4,12 C4,11.4477153 4.44771525,11 5,11 Z M5,15 L19,15 C19.5522847,15 20,15.4477153 20,16 C20,16.5522847 19.5522847,17 19,17 L5,17 C4.44771525,17 4,16.5522847 4,16 C4,15.4477153 4.44771525,15 5,15 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#table-row-a"/>\n  </g>\n</svg>\n',[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:"Строка заголовков",bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowBelow",label:"Вставить строку ниже"}},{type:"button",model:{commandName:"insertTableRowAbove",label:"Вставить строку выше"}},{type:"button",model:{commandName:"removeTableRow",label:"Удалить строку"}}],t)),t.ui.componentFactory.add("mergeTableCells",t=>this._prepareDropdown("Объединить ячейки",'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',[{type:"button",model:{commandName:"mergeTableCellUp",label:"Объединить с ячейкой сверху"}},{type:"button",model:{commandName:"mergeTableCellRight",label:"Объединить с ячейкой справа"}},{type:"button",model:{commandName:"mergeTableCellDown",label:"Объединить с ячейкой снизу"}},{type:"button",model:{commandName:"mergeTableCellLeft",label:"Объединить с ячейкой слева"}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:"Разделить ячейку вертикально"}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:"Разделить ячейку горизонтально"}}],t))}_prepareDropdown(t,e,n,i){const s=this.editor,o=Sd(i);o.set({panelPosition:"se",class:"ck-custom-table-dropdown"});const r=[],a=new XC;for(const t of n)lM(t,s,r,a);o.buttonView.set({label:t,icon:e,tooltip:!0}),o.bind("isEnabled").toMany(r,"isEnabled",(...t)=>t.some(t=>t)),this.listenTo(o,"execute",t=>{s.execute(t.source.commandName),s.editing.view.focus()});const l=new Ku("div",[$u(o,a)]);return o.render(),o.panelView.children.add(l),o}}function lM(t,e,n,i){const s=t.model=new Gf(t.model),{commandName:o,bindIsOn:r}=t.model;if("separator"!==t.type){const t=e.commands.get(o);n.push(t),s.set({commandName:o}),s.bind("isEnabled").to(t),r&&s.bind("isOn").to(t,"value")}s.set({withText:!0}),i.add(t)}class cM extends qE{constructor(t){super(t),this.domEventType=["mousemove","mouseup","mouseleave"]}onDomEvent(t){this.fire(t.type,t)}}function hM(t,e,n,i){const{startRow:s,startColumn:o,endRow:r,endColumn:a}=e,l=n.createElement("table"),c=r-s+1;for(let t=0;t<c;t++)n.insertElement("tableRow",l,"end");const h=[...new $S(t,{startRow:s,endRow:r,includeSpanned:!0})];for(const{row:t,column:e,cell:c,isSpanned:d}of h){if(e<o||e>a)continue;const h=t-s,u=l.getChild(h);if(d){const{row:t,column:e}=i.getCellLocation(c);(t<s||e<o)&&US(n,n.createPositionAt(u,"end"))}else{const i=c._clone(!0);n.append(i,u),dM(i,t,e,r,a,n)}}return function(t,e,n,i,s){const o=parseInt(e.getAttribute("headingRows")||0);if(o>0){qS("headingRows",o-n,t,s,0)}const r=parseInt(e.getAttribute("headingColumns")||0);if(r>0){qS("headingColumns",r-i,t,s,0)}}(l,t,s,o,n),l}function dM(t,e,n,i,s,o){const r=parseInt(t.getAttribute("colspan")||1),a=parseInt(t.getAttribute("rowspan")||1);if(n+r-1>s){qS("colspan",s-n+1,t,o,1)}if(e+a-1>i){qS("rowspan",i-e+1,t,o,1)}}n(131);class uM extends Nc{static get pluginName(){return"TableSelection"}static get requires(){return[VO]}init(){const t=this.editor,e=t.model;this.listenTo(e,"deleteContent",(t,e)=>this._handleDeleteContent(t,e),{priority:"high"}),t.editing.view.addObserver(cM),this._defineSelectionConverter(),this._enableShiftClickSelection(),this._enableMouseDragSelection(),this._enablePluginDisabling()}getSelectedTableCells(){const t=ZS(this.editor.model.document.selection);return 0==t.length?null:t}getSelectionAsFragment(){const t=this.getSelectedTableCells();return t?this.editor.model.change(e=>{const n=e.createDocumentFragment(),{first:i,last:s}=nO(t),{first:o,last:r}=eO(t),a=hM(zS("table",t[0]),{startRow:o,startColumn:i,endRow:r,endColumn:s},e,this.editor.plugins.get("TableUtils"));return e.insert(a,n,0),n}):null}setCellSelection(t,e){const n=this._getCellsToSelect(t,e);this.editor.model.change(t=>{t.setSelection(n.cells.map(e=>t.createRangeOn(e)),{backward:n.backward})})}getFocusCell(){const t=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return t&&t.is("tableCell")?t:null}getAnchorCell(){const t=Fu(this.editor.model.document.selection.getRanges()).getContainedElement();return t&&t.is("tableCell")?t:null}_defineSelectionConverter(){const t=this.editor,e=new Set;t.conversion.for("editingDowncast").add(t=>t.on("selection",(t,n,i)=>{const s=i.writer;!function(t){for(const n of e)t.removeClass("ck-editor__editable_selected",n);e.clear()}(s);const o=this.getSelectedTableCells();if(!o)return;for(const t of o){const n=i.mapper.toViewElement(t);s.addClass("ck-editor__editable_selected",n),e.add(n)}const r=i.mapper.toViewElement(o[o.length-1]);s.setSelection(r,0)},{priority:"lowest"}))}_enableShiftClickSelection(){const t=this.editor;let e=!1;this.listenTo(t.editing.view.document,"mousedown",(n,i)=>{if(!this.isEnabled)return;if(!i.domEvent.shiftKey)return;const s=this.getAnchorCell()||XS(t.model.document.selection)[0];if(!s)return;const o=this._getModelTableCellFromDomEvent(i);o&&fM(s,o)&&(e=!0,this.setCellSelection(s,o),i.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{e=!1}),this.listenTo(t.editing.view.document,"selectionChange",t=>{e&&t.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let e,n,i=!1,s=!1;this.listenTo(t.editing.view.document,"mousedown",(t,n)=>{this.isEnabled&&(n.domEvent.shiftKey||n.domEvent.ctrlKey||n.domEvent.altKey||(e=this._getModelTableCellFromDomEvent(n)))}),this.listenTo(t.editing.view.document,"mousemove",(t,o)=>{if(!o.domEvent.buttons)return;if(!e)return;const r=this._getModelTableCellFromDomEvent(o);r&&fM(e,r)&&(n=r,i||n==e||(i=!0)),i&&(s=!0,this.setCellSelection(e,n),o.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{i=!1,s=!1,e=null,n=null}),this.listenTo(t.editing.view.document,"selectionChange",t=>{s&&t.stop()},{priority:"highest"})}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const e=this.getSelectedTableCells();if(!e)return;t.model.change(n=>{const i=n.createPositionAt(e[0],0),s=t.model.schema.getNearestSelectionRange(i);n.setSelection(s)})}})}_handleDeleteContent(t,e){const[n,i]=e,s=this.editor.model,o=!i||"backward"==i.direction,r=ZS(n);r.length&&(t.stop(),s.change(t=>{const e=r[o?r.length-1:0];s.change(t=>{for(const e of r)s.deleteContent(t.createSelection(e,"in"))});const i=s.schema.getNearestSelectionRange(t.createPositionAt(e,0));n.is("documentSelection")?t.setSelection(i):n.setTo(i)}))}_getModelTableCellFromDomEvent(t){const e=t.target,n=this.editor.editing.view.createPositionAt(e,0),i=this.editor.editing.mapper.toModelPosition(n).parent;return i.is("tableCell")?i:zS("tableCell",i)}_getCellsToSelect(t,e){const n=this.editor.plugins.get("TableUtils"),i=n.getCellLocation(t),s=n.getCellLocation(e),o=Math.min(i.row,s.row),r=Math.max(i.row,s.row),a=Math.min(i.column,s.column),l=Math.max(i.column,s.column),c=new Array(r-o+1).fill(null).map(()=>[]);for(const e of new $S(zS("table",t),{startRow:o,endRow:r}))e.column>=a&&e.column<=l&&c[e.row-o].push(e.cell);const h=s.row<i.row,d=s.column<i.column;return h&&c.reverse(),d&&c.forEach(t=>t.reverse()),{cells:c.flat(),backward:h||d}}}function fM(t,e){return t.parent.parent==e.parent.parent}class gM extends Nc{static get pluginName(){return"TableClipboard"}static get requires(){return[uM,VO]}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"copy",(t,e)=>this._onCopyCut(t,e)),this.listenTo(e,"cut",(t,e)=>this._onCopyCut(t,e)),this.listenTo(t.model,"insertContent",(t,e)=>this._onInsertContent(t,...e),{priority:"high"})}_onCopyCut(t,e){const n=this.editor.plugins.get(uM);if(!n.getSelectedTableCells())return;if("cut"==t.name&&this.editor.isReadOnly)return;e.preventDefault(),t.stop();const i=this.editor.data,s=this.editor.editing.view.document,o=i.toView(n.getSelectionAsFragment());s.fire("clipboardOutput",{dataTransfer:e.dataTransfer,content:o,method:t.name})}_onInsertContent(t,e,n){if(n&&!n.is("documentSelection"))return;const i=this.editor.model,s=this.editor.plugins.get(VO),o=tO(i.document.selection);if(!o.length)return;let r=function(t){if(t.is("table"))return t;if(1!=t.childCount||!t.getChild(0).is("table"))return null;return t.getChild(0)}(e);r&&(t.stop(),i.change(t=>{const e=nO(o),n=eO(o);let{first:i,last:a}=e,{first:l,last:c}=n;const h=s.getRows(r),d=s.getColumns(r),u=zS("table",o[0]),f=1===o.length;if(f&&(c+=h-1,a+=d-1,function(t,e,n,i,s){const o=s.getColumns(t),r=s.getRows(t);n>o&&s.insertColumns(t,{batch:i.batch,at:o,columns:n-o});e>r&&s.insertRows(t,{batch:i.batch,at:r,rows:e-r})}(u,c+1,a+1,t,s)),f||!iO(o,s)){!function(t,e,n){const{firstRow:i,lastRow:s,firstColumn:o,lastColumn:r}=e,a={first:i,last:s},l={first:o,last:r};mM(t,o,a,n),mM(t,r+1,a,n),pM(t,i,l,n),pM(t,s+1,l,n,i)}(u,{firstRow:l,lastRow:c,firstColumn:i,lastColumn:a},t)}else c=function(t,e,n){const i=new $S(t,{startRow:e.last,endRow:e.last}),s=Array.from(i).filter(({column:t})=>n.first<=t&&t<=n.last);if(s.every(({rowspan:t})=>1===t))return e.last;const o=s[0].rowspan-1;return e.last+o}(u,n,e),a=function(t,e,n){const i=Array.from(new $S(t,{startRow:e.first,endRow:e.last,column:n.last}));if(i.every(({colspan:t})=>1===t))return n.last;const s=i[0].colspan-1;return n.last+s}(u,n,e);const g=c-l+1,p=a-i+1,m={startRow:0,startColumn:0,endRow:Math.min(g-1,h-1),endColumn:Math.min(p-1,d-1)};r=hM(r,m,t,s);!function(t,e,n,i,s){const{firstColumnOfSelection:o,lastColumnOfSelection:r,firstRowOfSelection:a,lastRowOfSelection:l}=i,{width:c,height:h}=e,d=function(t,e,n){const i=new Array(n).fill(null).map(()=>new Array(e).fill(null));for(const{column:e,row:n,cell:s}of new $S(t))i[n][e]=s;return i}(t,c,h),u=[...new $S(n,{startRow:a,endRow:l,includeSpanned:!0})],f=[];let g;for(const{row:t,column:e,cell:i,isSpanned:p}of u){if(0===e&&(g=null),e<o||e>r){p||(g=i);continue}p||s.remove(i);const u=e-o,m=d[(t-a)%h][u%c];if(!m)continue;const b=m._clone(!0);let w;dM(b,t,e,l,r,s),w=g?s.createPositionAfter(g):s.createPositionAt(n.getChild(t),0),s.insert(b,w),f.push(b),g=b}s.setSelection(f.map(t=>s.createRangeOn(t)))}(r,{width:d,height:h},u,{firstColumnOfSelection:i,firstRowOfSelection:l,lastColumnOfSelection:a,lastRowOfSelection:c},t)}))}}function pM(t,e,n,i,s=0){if(e<1)return;const o=sO(t,e,s).filter(({column:t,colspan:e})=>bM(t,e,n));for(const{cell:t}of o)oO(t,e,i)}function mM(t,e,n,i){if(e<1)return;const s=rO(t,e).filter(({row:t,rowspan:e})=>bM(t,e,n));for(const{cell:t,column:n}of s)aO(t,n,e,i)}function bM(t,e,n){const i=t+e-1,{first:s,last:o}=n;return t>=s&&t<=o||t<s&&i>=s}class wM extends Nc{static get pluginName(){return"TableNavigation"}static get requires(){return[uM]}init(){const t=this.editor.editing.view.document;this.editor.keystrokes.set("Tab",(...t)=>this._handleTabOnSelectedTable(...t),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"keydown",(...t)=>this._onKeydown(...t),{priority:qC.get("high")+1})}_handleTabOnSelectedTable(t,e){const n=this.editor,i=n.model.document.selection;if(!i.isCollapsed&&1===i.rangeCount&&i.getFirstRange().isFlat){const t=i.getSelectedElement();if(!t||!t.is("table"))return;e(),n.model.change(e=>{e.setSelection(e.createRangeIn(t.getChild(0).getChild(0)))})}}_getTabHandler(t){const e=this.editor;return(n,i)=>{const s=XS(e.model.document.selection)[0];if(!s)return;i();const o=s.parent,r=o.parent,a=r.getChildIndex(o),l=o.getChildIndex(s),c=0===l;if(!t&&c&&0===a)return;const h=l===o.childCount-1,d=a===r.childCount-1;if(t&&d&&h&&(e.execute("insertTableRowBelow"),a===r.childCount-1))return;let u;if(t&&h){const t=r.getChild(a+1);u=t.getChild(0)}else if(!t&&c){const t=r.getChild(a-1);u=t.getChild(t.childCount-1)}else u=o.getChild(l+(t?1:-1));e.model.change(t=>{t.setSelection(t.createRangeIn(u))})}}_onKeydown(t,e){const n=e.keyCode;if(!function(t){return t==aT.arrowright||t==aT.arrowleft||t==aT.arrowup||t==aT.arrowdown}(n))return;const i=function(t,e){const n="ltr"===e;switch(t){case aT.arrowleft:return n?"left":"right";case aT.arrowright:return n?"right":"left";case aT.arrowup:return"up";case aT.arrowdown:return"down"}}(n,this.editor.locale.contentLanguageDirection);this._handleArrowKeys(i,e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),t.stop())}_handleArrowKeys(t,e){const n=this.editor.model,i=n.document.selection,s=["right","down"].includes(t),o=ZS(i);if(o.length){let n;return n=e?this.editor.plugins.get("TableSelection").getFocusCell():s?o[o.length-1]:o[0],this._navigateFromCellInDirection(n,t,e),!0}const r=zS("tableCell",i.focus);if(!r)return!1;const a=n.createRangeIn(r);if(this._isSelectionAtCellEdge(i,s))return this._navigateFromCellInDirection(r,t,e),!0;const l=i.getSelectedElement();if(l&&n.schema.isObject(l))return!1;if(this._isObjectElementNextToSelection(i,s))return!1;const c=this._findTextRangeFromSelection(a,i,s);return c?!["left","right"].includes(t)&&(this._isSingleLineRange(c,s)?(n.change(t=>{const o=s?a.end:a.start;if(e){const e=n.createSelection(i.anchor);e.setFocus(o),t.setSelection(e)}else t.setSelection(o)}),!0):void 0):(this._navigateFromCellInDirection(r,t,e),!0)}_isSelectionAtCellEdge(t,e){const n=this.editor.model,i=this.editor.model.schema,s=e?t.getLastPosition():t.getFirstPosition();if(!i.getLimitElement(s).is("tableCell"))return!1;const o=n.createSelection(s);return n.modifySelection(o,{direction:e?"forward":"backward"}),s.isEqual(o.focus)}_isObjectElementNextToSelection(t,e){const n=this.editor.model,i=n.schema,s=n.createSelection(t);n.modifySelection(s,{direction:e?"forward":"backward"});const o=e?s.focus.nodeBefore:s.focus.nodeAfter;return o&&i.isObject(o)}_findTextRangeFromSelection(t,e,n){const i=this.editor.model;if(n){const n=e.getLastPosition(),s=this._getNearestVisibleTextPosition(t,"backward");return s&&n.isBefore(s)?i.createRange(n,s):null}{const n=e.getFirstPosition(),s=this._getNearestVisibleTextPosition(t,"forward");return s&&n.isAfter(s)?i.createRange(s,n):null}}_getNearestVisibleTextPosition(t,e){const n=this.editor.model.schema,i=this.editor.editing.mapper;for(const{nextPosition:s,item:o}of t.getWalker({direction:e}))if(n.checkChild(s,"$text")){const t=i.toViewElement(o);if(t&&!t.hasClass("ck-hidden"))return s}}_isSingleLineRange(t,e){const n=this.editor.model,i=this.editor.editing,s=i.view.domConverter;if(e){const e=n.createSelection(t.start);n.modifySelection(e),e.focus.isAtEnd||t.start.isEqual(e.focus)||(t=n.createRange(e.focus,t.end))}const o=i.mapper.toViewRange(t),r=s.viewRangeToDom(o),a=pg.getDomRangeRects(r);let l;for(const t of a)if(void 0!==l){if(Math.round(t.top)>=l)return!1;l=Math.max(l,Math.round(t.bottom))}else l=Math.round(t.bottom);return!0}_navigateFromCellInDirection(t,e,n=!1){const i=this.editor.model,s=zS("table",t),o=[...new $S(s,{includeSpanned:!0})],{row:r,column:a}=o[o.length-1],l=o.find(({cell:e})=>e==t);let{row:c,column:h}=l;switch(e){case"left":h--;break;case"up":c--;break;case"right":h+=l.colspan;break;case"down":c+=l.rowspan}if(c<0||c>r||h<0&&c<=0||h>a&&c>=r)return void i.change(t=>{t.setSelection(t.createRangeOn(s))});h<0?(h=n?0:a,c--):h>a&&(h=n?a:0,c++);const d=o.find(t=>t.row==c&&t.column==h).cell,u=["right","down"].includes(e);if(n){const e=this.editor.plugins.get("TableSelection"),n=e.getAnchorCell()||t;e.setCellSelection(n,d)}else{const t=i.createPositionAt(d,u?0:"end");i.change(e=>{e.setSelection(t)})}}}n(133);class _M extends Nc{static get pluginName(){return"UnderlineEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"underline"}),t.model.schema.setAttributeProperties("underline",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"underline",view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),t.commands.add("underline",new vg(t,"underline")),t.keystrokes.set("CTRL+U","underline")}}class kM extends Nc{init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("underline",n=>{const i=t.commands.get("underline"),s=new ld(n);return s.set({label:e("Underline"),icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="underline-a" d="M11.48,17.216 C7.988,17.216 6.278,15.218 6.278,12.266 L6.278,4.994 L8.402,4.994 L8.402,12.194 C8.402,14.102 9.464,15.344 11.48,15.344 C13.478,15.344 14.54,14.102 14.54,12.194 L14.54,4.994 L16.664,4.994 L16.664,12.248 C16.664,15.236 14.954,17.216 11.48,17.216 Z M5,18 L18,18 L18,20 L5,20 L5,18 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#underline-a"/>\n  </g>\n</svg>\n',keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",()=>{t.execute("underline"),t.editing.view.focus()}),s})}}class vM{constructor(t,e){this.model=t,this.testCallback=e,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(t.document.selection),this.stopListening(t.document))}),this._startListening()}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(e,{directChange:n})=>{n&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))}),this.listenTo(t,"change:data",(t,e)=>{"transparent"!=e.type&&this._evaluateTextBeforeSelection("data",{batch:e})})}_evaluateTextBeforeSelection(t,e={}){const n=this.model,i=n.document.selection,s=n.createRange(n.createPositionAt(i.focus.parent,0),i.focus),{text:o,range:r}=Iu(s,n),a=this.testCallback(o);if(!a&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!a,a){const n=Object.assign(e,{text:o,range:r});"object"==typeof a&&Object.assign(n,a),this.fire("matched:"+t,n)}}}Ik(vM,Xk);var yM=/[\\^$.*+?()[\]{}|]/g,xM=RegExp(yM.source);var CM=function(t){return(t=Zn(t))&&xM.test(t)?t.replace(yM,"\\$&"):t};const EM={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:"1/2",to:"½"},oneThird:{from:"1/3",to:"⅓"},twoThirds:{from:"2/3",to:"⅔"},oneForth:{from:"1/4",to:"¼"},threeQuarters:{from:"3/4",to:"¾"},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:MM('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:MM("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:MM("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:MM('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:MM('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:MM("'"),to:[null,"‚",null,"’"]}},TM={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},AM=["symbols","mathematical","typography","quotes"];function PM(t){return"string"==typeof t?new RegExp(`(${CM(t)})$`):t}function SM(t){return"string"==typeof t?()=>[t]:t instanceof Array?()=>t:t}function OM(t){return(t.textNode?t.textNode:t.nodeAfter).getAttributes()}function MM(t){return new RegExp(`(^|\\s)(${t})([^${t}]*)(${t})$`)}n(135);class NM extends Vu{refresh(){const t=this.editor.model,e=t.document;this.value=e.selection.getAttribute("customHighlight"),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"customHighlight")}execute(t={}){const e=this.editor.model,n=e.document.selection,i=t.value;e.change(t=>{const s=e.schema.getValidRanges(n.getRanges(),"customHighlight");if(n.isCollapsed){const e=n.getFirstPosition();if(n.hasAttribute("customHighlight")){const n=t=>t.item.hasAttribute("customHighlight")&&t.item.getAttribute("customHighlight")===this.value,s=e.getLastMatchingPosition(n,{direction:"backward"}),o=e.getLastMatchingPosition(n),r=t.createRange(s,o);i&&this.value!==i?(t.setAttribute("customHighlight",i,r),t.setSelectionAttribute("customHighlight",i)):(t.removeAttribute("customHighlight",r),t.removeSelectionAttribute("customHighlight"))}else i&&t.setSelectionAttribute("customHighlight",i)}else for(const e of s)i?t.setAttribute("customHighlight",i,e):t.removeAttribute("customHighlight",e)})}}class IM extends Nc{constructor(t){super(t),t.config.define("customHighlight",{options:{markers:[{model:"blueMarker",class:"marker-blue",title:"Голубой маркер",color:"#ddf5fb",type:"marker"},{model:"yellowMarker",class:"marker-yellow",title:"Желтый маркер",color:"#fdf5dd",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Зеленый маркер",color:"#e3f7f3",type:"marker"},{model:"orangeMarker",class:"marker-orange",title:"Оранжевый маркер",color:"#fbe8df",type:"marker"},{model:"grayMarker",class:"marker-gray",title:"Серый маркер",color:"#f0f2f3",type:"marker"}],pens:[{model:"lightBluePen",class:"pen-light-blue",title:"Голубой",color:"#1ebfe9",type:"pen"},{model:"bluePen",class:"pen-blue",title:"Синий",color:"#1f8ceb",type:"pen"},{model:"yellowPen",class:"pen-yellow",title:"Желтый",color:"#f4c221",type:"pen"},{model:"greenPen",class:"pen-green",title:"Зеленый",color:"#3bc7ab",type:"pen"},{model:"orangePen",class:"pen-orange",title:"Оранжевый",color:"#e86d31",type:"pen"},{model:"redPen",class:"pen-red",title:"Красный",color:"#f35e5e",type:"pen"},{model:"blackPen",class:"pen-black",title:"Черный",color:"#333333",type:"pen"},{model:"darkGrayPen",class:"pen-dark-gray",title:"Темный серый",color:"#556066",type:"pen"},{model:"mediumGrayPen",class:"pen-medium-gray",title:"Серый",color:"#9aa5ab",type:"pen"},{model:"grayPen",class:"pen-gray",title:"Серый",color:"#c4c7cc",type:"pen"},{model:"lightGrayPen",class:"pen-light-gray",title:"Светлый серый",color:"#e4e5e9",type:"pen"}]}})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"customHighlight"});const e=t.config.get("customHighlight.options");t.conversion.attributeToElement(function(t){const e={model:{key:"customHighlight",values:[]},view:{}};for(const n of[...t.markers,...t.pens])e.model.values.push(n.model),e.view[n.model]={name:"mark",classes:n.class};return e}(e)),t.commands.add("customHighlight",new NM(t))}}class RM extends Nc{static get pluginName(){return"CustomHighlightUI"}init(){const t=this.editor.config.get("customHighlight.options");for(const e of[...t.markers,...t.pens])this._addHighlighterButton(e);this._addRemoveHighlightButton(),this._addDropdown(t)}_addRemoveHighlightButton(){this._addButton("removeCustomHighlight","Убрать выделение",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="erasor-a" d="M10.9987151,16.2857265 L13.9987187,12.857151 L7.14156768,12.857151 L4.1415641,16.2857265 L10.9987151,16.2857265 Z M20.0433688,6.66964366 C20.2219404,7.08035843 20.1505118,7.55357328 19.8558685,7.8928594 L11.855859,17.0357274 C11.641573,17.2857277 11.3290727,17.4285851 10.9987151,17.4285851 L4.1415641,17.4285851 C3.695135,17.4285851 3.28442022,17.1696562 3.09692,16.7589414 C2.91834836,16.3482266 2.98977701,15.8750118 3.28442022,15.5357257 L11.2844298,6.39285761 C11.4987157,6.14285731 11.8112161,6 12.1415736,6 L18.9987247,6 C19.4451538,6 19.8558685,6.25892888 20.0433688,6.66964366 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#erasor-a"/>\n  </g>\n</svg>\n',null,t=>{t.class="ck-button_eraser"})}_addHighlighterButton(t){const e=this.editor.commands.get("customHighlight");this._addButton("customHighlight:"+t.model,t.title,'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="square" class="svg-inline--fa fa-square fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"></path></svg>',t.model,(function(n){n.bind("isEnabled").to(e,"isEnabled"),n.bind("isOn").to(e,"value",e=>e===t.model),n.class=t.class}))}_addButton(t,e,n,i,s=(()=>{})){const o=this.editor;o.ui.componentFactory.add(t,t=>{const r=new ld(t);return r.set({label:e,icon:n,tooltip:!0}),r.on("execute",()=>{o.execute("customHighlight",{value:i}),o.editing.view.focus()}),s(r),r})}_addDropdown(t){const e=this.editor,n=e.ui.componentFactory,i=[...t.markers,...t.pens][0];n.add("customHighlight",s=>{const o=e.commands.get("customHighlight"),r=Sd(s);r.set({panelPosition:"se",class:["ck-custom-highlight"]});const a=r.buttonView;r.bind("isEnabled").to(o),a.set({tooltip:"Цвет текста",lastExecuted:i.model,commandValue:i.model,icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="brush-a" d="M19.022,6.224 C19.1660007,6.36800072 19.238,6.54499895 19.238,6.755 C19.238,6.96500105 19.1660007,7.14199928 19.022,7.286 L12.308,14 L10.238,11.93 L16.952,5.216 C17.0960007,5.07199928 17.272999,5 17.483,5 C17.693001,5 17.8699993,5.07199928 18.014,5.216 L19.022,6.224 Z M8.726,13.262 C9.12200198,13.262 9.49399826,13.363999 9.842,13.568 C10.1900017,13.772001 10.465999,14.0479983 10.67,14.396 C10.874001,14.7440017 10.976,15.115998 10.976,15.512 C10.976,16.0520027 10.8410014,16.5499977 10.571,17.006 C10.3009987,17.4620023 9.93800228,17.8249987 9.482,18.095 C9.02599772,18.3650014 8.52500273,18.5 7.979,18.5 C7.43299727,18.5 6.88700273,18.3620014 6.341,18.086 C5.79499727,17.8099986 5.34800174,17.4440023 5,16.988 C5.22800114,16.988 5.45599886,16.9310006 5.684,16.817 C5.91200114,16.7029994 6.09799928,16.544001 6.242,16.34 C6.39800078,16.0999988 6.476,15.8240016 6.476,15.512 C6.476,15.115998 6.57799898,14.7440017 6.782,14.396 C6.98600102,14.0479983 7.26199826,13.772001 7.61,13.568 C7.95800174,13.363999 8.32999802,13.262 8.726,13.262 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#brush-a"/>\n  </g>\n</svg>\n'});const l=t.pens.map(t=>{const i=n.create("customHighlight:"+t.model);return this.listenTo(i,"execute",()=>{e.execute("customHighlight",{value:t.model})}),i}),c=t.markers.map(t=>{const i=n.create("customHighlight:"+t.model);return this.listenTo(i,"execute",()=>{e.execute("customHighlight",{value:t.model})}),i}),h=new dT("Выбор цвета текста"),d=new dT("Выбор цвета выделения текста");l.push(n.create("removeCustomHighlight")),c.push(n.create("removeCustomHighlight"));const u=new Ku("div",[h,Ju(r,l),d,Ju(r,c)]);return r.render(),r.panelView.children.add(u),r})}}const LM={heading1:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="h1-a" d="M13.9641577,18 L13.9641577,6 L12.4767025,6 L12.4767025,11.1634183 L5.4874552,11.1634183 L5.4874552,6 L4,6 L4,18 L5.4874552,18 L5.4874552,12.4947526 L12.4767025,12.4947526 L12.4767025,18 L13.9641577,18 Z M19,18 L19,8.66666667 L17.9824771,8.66666667 L15.6547192,11.0734633 L16.3516527,11.7871064 L17.8430904,10.2058971 L17.8430904,18 L19,18 Z"/>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <use xlink:href="#h1-a"/>\n  </g>\n</svg>\n',heading2:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',heading3:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53l1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',heading4:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',heading5:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607l1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',heading6:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973l-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>'};const DM=(t,e)=>({top:t.top+(t.height-e.height)+3,left:t.left+t.width});class VM extends Nc{static get requires(){return[dd]}static get pluginName(){return"WidgetToolbarPlugin"}init(){const t=this.editor;if(t.plugins.has("BalloonToolbar")){const e=t.plugins.get("BalloonToolbar");this.listenTo(e,"show",e=>{(function(t){const e=t.getSelectedElement();return!(!e||!function(t){if(!t.is("element"))return!1;return!!t.getCustomProperty("widget")}(e))})(t.editing.view.document.selection)&&e.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.listenTo(t.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const t of this._toolbarDefinitions.values())t.view.destroy()}register(t,{items:e,getRelatedElement:n,balloonClassName:i="ck-toolbar-container"}){const s=this.editor,o=new Nd;if(o.set({isVertical:!0}),this._toolbarDefinitions.has(t))throw new Dm.b("widget-toolbar-duplicated: Toolbar with the given id was already added.",{toolbarId:t});o.fillFromConfig(e,s.ui.componentFactory),this._toolbarDefinitions.set(t,{view:o,getRelatedElement:n,balloonClassName:i})}_updateToolbarsVisibility(){let t=0,e=null,n=null;for(const i of this._toolbarDefinitions.values()){const s=i.getRelatedElement(this.editor.editing.view.document.selection);if(this.editor.ui.focusTracker.isFocused&&s){const o=s.getAncestors().length;o>t&&(t=o,e=s,n=i)}else this._hideToolbar(i)}n&&this._showToolbar(n,e)}_hideToolbar(t){this._isToolbarVisible(t)&&this._balloon.remove(t.view)}_showToolbar(t,e){this._isToolbarVisible(t)?function(t,e){const n=t.plugins.get("ContextualBalloon"),i=BM(t,e);n.set({withArrow:!1}),n.updatePosition(i)}(this.editor,e):this._balloon.hasView(t.view)||this._balloon.add({view:t.view,position:BM(this.editor,e),balloonClassName:t.balloonClassName})}_isToolbarVisible(t){return this._balloon.visibleView==t.view}}function BM(t,e){return{target:t.editing.view.domConverter.viewToDom(e),positions:[DM]}}function FM(t){const e=t.getSelectedElement();return e&&function(t){return!!t.getCustomProperty("delimiter")&&vp(t)}(e)?e:null}class jM extends nu{}jM.builtinPlugins=[class extends Nc{static get requires(){return[m_,H_,rk,G_,Wv,Uy]}static get pluginName(){return"Essentials"}},bb,class extends Nc{static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats()}_addListAutoformats(){const t=this.editor.commands;t.get("bulletedList")&&new Nu(this.editor,/^[*-]\s$/,"bulletedList"),t.get("numberedList")&&new Nu(this.editor,/^1[.|)]\s$/,"numberedList")}_addBasicStylesAutoformats(){const t=this.editor.commands;if(t.get("bold")){const t=Du(this.editor,"bold");new Ru(this.editor,/(\*\*)([^*]+)(\*\*)$/g,t),new Ru(this.editor,/(__)([^_]+)(__)$/g,t)}if(t.get("italic")){const t=Du(this.editor,"italic");new Ru(this.editor,/(?:^|[^*])(\*)([^*_]+)(\*)$/g,t),new Ru(this.editor,/(?:^|[^_])(_)([^_]+)(_)$/g,t)}if(t.get("code")){const t=Du(this.editor,"code");new Ru(this.editor,/(`)([^`]+)(`)$/g,t)}if(t.get("strikethrough")){const t=Du(this.editor,"strikethrough");new Ru(this.editor,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const t=this.editor.commands.get("heading");t&&t.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(e=>{const n=e[7],i=new RegExp(`^(#{${n}})\\s$`);new Nu(this.editor,i,()=>{if(!t.isEnabled)return!1;this.editor.execute("heading",{value:e})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&new Nu(this.editor,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){this.editor.commands.get("codeBlock")&&new Nu(this.editor,/^```$/,"codeBlock")}},class extends Nc{static get requires(){return[Wu,Yu]}static get pluginName(){return"Alignment"}},class extends Nc{static get requires(){return[$f,Yf]}static get pluginName(){return"FontSize"}},class extends Nc{static get requires(){return[eg,ng]}static get pluginName(){return"FontFamily"}},class extends Nc{static get requires(){return[sg,rg]}static get pluginName(){return"Highlight"}},class extends Nc{static get requires(){return[IM,RM]}static get pluginName(){return"CustomHighlight"}},class extends Nc{static get pluginName(){return"BlockToolbar"}constructor(t){super(t),this.toolbarView=this._createToolbarView(),this.panelView=this._createPanelView(),this.buttonView=this._createButtonView(),Pd({emitter:this.panelView,contextElements:[this.panelView.element,this.buttonView.element],activator:()=>this.panelView.isVisible,callback:()=>this._hidePanel()})}init(){const t=this.editor;this.listenTo(t.model.document.selection,"change:range",(t,e)=>{e.directChange&&this._hidePanel()}),this.listenTo(t.ui,"update",()=>this._updateButton()),this.listenTo(t,"change:isReadOnly",()=>this._updateButton(),{priority:"low"}),this.listenTo(t.ui.focusTracker,"change:isFocused",()=>this._updateButton()),this.listenTo(this.buttonView,"change:isVisible",(t,e,n)=>{n?this.buttonView.listenTo(window,"resize",()=>this._updateButton()):(this.buttonView.stopListening(window,"resize"),this._hidePanel())})}afterInit(){const t=this.editor.ui.componentFactory,e=this.editor.config.get("blockToolbar");this.toolbarView.fillFromConfig(e,t);for(const t of this.toolbarView.items)t.on("execute",()=>this._hidePanel(!0),{priority:"high"})}destroy(){super.destroy(),this.panelView.destroy(),this.buttonView.destroy(),this.toolbarView.destroy()}_createToolbarView(){const t=new Nd(this.editor.locale);return t.extendTemplate({attributes:{class:["ck-toolbar_floating"]}}),t.focusTracker.on("change:isFocused",(t,e,n)=>{n||this._hidePanel()}),t}_createPanelView(){const t=this.editor,e=new $h(t.locale);return e.content.add(this.toolbarView),e.class="ck-toolbar-container",t.ui.view.body.add(e),t.ui.focusTracker.add(e.element),this.toolbarView.keystrokes.set("Esc",(t,e)=>{this._hidePanel(!0),e()}),e}_createButtonView(){const t=this.editor,e=t.t,n=new cg(t.locale);return n.set({label:e("Edit block"),icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path fill="#1f8ceb" d="M0.530276514,8.03380613 C0.234829923,8.03380613 0,7.79147055 0,7.49618369 C0,7.20089683 0.234829923,6.96619387 0.530276514,6.96619387 L6.96184809,6.96619387 L6.96184809,0.53762244 C6.96232539,0.242335581 7.20479206,0 7.50023865,0 C7.79568524,0 8.03051516,0.242335581 8.03051516,0.53762244 L8.03051516,6.96619387 L14.4620867,6.96619387 C14.7575333,6.96619387 15,7.20089683 15,7.49618369 C15,7.79147055 14.7575333,8.03380613 14.4620867,8.03380613 L8.03051516,8.03380613 L8.03051516,14.4623776 C8.03051516,14.7576644 7.79568524,15 7.50023865,15 C7.20479206,15 6.96232539,14.7576644 6.96232539,14.4623776 L6.96232539,8.03380613 L0.530276514,8.03380613 Z" transform="translate(5 5)"/>\n</svg>\n',withText:!1}),n.bind("isOn").to(this.panelView,"isVisible"),this.listenTo(n,"execute",()=>{this.panelView.isVisible?this._hidePanel(!0):this._showPanel()}),t.ui.view.body.add(n),t.ui.focusTracker.add(n.element),n}_updateButton(){const t=this.editor,e=t.model,n=t.editing.view;if(!t.ui.focusTracker.isFocused)return void this._hideButton();if(t.isReadOnly)return void this._hideButton();const i=Array.from(e.document.selection.getSelectedBlocks())[0];if(!i||Array.from(this.toolbarView.items).every(t=>!t.isEnabled))return void this._hideButton();const s=n.domConverter.mapViewToDom(t.editing.mapper.toViewElement(i));this.buttonView.isVisible=!0,this._attachButtonToElement(s),this.panelView.isVisible&&this._showPanel()}_hideButton(){this.buttonView.isVisible=!1}_showPanel(){const t=this.panelView.isVisible;this.panelView.pin({target:this.buttonView.element,limiter:this.editor.ui.getEditableElement()}),t||this.toolbarView.items.get(0).focus()}_hidePanel(t){this.panelView.isVisible=!1,t&&this.editor.editing.view.focus()}_attachButtonToElement(t){const e=window.getComputedStyle(t),n=new pg(this.editor.ui.getEditableElement()),i=parseInt(e.paddingTop,10),s=parseInt(e.lineHeight,10)||1.2*parseInt(e.fontSize,10),o=wg({element:this.buttonView.element,target:t,positions:[(t,e)=>({top:t.top+i+(s-e.height)/2,left:n.left-e.width})]});this.buttonView.top=o.top,this.buttonView.left=o.left}},class extends Nc{static get requires(){return[yg,xg]}static get pluginName(){return"Bold"}},class extends Nc{static get requires(){return[Wb,Hb]}},class extends Nc{static get requires(){return[VM]}static get pluginName(){return"DelimiterToolbar"}afterInit(){this.editor.plugins.get(VM).register("delimiter",{items:["removeDelimiter"],balloonClassName:"ck-delimiter-remove-container",getRelatedElement:FM})}},class extends Nc{static get requires(){return[PE,SE]}static get pluginName(){return"Italic"}},class extends Nc{static get requires(){return[FS,jS]}static get pluginName(){return"Strikethrough"}},class extends Nc{static get requires(){return[_M,kM]}static get pluginName(){return"Underline"}},class extends Nc{static get requires(){return[nf,sf]}static get pluginName(){return"BlockQuote"}},class extends Nc{static get pluginName(){return"CKFinder"}static get requires(){return[Fm,Cg,bb]}},class extends Nc{static get requires(){return[kx,Gx,RC]}static get pluginName(){return"EasyImage"}},class extends Nc{static get requires(){return[BC,tE]}static get pluginName(){return"Heading"}},class extends Nc{init(){(function(t){const e=t.t,n={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3"),"Heading 4":e("Heading 4"),"Heading 5":e("Heading 5"),"Heading 6":e("Heading 6")};return t.config.get("heading.options").map(t=>{const e=n[t.title];return e&&e!=t.title&&(t.title=e),t})})(this.editor).filter(t=>"paragraph"!==t.model).map(t=>this._createButton(t))}_createButton(t){const e=this.editor;e.ui.componentFactory.add(t.model,n=>{const i=new ld(n),s=e.commands.get("heading");return i.label=t.title,i.icon=t.icon||LM[t.model],i.tooltip=!0,i.isToggleable=!0,i.bind("isEnabled").to(s),i.bind("isOn").to(s,"value",e=>e==t.model),i.on("execute",()=>{e.execute("heading",{value:t.model}),e.editing.view.focus()}),i})}},Gx,class extends Nc{static get requires(){return[lE]}static get pluginName(){return"ImageCaption"}},class extends Nc{static get requires(){return[xE,CE]}static get pluginName(){return"ImageStyle"}},class extends Nc{static get requires(){return[EE]}static get pluginName(){return"ImageToolbar"}afterInit(){const t=this.editor,e=t.t;t.plugins.get(EE).register("image",{ariaLabel:e("Image toolbar"),items:t.config.get("image.toolbar")||[],getRelatedElement:Pp})}},RC,class extends Nc{static get pluginName(){return"Indent"}static get requires(){return[ME,RE]}},class extends Nc{static get requires(){return[Im,gT]}static get pluginName(){return"Link"}},class extends Nc{static get requires(){return[bA,_A]}static get pluginName(){return"List"}},class extends Nc{static get requires(){return[SA,gP,uP,jb]}static get pluginName(){return"MediaEmbed"}},Ob,class extends Nc{static get pluginName(){return"PasteFromOffice"}static get requires(){return[m_]}init(){const t=this.editor,e=t.editing.view.document,n=[];n.push(new BS(e)),n.push(new gS(e)),t.plugins.get("Clipboard").on("inputTransformation",(t,e)=>{if(e.isTransformedWithPasteFromOffice)return;const i=e.dataTransfer.getData("text/html"),s=n.find(t=>t.isActive(i));s&&(s.execute(e),e.isTransformedWithPasteFromOffice=!0)},{priority:"high"})}},class extends Nc{static get requires(){return[sM,aM,uM,gM,wM,jb]}static get pluginName(){return"Table"}},class extends Nc{static get requires(){return[EE]}static get pluginName(){return"TableToolbar"}afterInit(){const t=this.editor,e=t.t,n=t.plugins.get(EE),i=t.config.get("table.contentToolbar"),s=t.config.get("table.tableToolbar");i&&n.register("tableContent",{ariaLabel:e("Table toolbar"),items:i,getRelatedElement:QS}),s&&n.register("table",{ariaLabel:e("Table toolbar"),items:s,getRelatedElement:YS})}},class extends Nc{static get pluginName(){return"TextTransformation"}constructor(t){super(t),t.config.define("typing",{transformations:{include:AM}})}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const t=this.editor,e=t.model,n=t.plugins.get("Input"),i=function(t){const e=t.extra||[],n=t.remove||[],i=t=>!n.includes(t);return function(t){const e=new Set;for(const n of t)if(TM[n])for(const t of TM[n])e.add(t);else e.add(n);return Array.from(e)}(t.include.concat(e).filter(i)).filter(i).map(t=>EM[t]||t).map(t=>({from:PM(t.from),to:SM(t.to)}))}(t.config.get("typing.transformations")),s=new vM(t.model,t=>{for(const e of i){if(e.from.test(t))return{normalizedTransformation:e}}});s.on("matched:data",(t,i)=>{if(!n.isInput(i.batch))return;const{from:s,to:o}=i.normalizedTransformation,r=s.exec(i.text),a=o(r.slice(1)),l=i.range;let c=r.index;e.enqueueChange(t=>{for(let n=1;n<r.length;n++){const i=r[n],s=a[n-1];if(null==s){c+=i.length;continue}const o=l.start.getShiftedBy(c),h=e.createRange(o,o.getShiftedBy(i.length)),d=OM(o);e.insertContent(t.createText(s,d),h),c+=s.length}})}),s.bind("isEnabled").to(this)}}],jM.defaultConfig={extraPlugins:[function(t){t.plugins.get("FileRepository").createUploadAdapter=e=>new mT(e,t.config._config.fileUploadOptions)}],blockToolbar:["delimiter","numberedList","bulletedList","imageUpload","mediaEmbed","blockQuote","insertTable"],toolbar:{items:["bold","italic","underline","strikethrough","|","numberedList","bulletedList","alignment","link","heading","customHighlight","blockQuote"]},image:{toolbar:["imageStyle:alignLeft","imageStyle:full","imageStyle:alignRight"],styles:["full","alignLeft","alignRight"]},heading:{options:[{model:"heading1",view:"h1",title:"Заголовок H1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Заголовок H2",class:"ck-heading_heading2"},{model:"paragraph",title:"Параграф",class:"ck-heading_paragraph"}]},table:{contentToolbar:["heading1","tableColumn","tableRow","mergeTableCells"]},alignment:{options:["left","right","center"]},mediaEmbed:{previewsInData:!0},language:"ru"}}]).default}));
//# sourceMappingURL=ckeditor.js.map